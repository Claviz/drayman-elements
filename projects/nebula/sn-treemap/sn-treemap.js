/*
* @nebula.js/sn-treemap v1.0.0-alpha.12
* Copyright (c) 2022 Qlik
* Released under the MIT license.
*/

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@nebula.js/stardust")):"function"==typeof define&&define.amd?define(["@nebula.js/stardust"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["sn-treemap"]=e(t.stardust)}(this,(function(t){"use strict";function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function n(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new _(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return D()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var h={};function f(){}function d(){}function p(){}var m={};u(m,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(q([])));y&&y!==e&&n.call(y,o)&&(m=y);var v=p.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;this._invoke=function(t,n){function o(){return new e((function(e,i){r(t,n,e,i)}))}return i=i?i.then(o,o):o()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function q(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:D}}function D(){return{value:void 0,done:!0}}return d.prototype=p,u(v,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(v),u(v,s,"Generator"),u(v,o,(function(){return this})),u(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=q,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:q(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function s(t){o(a,r,i,s,u,"next",t)}function u(t){o(a,r,i,s,u,"throw",t)}s(void 0)}))}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function m(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=d(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function g(t){return g="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)},g(t)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var M=Object.prototype.hasOwnProperty,k=Object.prototype.toString,_=Object.defineProperty,q=Object.getOwnPropertyDescriptor,D=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===k.call(t)},S=function(t){if(!t||"[object Object]"!==k.call(t))return!1;var e,n=M.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&M.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||M.call(t,e)},C=function(t,e){_&&"__proto__"===e.name?_(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},E=function(t,e){if("__proto__"===e){if(!M.call(t,e))return;if(q)return q(t,e).value}return t[e]},A=function t(){var e,n,r,o,a,s,u=arguments[0],l=1,c=arguments.length,h=!1;for("boolean"==typeof u&&(h=u,u=arguments[1]||{},l=2),(null==u||"object"!=i(u)&&"function"!=typeof u)&&(u={});l<c;++l)if(null!=(e=arguments[l]))for(n in e)r=E(u,n),u!==(o=E(e,n))&&(h&&o&&(S(o)||(a=D(o)))?(a?(a=!1,s=r&&D(r)?r:[]):s=r&&S(r)?r:{},C(u,{name:n,newValue:t(h,s,o)})):void 0!==o&&C(u,{name:n,newValue:o}));return u};function N(t,e){return{range:function(t){var n=t.resources,r=t.data,i=n.theme.palette("categorical",0===e?r.items.length:e);return r.items.map((function(t){return i[t.value%i.length]}))},valueAccessor:t.value}}function O(t,e){return{range:function(t){var n=t.resources,r=t.data,i=n.theme.palette("categorical",0===e?r.items.length:e);return r.items.map((function(t){return i[t.row.value%i.length]}))},valueAccessor:t.value}}function I(t,e,n,r,i){var o,a=i.byRow,s=i.byElemNo;if(r&&(e.input.persistent||t.hc.qDimensionInfo.length>1||void 0===n.activeDimensionIndex&&t.hc.qSize.qcy>((null===(o=t.hc.qDataPages[0])||void 0===o?void 0:o.qArea.qHeight)||0)))return s(r,r.raw().qCardinal);if(r){var u=e.pic.extract({field:r.key(),trackBy:r.value}).length;return a(r,u)}return{}}function T(t,e){var n=t.hc.qDimensionInfo,r=e.input.byDimDef||{activeDimensionIndex:n.length-1};if(r.activeDimensionIndex>=0){var i=n[r.activeDimensionIndex];r=i.coloring&&i.coloring.colorMapRef?{type:"libraryItem",key:i.coloring.colorMapRef,activeDimensionIndex:r.activeDimensionIndex}:{activeDimensionIndex:r.activeDimensionIndex}}return r}function R(t,e){var n;return e.activeDimensionIndex>=0?n=t.pic.fields().filter((function(t){return"dimension"===t.type()}))[e.activeDimensionIndex]:"libraryItem"===e.type?!1===(n=e.key?t.pic.field((function(t){return t.raw().colorMapRef===e.key})):void 0)&&(n=t.pic.field((function(t){return"colorByAlternative"===t.raw().id}))):"expression"===e.type&&(n=t.pic.field((function(t){return"colorByAlternative"===t.raw().id}))),n}function P(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function F(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function L(){}var j=1/.7,z="\\s*([+-]?\\d+)\\s*",V="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",H="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",B=/^#([0-9a-f]{3,8})$/,W=new RegExp("^rgb\\("+[z,z,z]+"\\)$"),U=new RegExp("^rgb\\("+[H,H,H]+"\\)$"),Y=new RegExp("^rgba\\("+[z,z,z,V]+"\\)$"),$=new RegExp("^rgba\\("+[H,H,H,V]+"\\)$"),X=new RegExp("^hsl\\("+[V,H,H]+"\\)$"),G=new RegExp("^hsla\\("+[V,H,H,V]+"\\)$"),K={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function J(){return this.rgb().formatHex()}function Z(){return this.rgb().formatRgb()}function Q(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=B.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?tt(e):3===n?new it(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?et(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?et(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=W.exec(t))?new it(e[1],e[2],e[3],1):(e=U.exec(t))?new it(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Y.exec(t))?et(e[1],e[2],e[3],e[4]):(e=$.exec(t))?et(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=X.exec(t))?ut(e[1],e[2]/100,e[3]/100,1):(e=G.exec(t))?ut(e[1],e[2]/100,e[3]/100,e[4]):K.hasOwnProperty(t)?tt(K[t]):"transparent"===t?new it(NaN,NaN,NaN,0):null}function tt(t){return new it(t>>16&255,t>>8&255,255&t,1)}function et(t,e,n,r){return r<=0&&(t=e=n=NaN),new it(t,e,n,r)}function nt(t){return t instanceof L||(t=Q(t)),t?new it((t=t.rgb()).r,t.g,t.b,t.opacity):new it}function rt(t,e,n,r){return 1===arguments.length?nt(t):new it(t,e,n,null==r?1:r)}function it(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ot(){return"#"+st(this.r)+st(this.g)+st(this.b)}function at(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function st(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ut(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ct(t,e,n,r)}function lt(t){if(t instanceof ct)return new ct(t.h,t.s,t.l,t.opacity);if(t instanceof L||(t=Q(t)),!t)return new ct;if(t instanceof ct)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new ct(a,s,u,t.opacity)}function ct(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ht(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}P(L,Q,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:J,formatHex:J,formatHsl:function(){return lt(this).formatHsl()},formatRgb:Z,toString:Z}),P(it,rt,F(L,{brighter:function(t){return t=null==t?j:Math.pow(j,t),new it(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new it(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ot,formatHex:ot,formatRgb:at,toString:at})),P(ct,(function(t,e,n,r){return 1===arguments.length?lt(t):new ct(t,e,n,null==r?1:r)}),F(L,{brighter:function(t){return t=null==t?j:Math.pow(j,t),new ct(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ct(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new it(ht(t>=240?t-240:t+120,i,r),ht(t,i,r),ht(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var ft=Math.PI/180,dt=180/Math.PI,pt=4/29,mt=6/29,gt=3*mt*mt;function yt(t){if(t instanceof vt)return new vt(t.l,t.a,t.b,t.opacity);if(t instanceof _t)return qt(t);t instanceof it||(t=nt(t));var e,n,r=Mt(t.r),i=Mt(t.g),o=Mt(t.b),a=xt((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?e=n=a:(e=xt((.4360747*r+.3850649*i+.1430804*o)/.96422),n=xt((.0139322*r+.0971045*i+.7141733*o)/.82521)),new vt(116*a-16,500*(e-a),200*(a-n),t.opacity)}function vt(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function xt(t){return t>.008856451679035631?Math.pow(t,1/3):t/gt+pt}function bt(t){return t>mt?t*t*t:gt*(t-pt)}function wt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Mt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function kt(t){if(t instanceof _t)return new _t(t.h,t.c,t.l,t.opacity);if(t instanceof vt||(t=yt(t)),0===t.a&&0===t.b)return new _t(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*dt;return new _t(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function _t(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function qt(t){if(isNaN(t.h))return new vt(t.l,0,0,t.opacity);var e=t.h*ft;return new vt(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Dt(t){return function(){return t}}function St(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Dt(isNaN(t)?e:t)}P(vt,(function(t,e,n,r){return 1===arguments.length?yt(t):new vt(t,e,n,null==r?1:r)}),F(L,{brighter:function(t){return new vt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new vt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new it(wt(3.1338561*(e=.96422*bt(e))-1.6168667*(t=1*bt(t))-.4906146*(n=.82521*bt(n))),wt(-.9787684*e+1.9161415*t+.033454*n),wt(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),P(_t,(function(t,e,n,r){return 1===arguments.length?kt(t):new _t(t,e,n,null==r?1:r)}),F(L,{brighter:function(t){return new _t(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new _t(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return qt(this).rgb()}}));var Ct=function t(e){var n=function(t){return 1==(t=+t)?St:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Dt(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=rt(t)).r,(e=rt(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=St(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1),Et=/^class(-pyramid)?/,At=function(t,e,n,r){var i=void 0!==n.min?n.min:r.min(),o=void 0!==n.max?n.max:r.max(),a=i,s=o,u=e.limits,l={},c="percent"===e.limitType?u.map((function(t){return i+(o-i)*t})):u,h=e.colors.map((function(e){return t.resolveUIColor(e)}));if(i=Math.min.apply(Math,[i].concat(b(c))),o=Math.max.apply(Math,[o].concat(b(c))),l.min=i,l.max=o,e.breakTypes&&-1===e.breakTypes.indexOf(!0))l.type="categorical",Object.assign(l,function(t){var e=t.min,n=t.max,r=t.limits,i=t.range,o=[],a=[];if(r.length)if(r[r.length-1]<e)a.push(e,n),o.push(i[i.length-1],i[i.length-1],i[i.length-1]);else if(r[0]>n)a.push(e,n),o.push(i[0],i[0],i[0]);else{if(r[0]>e)a.push(e),o.push(i[0]);else{a.push(e);for(var s=0;s<r.length;s++)if(e<r[s]){o.push(i[s]);break}}for(var u=0;u<r.length;u++)e<r[u]&&r[u]<n&&(a.push(r[u]),o.push(i[u]));if(r[r.length-1]<n)a.push(n),o.push(i[r.length]),o.push(i[r.length]);else{a.push(n);for(var l=0;l<r.length;l++)if(r[l]>n){o.push(i[l]),o.push(i[l]);break}}}else o.push(i[0]);return{min:e,max:n,range:o,domain:a}}({min:"percent"===e.limitType?i:a,max:"percent"===e.limitType?o:s,range:h,limits:"percent"===e.limitType?c:u}));else if(e.breakTypes){var f=e.breakTypes;l.type="continuous",l.domain=[i],l.range=[h[0]];for(var d=0;d<c.length;d+=1)if(f[d]){var p=h[d],m=h[d+1],g=Ct(p,m)(.5);l.range.push(g),l.domain.push(c[d]),d<c.length-1&&f[d+1]&&(l.range.push(h[d+1]),l.domain.push((c[d]+c[d+1])/2))}else l.range.push(h[d]),l.range.push(h[d+1]),l.domain.push(c[d]),l.domain.push(c[d]+Math.min(1e-6,(o-i)/1e6));l.range.push(h[h.length-1]),l.domain.push(o)}else l.domain=c,l.range=h;return l};function Nt(t,e,n,r,i){var o,a,s,u=0,l=[],c=(t-e)/(r+1);if(0===c)return 1;for(o=0;o<n.length;o+=1)a=.99*(n[o]-e),s=n[o]>t?Math.floor(t/c):n[o]<e?0:Math.floor(a/c),Number.isNaN(s)||(l[s]?l[s]+=1:l[s]=1);for(o=0;o<l.length;o+=1)l[o]&&(u+=1);return u<=r||u>=i?Math.max(u,r):Nt(t,e,n,r+1,i)}var Ot=function(t,e,n,r){var i,o,a=e.theme,s=e.hc,u=r.f,l={mode:"field",fieldType:"measure",field:u?u.key():void 0,reverse:n.input.reverseScheme||!1,type:"continuous",range:function(t){return t.resources.theme.palette("quant")}},c=[],h=!0;if(u){if(Number.isNaN(+u.min())||Number.isNaN(+u.max()))return{invalid:!0};(h=!("S"===(i=n.pic.raw()).qMode&&(i.qDataPages[0]&&i.qSize.qcy>i.qDataPages[0].qArea.qHeight||!i.qDataPages.length&&i.qSize.qcy>0)||"K"===i.qMode&&i.qStackedDataPages[0]&&i.qSize.qcy>i.qStackedDataPages[0].qArea.qHeight||"T"===i.qMode&&i.qSize.qcy>i.qTreeDataPages[0].qGroupSize))&&(c=n.pic.extract({field:0,props:{num:{field:u.key()},exclude:{fields:s.qDimensionInfo.map((function(t,e){return{field:"qDimensionInfo/".concat(e)}})),value:function(t){return Math.min.apply(Math,b(t))<0}}}}).filter((function(t){return t.value>=0&&!t.exclude.value})).map((function(t){return t.num.value})).filter((function(t){return"number"==typeof t})))}if(!1===n.input.autoMinMax){if(l.min=n.input.measureMin,l.max=n.input.measureMax,l.max<l.min)return{invalid:!0}}else if(u&&!h)l.min=u.min(),l.max=u.max();else if(u){if(!c.length)return{invalid:!0};l.min=Math.min.apply(Math,b(c)),l.max=Math.max.apply(Math,b(c))}if(n.input.measureScheme&&(l.palettes={quant:n.input.measureScheme}),a){var f=a.getDataColorScales().filter((function(t){return t.key===n.input.measureScheme}))[0];l.type=f&&Et.test(f.type)?"categorical":"continuous","categorical"===l.type&&(o=f.colors.some((function(t){return Array.isArray(t)}))?Math.max.apply(Math,b(f.colors.map((function(t){return t?t.length:0})))):f.colors.length)}if("categorical"===l.type){for(var d=h?Nt(l.max,l.min,c,1,o):o,p=(l.max-l.min)/d,m=[],g=0;g<d+1;g+=1)m.push(l.min+p*g);l.domain=m,l.range=function(t){for(var e=t.resources.theme.palette("quant",d),n=Math.max(1,Math.floor(e.length/d)),r=[],i=0;i<d;i+=1)r.push(e[i*n]);return[r[0]].concat(r,[r[r.length-1]])}}return l};function It(t,e){var n;return e.activeMeasureIndex>=0?n=t.pic.fields().filter((function(t){return"measure"===t.type()}))[e.activeMeasureIndex]:"libraryItem"===e.type?n=t.pic.field((function(t){return t.raw().colorMapRef===e.key&&void 0!==e.key})):"expression"===e.type&&(n=t.pic.field((function(t){return"colorByAlternative"===t.raw().id}))),n||(n=t.pic.field((function(t){return void 0!==t.raw().matchMeasure})))&&(n=t.pic.fields().filter((function(t){return"measure"===t.type()}))[n.raw().matchMeasure]),n}function Tt(t){var e,n=t.cm,r=t.defaults,i=t.index,o=t.input,a=t.pic;if(!o||!o.on)return null;var s=null!==(e=o.mode)&&void 0!==e?e:"primary";return"primary"===s?function(t,e,n){var r=n.primary;return void 0!==e.paletteColor&&e.paletteColor&&(r=t.resolveUIColor(e.paletteColor)),x(x({},n),{},{mode:"constant",type:"constant",primary:r})}(n,o,r):"byExpression"===s?function(t,e,n){var r="qMeasureInfo/".concat(t,"/"),i=e.field((function(t){return t.id().startsWith(r)&&"colorByMeasureExpression"===t.raw().id})),o=i;return x(x({},n),{},o?{mode:"field",fieldType:"expression",field:i?i.key():void 0,type:"color"}:{mode:"constant",type:"constant",primary:n.nil})}(i,a,r):null}function Rt(t){t.measureOverrides.every((function(t){return!t}))&&(t.measureOverrides=null)}function Pt(t,e){for(var n=(null==e?void 0:e.domain)||[],r=(null==e?void 0:e.range)||[],i=[],o=0;o<t.length;++o){var a=t[o];if("constant"===(null==a?void 0:a.mode)){var s=n.indexOf(o);-1===s?(n.push(o),r.push(a.primary)):r[s]=a.primary,t[o]=null}else if(a){i.push(o);var u=n.indexOf(o);-1!==u&&(n.splice(u,1),r.splice(u,1))}}return{domain:n,range:r,exclude:i}}function Ft(t,e,n,r){var i,o=function(t,e,n,r){if(e.input&&!e.input.auto){if("byMeasure"===e.input.mode)return function(t,e,n){var r=e.theme,i=e.hc,o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).getCField,a=void 0===o?It:o,s=n.input.byMeasureDef||{activeMeasureIndex:0},u=a(n,s),l=Ot(0,{theme:r,hc:i},n,{f:u});if(l.invalid)return l;("expression"===s.type||s.activeMeasureIndex<0)&&(l.label=s.label,u&&"color.altLabel"===u.raw().labelExpRef&&(l.label=n.input.altLabel)),!l.label&&u&&(l.label=u.title());var c=s.activeMeasureIndex>=0?u:null;if(!c&&u&&void 0!==u.raw().matchMeasure&&u.raw().matchMeasure>-1&&(c=n.pic.fields().filter((function(t){return"measure"===t.type()}))[u.raw().matchMeasure]),n.input.useMeasureGradient&&"libraryItem"===s.type)if(c){var h=c.raw().coloring;h&&h.gradient&&A(l,At(t,h.gradient,l,c))}else l.auxiliary=s;return l}(t,n,e);if("byDimension"===e.input.mode)return function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.getCDef,o=void 0===i?T:i,a=r.getCByField,s=void 0===a?R:a,u=r.getPersistence,l=void 0===u?I:u,c=o(e,n),h=s(n,c),f=h?h.raw():{},d=n&&n.pic?n.pic.raw():{};if(f.qError||f.qSize&&0===f.qSize.qcy&&!d.qHasOtherValues)return{invalid:!0};var p={mode:"field",fieldType:"dimension",type:"categorical",field:h?h.key():void 0,isFieldLocked:f.qLocked};return("expression"===c.type||c.activeDimensionIndex<0)&&(p.label=c.label,"color.altLabel"===f.labelExpRef&&(p.label=n.input.altLabel)),!p.label&&h&&(p.label=h.title()),n.input.dimensionScheme&&(p.palettes={categorical:n.input.dimensionScheme}),n.input.useDimColVal&&"libraryItem"===c.type&&(p.auxiliary=c),A(p,l(e,n,c,h,{byRow:O,byElemNo:N})),p}(t,n,e);if("byExpression"===e.input.mode)return function(t,e,n,r){var i=e.hc,o=e.theme,a=e.translator,s=n.pic.field((function(t){return"colorByExpression"===t.raw().id}));if(!s||!s.raw().qFallbackTitle&&!n.input.colorExpression||!(Number.isFinite(s.raw().qMin)&&Number.isFinite(s.raw().qMax)||n.input.expressionIsColor))return{mode:"constant",type:"constant",primary:r.nil};if(n.input.expressionIsColor)return{mode:"field",fieldType:"expression",field:s?s.key():void 0,type:"color"};var u=Ot(0,{hc:i,theme:o},n,{f:s});return u.invalid||(u.label=n.input.expressionLabel||a.get("Object.ChartTooltip.ColorExpression")),u}(0,n,e,r);if("byMultiple"===e.input.mode||"primary"===e.input.mode)return function(t,e,n,r){var i=e.hc,o=e.theme,a=e.translator,s=n.input.useBaseColors;if(("byMultiple"===n.input.mode||"primary"===n.input.mode&&"measure"===n.input.useBaseColors)&&i.qMeasureInfo.length>1&&(s="measure"),"measure"===s){var u=[],l=[];"measure"===n.input.useBaseColors&&i.qMeasureInfo.forEach((function(e,n){if(e.baseColor||e.coloring&&e.coloring.baseColor){u.push(n);var i=t.resolveUIColor(e.baseColor||e.coloring.baseColor);"none"===i?l.push(r.primary):l.push(i)}}));var c=n.input.dimensionScheme?{categorical:n.input.dimensionScheme}:void 0,h=o?o.getDataColorPalettes()[0]:void 0;return"measure"===n.input.useBaseColors&&h&&(c={categorical:h.key}),{mode:"measure",type:"categorical",palettes:c,label:a?a.get("Common.Measures"):void 0,explicit:u.length?{domain:u,range:l}:void 0}}if("dimension"===s){var f=[],d=[];return i.qDimensionInfo.forEach((function(e,n){if(e.baseColor||e.coloring&&e.coloring.baseColor){f.push(n);var i=t.resolveUIColor(e.baseColor||e.coloring.baseColor);"none"===i?d.push(r.primary):d.push(i)}})),{mode:"dimension",type:"categorical",field:f.length?f[0]:void 0,explicit:f.length?{domain:f,range:d}:void 0}}var p=r.primary;if(void 0!==n.input.paletteColor)n.input.paletteColor&&(p=t.resolveUIColor(n.input.paletteColor));else{var m=n.input.singleColor;"number"!=typeof m||Number.isNaN(m)||(p=["#b0afae","#7b7a78","#545352","#4477aa","#7db8da","#b6d7ea","#46c646","#f93f17","#ffcf02","#276e27","#ffffff","#000000"][m])}return{mode:"constant",type:"constant",primary:p}}(t,n,e,r)}return{}}(t,e,n,r);return null!==(i=e.input)&&void 0!==i&&i.measureOverrides?(o.measureOverrides=e.input.measureOverrides.map((function(n,i){return Tt({cm:t,input:n,defaults:r,index:i,pic:e.pic})})),function(t,e){var n,r,i,o=e.translator;if(Rt(t),1===(null===(n=t.measureOverrides)||void 0===n?void 0:n.length))return t.measureOverrides[0];if("measure"===t.mode&&t.measureOverrides&&(t.explicit=Pt(t.measureOverrides,t.explicit),Rt(t)),null!==(r=t.measureOverrides)&&void 0!==r&&r.every((function(t){return"constant"===(null==t?void 0:t.mode)}))){var a={mode:"measure",type:"categorical",label:null==o?void 0:o.get("Common.Measures")};return a.explicit=Pt(t.measureOverrides),a}return null!==(i=t.measureOverrides)&&void 0!==i&&i.every((function(t){return t}))?{invalid:!0,measureOverrides:t.measureOverrides}:t}(o,n)):o}function Lt(t){var e=x({hc:null,colorProps:null,layout:null,theme:null},t),n={},r={auto:function(){return{mode:"primary"}},getDimensionColorMap:function(){return Promise.reject()},getMeasure:function(){return Promise.reject()},getAttributeDimension:function(){return Promise.reject()}},i={auto:function(t){return t?(r.auto=t,i):r.auto},getDimensionColorMap:function(t){return t?(r.getDimensionColorMap=t,i):r.getDimensionColorMap},getAttributeDimension:function(t){return t?(r.getAttributeDimension=t,i):r.getAttributeDimension},getMeasure:function(t){return t?(r.getMeasure=t,i):r.getMeasure},set:function(t){var i;if(!t.colorProps)throw new Error('Missing "colorProps"');if(A(e,t),(n={pic:e.picasso.data("q")({data:e.hc,config:{localeInfo:e.localeInfo}}),input:e.colorProps}).input.auto){var o=r.auto(t.layout);n.input=A(!0,{},n.input,o,{auto:!1});var a=e.theme?e.theme.getDataColorPalettes():[];a[0]&&(n.input.dimensionScheme=a[0].key);var s=0;n.input.byDimDef&&+n.input.byDimDef.activeDimensionIndex>=0&&(s=+n.input.byDimDef.activeDimensionIndex),e.hc&&e.hc.qDimensionInfo[s]&&e.hc.qDimensionInfo[s].coloring&&e.hc.qDimensionInfo[s].coloring.colorMapRef&&n.input.byDimDef&&(n.input.byDimDef.type="libraryItem",n.input.byDimDef.key=e.hc.qDimensionInfo[s].coloring.colorMapRef)}null!==(i=n.input.measureOverrides)&&void 0!==i&&i.every((function(t){return!t||!t.on}))&&(n.input=A(!1,{},n.input,{measureOverrides:null}))},palettes:function(){if(!n.palettes){var t=e.theme,r=[];(t&&t.getDataColorPickerPalettes()||[]).forEach((function(t){r.push({key:"ui",colors:t.colors})})),n.palettes=r}return n.palettes},getAuxiliaryData:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/qHyperCubeDef";if(!t.auxiliary&&!/qAttrDimInfo/.test(t.field))return Promise.resolve();var i=t.auxiliary||{},o=i.key;if("measure"===t.fieldType)return r.getMeasure(o,e).catch((function(){}));if("dimension"===t.fieldType){var a="".concat(n,"/").concat(t.field).replace("qDimensionInfo","qDimensions").replace("qAttrDimInfo","qAttributeDimensions");return Promise.all([/qAttrDimInfo/.test(t.field)?r.getAttributeDimension(a,e).catch((function(){})):Promise.resolve(),o?r.getDimensionColorMap(o,e).catch((function(){})):Promise.resolve()])}return Promise.resolve()},getAuxiliarySettings:function(t,r){var i=this;return t.auxiliary||/qAttrDimInfo/.test(t.field)?(this.palettes(),this.getAuxiliaryData(t,r).then((function(r){if(!r)return{};if("measure"===t.fieldType){if(r.coloring&&r.coloring.gradient){var o=n.pic.field(t.field);return At(i,r.coloring.gradient,t,o)}return{}}if("dimension"===t.fieldType){var a={nil:t.nil,others:t.others},s=r[0],u=r[1]?r[1].colorMap:null;if(s){var l=e.picasso.data("q")({data:{qDimensionInfo:[n.pic.field(t.field).raw(),n.pic.field(t.field).raw()],qMeasureInfo:[],qDataPages:s,qInterColumnSortOrder:[0,1],qMode:"S"}});a.legendDataset=l}return u?function(t,e,n,r){var i=r.external,o=r.field,a=x({},t);A(a,N(o,o.raw().qCardinal));var s=i.theme?i.theme.getDataColorPalettes()[0]:null;return e.nul&&(a.nil=n.resolveUIColor(e.nul)),e.oth&&(a.others=n.resolveUIColor(e.oth)),e.usePal?(a.palettes={categorical:e.pal},s&&!e.pal&&(a.palettes.categorical=s.key,A(a,N(o)))):!1===e.autoFill&&e.single?a.range=[n.resolveUIColor(e.single)]:e.autoFill&&(s&&(a.palettes={categorical:s.key}),A(a,N(o))),e.colors&&e.colors.length&&(a.explicit=function(t,e,n){for(var r={},i=0;i<t.length;i+=1)r[t[i].value]=t[i].baseColor;var o=[];return{domain:function(t){var i=t.data,a=[];o=[];for(var s=0;s<i.items.length;s++){var u=i.items[s],l=(u.text||u).label;r[l]&&-1===a.indexOf(u.value)&&(a.push(u.value),o.push(e.resolveUIColor(r[l])))}return a.push(-3,-2),o.push(n.others),o.push(n.nil),a},range:function(){return o}}}(e.colors,n,a)),a}(a,u,i,{external:e,field:n.pic.field(t.field)}):a}return{}}))):Promise.resolve()},resolveUIColor:function(t){if(t.index<0||void 0===t.index)return t.color;if(void 0===n.uiPalette&&(n.uiPalette=this.palettes().filter((function(t){return"ui"===t.key}))[0]||!1),!n.uiPalette)return t.color;var e="none"===n.uiPalette.colors[0]?t.index:t.index-1;return void 0===n.uiPalette.colors[e]?t.color:n.uiPalette.colors[e]},settings:function(){if(this.palettes(),!n.settings){var t={primary:"steelblue",others:"#aaa",nil:"#ddd"},r=e.theme;r&&(t=x(x({},t),r.getDataColorSpecials())),n.settings=A(t,Ft(this,n,e,t))}return n.settings}};return i}var jt=function(t,e){var n=t.fieldType,r={};if(e)if("measure"===n){var i=e.coloring;i&&(r.measureGradient=i.gradient)}else if("dimension"===n){var o=e[0],a=e[1];o&&(r.legendDataPage=o),a&&(r.dimValsData=a.colorMap)}return r},zt=function(t){throw t.isHandled=!0,t},Vt=function(t,e){var n=e.layout,r=e.app;return n&&n.snapshotData?n.snapshotData.content&&n.snapshotData.content.chartData&&n.snapshotData.content.chartData.dimValsData?Promise.resolve({colorMap:n.snapshotData.content.chartData.dimValsData}):Promise.reject():r&&r.getObject?r.getObject("ColorMapModel_".concat(t)).then((function(t){return t.getLayout()})):Promise.reject()},Ht=function(t,e){var n=e.layout,r=e.app;return n&&n.snapshotData?n.snapshotData.content&&n.snapshotData.content.chartData&&n.snapshotData.content.chartData.measureGradient?Promise.resolve({coloring:{gradient:n.snapshotData.content.chartData.measureGradient}}):Promise.reject():r&&r.getMeasure?r.getMeasure(t).then((function(t){return t.getMeasure()})):Promise.reject()},Bt=function(t,e){var n=e.layout,r=e.model,i=e.app;return n&&n.snapshotData?n.snapshotData.content&&n.snapshotData.content.chartData&&n.snapshotData.content.chartData.legendDataPage?Promise.resolve(n.snapshotData.content.chartData.legendDataPage):Promise.reject():r&&r.session&&i?r.getHyperCubeData(t,[{qHeight:100,qLeft:0,qTop:0,qWidth:2}]).catch(zt):Promise.reject()};function Wt(t){var e=t.hc,n=t.source,r=t.coloring,i={data:{extract:[{source:"dummy",field:0,filter:function(){return i.expando=e.qDataPages[0]?e.qDataPages[0].qArea.qTop:0,!1}},{source:n,field:r.field,trackBy:r.valueAccessor,reduce:"first",props:{row:{reduce:function(){return i.expando++}},text:{value:function(t){return t.qText},reduce:"first"}}}]},expando:0};return i}function Ut(t){return function(e){return"object"===g(e.datum[t])?e.datum[t].value:void 0}}function Yt(t){return"object"===g(t.datum.isNull)?t.datum.isNull.value:-2===t.datum.value}function $t(t){return-3===t.datum.value}var Xt=function(t,e,n){var r=t&&t.dock||void 0;if("auto"!==r)return r||"right";if(e){var i=e.element.getBoundingClientRect();if(i.height>i.width)return"bottom"}return n?"left":"right"},Gt=function(t,e,n){return!(n.invalid||"color"===n.type||"measure"===n.mode&&e.qMeasureInfo.length<=1||"dimension"===n.mode)&&("function"==typeof t.show?t.show():!1!==t.show)};function Kt(t,e){var n=t.styleReference,r=t.chart,i=t.rtl,o=e.legendProps,a=e.coloring,s=e.theme,u=e.hc;return{layout:{minimumLayoutMode:"MEDIUM",dock:Xt(o,r,i)},show:"function"==typeof o.show?function(){return Gt(o,u,a)}:Gt(o,u,a),renderer:"svg",mounted:function(t){t.childNodes[0].style.pointerEvents="none",t.style.overflow="hidden"},settings:{title:{show:!1!==o.showTitle,wordBreak:"break-word",maxLines:2,lineHeight:1.2,text:a.label||"",fill:s?s.getStyle(n,"legend.title","color"):void 0,fontSize:s?s.getStyle(n,"legend.title","fontSize"):"16px",fontFamily:s?s.getStyle(n,"legend.title","fontFamily"):"QlikView Sans, sans-serif"}}}}function Jt(t,e,n){return"categorical"===e.coloring.type?function(t,e,n){var r=Kt(t,e);if(!r.show)return!1;var i=t.key,o=t.styleReference,a=t.viewState,s=t.rtl,u=t.settings,l=t.style,c=e.scaleKey,h=e.theme,f=e.scales,d=r.layout.dock,p="left"===d||"right"===d?{maxLines:3,wordBreak:"break-word"}:{},m={up:"M13.6,11 L2.4,11 C2.28954305,11 2.2,10.9104569 2.2,10.8 C2.2,10.756726 2.21403557,10.7146192 2.24,10.68 L7.84,3.21333333 C7.90627417,3.12496777 8.03163444,3.10705916 8.12,3.17333333 C8.13516113,3.18470418 8.14862915,3.1981722 8.16,3.21333333 L13.76,10.68 C13.8262742,10.7683656 13.8083656,10.8937258 13.72,10.96 C13.6853808,10.9859644 13.643274,11 13.6,11 Z",down:"M2.4,4 L13.6,4 C13.7104569,4 13.8,4.08954305 13.8,4.2 C13.8,4.24327404 13.7859644,4.28538077 13.76,4.32 L8.16,11.7866667 C8.09372583,11.8750322 7.96836556,11.8929408 7.88,11.8266667 C7.86483887,11.8152958 7.85137085,11.8018278 7.84,11.7866667 L2.24,4.32 C2.17372583,4.23163444 2.19163444,4.10627417 2.28,4.04 C2.31461923,4.01403557 2.35672596,4 2.4,4 Z",left:"M11,2.4 L11,13.6 C11,13.7104569 10.9104569,13.8 10.8,13.8 C10.756726,13.8 10.7146192,13.7859644 10.68,13.76 L3.21333333,8.16 C3.12496777,8.09372583 3.10705916,7.96836556 3.17333333,7.88 C3.18470418,7.86483887 3.1981722,7.85137085 3.21333333,7.84 L10.68,2.24 C10.7683656,2.17372583 10.8937258,2.19163444 10.96,2.28 C10.9859644,2.31461923 11,2.35672596 11,2.4 Z",right:"M4,13.6 L4,2.4 C4,2.28954305 4.08954305,2.2 4.2,2.2 C4.24327404,2.2 4.28538077,2.21403557 4.32,2.24 L11.7866667,7.84 C11.8750322,7.90627417 11.8929408,8.03163444 11.8266667,8.12 C11.8152958,8.13516113 11.8018278,8.14862915 11.7866667,8.16 L4.32,13.76 C4.23163444,13.8262742 4.10627417,13.8083656 4.04,13.72 C4.01403557,13.6853808 4,13.643274 4,13.6 Z"},g="".concat(c,"Legend");return A(!0,r,{type:"legend-cat",key:"".concat(i,"-cat"),scale:g in f?g:c,settings:{layout:{scrollOffset:function(){return a?a.get("legendScrollOffset"):void 0},size:-1!==["top","bottom"].indexOf(r.layout.dock)?2:1,direction:s?"rtl":"ltr",horizontal:20},item:{show:function(t){return-2!==t.datum.value},label:x({fill:h?h.getStyle(o,"legend.label","color"):void 0,fontSize:h?h.getStyle(o,"legend.label","fontSize"):void 0,fontFamily:h?h.getStyle(o,"legend.label","fontFamily"):"QlikView Sans, sans-serif"},p)},navigation:{disabled:n,button:{content:function(t,e){var n=e.direction;return t("i",{style:{"pointer-events":"none",fontSize:"12px",display:"inline-block",fontStyle:"normal",lineHeight:"0",textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizelegibility",margin:"0px"}},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:m[n]})])])}}}},brush:{consume:[{context:"selection",data:["",i],style:{inactive:{opacity:.3}}}]}},{settings:u,style:l})}(t,e,n):"continuous"===e.coloring.type&&function(t,e){var n=t.key,r=t.styleReference,i=t.rtl,o=t.settings,a=t.style,s=e.scaleKey,u=e.theme,l=Kt(t,e);return!!l.show&&A(!0,l,{type:"legend-seq",key:"".concat(n,"-seq"),settings:{fill:s,major:"".concat(s,"Range"),length:1,tick:{fill:u?u.getStyle(r,"legend.label","color"):void 0,fontSize:u?u.getStyle(r,"legend.label","fontSize"):void 0,fontFamily:u?u.getStyle(r,"legend.label","fontFamily"):"QlikView Sans, sans-serif"},title:{anchor:!i||"top"!==l.layout.dock&&"bottom"!==l.layout.dock?void 0:"right",padding:parseFloat(l.settings.title.fontSize)||16}}},{settings:o,style:a})}(t,e)}function Zt(t,e,n){var r=[],i=[],o=Jt(t,e,n&&n.navigationDisabled);return r.push(o),o&&"legend-cat"===o.type&&(i.push(function(t){var e=t.key,n=t.requireFailure,r=t.recognizeWith,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:tap-".concat(e),type:"Tap",requireFailure:n,recognizeWith:r,options:{event:"legendtap",interval:10,pointers:1,enable:function(t,n){var r;if(!n)return!0;if(null!=i&&null!==(r=i.interact)&&void 0!==r&&r.enabled&&!i.interact.enabled())return!1;if(!this.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).some((function(t){return t.key==="".concat(e,"-cat")})))return!1;var o=n.srcEvent.target;return!!(o&&o.hasAttribute("data-action")&&o.hasAttribute("data-component-key"))||!(!o||!o.childNodes[0]||"BUTTON"!==o.childNodes[0].nodeName)}},events:{legendtap:function(t){t.preventDefault();var e=t.srcEvent.target;e&&e.hasAttribute("data-action")&&e.hasAttribute("data-component-key")&&this.chart.component(e.getAttribute("data-component-key")).emit(e.getAttribute("data-action"))}}}}(t,n)),i.push(function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.eventName,r=e.key,i=e.requireFailure,o=e.recognizeWith,a=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:pan-".concat(r),type:"Pan",requireFailure:i,recognizeWith:o,options:{event:n,pointers:1,threshold:10,enable:function(t,e){var i;return this.started===n||!e||!(null!=a&&null!==(i=a.interact)&&void 0!==i&&i.enabled&&!a.interact.enabled())&&this.chart.componentsFromPoint({x:e.center.x,y:e.center.y}).some((function(t){return t.key==="".concat(r,"-cat")}))}},events:(t={},y(t,"".concat(n,"start"),(function(t){t.preventDefault(),this.started!==n&&(this.started=n,this.chart.component("".concat(r,"-cat")).emit("panstart",t))})),y(t,"".concat(n,"move"),(function(t){t.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panmove",t)})),y(t,"".concat(n,"end"),(function(t){t.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panend",t),this.started=!1})),t)}}(t,n))),{interactions:i,components:r}}var Qt=function(t){return"rgba(".concat([(16711680&t)>>16,(65280&t)>>8,255&t,((4278190080&t)>>>24)/255].join(","),")")};var te=function(t){return t.baseColor||t.coloring&&t.coloring.baseColor};function ee(t){var e=t.qHyperCube,n=e.qDimensionInfo,r=e.qMeasureInfo,i=n.some(te),o=r.some(te),a=t.color.useBaseColors;return"measure"===a&&!o||"dimension"===a&&!i?"off":a}function ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=x(x(x({},t),e),{},{colorProps:x(x({},t.colorProps),e.colorProps||{})});return n}var re=function(t){return t.baseColor||t.coloring&&t.coloring.baseColor};function ie(t){var e,n=t.qHyperCube.qDimensionInfo.some(re),r=t.qHyperCube.qMeasureInfo.some(re),i=n?"dimension":void 0;return{mode:"primary",useBaseColors:null!==(e=null!=i?i:r?"measure":void 0)&&void 0!==e?e:"off",paletteColor:null}}var oe=function(){};function ae(t){var e,n,r,i,o=t.picasso,a=t.model,s=t.app,u=t.translator,l=t.layoutService,c=void 0===l?void 0:l,h=t.createConfig,f=void 0===h?oe:h,d=t.config,p=void 0===d?{}:d,m=t.custom,g=void 0===m?{}:m,v=p.localeInfo,w=p.key,M=p.theme,k=void 0===M?void 0:M,_=p.auto,q=void 0===_?void 0:_,D=p.definitionPath,S=null==c||null===(e=c.getLayout)||void 0===e?void 0:e.call(c),C={theme:k,key:w,localeInfo:v,layout:S,hc:null==c||null===(n=c.getHyperCube)||void 0===n?void 0:n.call(c),legendProps:null==c||null===(r=c.getLayoutValue)||void 0===r?void 0:r.call(c,"legend"),colorProps:x(x({},null==c||null===(i=c.getLayoutValue)||void 0===i?void 0:i.call(c,"color")),{},{useBaseColors:S?ee(S):void 0})},E=function(t){var e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.auto,n=Lt(t.resources).auto(e||function(){return{mode:"byDimension",persistent:!1,useDimColVal:!0,byDimDef:{activeDimensionIndex:0,type:"expression",label:""}}}).getDimensionColorMap((function(t,e){var n=e.layout,r=e.app;return Vt(t,{layout:n,app:r})})).getMeasure((function(t,e){var n=e.layout,r=e.app;return Ht(t,{layout:n,app:r})})).getAttributeDimension((function(t,e){var n=e.layout,r=e.model,i=e.app;return Bt(t,{layout:n,model:r,app:i})}));return n.getSnapshotData=jt,n}({resources:t}),n={},r={},i=function(t){return r.settings||(t||console.warn("settings() called before auxiliarySettings()"),r.settings=e.settings()),r.settings},o={config:function(i){if(n=x({},i),r={},!n.key)throw new Error("Missing key");e.set(x(x({},t),n))},auto:function(t){return t?(e.auto(t),o):e.auto()},getAuxiliarySettings:function(t){return r.auxiliarySettings?Promise.resolve(r.auxiliarySettings):e.getAuxiliarySettings(i(!0),t).then((function(t){return r.auxiliarySettings=t||{},r.settings=x(x({},r.settings),r.auxiliarySettings),r.scales=void 0,r.color=void 0,r.auxiliarySettings}))},getAuxiliaryData:function(){return e.getAuxiliaryData(i())},getSnapshotData:function(t){var n=i();return e.getAuxiliaryData(n,t).then((function(t){return e.getSnapshotData(n,t)}))},resolveUIColor:function(t){return e.resolveUIColor(t)},settings:function(){var t=i();return{mode:t.mode,type:t.type,label:t.label,field:t.field,fieldType:t.fieldType,nil:t.nil,others:t.others,primary:t.primary}},settingsForMeasure:function(t){var e;return(null===(e=i().measureOverrides)||void 0===e?void 0:e[t])||this.settings()},isSelectionLocked:function(t){var e=t.isMeasureSelectionLocked;return function(t,e){var n=e.isMeasureSelectionLocked;return"field"!==t.mode||("dimension"===t.fieldType?t.isFieldLocked:"measure"!==t.fieldType||n)}(i(),{isMeasureSelectionLocked:e})},palettes:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.colorProps,n=t.coloring,r=t.theme,i=[];if(n&&n.palettes&&r){var o=n.palettes.categorical||e.dimensionScheme,a=r.getDataColorPalettes().filter((function(t){return t.key===o}))[0]||r.getDataColorPalettes()[0];o&&a&&i.push({key:"categorical",colors:a.colors});var s=n.palettes.metric||e.measureScheme,u=r.getDataColorScales().filter((function(t){return t.key===s}))[0];if(u){var l=u.colors[0]?u.colors:[[]].concat(b(u.colors.slice(1)));l=Array.isArray(l[0])?l.map((function(t){return t.slice().reverse()})):l.slice().reverse(),i.push({key:"quant",colors:l})}}return i}({coloring:i(),colorProps:n.colorProps,theme:n.theme})},scales:function(){return r.scales=r.scales||function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.hc,n=t.coloring,r=t.rtl,i=t.key,o=t.source,a=t.picasso,s={},u=i;if(n){var l={override:!0,domain:n.explicit&&"function"==typeof n.explicit.domain?n.explicit.domain:[].concat(b((n.explicit||{}).domain||[]),[-3,-2]),range:n.explicit&&"function"==typeof n.explicit.range?n.explicit.range:[].concat(b((n.explicit||{}).range||[]),[n.others,n.nil])};if("field"===n.mode){if("dimension"===n.fieldType){var c,h=Wt({hc:e,source:o,coloring:n}).data;if(n.legendDataset){var f=0,d={};a.data("q")({data:e}).extract({field:n.field,trackBy:n.valueAccessor,reduce:function(t){var e=t[0];return d[e]=f++,t[0]}}),c={source:"attrDim",extract:{field:"qDimensionInfo/0",filter:function(t){return t.qElemNumber>=0},props:{row:{value:function(t){return d[t.qElemNumber]}}}}}}var p={data:h,range:n.range,domain:n.domain,explicit:l,type:"categorical-color",label:function(t){return t.datum.text&&t.datum.text.value?t.datum.text.value:t.datum.label}};s[u]=p,c&&(s["".concat(u,"Legend")]=x(x({},p),{},{data:c})),e&&e.qHasOtherValues&&c&&((c||p.data).amend=[{label:e.qDimensionInfo[0].othersLabel,source:{key:"qHyperCube",field:"qDimensionInfo/0"},row:{value:-3},value:-3}])}else if("measure"===n.fieldType){var m={data:{field:n.field},min:n.min,max:n.max};s[u]=A({},m,{type:"categorical"===n.type?"threshold-color":"sequential-color",range:n.range,domain:n.domain,invert:n.reverse}),"sequential-color"===s[u].type&&(s["".concat(u,"Range")]=A({},m,{invert:!!r}))}else if("color"!==n.type)throw new Error("UNUSED FIELD")}else if("dimension"===n.mode){var g={data:e.qDimensionInfo.map((function(t,e){return e})),label:function(t){return e.qDimensionInfo[t.datum.value].qFallbackTitle},explicit:l,type:"categorical-color"};s[u]=g}else if("measure"===n.mode){var y={data:e.qMeasureInfo.map((function(t,e){return e})).filter((function(t){var e,r;return!(null!==(e=n.explicit)&&void 0!==e&&null!==(r=e.exclude)&&void 0!==r&&r.includes(t))})),label:function(t){return e.qMeasureInfo[t.datum.value].qFallbackTitle},explicit:l,type:"categorical-color"};s[u]=y}}return s}({hc:n.hc,coloring:i(),key:n.key,source:n.source,picasso:t.picasso}),r.scales},color:function(){return r.color=r.color||function(t){var e=t.coloring,n=t.scales,r=t.key,i=Ut(r),o=Ut("".concat(r,"IsAnOther")),a=function(t,e){var r=t.fieldType,a=t.invalid,s=t.mode,u=t.nil,l=t.others,c=t.primary,h=t.type;return a?function(t){return $t(t)||o(t)?l:u}:n[e]?function(t){return $t(t)?l:Yt(t)||-2===i(t)&&"dimension"===r||"NaN"===i(t)?u:o(t)?l:t.resources.scale(e)(i(t))||l}:"constant"===s?function(t){return $t(t)||o(t)?l:Yt(t)?u:c}:"color"===h?function(t){return $t(t)||o(t)?l:Yt(t)?u:i(t)||l}:null},s=a(e,r);if(e.measureOverrides){var u=Ut("".concat(r,"MeasureIdx")),l=e.measureOverrides.map((function(t){return t&&a(t)}));return function(t){var e=u(t);return l[e]?l[e](t):s(t)}}return s}({coloring:i(),scales:this.scales(),key:n.key}),r.color},datumProps:function(t){return function(t){var e,n,r=t.hc,i=t.coloring,o=t.scales,a=t.key,s=t.addMeasureIx,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=a,c=i.nil;"field"===i.mode&&i.field?e=i.field:o[a]&&"field"===i.mode&&(e=o[a].data.field||i.field),e?(n={field:e,reduce:"first"},"color"===i.type&&(n.value=function(t){return"NaN"!==t.qNum?Qt(t.qNum):t.qText&&Q(t.qText)?t.qText:c})):"dimension"===i.mode?n=void 0!==i.field?i.field:r.qDimensionInfo.length-1:"measure"===i.mode&&(n=u);var h=y({},l,n);return r.qDimensionInfo.length>1&&(h["".concat(l,"IsAnOther")]={fields:r.qDimensionInfo.map((function(t,e){return{field:"qDimensionInfo/".concat(e)}})),value:function(t){return-1!==t.indexOf(-3)}}),s&&(h["".concat(l,"MeasureIdx")]=u),h}({coloring:this.settingsForMeasure(t),scales:this.scales(),key:n.key,hc:n.hc,addMeasureIx:i().measureOverrides},t)},data:function(){var t=i(),e={key:"dummy",data:[["field"],["a"]]};return t.legendDataset?[e,{type:"q",key:"attrDim",data:t.legendDataset.raw(),config:{localeInfo:n.localeInfo}}]:[e]},legend:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.eventName,r=t.key,o=t.viewState,a=t.chart,s=t.rtl,u=t.styleReference,l=void 0===u?"object.legend":u,c=t.settings,h=void 0===c?{}:c,f=t.style,d=arguments.length>1?arguments[1]:void 0;return Zt({eventName:e,key:r,rtl:s,viewState:o,chart:a,styleReference:l,settings:h,style:void 0===f?{}:f},{legendProps:n.legendProps,scaleKey:n.key,coloring:i(),theme:n.theme,hc:n.hc,scales:this.scales()},d)}};return o}({picasso:o,model:a,app:s,translator:u,auto:q});!1!==q&&E.auto((function(t){return q?q({layout:t,defaultAuto:ie}):ie(t)}));var N=!1,O={getColor:function(){return E.color()},getPaletteColor:function(t){var e=t.index,n=t.color;return E.resolveUIColor({index:e,color:n})},getData:function(){return E.data()},getDatumProps:function(t){return E.datumProps(t)},getSnapshotData:function(){return E.getSnapshotData(D)},getSettingsForMeasure:function(t){return E.settingsForMeasure(t)},getSettings:function(){return E.settings()},getLegend:function(t,e){return E.legend(t,e)},getScales:function(){return E.scales()},getPalettes:function(){return E.palettes()},isSelectionLocked:function(t){var e=t.isMeasureSelectionLocked;return E.isSelectionLocked({isMeasureSelectionLocked:e})},isInitialized:function(){return N},custom:x({},g),initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.createConfig,n=void 0===e?f:e,r=n({getUseBaseColors:ee}),i=ne(C,r);E.config(i);var o=E.getAuxiliarySettings(D).then((function(){N=!0}));return o}};return O}function se(t,e,n){if(void 0===t||void 0===e)return n;for(var r=e.split("."),i=t,o=0;o<r.length;++o){var a=r[o];if(void 0===i[a])return n;i=i[a]}return i}function ue(t,e,n){if(void 0!==t&&void 0!==e){for(var r=e.split("."),i=r[r.length-1],o=t,a=0;a<r.length-1;++a){var s=r[a];void 0===o[s]&&(o[s]=Number.isNaN(+r[a+1])?{}:[]),o=o[s]}void 0!==n?o[i]=n:delete o[i]}}function le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function he(t,e,n){return e&&ce(t.prototype,e),n&&ce(t,n),t}function fe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function de(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function pe(t,e){var n,r,i,o,a,s=new ve(t),u=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=me);n=l.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)l.push(r=n.children[o]=new ve(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(ye)}function me(t){return t.children}function ge(t){t.data=t.data.data}function ye(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function ve(t){this.data=t,this.depth=this.height=0,this.parent=null}ve.prototype=pe.prototype={constructor:ve,count:function(){return this.eachAfter(de)},each:function(t){var e,n,r,i,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(t){for(var e,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return pe(this).eachBefore(ge)}};var xe,be,we=(xe=function(t){
/*! javascript-number-formatter - v1.1.11 - http://mottie.github.com/javascript-number-formatter/ *  ecava */
t.exports=function(t,e){if(!t||isNaN(+e))return e;var n,r,i,o,a,s,u,l,c,h,f=t.length,d=t.search(/[0-9\-\+#]/),p=d>0?t.substring(0,d):"",m=t.split("").reverse().join(""),g=m.search(/[0-9\-\+#]/),y=f-g,v=t.substring(y,y+1),x=y+("."===v||","===v?1:0),b=g>0?t.substring(x,f):"";if(n=(e="-"===(t=t.substring(d,x)).charAt(0)?-e:+e)<0?e=-e:0,i=(r=t.match(/[^\d\-\+#]/g))&&r[r.length-1]||".",o=r&&r[1]&&r[0]||",",t=t.split(i),e=+(e=e.toFixed(t[1]&&t[1].length))+"",s=t[1]&&t[1].lastIndexOf("0"),(!(l=e.split("."))[1]||l[1]&&l[1].length<=s)&&(e=(+e).toFixed(s+1)),c=t[0].split(o),t[0]=c.join(""),(a=t[0]&&t[0].indexOf("0"))>-1)for(;l[0].length<t[0].length-a;)l[0]="0"+l[0];else 0==+l[0]&&(l[0]="");if((e=e.split("."))[0]=l[0],u=c[1]&&c[c.length-1].length){for(m="",y=(h=e[0]).length%u,f=h.length,x=0;x<f;x++)m+=h.charAt(x),!((x-y+1)%u)&&x<f-u&&(m+=o);e[0]=m}return e[1]=t[1]&&e[1]?i+e[1]:"","0"!==(r=e.join(""))&&""!==r||(n=!1),p+(n?"-":"")+r+b}},xe(be={exports:{}}),be.exports);function Me(t){return t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}var ke={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},_e=/%$/,qe=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,De=/^\(oct\)/i,Se=/^\(dec\)/i,Ce=/^\(hex\)/i,Ee=/^\(bin\)/i,Ae=/^\(rom\)/i,Ne=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i,Oe=/#|0/g;function Ie(t,e,n,r){return t=t.toString(e),n[1]===n[1].toUpperCase()&&(t=t.toUpperCase()),t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11)),t.replace(".",r||".")}function Te(t,e,n){var r=Me(t);return n?r:new RegExp(r||"",e)}function Re(t,e,n){var r,i,o,a,s,u,l,c,h,f,d,p=t.pattern;p.indexOf("A")>=0&&(p=p.replace("A",""),t.abbreviate=!0),f=e,(d=n)&&(d=Me(d)),f&&(f=Me(f)),h=new RegExp("(?:[#0]+".concat(f,")?[#0]+(?:").concat(d,"[#0]+)?")),a=(o=(o=p.match(h))?o[0]:"")?p.substr(0,p.indexOf(o)):p,s=o?p.substring(p.indexOf(o)+o.length):"",o||(o=p?"#":"##########"),e&&e===n&&(i=(r=o.split(n)).pop(),o=r.join("")+n+i,e=""),u=e,e=/,/.test(n)?"":",",u&&(o=o.replace(Te(u,"g"),e)),l=n,n=".",l&&(o=o.replace(Te(l,"g"),n)),c=(c=o.match(/#/g))?c.length:0;var m,g=p.split(l);g[1]&&(m=g[1].match(Oe)),t.prefix=a||"",t.postfix=s||"",t.pattern=p,t.maxPrecision=m?m.length:2,t.percentage=_e.test(p),t.numericPattern=o||"",t.numericRegex=new RegExp("".concat(Te(e,null,!0),"|").concat(Te(n,null,!0)),"g"),t.groupTemp=u,t.decTemp=l,t.t=e,t.d=n,t.temp=c}!function(){function t(e,n,r,i,o){le(this,t),this.localeInfo=e,this.pattern=n,this.thousandDelimiter=r||",",this.decimalDelimiter=i||".",this.type=o||"numeric",this.patternSeparator=";",this.abbreviations=function(t,e){if(!t||!t.qNumericalAbbreviation)return ke;var n={};return t.qNumericalAbbreviation.split(e).forEach((function(t){var e=t.split(":");2===e.length&&(n[e[0]]=e[1])})),n}(e,this.patternSeparator),this.prepare()}he(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e,n,r){return this.prepare(e,n,r),this.formatValue(t)}},{key:"prepare",value:function(t,e,n){var r;void 0===t&&(t=this.pattern),void 0===e&&(e=this.thousandDelimiter),void 0===n&&(n=this.decimalDelimiter),t?(this._prepared={positive:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},zero:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}},r=this._prepared,t=t.split(this.patternSeparator),r.positive.pattern=t[0],r.negative.pattern=t[1],r.zero.pattern=t[2],Ne.test(t[0])&&(r.positive.isFunctional=!0),t[1]?Ne.test(t[1])&&(r.negative.isFunctional=!0):r.negative=!1,t[2]?Ne.test(t[2])&&(r.zero.isFunctional=!0):r.zero=!1,r.positive.isFunctional||Re(r.positive,e,n),r.negative&&!r.negative.isFunctional&&Re(r.negative,e,n),r.zero&&!r.zero.isFunctional&&Re(r.zero,e,n)):this._prepared={pattern:!1}}},{key:"formatValue",value:function(t){var e,n,r,i,o,a,s,u,l,c=this._prepared,h="",f="",d=t;if(isNaN(t))return"".concat(d);if(t=+t,!1===c.pattern)return t.toString();if(0===t&&c.zero)return(c=c.zero).pattern;if(t<0&&c.negative?(c=c.negative,t=-t):c=c.positive,o=c.d,a=c.t,c.isFunctional)t=function(t,e,n){var r;return qe.test(e)?t=Ie(t,Number(/\d{2}/.exec(e)[0]),e,n):De.test(e)?t=Ie(t,8,e,n):Se.test(e)?t=Ie(t,10,e,n):Ce.test(e)?t=Ie(t,16,e,n):Ee.test(e)?t=Ie(t,2,e,n):Ae.test(e)&&(r="",t<0&&(r="-",t=-t),0===(t=Math.floor(t))?t="0":t<=5e5?(t=function(t,e){for(var n,r="",i=Number(String(t).slice(-3)),o=(t-i)/1e3,a=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),s=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();i>0;)for(n=0;n<a.length;n++)if(a[n]<=i){r+=s[n],i-=a[n];break}for(n=0;n<o;n++)r="M".concat(r);return e[1]!==e[1].toUpperCase()&&(r=r.toLowerCase()),r}(t,e),t=r+t):t=e+r+t.toExponential(0)),t}(t,c.pattern,o);else{if(c.percentage&&(t*=100),c.abbreviate){var p,m,g=Object.keys(this.abbreviations).map((function(t){return parseInt(t,10)})).sort((function(t,e){return t-e})),y=g[0];for(s=0,n=Number(Number(t).toExponential().split("e")[1]);y<=n&&s<g.length;)y=g[++s];s>0&&(p=g[s-1]),p&&n>0&&p>0?m=p:(n<0&&p<0||!p)&&(y<0&&y-n<=c.maxPrecision?m=y:p<=n&&!(y>0&&-n<=c.maxPrecision)&&(m=p)),m&&(h=this.abbreviations[m],t/=Math.pow(10,m))}if(r=Math.abs(t),e=c.temp,l=(u=c.numericPattern).split(o)[1],"I"===this.type&&(t=Math.round(t)),i=t,l||"#"!==u.slice(-1)[0])if(r>=1e15||r>0&&r<=1e-14)t=r?r.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var v=Number(t.toFixed(Math.min(20,l?l.length:0)).split(".")[0]),x=u.split(o)[0];if(t=we(x+=o,v)||"0",l){var b=Math.max(0,Math.min(14,l.length)),w=l.replace(/#+$/,"").length,M=("I"===this.type?0:r%1).toFixed(b).slice(2).replace(/0+$/,"");for(s=M.length;s<w;s++)M+="0";M&&(t+=o+M)}else 0===v&&(i=0)}else if(r>=Math.pow(10,e)||r<1||r<1e-4)0===t?t="0":r<1e-4||r>=1e20?(t=(t=i.toExponential(Math.max(1,Math.min(14,e))-1)).replace(/\.?0+(?=e)/,""),f=""):(t=t.toPrecision(Math.max(1,Math.min(14,e)))).indexOf(".")>=0&&(t=(t=t.replace(t.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"")).replace(".",o));else{for(u+=o,e=Math.max(0,Math.min(20,e-Math.ceil(Math.log(r)/Math.log(10)))),s=0;s<e;s++)u+="#";t=we(u,t)}t=t.replace(c.numericRegex,(function(t){return t===a?c.groupTemp:t===o?c.decTemp:""})),i<0&&!/^-/.test(t)&&(t="-".concat(t))}return c.prefix+t+f+h+c.postfix}}],[{key:"getStaticFormatter",value:function(){return{prepare:function(){},formatValue:function(t){return"".concat(t)}}}}])}();var Pe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Fe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Le=["January","February","March","April","May","June","July","August","September","October","November","December"],je=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ze(t,e){for(var n=t.length;n<e;n++)t="0".concat(t);return t}function Ve(t){var e=t.toString().split(".");return e[1]?e=Number("0.".concat(e[1])):0}function He(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}!function(){function t(e,n,r){le(this,t);var i,o=e||{};o.qCalendarStrings||(o.qCalendarStrings={qLongDayNames:Pe,qDayNames:Fe,qLongMonthNames:Le,qMonthNames:je}),this.localeInfo=o,this.locale_days=o.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=o.qCalendarStrings.qDayNames.slice(),this.locale_months=o.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=o.qCalendarStrings.qMonthNames.slice(),n||(n=(fe(i={},"T",o.qTimeFmt||"hh:mm:ss"),fe(i,"D",o.qDateFmt||"YYYY-MM-DD"),fe(i,"TS",o.qTimestampFmt||"YYYY-MM-DD hh:mm:ss"),i)[r]),this.pattern=n}he(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e){e||(e=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),e=e.replace(/\[.+]|\[|]/g,"");var n,r,i,o,a,s=/t+/gi.test(e);t instanceof Date?(i=s,o=(r=t).getUTCHours(),i&&((o%=12)||(o=12)),(a=r.getUTCDay()-1)<0&&(a=6),n={year:r.getUTCFullYear(),month:r.getUTCMonth(),day:a,date:r.getUTCDate(),h:o,m:r.getUTCMinutes(),s:r.getUTCSeconds(),f:r.getUTCMilliseconds(),t:r.getUTCHours()>=12?"pm":"am"}):(t<0&&(t=-t,e="-".concat(e)),n=function(t,e){var n,r=function(t){var e=t,n=24*Ve(e),r=60*Ve(n),i=60*Ve(r),o=1e3*Ve(i);return{d:Math.floor(e),h:Math.floor(n),m:Math.floor(r),s:Math.floor(i),f:Math.round(o)}}(t),i=r.d,o=r.h,a=r.m,s=r.s,u=r.f,l=0;/w+|t+/gi.test(e)&&(n=new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,Math.round(86400*(t-Math.floor(t))))),isNaN(n.getTime())&&(n=null)),/D+/gi.test(e)||(o+=24*i),/h+/gi.test(e)||(a+=60*o),/m+/gi.test(e)||(s+=60*a),/w+/gi.test(e)&&(l=n?n.getDay()-1:0)<0&&(l=6);var c="";return n&&(c=n.getUTCHours()>=12?"pm":"am"),{year:0,month:0,day:l,date:i,h:o,m:a,s:s,f:u,t:c}}(t,e));var u=function(t,e){return{"Y+|y+":{Y:"".concat(Number("".concat(e.year).slice(-2))),YY:ze("".concat(e.year).slice(-2),2),YYY:ze("".concat(e.year).slice(-3),3),def:function(t){return ze("".concat(e.year),t.length)}},"M+":{M:e.month+1,MM:ze("".concat(e.month+1),2),MMM:t.locale_months_abbr[e.month],def:t.locale_months[e.month]},"W+|w+":{W:e.day,WW:ze("".concat(e.day),2),WWW:t.locale_days_abbr[e.day],def:t.locale_days[e.day]},"D+|d+":{D:e.date,def:function(t){return ze("".concat(e.date),t.length)}},"h+|H+":{h:e.h,def:function(t){return ze("".concat(e.h),t.length)}},"m+":{m:e.m,def:function(t){return ze("".concat(e.m),t.length)}},"s+|S+":{s:e.s,def:function(t){return ze("".concat(e.s),t.length)}},"f+|F+":{def:function(t){var n="".concat(e.f),r=t.length-n.length;if(r>0)for(var i=0;i<r;i++)n+="0";else r<0&&(n=n.slice(0,t.length));return n}},"t{1,2}|T{1,2}":{def:function(t){var n=e.t;return t[0].toUpperCase()===t[0]&&(n=n.toUpperCase()),n.slice(0,t.length)}}}}(this,n),l=[];for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&l.push(c);var h=new RegExp(l.join("|"),"g"),f=e.replace(h,(function(t){var e,n,r;for(n in u)if(Object.prototype.hasOwnProperty.call(u,n)&&(e=new RegExp(n)).test(t))break;if(!e)return"";for(var i in u[n])if(i===t||i.toLowerCase()===t){void 0===(r=u[n][i])&&(r=u[n][i.toLowerCase()]);break}return void 0===r&&(r=u[n].def),"function"==typeof r&&(r=r(t)),r}));return f}}])}();var Be={exports:{}};!function(t){!function(e,n,r,o){var a,s=["","webkit","Moz","MS","ms","o"],u=n.createElement("div"),l=Math.round,c=Math.abs,h=Date.now;function f(t,e,n){return setTimeout(x(t,n),e)}function d(t,e,n){return!!Array.isArray(t)&&(p(t,n[e],n),!0)}function p(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==o)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function m(t,n,r){var i="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=e.console&&(e.console.warn||e.console.log);return o&&o.call(e.console,i,r),t.apply(this,arguments)}}a="function"!=typeof Object.assign?function(t){if(t===o||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==o&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var g=m((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===o)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),y=m((function(t,e){return g(t,e,!0)}),"merge","Use `assign`.");function v(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&a(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function b(t,e){return"function"==i(t)?t.apply(e&&e[0]||o,e):t}function w(t,e){return t===o?e:t}function M(t,e,n){p(D(e),(function(e){t.addEventListener(e,n,!1)}))}function k(t,e,n){p(D(e),(function(e){t.removeEventListener(e,n,!1)}))}function _(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function q(t,e){return t.indexOf(e)>-1}function D(t){return t.trim().split(/\s+/g)}function S(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function C(t){return Array.prototype.slice.call(t,0)}function E(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];S(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function A(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),a=0;a<s.length;){if((r=(n=s[a])?n+i:e)in t)return r;a++}return o}var N=1;function O(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}var I="ontouchstart"in e,T=A(e,"PointerEvent")!==o,R=I&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),P="touch",F="mouse",L=24,j=["x","y"],z=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){b(t.options.enable,[t])&&n.handler(e)},this.init()}function H(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,a=1&e&&r-i==0,s=12&e&&r-i==0;n.isFirst=!!a,n.isFinal=!!s,a&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=B(e));i>1&&!n.firstMultiple?n.firstMultiple=B(e):1===i&&(n.firstMultiple=!1);var a=n.firstInput,s=n.firstMultiple,u=s?s.center:a.center,l=e.center=W(r);e.timeStamp=h(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=X(u,l),e.distance=$(u,l),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=Y(e.deltaX,e.deltaY);var f=U(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=f.x,e.overallVelocityY=f.y,e.overallVelocity=c(f.x)>c(f.y)?f.x:f.y,e.scale=s?function(t,e){return $(e[0],e[1],z)/$(t[0],t[1],z)}(s.pointers,r):1,e.rotation=s?function(t,e){return X(e[1],e[0],z)+X(t[1],t[0],z)}(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,a,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(u>25||s.velocity===o)){var l=e.deltaX-s.deltaX,h=e.deltaY-s.deltaY,f=U(u,l,h);r=f.x,i=f.y,n=c(f.x)>c(f.y)?f.x:f.y,a=Y(l,h),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,a=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=a}(n,e);var d=t.element;_(e.srcEvent.target,d)&&(d=e.srcEvent.target);e.target=d}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function B(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:l(t.pointers[n].clientX),clientY:l(t.pointers[n].clientY)},n++;return{timeStamp:h(),pointers:e,center:W(e),deltaX:t.deltaX,deltaY:t.deltaY}}function W(t){var e=t.length;if(1===e)return{x:l(t[0].clientX),y:l(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:l(n/e),y:l(r/e)}}function U(t,e,n){return{x:e/t||0,y:n/t||0}}function Y(t,e){return t===e?1:c(t)>=c(e)?t<0?2:4:e<0?8:16}function $(t,e,n){n||(n=j);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function X(t,e,n){n||(n=j);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(O(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(O(this.element),this.evWin,this.domHandler)}};var G={mousedown:1,mousemove:2,mouseup:4},K="mousedown",J="mousemove mouseup";function Z(){this.evEl=K,this.evWin=J,this.pressed=!1,V.apply(this,arguments)}v(Z,V,{handler:function(t){var e=G[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:F,srcEvent:t}))}});var Q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},tt={2:P,3:"pen",4:F,5:"kinect"},et="pointerdown",nt="pointermove pointerup pointercancel";function rt(){this.evEl=et,this.evWin=nt,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(et="MSPointerDown",nt="MSPointerMove MSPointerUp MSPointerCancel"),v(rt,V,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Q[r],o=tt[t.pointerType]||t.pointerType,a=o==P,s=S(e,t.pointerId,"pointerId");1&i&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ot="touchstart",at="touchstart touchmove touchend touchcancel";function st(){this.evTarget=ot,this.evWin=at,this.started=!1,V.apply(this,arguments)}function ut(t,e){var n=C(t.touches),r=C(t.changedTouches);return 12&e&&(n=E(n.concat(r),"identifier",!0)),[n,r]}v(st,V,{handler:function(t){var e=it[t.type];if(1===e&&(this.started=!0),this.started){var n=ut.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:P,srcEvent:t})}}});var lt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ct="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=ct,this.targetIds={},V.apply(this,arguments)}function ft(t,e){var n=C(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=C(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return _(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&e&&delete r[a[i].identifier],i++;return s.length?[E(o.concat(s),"identifier",!0),s]:void 0}v(ht,V,{handler:function(t){var e=lt[t.type],n=ft.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:P,srcEvent:t})}});function dt(){V.apply(this,arguments);var t=x(this.handler,this);this.touch=new ht(this.manager,t),this.mouse=new Z(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function pt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,mt.call(this,e)):12&t&&mt.call(this,e)}function mt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function gt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}v(dt,V,{handler:function(t,e,n){var r=n.pointerType==P,i=n.pointerType==F;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)pt.call(this,e,n);else if(i&&gt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var yt=A(u.style,"touchAction"),vt=yt!==o,xt="compute",bt="auto",wt="manipulation",Mt="none",kt="pan-x",_t="pan-y",qt=function(){if(!vt)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){t[r]=!n||e.CSS.supports("touch-action",r)})),t}();function Dt(t,e){this.manager=t,this.set(e)}Dt.prototype={set:function(t){t==xt&&(t=this.compute()),vt&&this.manager.element.style&&qt[t]&&(this.manager.element.style[yt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return p(this.manager.recognizers,(function(e){b(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(q(t,Mt))return Mt;var e=q(t,kt),n=q(t,_t);if(e&&n)return Mt;if(e||n)return e?kt:_t;if(q(t,wt))return wt;return bt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=q(r,Mt)&&!qt.none,o=q(r,_t)&&!qt["pan-y"],a=q(r,kt)&&!qt["pan-x"];if(i){var s=1===t.pointers.length,u=t.distance<2,l=t.deltaTime<250;if(s&&u&&l)return}if(!a||!o)return i||o&&6&n||a&&n&L?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var St=32;function Ct(t){this.options=a({},this.defaults,t||{}),this.id=N++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Et(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function At(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Nt(t,e){var n=e.manager;return n?n.get(t):t}function Ot(){Ct.apply(this,arguments)}function It(){Ot.apply(this,arguments),this.pX=null,this.pY=null}function Tt(){Ot.apply(this,arguments)}function Rt(){Ct.apply(this,arguments),this._timer=null,this._input=null}function Pt(){Ot.apply(this,arguments)}function Ft(){Ot.apply(this,arguments)}function Lt(){Ct.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function jt(t,e){return(e=e||{}).recognizers=w(e.recognizers,jt.defaults.preset),new zt(t,e)}Ct.prototype={defaults:{},set:function(t){return a(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(d(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Nt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return d(t,"dropRecognizeWith",this)||(t=Nt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(d(t,"requireFailure",this))return this;var e=this.requireFail;return-1===S(e,t=Nt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(d(t,"dropRequireFailure",this))return this;t=Nt(t,this);var e=S(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+Et(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+Et(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=St},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=a({},t);if(!b(this.options.enable,[this,e]))return this.reset(),void(this.state=St);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},v(Ot,Ct,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:St}}),v(It,Ot,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(_t),t&L&&e.push(kt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Ot.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=At(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),v(Tt,Ot,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Mt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),v(Rt,Ct,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[bt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=f((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return St},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}}),v(Pt,Ot,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Mt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),v(Ft,Ot,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return It.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:n&L&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&c(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=At(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),v(Lt,Ct,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||$(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=f((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return St},failTimeout:function(){return this._timer=f((function(){this.state=St}),this.options.interval,this),St},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),jt.VERSION="2.0.7",jt.defaults={domEvents:!1,touchAction:xt,enable:!0,inputTarget:null,inputClass:null,preset:[[Pt,{enable:!1}],[Tt,{enable:!1},["rotate"]],[Ft,{direction:6}],[It,{direction:6},["swipe"]],[Lt],[Lt,{event:"doubletap",taps:2},["tap"]],[Rt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function zt(t,e){var n;this.options=a({},jt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(T?rt:R?ht:I?dt:Z))(n,H),this.touchAction=new Dt(this,this.options.touchAction),Vt(this,!0),p(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Vt(t,e){var n,r=t.element;r.style&&(p(t.options.cssProps,(function(i,o){n=A(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}zt.prototype={set:function(t){return a(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Ct)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(d(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(d(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=S(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==o&&e!==o){var n=this.handlers;return p(D(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==o){var n=this.handlers;return p(D(t),(function(t){e?n[t]&&n[t].splice(S(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var r=n.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=e,e.target.dispatchEvent(r)}(t,e);var r=this.handlers[t]&&this.handlers[t].slice();if(r&&r.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](e),i++}},destroy:function(){this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},a(jt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:St,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:L,DIRECTION_ALL:30,Manager:zt,Input:V,TouchAction:Dt,TouchInput:ht,MouseInput:Z,PointerEventInput:rt,TouchMouseInput:dt,SingleTouchInput:st,Recognizer:Ct,AttrRecognizer:Ot,Tap:Lt,Pan:It,Swipe:Ft,Pinch:Tt,Rotate:Pt,Press:Rt,on:M,off:k,each:p,merge:y,extend:g,assign:a,inherit:v,bindFn:x,prefixed:A}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=jt,t.exports?t.exports=jt:e.Hammer=jt}(window,document)}(Be);var We=Be.exports,Ue={click:"Tap",Click:"Tap",tap:"Tap",pan:"Pan",swipe:"Swipe",rotate:"Rotate",press:"Press",pinch:"Pinch"};function Ye(t){return Ue[t]||t}function $e(t){return function(e,n,r){var i,o,a,s,u=[],l=!0;function c(){"function"==typeof i.enable&&(i.enable=i.enable.bind(o)()),i.enable&&(i.gestures.forEach((function(e){e.options=e.options||{},void 0===e.options.enable&&(e.options.enable=!0),"function"==typeof e.options.enable&&(e.options.enable=e.options.enable.bind(o));var n=Ye(e.type);t&&t[n]&&(e.options.event=e.options.event||e.type.toLowerCase(),(a=a||new t.Manager(r)).add(new t[n](e.options)),Object.keys(e.events).forEach((function(t){e.events[t]=e.events[t].bind(o),a.on(t,e.events[t])})),u.push(e))})),i.gestures.forEach((function(e){var n=Ye(e.type);t&&t[n]&&(e.recognizeWith&&a.get(e.options.event).recognizeWith(e.recognizeWith.split(" ").filter((function(t){return""!==t}))),e.requireFailure&&a.get(e.options.event).requireFailure(e.requireFailure.split(" ").filter((function(t){return""!==t}))))})))}function h(){u.forEach((function(t){Object.keys(t.events).forEach((function(e){a.off(e,t.events[e])})),a.remove(t.options.event)})),u=[]}return{get key(){return s},set:function(t){!function(t){s=t.key,o={chart:e,mediator:n,settings:i=t},i.gestures=i.gestures||[],void 0===i.enable&&(i.enable=!0)}(t),h(),l&&c()},off:function(){l=!1,h()},on:function(){l=!0,0===u.length&&c()},destroy:function(){h(),a&&a.destroy(),a=null,o=null,i=null}}}}var Xe={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Ge=/([astvzqmhlc])([^astvzqmhlc]*)/gi,Ke=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;var Je=function(t){var e=[],n=String(t).trim();return"M"!==n[0]&&"m"!==n[0]||n.replace(Ge,(function(t,n,r){var i=n.toLowerCase(),o=function(t){var e=t.match(Ke);return e?e.map(Number):[]}(r),a=n;if("m"===i&&o.length>2&&(e.push([a].concat(o.splice(0,2))),i="l",a="m"===a?"l":"L"),o.length<Xe[i])return"";for(e.push([a].concat(o.splice(0,Xe[i])));o.length>=Xe[i]&&o.length&&Xe[i];)e.push([a].concat(o.splice(0,Xe[i])));return""})),e};function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qe(t){return function(t){if(Array.isArray(t))return tn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return tn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var en=Je;function nn(t,e){var n=t.x*Math.cos(e)-t.y*Math.sin(e),r=t.y*Math.cos(e)+t.x*Math.sin(e);t.x=n,t.y=r}function rn(t,e){t.x*=e,t.y*=e}var on=function(t){if(void 0!==t&&t.CanvasRenderingContext2D&&(!t.Path2D||!function(t){var e=t.document.createElement("canvas").getContext("2d"),n=new t.Path2D("M0 0 L1 1");return e.strokeStyle="red",e.lineWidth=1,e.stroke(n),255===e.getImageData(0,0,1,1).data[0]}(t))){var e=function(){function t(e){var n;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.segments=[],e&&e instanceof t)?(n=this.segments).push.apply(n,Qe(e.segments)):e&&(this.segments=en(e))}var e,n,r;return e=t,n=[{key:"addPath",value:function(e){var n;e&&e instanceof t&&(n=this.segments).push.apply(n,Qe(e.segments))}},{key:"moveTo",value:function(t,e){this.segments.push(["M",t,e])}},{key:"lineTo",value:function(t,e){this.segments.push(["L",t,e])}},{key:"arc",value:function(t,e,n,r,i,o){this.segments.push(["AC",t,e,n,r,i,!!o])}},{key:"arcTo",value:function(t,e,n,r,i){this.segments.push(["AT",t,e,n,r,i])}},{key:"ellipse",value:function(t,e,n,r,i,o,a,s){this.segments.push(["E",t,e,n,r,i,o,a,!!s])}},{key:"closePath",value:function(){this.segments.push(["Z"])}},{key:"bezierCurveTo",value:function(t,e,n,r,i,o){this.segments.push(["C",t,e,n,r,i,o])}},{key:"quadraticCurveTo",value:function(t,e,n,r){this.segments.push(["Q",t,e,n,r])}},{key:"rect",value:function(t,e,n,r){this.segments.push(["R",t,e,n,r])}}],n&&Ze(e.prototype,n),r&&Ze(e,r),t}(),n=t.CanvasRenderingContext2D.prototype.fill,r=t.CanvasRenderingContext2D.prototype.stroke;t.CanvasRenderingContext2D.prototype.fill=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i="nonzero";if(0===e.length||1===e.length&&"string"==typeof e[0])n.apply(this,e);else{2===arguments.length&&(i=e[1]);var a=e[0];o(this,a.segments),n.call(this,i)}},t.CanvasRenderingContext2D.prototype.stroke=function(t){t?(o(this,t.segments),r.call(this)):r.call(this)};var i=t.CanvasRenderingContext2D.prototype.isPointInPath;t.CanvasRenderingContext2D.prototype.isPointInPath=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("Path2D"===e[0].constructor.name){var r=e[1],a=e[2],s=e[3]||"nonzero",u=e[0];return o(this,u.segments),i.apply(this,[r,a,s])}return i.apply(this,e)},t.Path2D=e}function o(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,m,g,y,v,x,b,w,M,k,_,q,D,S,C,E,A,N={x:0,y:0},O={x:0,y:0};t.beginPath();for(var I=0;I<e.length;++I){var T=e[I];switch("S"!==(w=T[0])&&"s"!==w&&"C"!==w&&"c"!==w&&(k=null,_=null),"T"!==w&&"t"!==w&&"Q"!==w&&"q"!==w&&(q=null,D=null),w){case"m":case"M":"m"===w?(f+=T[1],p+=T[2]):(f=T[1],p=T[2]),"M"!==w&&N||(N={x:f,y:p}),t.moveTo(f,p);break;case"l":f+=T[1],p+=T[2],t.lineTo(f,p);break;case"L":f=T[1],p=T[2],t.lineTo(f,p);break;case"H":f=T[1],t.lineTo(f,p);break;case"h":f+=T[1],t.lineTo(f,p);break;case"V":p=T[1],t.lineTo(f,p);break;case"v":p+=T[1],t.lineTo(f,p);break;case"a":case"A":"a"===w?(f+=T[6],p+=T[7]):(f=T[6],p=T[7]),y=T[1],v=T[2],u=T[3]*Math.PI/180,i=!!T[4],o=!!T[5],a={x:f,y:p},nn(s={x:(O.x-a.x)/2,y:(O.y-a.y)/2},-u),(l=s.x*s.x/(y*y)+s.y*s.y/(v*v))>1&&(y*=l=Math.sqrt(l),v*=l),c=y*y*v*v,h=y*y*s.y*s.y+v*v*s.x*s.x,rn(M={x:y*s.y/v,y:-v*s.x/y},o!==i?Math.sqrt((c-h)/h)||0:-Math.sqrt((c-h)/h)||0),r=Math.atan2((s.y-M.y)/v,(s.x-M.x)/y),n=Math.atan2(-(s.y+M.y)/v,-(s.x+M.x)/y),nn(M,u),C=M,E=(a.x+O.x)/2,A=(a.y+O.y)/2,C.x+=E,C.y+=A,t.save(),t.translate(M.x,M.y),t.rotate(u),t.scale(y,v),t.arc(0,0,1,r,n,!o),t.restore();break;case"C":k=T[3],_=T[4],f=T[5],p=T[6],t.bezierCurveTo(T[1],T[2],k,_,f,p);break;case"c":t.bezierCurveTo(T[1]+f,T[2]+p,T[3]+f,T[4]+p,T[5]+f,T[6]+p),k=T[3]+f,_=T[4]+p,f+=T[5],p+=T[6];break;case"S":null!==k&&null!==_||(k=f,_=p),t.bezierCurveTo(2*f-k,2*p-_,T[1],T[2],T[3],T[4]),k=T[1],_=T[2],f=T[3],p=T[4];break;case"s":null!==k&&null!==_||(k=f,_=p),t.bezierCurveTo(2*f-k,2*p-_,T[1]+f,T[2]+p,T[3]+f,T[4]+p),k=T[1]+f,_=T[2]+p,f+=T[3],p+=T[4];break;case"Q":q=T[1],D=T[2],f=T[3],p=T[4],t.quadraticCurveTo(q,D,f,p);break;case"q":q=T[1]+f,D=T[2]+p,f+=T[3],p+=T[4],t.quadraticCurveTo(q,D,f,p);break;case"T":null!==q&&null!==D||(q=f,D=p),q=2*f-q,D=2*p-D,f=T[1],p=T[2],t.quadraticCurveTo(q,D,f,p);break;case"t":null!==q&&null!==D||(q=f,D=p),q=2*f-q,D=2*p-D,f+=T[1],p+=T[2],t.quadraticCurveTo(q,D,f,p);break;case"z":case"Z":f=N.x,p=N.y,N=void 0,t.closePath();break;case"AC":f=T[1],p=T[2],g=T[3],r=T[4],n=T[5],S=T[6],t.arc(f,p,g,r,n,S);break;case"AT":d=T[1],m=T[2],f=T[3],p=T[4],g=T[5],t.arcTo(d,m,f,p,g);break;case"E":f=T[1],p=T[2],y=T[3],v=T[4],u=T[5],r=T[6],n=T[7],S=T[8],t.save(),t.translate(f,p),t.rotate(u),t.scale(y,v),t.arc(0,0,1,r,n,S),t.restore();break;case"R":f=T[1],p=T[2],x=T[3],b=T[4],N={x:f,y:p},t.rect(f,p,x,b)}O.x=f,O.y=p}}},an=Je,sn=on;"undefined"!=typeof window&&sn(window);var un={path2dPolyfill:sn,parsePath:an},ln=Object.prototype.hasOwnProperty,cn=Object.prototype.toString,hn=Object.defineProperty,fn=Object.getOwnPropertyDescriptor,dn=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===cn.call(t)},pn=function(t){if(!t||"[object Object]"!==cn.call(t))return!1;var e,n=ln.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&ln.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||ln.call(t,e)},mn=function(t,e){hn&&"__proto__"===e.name?hn(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},gn=function(t,e){if("__proto__"===e){if(!ln.call(t,e))return;if(fn)return fn(t,e).value}return t[e]},yn=function t(){var e,n,r,o,a,s,u=arguments[0],l=1,c=arguments.length,h=!1;for("boolean"==typeof u&&(h=u,u=arguments[1]||{},l=2),(null==u||"object"!==i(u)&&"function"!=typeof u)&&(u={});l<c;++l)if(null!=(e=arguments[l]))for(n in e)r=gn(u,n),u!==(o=gn(e,n))&&(h&&o&&(pn(o)||(a=dn(o)))?(a?(a=!1,s=r&&dn(r)?r:[]):s=r&&pn(r)?r:{},mn(u,{name:n,newValue:t(h,s,o)})):void 0!==o&&mn(u,{name:n,newValue:o}));return u},vn="1.6.0";function xn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xn(Object(n),!0).forEach((function(e){qn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function wn(t){return wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wn(t)}function Mn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _n(t,e,n){return e&&kn(t.prototype,e),n&&kn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cn(t,e)}function Sn(t){return Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Sn(t)}function Cn(t,e){return Cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Cn(t,e)}function En(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function An(t,e,n){return An=En()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Cn(i,n.prototype),i},An.apply(null,arguments)}function Nn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function On(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Nn(t)}function In(t){var e=En();return function(){var n,r=Sn(t);if(e){var i=Sn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return On(this,n)}}function Tn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sn(t)););return t}function Rn(){return Rn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Tn(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Rn.apply(this,arguments)}function Pn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(t,e)||Ln(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fn(t){return function(t){if(Array.isArray(t))return jn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ln(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(t,e){if(t){if("string"==typeof t)return jn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jn(t,e):void 0}}function jn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function zn(t){return!!t.changedTouches}function Vn(t){return"number"==typeof t&&!isNaN(t)}function Hn(t){return"number"!=typeof t||isNaN(t)}function Bn(t){for(var e=t.length,n=NaN,r=NaN,i=NaN,o=NaN,a=0;a<e;a++)n=isNaN(n)?t[a].x:Math.min(n,t[a].x),r=isNaN(r)?t[a].x:Math.max(r,t[a].x),i=isNaN(i)?t[a].y:Math.min(i,t[a].y),o=isNaN(o)?t[a].y:Math.max(o,t[a].y);return[n,i,r,o]}function Wn(t){return[{x:t.x1||0,y:t.y1||0},{x:t.x2||0,y:t.y2||0}]}function Un(t){return[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}]}function Yn(t){var e=Pn(Bn(t),4),n=e[0],r=e[1];return{x:n,y:r,width:e[2]-n,height:e[3]-r}}function $n(t){return{x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}function Xn(t){var e=t||{},n=e.x,r=e.y,i=e.width,o=e.height,a=e.x1,s=e.x2,u=e.y1,l=e.y2,c=e.cx,h=e.cy,f=e.r,d=e.vertices;return Vn(c)&&Vn(h)&&Vn(f)?"circle":Vn(a)&&Vn(s)&&Vn(u)&&Vn(l)?"line":Vn(n)&&Vn(r)&&Vn(i)&&Vn(o)?"rect":Vn(n)&&Vn(r)?"point":Array.isArray(d)?d.every((function(t){return Array.isArray(t)}))?"geopolygon":"polygon":null}function Gn(t,e){return{x:e.x-t,y:e.y-t,width:e.width+t,height:e.height+t}}function Kn(t,e){var n=e.types,r=e.logger,i={},o=[];Array.isArray(t)?o.push.apply(o,Fn(t)):(r.warn('Deprecated: "data-source" configuration"'),o.push(t)),o.forEach((function(t,e){var o=n(t.type);if(o){var a=t.key;void 0===t.key&&(r.warn("Missing key for dataset. Using index '".concat(e,"' as key.")),a=e);var s=o({key:a,data:t.data,config:t.config});i[a]=s}}));return function(t){return t?i[t]:i[Object.keys(i)[0]]}}var Jn=Math.PI,Zn=2*Jn,Qn=1e-6,tr=Zn-Qn;function er(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function nr(){return new er}function rr(t){return function(){return t}}er.prototype=nr.prototype={constructor:er,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-t,u=r-e,l=o-t,c=a-e,h=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>Qn)if(Math.abs(c*s-u*l)>Qn&&i){var f=n-o,d=r-a,p=s*s+u*u,m=f*f+d*d,g=Math.sqrt(p),y=Math.sqrt(h),v=i*Math.tan((Jn-Math.acos((p+h-m)/(2*g*y)))/2),x=v/y,b=v/g;Math.abs(x-1)>Qn&&(this._+="L"+(t+x*l)+","+(e+x*c)),this._+="A"+i+","+i+",0,0,"+ +(c*f>l*d)+","+(this._x1=t+b*s)+","+(this._y1=e+b*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+a,l=e+s,c=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>Qn||Math.abs(this._y1-l)>Qn)&&(this._+="L"+u+","+l),n&&(h<0&&(h=h%Zn+Zn),h>tr?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):h>Qn&&(this._+="A"+n+","+n+",0,"+ +(h>=Jn)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var ir=Math.abs,or=Math.atan2,ar=Math.cos,sr=Math.max,ur=Math.min,lr=Math.sin,cr=Math.sqrt,hr=1e-12,fr=Math.PI,dr=fr/2,pr=2*fr;function mr(t){return t>1?0:t<-1?fr:Math.acos(t)}function gr(t){return t>=1?dr:t<=-1?-dr:Math.asin(t)}function yr(t){return t.innerRadius}function vr(t){return t.outerRadius}function xr(t){return t.startAngle}function br(t){return t.endAngle}function wr(t){return t&&t.padAngle}function Mr(t,e,n,r,i,o,a,s){var u=n-t,l=r-e,c=a-i,h=s-o,f=h*u-c*l;if(!(f*f<hr))return[t+(f=(c*(e-o)-h*(t-i))/f)*u,e+f*l]}function kr(t,e,n,r,i,o,a){var s=t-n,u=e-r,l=(a?o:-o)/cr(s*s+u*u),c=l*u,h=-l*s,f=t+c,d=e+h,p=n+c,m=r+h,g=(f+p)/2,y=(d+m)/2,v=p-f,x=m-d,b=v*v+x*x,w=i-o,M=f*m-p*d,k=(x<0?-1:1)*cr(sr(0,w*w*b-M*M)),_=(M*x-v*k)/b,q=(-M*v-x*k)/b,D=(M*x+v*k)/b,S=(-M*v+x*k)/b,C=_-g,E=q-y,A=D-g,N=S-y;return C*C+E*E>A*A+N*N&&(_=D,q=S),{cx:_,cy:q,x01:-c,y01:-h,x11:_*(i/w-1),y11:q*(i/w-1)}}function _r(t){this._context=t}function qr(t){return new _r(t)}function Dr(t){return t[0]}function Sr(t){return t[1]}function Cr(){var t=Dr,e=null,n=rr(0),r=Sr,i=rr(!0),o=null,a=qr,s=null;function u(u){var l,c,h,f,d,p=u.length,m=!1,g=new Array(p),y=new Array(p);for(null==o&&(s=a(d=nr())),l=0;l<=p;++l){if(!(l<p&&i(f=u[l],l,u))===m)if(m=!m)c=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=l-1;h>=c;--h)s.point(g[h],y[h]);s.lineEnd(),s.areaEnd()}m&&(g[l]=+t(f,l,u),y[l]=+n(f,l,u),s.point(e?+e(f,l,u):g[l],r?+r(f,l,u):y[l]))}if(d)return s=null,d+""||null}function l(){return function(){var t=Dr,e=Sr,n=rr(!0),r=null,i=qr,o=null;function a(a){var s,u,l,c=a.length,h=!1;for(null==r&&(o=i(l=nr())),s=0;s<=c;++s)!(s<c&&n(u=a[s],s,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(u,s,a),+e(u,s,a));if(l)return o=null,l+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:rr(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:rr(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:rr(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}().defined(i).curve(a).context(o)}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:rr(+n),e=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:rr(+e),u):t},u.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:rr(+t),u):e},u.y=function(t){return arguments.length?(n="function"==typeof t?t:rr(+t),r=null,u):n},u.y0=function(t){return arguments.length?(n="function"==typeof t?t:rr(+t),u):n},u.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:rr(+t),u):r},u.lineX0=u.lineY0=function(){return l().x(t).y(n)},u.lineY1=function(){return l().x(t).y(r)},u.lineX1=function(){return l().x(e).y(n)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:rr(!!t),u):i},u.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),u):a},u.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),u):o},u}function Er(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function Ar(t){return t}_r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Nr=Array.prototype.slice;function Or(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Ir(t){this._context=t}function Tr(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Rr(t,e){this._context=t,this._k=(1-e)/6}Ir.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Or(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Or(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Rr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Tr(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Tr(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Pr=function t(e){function n(t){return new Rr(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Fr(t,e){this._context=t,this._alpha=e}Fr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:!function(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>hr){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>hr){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*l+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*l+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Lr=function t(e){function n(t){return e?new Fr(t,e):new Rr(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function jr(t){return t<0?-1:1}function zr(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(jr(o)+jr(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Vr(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Hr(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function Br(t){this._context=t}function Wr(t){this._context=new Ur(t)}function Ur(t){this._context=t}function Yr(t){this._context=t}function $r(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function Xr(t,e){this._context=t,this._t=e}function Gr(t,e){if((i=t.length)>1)for(var n,r,i,o=1,a=t[e[0]],s=a.length;o<i;++o)for(r=a,a=t[e[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function Kr(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function Jr(t,e){return t[e]}function Zr(t){for(var e,n=-1,r=0,i=t.length,o=-1/0;++n<i;)(e=+t[n][1])>o&&(o=e,r=n);return r}function Qr(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function ti(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unspecified",r=arguments.length>2?arguments[2]:void 0,i={},o=t||{get:function(){},has:function(){return!1},default:function(){}};function a(t,e){if(!t||"string"!=typeof t)throw new TypeError("Invalid argument: key must be a non-empty string");return!(t in i)&&(i[t]=e,!0)}function s(t){return i[t]||o.get(t)}function u(t){return!!i[t]||o.has(t)}function l(t){var e=i[t];return delete i[t],e}function c(){return Object.keys(i)}function h(){return Object.keys(i).map((function(t){return i[t]}))}function f(t){return void 0!==t&&(e=t),e}function d(t,i){if(void 0!==i)return a(t,i);var o=s(t);return r&&void 0===o&&r.warn("".concat(t," does not exist in ").concat(n," registry")),o||s(e)}return e=o.default(),d.add=a,d.get=s,d.has=u,d.remove=l,d.getKeys=c,d.getValues=h,d.default=f,d.register=a,d}function ei(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ni(t){return(t=ei(Math.abs(t)))?t[1]:NaN}Br.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Hr(this,this._t0,Vr(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Hr(this,Vr(this,n=zr(this,t,e)),n);break;default:Hr(this,this._t0,n=zr(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Wr.prototype=Object.create(Br.prototype)).point=function(t,e){Br.prototype.point.call(this,e,t)},Ur.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},Yr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=$r(t),i=$r(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Xr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var ri,ii=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function oi(t){if(!(e=ii.exec(t)))throw new Error("invalid format: "+t);var e;return new ai({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ai(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function si(t,e){var n=ei(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}oi.prototype=ai.prototype,ai.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ui={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return si(100*t,e)},r:si,s:function(t,e){var n=ei(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(ri=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ei(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function li(t){return t}var ci,hi,fi,di=Array.prototype.map,pi=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function mi(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?li:(e=di.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?li:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(di.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=oi(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):ui[v]||(void 0===g&&(g=12),y=!0,v="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===f?i:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===f?o:/[%p]/.test(v)?u:"",w=ui[v],M=/[defgprs%]/.test(v);function k(t){var i,o,u,f=x,k=b;if("c"===v)k=w(t)+k,t="";else{var _=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:w(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),_&&0==+t&&"+"!==h&&(_=!1),f=(_?"("===h?h:l:"-"===h||"("===h?"":h)+f,k=("s"===v?pi[8+ri/3]:"")+k+(_&&"("===h?")":""),M)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){k=(46===u?a+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}m&&!d&&(t=r(t,1/0));var q=f.length+t.length+k.length,D=q<p?new Array(p-q+1).join(e):"";switch(m&&d&&(t=r(D+t,D.length?p-k.length:1/0),D=""),n){case"<":t=f+t+k+D;break;case"=":t=f+D+t+k;break;case"^":t=D.slice(0,q=D.length>>1)+f+t+k+D.slice(q);break;default:t=D+f+t+k}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:h,formatPrefix:function(t,e){var n=h(((t=oi(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(ni(e)/3))),i=Math.pow(10,-r),o=pi[8+r/3];return function(t){return n(i*t)+o}}}}!function(t){ci=mi(t),hi=ci.format,fi=ci.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var gi=new Date,yi=new Date;function vi(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return vi((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return gi.setTime(+e),yi.setTime(+r),t(gi),t(yi),Math.floor(n(gi,yi))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var xi=864e5,bi=6048e5,wi=vi((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/xi}),(function(t){return t.getDate()-1})),Mi=wi;function ki(t){return vi((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/bi}))}var _i=ki(0),qi=ki(1);ki(2),ki(3);var Di=ki(4);ki(5),ki(6);var Si=vi((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Si.every=function(t){return isFinite(t=Math.floor(t))&&t>0?vi((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Ci=Si,Ei=vi((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/xi}),(function(t){return t.getUTCDate()-1})),Ai=Ei;function Ni(t){return vi((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/bi}))}var Oi=Ni(0),Ii=Ni(1);Ni(2),Ni(3);var Ti=Ni(4);Ni(5),Ni(6);var Ri=vi((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Ri.every=function(t){return isFinite(t=Math.floor(t))&&t>0?vi((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Pi=Ri;function Fi(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Li(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ji(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function zi(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,l=$i(i),c=Xi(i),h=$i(o),f=Xi(o),d=$i(a),p=Xi(a),m=$i(s),g=Xi(s),y=$i(u),v=Xi(u),x={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:go,e:go,f:wo,g:Oo,G:To,H:yo,I:vo,j:xo,L:bo,m:Mo,M:ko,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:ra,s:ia,S:_o,u:qo,U:Do,V:Co,w:Eo,W:Ao,x:null,X:null,y:No,Y:Io,Z:Ro,"%":na},b={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Po,e:Po,f:Vo,g:Zo,G:ta,H:Fo,I:Lo,j:jo,L:zo,m:Ho,M:Bo,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:ra,s:ia,S:Wo,u:Uo,U:Yo,V:Xo,w:Go,W:Ko,x:null,X:null,y:Jo,Y:Qo,Z:ea,"%":na},w={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return _(t,e,n,r)},d:oo,e:oo,f:ho,g:eo,G:to,H:so,I:so,j:ao,L:co,m:io,M:uo,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:ro,Q:po,s:mo,S:lo,u:Ki,U:Ji,V:Zi,w:Gi,W:Qi,x:function(t,e,r){return _(t,n,e,r)},X:function(t,e,n){return _(t,r,e,n)},y:eo,Y:to,Z:no,"%":fo};function M(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=Vi[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function k(t,e){return function(n){var r,i,o=ji(1900,void 0,1);if(_(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Li(ji(o.y,0,1))).getUTCDay(),r=i>4||0===i?Ii.ceil(r):Ii(r),r=Ai.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Fi(ji(o.y,0,1))).getDay(),r=i>4||0===i?qi.ceil(r):qi(r),r=Mi.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Li(ji(o.y,0,1)).getUTCDay():Fi(ji(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Li(o)):Fi(o)}}function _(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=w[i in Vi?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return x.x=M(n,x),x.X=M(r,x),x.c=M(e,x),b.x=M(n,b),b.X=M(r,b),b.c=M(e,b),{format:function(t){var e=M(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=k(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=M(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=k(t+="",!0);return e.toString=function(){return t},e}}}var Vi={"-":"",_:" ",0:"0"},Hi=/^\s*\d+/,Bi=/^%/,Wi=/[\\^$*+?|[\]().{}]/g;function Ui(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Yi(t){return t.replace(Wi,"\\$&")}function $i(t){return new RegExp("^(?:"+t.map(Yi).join("|")+")","i")}function Xi(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Gi(t,e,n){var r=Hi.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ki(t,e,n){var r=Hi.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ji(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Zi(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Qi(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function to(t,e,n){var r=Hi.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function eo(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function no(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ro(t,e,n){var r=Hi.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function io(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function oo(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function ao(t,e,n){var r=Hi.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function so(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function uo(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function lo(t,e,n){var r=Hi.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function co(t,e,n){var r=Hi.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ho(t,e,n){var r=Hi.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function fo(t,e,n){var r=Bi.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function po(t,e,n){var r=Hi.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function mo(t,e,n){var r=Hi.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function go(t,e){return Ui(t.getDate(),e,2)}function yo(t,e){return Ui(t.getHours(),e,2)}function vo(t,e){return Ui(t.getHours()%12||12,e,2)}function xo(t,e){return Ui(1+Mi.count(Ci(t),t),e,3)}function bo(t,e){return Ui(t.getMilliseconds(),e,3)}function wo(t,e){return bo(t,e)+"000"}function Mo(t,e){return Ui(t.getMonth()+1,e,2)}function ko(t,e){return Ui(t.getMinutes(),e,2)}function _o(t,e){return Ui(t.getSeconds(),e,2)}function qo(t){var e=t.getDay();return 0===e?7:e}function Do(t,e){return Ui(_i.count(Ci(t)-1,t),e,2)}function So(t){var e=t.getDay();return e>=4||0===e?Di(t):Di.ceil(t)}function Co(t,e){return t=So(t),Ui(Di.count(Ci(t),t)+(4===Ci(t).getDay()),e,2)}function Eo(t){return t.getDay()}function Ao(t,e){return Ui(qi.count(Ci(t)-1,t),e,2)}function No(t,e){return Ui(t.getFullYear()%100,e,2)}function Oo(t,e){return Ui((t=So(t)).getFullYear()%100,e,2)}function Io(t,e){return Ui(t.getFullYear()%1e4,e,4)}function To(t,e){var n=t.getDay();return Ui((t=n>=4||0===n?Di(t):Di.ceil(t)).getFullYear()%1e4,e,4)}function Ro(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ui(e/60|0,"0",2)+Ui(e%60,"0",2)}function Po(t,e){return Ui(t.getUTCDate(),e,2)}function Fo(t,e){return Ui(t.getUTCHours(),e,2)}function Lo(t,e){return Ui(t.getUTCHours()%12||12,e,2)}function jo(t,e){return Ui(1+Ai.count(Pi(t),t),e,3)}function zo(t,e){return Ui(t.getUTCMilliseconds(),e,3)}function Vo(t,e){return zo(t,e)+"000"}function Ho(t,e){return Ui(t.getUTCMonth()+1,e,2)}function Bo(t,e){return Ui(t.getUTCMinutes(),e,2)}function Wo(t,e){return Ui(t.getUTCSeconds(),e,2)}function Uo(t){var e=t.getUTCDay();return 0===e?7:e}function Yo(t,e){return Ui(Oi.count(Pi(t)-1,t),e,2)}function $o(t){var e=t.getUTCDay();return e>=4||0===e?Ti(t):Ti.ceil(t)}function Xo(t,e){return t=$o(t),Ui(Ti.count(Pi(t),t)+(4===Pi(t).getUTCDay()),e,2)}function Go(t){return t.getUTCDay()}function Ko(t,e){return Ui(Ii.count(Pi(t)-1,t),e,2)}function Jo(t,e){return Ui(t.getUTCFullYear()%100,e,2)}function Zo(t,e){return Ui((t=$o(t)).getUTCFullYear()%100,e,2)}function Qo(t,e){return Ui(t.getUTCFullYear()%1e4,e,4)}function ta(t,e){var n=t.getUTCDay();return Ui((t=n>=4||0===n?Ti(t):Ti.ceil(t)).getUTCFullYear()%1e4,e,4)}function ea(){return"+0000"}function na(){return"%"}function ra(t){return+t}function ia(t){return Math.floor(+t/1e3)}var oa=ti();oa("d3-number",(function(t,e,n){var r,i;function o(t){return i(t)}function a(){o.locale({decimal:n||".",thousands:e||",",grouping:[3],currency:["$",""]})}return o.locale=function(e){return r=mi(e),i=r.format(t),this},a(),o.format=function(t,i,o,s){return(o||s)&&(e=o,n=s,a()),r.format(t)(i)},o.pattern=function(e){return e&&(t=e,i=r.format(e)),t},o})),oa("d3-time",(function(t){var e=zi({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),n=e.format(t);function r(t){return n(t)}return r.format=function(t,n){return e.format(t)(n)},r.locale=function(){return e=zi.apply(void 0,arguments),n=e.format(t),this},r.parse=function(t,n){return e.parse(t)(n)},r.parsePattern=function(t){return e.parse(t)},r}));var aa={id:function(t){return"".concat(t.source,"/").concat(t.key||t.title)},key:function(t){return String(t.key||t.title)},tags:function(t){return t.tags},min:function(t){return t.min},max:function(t){return t.max},type:function(t){return t.type},title:function(t){return String(t.title)},values:function(t){return t.values},value:function(t){return t},label:function(t){return t},formatter:function(t){return function(t){if("function"==typeof t.formatter)return t.formatter();var e=t.formatter||{};return oa(e.type||"d3-number")(e.format||"")}(t)}};function sa(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.id,r=void 0===n?aa.id:n,i=e.key,o=void 0===i?aa.key:i,a=e.min,s=void 0===a?aa.min:a,u=e.max,l=void 0===u?aa.max:u,c=e.type,h=void 0===c?aa.type:c,f=e.tags,d=void 0===f?aa.tags:f,p=e.title,m=void 0===p?aa.title:p,g=e.values,y=void 0===g?aa.values:g,v=e.value,x=void 0===v?aa.value:v,b=e.label,w=void 0===b?aa.label:b,M=e.formatter,k=void 0===M?aa.formatter:M,_={id:function(){return r(t)},key:function(){return o(t)},raw:function(){return t},tags:function(){return d(t)},type:function(){return h(t)},min:function(){return s(t)},max:function(){return l(t)},title:function(){return m(t)},items:function(){return y(t)},formatter:function(){return k(t)},value:x,label:w};return _}var ua={diverging:function(t,e){if((s=t.length)>0)for(var n,r,i,o,a,s,u=0,l=t[e[0]].length;u<l;++u)for(o=a=0,n=0;n<s;++n)(i=(r=t[e[n]][u])[1]-r[0])>=0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):r[0]=o},none:Gr,silhouette:function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],o=i.length;r<o;++r){for(var a=0,s=0;a<n;++a)s+=t[a][r][1]||0;i[r][1]+=i[r][0]=-s/2}Gr(t,e)}},expand:function(t,e){if((r=t.length)>0){for(var n,r,i,o=0,a=t[0].length;o<a;++o){for(i=n=0;n<r;++n)i+=t[n][o][1]||0;if(i)for(n=0;n<r;++n)t[n][o][1]/=i}Gr(t,e)}},wiggle:function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,o=0,a=1;a<r;++a){for(var s=0,u=0,l=0;s<i;++s){for(var c=t[e[s]],h=c[a][1]||0,f=(h-(c[a-1][1]||0))/2,d=0;d<s;++d){var p=t[e[d]];f+=(p[a][1]||0)-(p[a-1][1]||0)}u+=h,l+=f*h}n[a-1][1]+=n[a-1][0]=o,u&&(o-=l/u)}n[a-1][1]+=n[a-1][0]=o,Gr(t,e)}}},la={ascending:function(t){var e=t.map(Qr);return Kr(t).sort((function(t,n){return e[t]-e[n]}))},insideout:function(t){var e,n,r=t.length,i=t.map(Qr),o=function(t){var e=t.map(Zr);return Kr(t).sort((function(t,n){return e[t]-e[n]}))}(t),a=0,s=0,u=[],l=[];for(e=0;e<r;++e)n=o[e],a<s?(a+=i[n],u.push(n)):(s+=i[n],l.push(n));return l.reverse().concat(u)},none:Kr,reverse:function(t){return Kr(t).reverse()}};function ca(t,e,n){for(var r={},i=e.stackKey,o=e.value,a=e.startProp||"start",s=e.endProp||"end",u=e.offset||"none",l=e.order||"none",c=e.valueRef||"",h=0,f={},d=0;d<t.items.length;d++){var p=t.items[d],m=c?p[c]:null;if(m&&m.source){var g="".concat(m.source.key||"","/").concat(m.source.field);f[g]||(f[g]=m.source)}var y=i(p);r[y]=r[y]||{items:[]},r[y].items.push(p),h=Math.max(h,r[y].items.length)}for(var v=Array.apply(null,{length:h}).map(Number.call,Number),x=Object.keys(r).map((function(t){return r[t].items})),b=function(){var t=rr([]),e=Kr,n=Gr,r=Jr;function i(i){var o,a,s=t.apply(this,arguments),u=i.length,l=s.length,c=new Array(l);for(o=0;o<l;++o){for(var h,f=s[o],d=c[o]=new Array(u),p=0;p<u;++p)d[p]=h=[0,+r(i[p],f,p,i)],h.data=i[p];d.key=f}for(o=0,a=e(c);o<l;++o)c[a[o]].index=o;return n(c,a),c}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:rr(Nr.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:rr(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?Kr:"function"==typeof t?t:rr(Nr.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?Gr:t,i):n},i}().keys(v).value((function(t,e){return t[e]?o(t[e]):0})).order(la[l]).offset(ua[u]),w=b(x),M=[],k=0;k<w.length;k++)for(var _=w[k],q=0;q<_.length;q++){var D=_[q],S=_[q].data[_.key];S&&(S[a]={value:D[0]},S[s]={value:D[1]},M.push(D[0],D[1]))}var C=Object.keys(f).map((function(t){var e=n(f[t].key);return e?e.field(f[t].field):null})).filter((function(t){return!!t})),E=sa({title:C.map((function(t){return t.title()})).join(", "),min:Math.min.apply(Math,M),max:Math.max.apply(Math,M),type:"measure",formatter:C[0]?C[0].formatter:void 0});t.fields.push(E)}function ha(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={},i=n.logger;if(Array.isArray(t))r.items=t.map((function(t){return{value:t,label:String(t)}}));else if(t){if("collection"in t)r=bn({},e.collection(t.collection));else{var o=e.dataset?e.dataset(t.source):null,a=t.value||function(t){return t},s=t.label||function(t){return t};if(t.groupBy||t.mapTo)i.warn('Deprecated "data" configuration',t),r.items=[];else if(t.hierarchy)r.root=o.hierarchy?o.hierarchy(t.hierarchy):null,r.fields=o.fields();else if(t.items)r.items=t.items.map((function(t){return{value:a(t),label:String(s(t))}}));else if(t.extract){var u=Array.isArray(t.extract)?t.extract:[t.extract];r.items=[];var l,c=[];if(u.forEach((function(t){var n,i=t.source?e.dataset(t.source):o;i&&((n=r.items).push.apply(n,Fn(i.extract(t))),void 0!==t.field&&c.push(i.field(t.field)))})),c.length&&(r.fields=c),t.amend&&Array.isArray(t.amend))(l=r.items).push.apply(l,Fn(t.amend))}else if(void 0!==t.field&&o){var h=o.field(t.field);h&&(r.fields||(r.fields=[]),r.fields.push(h),"value"in t||(a=h.value||function(t){return t},s=h.label||function(t){return t},r.value=a),r.items=h.items().map((function(e){return{value:a(e),label:String(s(e)),source:{field:t.field}}})))}else t.fields&&t.fields.forEach((function(t){var n,i="object"===wn(t)&&t.source?e.dataset(t.source):o;i&&((n="object"===wn(t)&&void 0!==t.field?i.field(t.field):i.field(t))&&(r.fields||(r.fields=[]),r.fields.push(n)))}));r.items&&t.map&&(r.items=r.items.map(t.map))}t&&t.stack&&ca(r,t.stack,e.dataset)}return t&&!Array.isArray(t)&&"function"==typeof t.filter&&r.items&&(r.items=r.items.filter(t.filter)),t&&!Array.isArray(t)&&"function"==typeof t.sort&&r.items&&(r.items=r.items.sort(t.sort)),r}function fa(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ha,i={};(t||[]).forEach((function(t){if(!t.key)throw new Error('Data collection is missing "key" property');if("object"===wn(t.data)&&"collection"in t.data)throw new Error("Data config for collections may not reference other collections");i[t.key]=function(){return r(t.data,e,n)}}));var o=function(t){var e,n;if("string"==typeof t?e=t:"object"===wn(t)&&(e=t.key,n=t),!(e in i))throw new Error("Unknown data collection: ".concat(e));"function"==typeof i[e]&&(i[e]=i[e]());var r=i[e];if(n&&n.fields&&n.fields.filter){var o=r.fields.filter(n.fields.filter);r.fields.length!==o.length&&(r=yn(r,{fields:o}))}return r};return o}function da(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ha;if(t.data){var o=i(t.data,e,n);if(o&&o.fields&&o.fields[0])return o.fields[0].formatter()}if(r=t.formatter?"".concat(t.formatter,"-").concat(t.type||"number"):t.type||"d3-number",n.formatter.has(r)){var a=n.formatter.get(r)(t.format||"");return a}throw new Error("Formatter of type '".concat(r,"' was not found"))}function pa(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:da,i={};return{get:function(o){var a;return"string"==typeof o&&t[o]?a=o:"object"===wn(o)&&"formatter"in o&&t[o.formatter]?a=o.formatter:"object"===wn(o)&&"type"in o&&t[o.type]&&(a=o.type),a?(i[a]=i[a]||r(t[a],e,n),i[a]):r(o||{},e,n)},all:function(){return Object.keys(t).forEach(this.get),i}}}function ma(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var ga,ya=(1===(ga=ma).length&&(ga=function(t){return function(e,n){return ma(t(e),n)}}(ga)),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;ga(t[i],e)<0?n=i+1:r=i}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;ga(t[i],e)>0?r=i:n=i+1}return n}}),va=ya.right;function xa(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}var ba=Math.sqrt(50),wa=Math.sqrt(10),Ma=Math.sqrt(2);function ka(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=ba?10:o>=wa?5:o>=Ma?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=ba?10:o>=wa?5:o>=Ma?2:1)}function _a(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var qa="$";function Da(){}function Sa(t,e){var n=new Da;if(t instanceof Da)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}function Ca(){}Da.prototype=Sa.prototype={constructor:Da,has:function(t){return qa+t in this},get:function(t){return this[qa+t]},set:function(t,e){return this[qa+t]=e,this},remove:function(t){var e=qa+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===qa&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===qa&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===qa&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===qa&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===qa&&++t;return t},empty:function(){for(var t in this)if(t[0]===qa)return!1;return!0},each:function(t){for(var e in this)e[0]===qa&&t(this[e],e.slice(1),this)}};var Ea=Sa.prototype;Ca.prototype={constructor:Ca,has:Ea.has,add:function(t){return this[qa+(t+="")]=t,this},remove:Ea.remove,clear:Ea.clear,values:Ea.keys,size:Ea.size,empty:Ea.empty,each:Ea.each};var Aa=Array.prototype,Na=Aa.map,Oa=Aa.slice,Ia={name:"implicit"};function Ta(){var t=Sa(),e=[],n=[],r=Ia;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==Ia)return r;t.set(o,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Sa();for(var r,o,a=-1,s=n.length;++a<s;)t.has(o=(r=n[a])+"")||t.set(o,e.push(r));return i},i.range=function(t){return arguments.length?(n=Oa.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Ta(e,n).unknown(r)},_a.apply(i,arguments),i}function Ra(){var t,e,n=Ta().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){var n=r().length,c=o[1]<o[0],h=o[c-0],f=o[1-c];t=(f-h)/Math.max(1,n-s+2*u),a&&(t=Math.floor(t)),h+=(f-h-t*(n-s))*l,e=t*(1-s),a&&(h=Math.round(h),e=Math.round(e));var d=xa(n).map((function(e){return h+t*e}));return i(c?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,c()):a},n.padding=function(t){return arguments.length?(s=Math.min(1,u=+t),c()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),c()):s},n.paddingOuter=function(t){return arguments.length?(u=+t,c()):u},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},n.copy=function(){return Ra(r(),o).round(a).paddingInner(s).paddingOuter(u).align(l)},_a.apply(c(),arguments)}function Pa(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Fa(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function La(){}var ja=.7,za=1/ja,Va="\\s*([+-]?\\d+)\\s*",Ha="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ba="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wa=/^#([0-9a-f]{3,8})$/,Ua=new RegExp("^rgb\\("+[Va,Va,Va]+"\\)$"),Ya=new RegExp("^rgb\\("+[Ba,Ba,Ba]+"\\)$"),$a=new RegExp("^rgba\\("+[Va,Va,Va,Ha]+"\\)$"),Xa=new RegExp("^rgba\\("+[Ba,Ba,Ba,Ha]+"\\)$"),Ga=new RegExp("^hsl\\("+[Ha,Ba,Ba]+"\\)$"),Ka=new RegExp("^hsla\\("+[Ha,Ba,Ba,Ha]+"\\)$"),Ja={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Za(){return this.rgb().formatHex()}function Qa(){return this.rgb().formatRgb()}function ts(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Wa.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?es(e):3===n?new os(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ns(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ns(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ua.exec(t))?new os(e[1],e[2],e[3],1):(e=Ya.exec(t))?new os(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=$a.exec(t))?ns(e[1],e[2],e[3],e[4]):(e=Xa.exec(t))?ns(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ga.exec(t))?ls(e[1],e[2]/100,e[3]/100,1):(e=Ka.exec(t))?ls(e[1],e[2]/100,e[3]/100,e[4]):Ja.hasOwnProperty(t)?es(Ja[t]):"transparent"===t?new os(NaN,NaN,NaN,0):null}function es(t){return new os(t>>16&255,t>>8&255,255&t,1)}function ns(t,e,n,r){return r<=0&&(t=e=n=NaN),new os(t,e,n,r)}function rs(t){return t instanceof La||(t=ts(t)),t?new os((t=t.rgb()).r,t.g,t.b,t.opacity):new os}function is(t,e,n,r){return 1===arguments.length?rs(t):new os(t,e,n,null==r?1:r)}function os(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function as(){return"#"+us(this.r)+us(this.g)+us(this.b)}function ss(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function us(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ls(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new hs(t,e,n,r)}function cs(t){if(t instanceof hs)return new hs(t.h,t.s,t.l,t.opacity);if(t instanceof La||(t=ts(t)),!t)return new hs;if(t instanceof hs)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new hs(a,s,u,t.opacity)}function hs(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function fs(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ds(t){return function(){return t}}function ps(t){return 1==(t=+t)?ms:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):ds(isNaN(e)?n:e)}}function ms(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):ds(isNaN(t)?e:t)}Pa(La,ts,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Za,formatHex:Za,formatHsl:function(){return cs(this).formatHsl()},formatRgb:Qa,toString:Qa}),Pa(os,is,Fa(La,{brighter:function(t){return t=null==t?za:Math.pow(za,t),new os(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?ja:Math.pow(ja,t),new os(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:as,formatHex:as,formatRgb:ss,toString:ss})),Pa(hs,(function(t,e,n,r){return 1===arguments.length?cs(t):new hs(t,e,n,null==r?1:r)}),Fa(La,{brighter:function(t){return t=null==t?za:Math.pow(za,t),new hs(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?ja:Math.pow(ja,t),new hs(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new os(fs(t>=240?t-240:t+120,i,r),fs(t,i,r),fs(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var gs=function t(e){var n=ps(e);function r(t,e){var r=n((t=is(t)).r,(e=is(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=ms(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function ys(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function vs(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=qs(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function xs(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function bs(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ws(t,e){var n,r={},o={};for(n in null!==t&&"object"===i(t)||(t={}),null!==e&&"object"===i(e)||(e={}),e)n in t?r[n]=qs(t[n],e[n]):o[n]=e[n];return function(t){for(n in r)o[n]=r[n](t);return o}}var Ms=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ks=new RegExp(Ms.source,"g");function _s(t,e){var n,r,i,o=Ms.lastIndex=ks.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=Ms.exec(t))&&(r=ks.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:bs(n,r)})),o=ks.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}function qs(t,e){var n,r=i(e);return null==e||"boolean"===r?ds(e):("number"===r?bs:"string"===r?(n=ts(e))?(e=n,gs):_s:e instanceof ts?gs:e instanceof Date?xs:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?ys:Array.isArray(e)?vs:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ws:bs)(t,e)}function Ds(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Ss(t){return+t}var Cs=[0,1];function Es(t){return t}function As(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Ns(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function Os(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=As(i,r),o=n(a,o)):(r=As(r,i),o=n(o,a)),function(t){return o(r(t))}}function Is(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=As(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=va(t,e,1,r)-1;return o[n](i[n](e))}}function Ts(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Rs(t,e){return function(){var t,e,n,r,i,o,a=Cs,s=Cs,u=qs,l=Es;function c(){return r=Math.min(a.length,s.length)>2?Is:Os,i=o=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,u)))(t(l(e)))}return h.invert=function(n){return l(e((o||(o=r(s,a.map(t),bs)))(n)))},h.domain=function(t){return arguments.length?(a=Na.call(t,Ss),l===Es||(l=Ns(a)),c()):a.slice()},h.range=function(t){return arguments.length?(s=Oa.call(t),c()):s.slice()},h.rangeRound=function(t){return s=Oa.call(t),u=Ds,c()},h.clamp=function(t){return arguments.length?(l=t?Ns(a):Es,h):l!==Es},h.interpolate=function(t){return arguments.length?(u=t,c()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}()(t,e)}function Ps(t,e,n,r){var i,o=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=ba?i*=10:o>=wa?i*=5:o>=Ma&&(i*=2),e<t?-i:i}(t,e,n);switch((r=oi(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ni(e)/3)))-ni(Math.abs(t)))}(o,a))||(r.precision=i),fi(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ni(e)-ni(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-ni(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return hi(r)}function Fs(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=ka(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Ps(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=ka(s,u,n))>0?r=ka(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=ka(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function Ls(){var t=Rs(Es,Es);return t.copy=function(){return Ts(t,Ls())},_a.apply(t,arguments),Fs(t)}function js(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[va(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=Oa.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=Oa.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return js().domain(e).range(n).unknown(t)},_a.apply(i,arguments)}function zs(t){return void 0===t?function(t){return t}:function(e){return t(e)}}function Vs(t){return Math.max(0,Math.min(1,t))}function Hs(t){return"object"===wn(t)}function Bs(t,e,n){for(var r=Math.abs(e-n)/(t+1),i=[],o=1;o<=t;o++){var a=o*r;i.push(e<n?e+a:e-a)}return i}function Ws(t,e,n){if(1===t.length)return t;for(var r=t.concat([]),i=0;i<t.length;i++){var o=t[i],a=t[i+1];0===i&&o!==n.start()?(r.push.apply(r,Fn(Bs(e,o,a))),o-=a-o,a=t[i],r.push.apply(r,Fn(Bs(e,o,a)))):i===t.length-1&&a!==n.end()?(a=o+(o-t[i-1]),r.push.apply(r,Fn(Bs(e,o,a)))):r.push.apply(r,Fn(Bs(e,o,a)))}return r.filter((function(t){return t>=n.min()&&t<=n.max()}))}function Us(t){var e=t.distance,n=t.scale,r=t.minorCount,i=void 0===r?0:r,o=t.unitDivider,a=void 0===o?100:o,s=t.formatter,u=void 0===s?void 0:s,l=Hn(a)||Hn(e)?2:Math.max(e/a,2),c=Math.min(1e3,Math.round(l)),h=n.ticks(c);h.length<=1&&(h=n.ticks(c+1));var f=i>0?Ws(h,i,n):h;f.sort((function(t,e){return t-e}));var d=f.map(zs(u));return f.map((function(t,e){var r=n(t);return{position:r,start:r,end:r,label:d[e],value:t,isMinor:-1===h.indexOf(t)}}))}function Ys(t){var e=t.distance,n=t.scale,r=t.minorCount,i=void 0===r?0:r,o=t.unitDivider,a=void 0===o?100:o,s=t.formatter,u=void 0===s?void 0:s,l=Hn(a)||Hn(e)?2:Math.max(e/a,2),c=Math.min(1e3,Math.round(l)),h=c>10?10:c;n.nice(h);var f=n.ticks(c),d=i>0?Ws(f,i,n):f;d.sort((function(t,e){return t-e}));var p=d.map(zs(u));return d.map((function(t,e){var r=n(t);return{position:r,start:r,end:r,label:p[e],value:t,isMinor:-1===f.indexOf(t)}}))}function $s(t){var e,n=t.settings,r=t.scale,i=t.distance,o=t.formatter,a=void 0===o?function(t){return t}:o,s=n.minorTicks&&!Hn(n.minorTicks.count)?Math.min(100,n.minorTicks.count):0;if(Array.isArray(n.ticks.values)){var u=n.ticks.values.filter((function(t){return"object"===wn(t)?!Hn(t.value):!Hn(t)}));e=function(t){var e=t.values,n=t.scale,r=t.formatter,i=void 0===r?function(t){return t}:r;return e.sort((function(t,e){return(Hs(t)?t.value:t)-(Hs(e)?e.value:e)})).filter((function(t,e,r){var i=Hs(t)?t.value:t;return i<=n.max()&&i>=n.min()&&r.indexOf(t)===e})).map((function(t){var e=Hs(t),r=e?t.value:t,o=n(r);return{position:o,value:r,label:e&&void 0!==t.label?t.label:i(r),isMinor:!!e&&!!t.isMinor,start:e&&!isNaN(t.start)?Vs(n(t.start)):o,end:e&&!isNaN(t.end)?Vs(n(t.end)):o}}))}({values:u,scale:r.copy(),formatter:a})}else if(Hn(n.ticks.count)){e=(n.ticks.tight?Ys:Us)({distance:i,minorCount:s,unitDivider:n.ticks.distance,scale:r,formatter:a}),n.ticks.forceBounds&&function(t,e,n){var r=t.map((function(t){return t.position})),i=e.range();-1===r.indexOf(i[0])?t.splice(0,0,{position:i[0],start:i[0],end:i[0],label:n(e.start()),isMinor:!1,value:e.start()}):t[0]&&t[0].isMinor&&(t[0].isMinor=!1);var o=t[t.length-1];-1===r.indexOf(i[1])?t.push({position:i[1],start:i[1],end:i[1],label:n(e.end()),isMinor:!1,value:e.end()}):o&&o.isMinor&&(o.isMinor=!1)}(e,r,a)}else{e=function(t){var e=t.count,n=t.minorCount,r=t.scale,i=t.formatter;return r.ticks((e-1)*n+e).map((function(t,e){var o=r(t);return{position:o,start:o,end:o,label:i(t),isMinor:e%(n+1)!=0,value:t}}))}({count:Math.min(1e3,n.ticks.count),minorCount:s,scale:r.copy(),formatter:a})}return e}function Xs(t){var e=t.scale,n=e.domain(),r=e.data().items,i=e.labels?e.labels():n,o=e.bandwidth();return n.map((function(t,n){var a=e(t);return{position:a+o/2,label:"".concat(i[n]),data:r?r[n]:void 0,start:a,end:a+o}}))}function Gs(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return Object.keys(e).forEach((function(i){var o=wn(t[i]);r[i]="function"===o?t[i](n):"undefined"===o?e[i]:t[i]})),r}var Ks={min:NaN,max:NaN,expand:NaN,include:[],invert:!1},Js={tight:!1,forceBounds:!1,values:void 0,count:NaN,distance:100},Zs={count:NaN};function Qs(t,e){var n=+t.min,r=+t.max,i=0,o=1;if(e&&e[0]){var a=e.map((function(t){return t.min()})).filter((function(t){return!isNaN(t)})),s=e.map((function(t){return t.max()})).filter((function(t){return!isNaN(t)}));if(i=a.length?Math.min.apply(Math,Fn(a)):Number.NaN,o=s.length?Math.max.apply(Math,Fn(s)):Number.NaN,isNaN(i)||isNaN(o))i=-1,o=1;else if(i===o&&0===i)i=-1,o=1;else if(i===o&&i)i-=Math.abs(.1*i),o+=Math.abs(.1*o);else if(!isNaN(t.expand)){var u=o-i;i-=u*t.expand,o+=u*t.expand}if(Array.isArray(t.include)){var l=t.include.filter((function(t){return!isNaN(t)}));i=Math.min.apply(Math,Fn(l).concat([i])),o=Math.max.apply(Math,Fn(l).concat([o]))}}return{mini:isNaN(n)?i:n,maxi:isNaN(r)?o:r}}function tu(t,e){t.instance||(t.instance=e.copy(),t.instance.domain([e.start(),e.end()]),t.instance.clamp(!0),t.instance.range(t.invert?[1,0]:[0,1]))}function eu(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Ls(),o={instance:null,invert:!1},a={data:n,resources:r},s=Gs(e,Ks,a);function u(t){return Hn(t)?NaN:i(t)}s.ticks=Gs(e.ticks,Js,a),s.minorTicks=Gs(e.minorTicks,Zs,a),u.data=function(){return n},u.invert=function(t){return i.invert(t)},u.rangeRound=function(t){return i.rangeRound(t),u},u.clamp=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return i.clamp(t),u},u.cachedTicks=function(){return t},u.clearTicksCache=function(){return t=void 0,this},u.ticks=function(e){return null!==e&&"object"===wn(e)?(e.settings=e.settings||{},e.settings=yn(!0,{},s,e.settings),e.scale=u,t=$s(e)):t=i.ticks(e)},u.nice=function(t){return i.nice(t),u},u.tickFormat=function(t,e){return i.tickFormat(t,e)},u.interpolate=function(t){return i.interpolate(t),u},u.domain=function(t){return arguments.length?(i.domain(t),o.instance&&o.instance.domain([u.start(),u.end()]),u):i.domain()},u.range=function(t){return arguments.length?(i.range(t),u):i.range()},u.start=function(){return u.domain()[0]},u.end=function(){return u.domain()[this.domain().length-1]},u.min=function(){return Math.min(this.start(),this.end())},u.max=function(){return Math.max(this.start(),this.end())},u.classify=function(t){for(var e=(u.start()-u.end())/t,n=[u.end()],r=[],i=e/2,o=0;o<t;o++){var a=n[n.length-1]||0,s=a+e,l=u(a+i);n.push.apply(n,[s,s]),r.push.apply(r,[l,l])}return n.pop(),u.domain(n),u.range(r),u},u.copy=function(){var t=eu(e,n,r);return t.domain(u.domain()),t.range(u.range()),t.clamp(i.clamp()),t},u.norm=function(t){return tu(o,u),o.instance(t)},u.normInvert=function(t){return tu(o,u),o.instance.invert(t)};var l=Qs(s,n?n.fields:[]),c=l.mini,h=l.maxi;return u.domain([c,h]),u.range(s.invert?[1,0]:[0,1]),o.invert=s.invert,u}var nu={padding:0,paddingInner:NaN,paddingOuter:NaN,align:.5,invert:!1,maxPxStep:NaN,range:[0,1]};function ru(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={data:e,resources:n},i=Gs(t,nu,r),o=e.items||[],a={},s=[],u=[];function l(t,n){t.data=function(){return e},t.datum=function(t){return o[a[t]]},t.start=function(){return t.domain()[0]},t.end=function(){return t.domain()[t.domain().length-1]},t.labels=function(){return u},t.ticks=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.scale=t,Xs(e,n.trackBy)}}var c=Ra();l(c,t),c.pxScale=function(e){var n=i.maxPxStep;if(isNaN(n))return c;var r=c.domain().length,o=Math.max(1,r-c.paddingInner()+2*c.paddingOuter());if(o*n>=e)return c;var a=c.copy();a.type=c.type,l(a,t);var s=o*n/e,u=(1-s)*c.align();return a.range(i.invert?[s+u,u]:[u,s+u]),a};for(var h="function"==typeof t.value?t.value:function(t){return t.datum.value},f="function"==typeof t.label?t.label:function(t){return t.datum.label},d=0;d<o.length;d++){var p=yn({datum:o[d]},r),m=h(p,d);-1===s.indexOf(m)&&(s.push(m),u.push(f(p,d)),a[m]=d)}return c.domain(s),c.range(i.invert?i.range.slice().reverse():i.range),c.padding(isNaN(i.padding)?0:i.padding),isNaN(i.paddingInner)||c.paddingInner(i.paddingInner),isNaN(i.paddingOuter)||c.paddingOuter(i.paddingOuter),c.align(isNaN(i.align)?.5:i.align),c}var iu={depth:0};function ou(t,e,n){return t.ancestors().map((function(t){return e(yn({datum:t.data},n))})).reverse().slice(1).toString()}function au(t,e,n){var r=e.ticks.depth,i=e.value,o=e.label,a=[],s=[],u={},l=[],c=0;if(!t)return{values:a,labels:s,items:u,ticks:l};t.eachAfter((function(t){if(t.depth>0){var e=ou(t,i,n),h=t.leaves()||[t],f=i(yn({datum:t.data},n)),d=o(yn({datum:t.data},n)),p=Array.isArray(t.children),m={key:e,count:h.length,value:f,label:d,leftEdge:ou(h[0],i,n),rightEdge:ou(h[Math.max(h.length-1,0)],i,n),node:t};p?(a.push("SPACER_".concat(c,"_SPACER")),c++):(a.push(e),s.push(d)),(r<=0&&!p||t.depth===r)&&l.push(m),u[e]=m}}));var h=t.height-1;return h>0&&a.splice(-h),{values:a,labels:s,items:u,ticks:l}}var su=function(t){return t.min()},uu=function(t){return t.max()};function lu(t,e){var n=t&&!isNaN(t.min),r=t&&!isNaN(t.max),i=n?+t.min:0,o=r?+t.max:1;if(e&&e.length){if(!n){var a=e.map(su).filter(Vn);i=a.length?Math.min.apply(Math,Fn(a)):i}if(!r){var s=e.map(uu).filter(Vn);o=s.length?Math.max.apply(Math,Fn(s)):o}}return[i,o]}var cu={domain:[],range:[],invert:!1,min:NaN,max:NaN};function hu(t,e,n){var r=t.length;if(2===r)return[e,n];var i=[],o=(n-e)/(r-1);i.push(e);for(var a=1;a<r-1;a++)i.push(e+o*a);return i.push(n),i}function fu(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=eu(t,e,n).clamp(!0).interpolate(gs),i=Gs(t,cu,{data:e,resources:n}),o=Array.isArray(i.domain)&&i.domain.length,a=Array.isArray(i.range)&&i.range.length,s=r;yn(!0,s,r);var u=lu(i,e?e.fields:[]),l=Pn(u,2),c=l[0],h=l[1],f=o?i.domain.length:-1,d=n.theme?n.theme.palette("sequential",f>0?f:2):[],p=a?i.range:d;return s.range(i.invert?p.slice().reverse():p.slice()),s.domain(o?i.domain:hu(s.range(),c,h)),s}var du={domain:[],range:[],invert:!1,min:NaN,max:NaN,nice:!1};function pu(t,e,n){var r=t.length;if(2===r)return[e+(n-e)/2];for(var i=[],o=(n-e)/r,a=1;a<r;a++)i.push(e+o*a);return i}function mu(t,e,n,r){n=t[0],r=t&&t.length>=2?t[t.length-1]:r;var i=fu().domain([n,r]).range(e),o=[n].concat(Fn(function(t){for(var e=[],n=0;n<t.length-1;n++)e.push((t[n]+t[n+1])/2);return e}(t)),[r]);return o.map((function(t){return i(t)}))}function gu(t,e,n){var r=2===t.length?10:Math.max(1,t.length),i=Ls().domain([e,n]).nice(r).ticks(r);if(!t||!t.length)return i;for(var o=Math.max(0,t.length-1);i.length>o;)i[0]-e<=n-i[i.length-1]?i.shift():i.pop();return i}var yu={domain:[],range:[]};function vu(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Ta(),i={data:e,resources:n},o=Gs(t,yu,i),a="function"==typeof t.value?t.value:function(t){return t.datum.value},s="function"==typeof t.label?t.label:function(t){return t.datum.label},u=e.items||[],l={},c=[],h=[],f=0;f<u.length;f++){var d=yn({datum:u[f]},i),p=a(d,f);-1===c.indexOf(p)&&(c.push(p),h.push(s(d,f)),l[p]=f)}return r.data=function(){return e},r.labels=function(){return h},r.label=function(t){return h[c.indexOf(t)]},r.datum=function(t){return u[l[t]]},r.range(o.range),Array.isArray(o.domain)&&o.domain.length?r.domain(o.domain):r.domain(c),r}var xu={domain:[],range:[],unknown:void 0},bu={domain:[],range:[],override:!1};var wu=ti();function Mu(t,e,n){var r=t.data;t.source&&(n.logger.warn("Deprecated: Scale data source configuration"),r={extract:[]},(Array.isArray(t.source)?t.source:[t.source]).forEach((function(t){r.extract.push({field:t})})));var i,o=ha(r,e,n),a=t.type||function(t){return t.root?"h-band":t.fields&&t.fields[0]?(e=t.fields,n=e.map((function(t){return"dimension"===t.type()?"band":"linear"})),-1!==n.indexOf("linear")?"linear":"band"):"linear";var e,n}(o);return"color"===a&&(a=o.fields&&o.fields[0]&&"dimension"===o.fields[0].type()?"categorical-color":"sequential-color"),n.scale.has(a)&&((i=(i=n.scale.get(a))(t,o,{theme:n.theme,logger:n.logger})).type=a),i}function ku(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mu,i={};return{get:function(o){var a;return"string"==typeof o&&t[o]?a=o:"object"===wn(o)&&"scale"in o&&t[o.scale]&&(a=o.scale),a?(i[a]=i[a]||r(t[a],e,n),i[a]):r(o,e,n)},all:function(){return Object.keys(t).forEach(this.get),i}}}wu("linear",eu),wu("band",ru),wu("h-band",(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={data:n,resources:r},o=Gs(e,nu,i);o.ticks=Gs(e.ticks,iu,i),o.value="function"==typeof e.value?e.value:function(t){return t.datum.value},o.label="function"==typeof e.label?e.label:function(t){return t.datum.value};var a=ru(o),s=au(n.root,o,i),u=s.values,l=s.labels,c=s.items,h=s.ticks,f=function(t){var e=String(t),n=c[e];return a(n?o.invert?n.rightEdge:n.leftEdge:e)};yn(!0,f,a),f.bandwidth=function(t){var e=c[String(t)],n=a.bandwidth();if(e&&!e.isLeaf){var r=f(e.leftEdge),i=f(e.rightEdge);return Math.abs(r-i)+n}return n},f.step=function(t){var e=c[String(t)],n=e?e.count:1,r=a.step();return r*=n},f.data=function(){return n},f.datum=function(t){var e=c[String(t)];return e?e.node.data:null},f.copy=function(){return t(e,n,r)},f.labels=function(){return l},f.ticks=function(){return h.map((function(t){var e=f(t.key),n=f.bandwidth(t.key);return{position:e+n/2,label:t.label,data:t.node.data,start:e,end:e+n}}))};var d=a.pxScale;return f.pxScale=function(t){return a=d(t),f},f.domain(u),f})),wu("sequential-color",fu),wu("threshold-color",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=js(),i=Gs(t,du,{data:e,resources:n}),o=Array.isArray(i.domain)&&i.domain.length,a=Array.isArray(i.range)&&i.range.length;function s(t){return Hn(t)?NaN:r(t)}Object.keys(r).forEach((function(t){return s[t]=r[t]}));var u=e.fields,l=lu(i,u),c=Pn(l,2),h=c[0],f=c[1],d=o?i.domain.length:-1,p=n.theme?n.theme.palette("sequential",d>0?d:2):[],m=a?i.range:p,g=[];return g=o?i.domain:i.nice?gu(m,h,f):[h+(f-h)/2],m.length>g.length+1?g=pu(m,h,f):m.length<g.length+1&&(m=mu(g,m,h,f)),s.data=function(){return e},s.range(i.invert?m.slice().reverse():m),s.domain(g),s})),wu("categorical-color",(function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=vu(e,n,r),o=r.theme,a=Gs(e,xu,{data:n,resources:r});if(a.explicit=Gs(e.explicit,bu,{data:n,resources:r}),t=Array.isArray(a.range)&&0!==a.range.length?a.range.slice():o?o.palette("categorical",i.domain().length).slice():[],a.unknown)i.unknown(a.unknown);else if(o&&o.palette("unknown")){var s=o.palette("unknown");i.unknown(s[0])}if(Array.isArray(a.explicit.domain)&&a.explicit.domain.length){for(var u=i.domain().slice(),l=a.explicit.domain,c=Array.isArray(a.explicit.range)?a.explicit.range:[],h=Math.floor(u.length/t.length),f=1;f<h+1;f*=2)t=t.concat(t);if(a.explicit.override)for(var d=0;d<l.length;d++){var p=u.indexOf(l[d]);p>-1&&(t[p]=c[d])}else{var m=l.map((function(t,e){return[u.indexOf(t),t,c[e]]})).sort((function(t,e){return t[0]-e[0]}));m.forEach((function(e){var n=u.indexOf(e[1]);-1!==n&&t.splice(n,0,e[2])}))}t.length=u.length}return i.range(t),i}));var _u={};function qu(){qu.init.call(this)}_u.isObject=function(t){return"object"===i(t)&&null!==t},_u.isNumber=function(t){return"number"==typeof t},_u.isUndefined=function(t){return void 0===t},_u.isFunction=function(t){return"function"==typeof t};var Du=qu;qu.EventEmitter=qu,qu.prototype._events=void 0,qu.prototype._maxListeners=void 0,qu.defaultMaxListeners=10,qu.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},qu.prototype.setMaxListeners=function(t){if(!_u.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},qu.prototype.emit=function(t){var e,n,r,i,o,a;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(e=arguments[1])instanceof Error?e:Error('Uncaught, unspecified "error" event.');if(n=this._events[t],_u.isUndefined(n))return!1;if(_u.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];n.apply(this,i)}else if(_u.isObject(n)){for(r=arguments.length,i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];for(r=(a=n.slice()).length,o=0;o<r;o++)a[o].apply(this,i)}return!0},qu.prototype.addListener=function(t,e){var n;if(!_u.isFunction(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,_u.isFunction(e.listener)?e.listener:e),this._events[t]?_u.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,_u.isObject(this._events[t])&&!this._events[t].warned)&&((n=_u.isUndefined(this._maxListeners)?qu.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,_u.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),_u.isFunction(console.trace)&&console.trace()));return this},qu.prototype.on=qu.prototype.addListener,qu.prototype.once=function(t,e){if(!_u.isFunction(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},qu.prototype.removeListener=function(t,e){var n,r,i,o;if(!_u.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,r=-1,n===e||_u.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(_u.isObject(n)){for(o=i;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},qu.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],_u.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},qu.prototype.listeners=function(t){return this._events&&this._events[t]?_u.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},qu.listenerCount=function(t,e){return t._events&&t._events[e]?_u.isFunction(t._events[e])?1:t._events[e].length:0};var Su=function(t){return Object.keys(Du.prototype).forEach((function(e){t[e]=Du.prototype[e]})),Du.init(t),t};function Cu(){var t=0,e=0,n=0,r=0;n=n||t;var i={move:function(t){this.moveTo(n+t)},moveTo:function(o){var a=Math.max(t,Math.min(e-r,o));n!==a&&(n=a,i.emit("update"))},update:function(o){var a=!1,s=o.min;t=void 0===s?t:s;var u=o.max;e=void 0===u?e:u,void 0!==o.viewSize&&o.viewSize!==r&&(r=o.viewSize,a=!0);var l=Math.max(t,Math.min(e-r,n));n!==l&&(n=l,a=!0),a&&i.emit("update")},getState:function(){return{min:t,max:e,start:n,viewSize:r}}};return Su(i),i}function Eu(t,e){var n=t.min||0,r=t.max||0,i=t.viewSize||0,o=e||Cu();return o.update({min:n,max:r,viewSize:i}),o}function Au(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=Eu(t[r],e?e[r]:null));return n}function Nu(t,e){return e[t]||(e[t]=Cu()),e[t]}function Ou(t,e){return t<=e}function Iu(t,e){return t<e}function Tu(t,e,n){for(var r=0;r<t.length&&e>t[r];)++r;return t[r]===e&&n&&++r,r}function Ru(t,e,n,r){for(var i=t.length,o=1;o<i;o+=2)if(n(t[o-1],e)&&r(e,t[o]))return!0;return!1}function Pu(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[];function i(){}return i.configure=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.includeMax,i=void 0===r||r,o=n.includeMin,a=void 0===o||o;t=i?Ou:Iu,e=a?Ou:Iu},i.add=function(t){var e,n=t.min,i=t.max,o=Tu(r,n),a=Tu(r,i,!0),s=[o,a-o];o%2==0&&s.push(n),a%2==0&&s.push(i);var u=r.join(",");return(e=r).splice.apply(e,s),u!==r.join(",")},i.remove=function(t){var e,n=t.min,i=t.max,o=Tu(r,n),a=Tu(r,i,!0),s=[o,a-o];o%2==1&&s.push(n),a%2==1&&s.push(i);var u=r.join(",");return(e=r).splice.apply(e,s),u!==r.join(",")},i.set=function(t){var e=r.join(",");return r=[],Array.isArray(t)?t.forEach(i.add):i.add(t),e!==r.join(",")},i.clear=function(){var t=r.length>0;return r=[],t},i.containsValue=function(n){return Ru(r,n,e,t)},i.containsRange=function(t){var e=t.min,n=t.max,i=Tu(r,e,!0),o=Tu(r,n);return i===o&&o%2==1},i.toggle=function(t){return i.containsRange(t)?i.remove(t):i.add(t)},i.ranges=function(){for(var t=[],e=1;e<r.length;e+=2)t.push({min:r[e-1],max:r[e]});return t},i.configure(n),i}function Fu(){var t=[];function e(){}return e.add=function(e){return-1===t.indexOf(e)&&(t.push(e),!0)},e.remove=function(e){var n=t.indexOf(e);return-1!==n&&(t.splice(n,1),!0)},e.contains=function(e){return-1!==t.indexOf(e)},e.values=function(){return t.slice()},e.clear=function(){return t=[]},e.toString=function(){return t.join(";")},e}var Lu={key:void 0,includeMin:!0,includeMax:!0};function ju(t){for(var e,n,r=t.items,i=t.collection,o=t.vc,a={},s=[],u=0,l=r.length;u<l;u++){i[e=r[u].key]||(i[e]=o()),n=r[u].values||[r[u].value];for(var c=0;c<n.length;c++)i[e].add(n[c])&&(a[e]=a[e]||[],a[e].push(n[c]))}for(var h=Object.keys(a),f=0,d=h.length;f<d;f++)e=h[f],s.push({id:e,values:a[e]});return s}function zu(t){for(var e,n,r=t.items,i=t.collection,o={},a=[],s=0,u=r.length;s<u;s++)if(i[e=r[s].key]){n=r[s].values||[r[s].value];for(var l=0;l<n.length;l++)i[e].remove(n[l])&&(o[e]=o[e]||[],o[e].push(n[l]))}for(var c=Object.keys(o),h=0,f=c.length;h<f;h++)e=c[h],a.push({id:e,values:o[e]});return a}function Vu(t){for(var e,n,r={},i=0,o=t.length;i<o;i++){e=t[i].key,n=t[i].values||[t[i].value],r[e]||(r[e]=[]);for(var a=0;a<n.length;a++){-1===r[e].indexOf(n[a])&&r[e].push(n[a])}}return r}function Hu(t){var e=t.key,n=t.collection,r=t.obj,i=t.fn,o=t.value;n[e]||(n[e]=i()),r[e]=r[e]||[],r[e].push(o),n[e].add(o)}function Bu(t){for(var e,n,r,i=t.items,o=t.values,a=t.vc,s={},u={},l=[],c=[],h=Vu(i),f=Object.keys(h),d=0,p=f.length;d<p;d++)for(var m=0,g=(r=h[e=f[d]]).length;m<g;m++)n=r[m],o[e]&&o[e].contains(n)?o[e]&&o[e].contains(n)&&(u[e]=u[e]||[],u[e].push(n),o[e].remove(n)):Hu({key:e,value:n,collection:o,obj:s,fn:a});for(var y=Object.keys(s),v=0,x=y.length;v<x;v++)e=y[v],l.push({id:e,values:s[e]});for(var b=Object.keys(u),w=0,M=b.length;w<M;w++)e=b[w],c.push({id:e,values:u[e]});return[l,c]}function Wu(t,e){for(var n,r,i=[],o=Object.keys(t),a=function(t){return-1===e[n].indexOf(t)},s=0,u=o.length;s<u;s++)n=o[s],e[n]?(r=t[n].filter(a)).length&&i.push({id:n,values:r}):i.push({id:n,values:t[n]});return i}function Uu(t){for(var e,n,r=t.items,i=t.vCollection,o=t.vc,a={},s=Vu(r),u={},l=Object.keys(i),c=0,h=l.length;c<h;c++)u[n=l[c]]=i[n].values().slice(),delete i[n];for(var f=function(t){i[n]&&i[n].contains(t)||Hu({key:n,value:t,collection:i,obj:a,fn:o})},d=Object.keys(s),p=0,m=d.length;p<m;p++)s[n=d[p]].forEach(f);return e=Wu(u,a),[Wu(a,u),e]}function Yu(t,e,n){var r=function(t,e){if(!Object.keys(e).length)return t;for(var n=t.length,r=Array(n),i=0;i<n;i++)r[i]=t[i].key in e?yn({},t[i],{key:e[t[i].key]}):t[i];return r}(e,n);return t&&t.length?t.reduce((function(t,e){return e(t)}),r):r}function $u(t){return t.replace(/(-[a-z])/g,(function(t){return t.toUpperCase().replace("-","")}))}function Xu(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t.toLowerCase())}))}function Gu(t,e,n){var r=n.ranges,i=n.interceptors,o=n.rc,a=n.aliases,s=n.rangeConfig,u=Yu(i["".concat(e,"Ranges")],t,a),l=!1;return u.forEach((function(t){var n=t.key;if(r[n]||(r[n]=o(s.sources[n]||s.default)),"set"===e)l=r[n][e](t.ranges||t.range)||l;else for(var i=t.ranges||[t.range],a=0;a<i.length;a++)l=r[n][e](i[a])||l})),l}function Ku(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vc,n=void 0===e?Fu:e,r=t.rc,i=void 0===r?Pu:r,o=!1,a={},s={},u={},l={sources:{},default:yn({},Lu)},c={addValues:[],removeValues:[],toggleValues:[],setValues:[],addRanges:[],setRanges:[],removeRanges:[],toggleRanges:[]},h=function(){var t={values:{},ranges:{}};return Object.keys(s).forEach((function(e){t.values[e]=s[e].values()})),Object.keys(a).forEach((function(e){t.ranges[e]=a[e].ranges()})),t},f={ls:[],clear:function(){this.ls.forEach((function(t){return t.clear()}))},start:function(){this.ls.forEach((function(t){return t.start()}))},end:function(){this.ls.forEach((function(t){return t.end()}))},update:function(){var t=h();this.ls.forEach((function(e){return e._state(t)}))},updateValues:function(){var t=h();this.ls.forEach((function(e){return e._state({values:t.values})}))},updateRanges:function(){var t=h();this.ls.forEach((function(e){return e._state({ranges:t.ranges})}))}},d={configure:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Array.isArray(t.ranges)&&t.ranges.length&&(l={sources:{},default:yn({},Lu)},t.ranges.forEach((function(t){var e={};Object.keys(Lu).filter((function(t){return"key"!==t})).forEach((function(n){e[n]=void 0!==t[n]?t[n]:Lu[n]})),void 0!==t.key?l.sources[t.key]=e:l.default=e})),Object.keys(a).forEach((function(t){return a[t].configure(l.sources[t]||l.default)})),d.emit("update",[],[]))},link:function(t){if(d===t)throw new Error("Can't link to self");f.ls.push(t),t._state(h())},_state:function(t){if(!t)return h();if(t.values){var e=[];Object.keys(t.values).forEach((function(n){s[n]&&t.values[n].join(";")===s[n].toString()||e.push({key:n,values:t.values[n]})})),Object.keys(s).forEach((function(n){t.values[n]||e.push({key:n,values:[]})})),e.length&&d.setValues(e)}if(t.ranges){var n=[];Object.keys(t.ranges).forEach((function(e){a[e]&&t.ranges[e].join(";")===a[e].toString()||n.push({key:e,ranges:t.ranges[e]})})),Object.keys(a).forEach((function(e){t.ranges[e]||n.push({key:e,ranges:[]})})),n.length&&d.setRanges(n)}},start:function(){if(!o){o=!0;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];d.emit.apply(d,["start"].concat(e)),f.start()}},end:function(){if(o){o=!1,a={},s={};for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];d.emit.apply(d,["end"].concat(e)),f.end()}},isActive:function(){return o},clear:function(){var t=d.brushes().filter((function(t){return"value"===t.type&&t.brush.values().length})).map((function(t){return{id:t.id,values:t.brush.values()}})),e=Object.keys(a).length>0||t.length;a={},s={},e&&(d.emit("update",[],t),f.clear())},brushes:function(){var t=[];return t=(t=t.concat(Object.keys(a).map((function(t){return{type:"range",id:t,brush:a[t]}})))).concat(Object.keys(s).map((function(t){return{type:"value",id:t,brush:s[t]}})))},addValue:function(t,e){d.addValues([{key:t,value:e}])},addValues:function(t){var e=Yu(c.addValues,t,u),r=ju({vc:n,collection:s,items:e});d.emit("add-values",e),r.length&&(o||(o=!0,d.emit("start")),d.emit("update",r,[]),f.updateValues())},setValues:function(t){var e=Yu(c.setValues,t,u),r=Uu({items:e,vCollection:s,vc:n});d.emit("set-values",e),(r[0].length>0||r[1].length>0)&&(o||(o=!0,d.emit("start")),d.emit("update",r[0],r[1]),f.updateValues())},removeValue:function(t,e){d.removeValues([{key:t,value:e}])},removeValues:function(t){var e=Yu(c.removeValues,t,u),n=zu({collection:s,items:e});d.emit("remove-values",e),n.length&&(d.emit("update",[],n),f.updateValues())},addAndRemoveValues:function(t,e){var r=Yu(c.addValues,t,u),i=Yu(c.removeValues,e,u),a=ju({vc:n,collection:s,items:r}),l=zu({collection:s,items:i});d.emit("add-values",r),d.emit("remove-values",i),(a.length||l.length)&&(o||(o=!0,d.emit("start")),d.emit("update",a,l),f.updateValues())},toggleValue:function(t,e){d.toggleValues([{key:t,value:e}])},toggleValues:function(t){var e=Yu(c.toggleValues,t,u),r=Bu({items:e,values:s,vc:n});d.emit("toggle-values",e),(r[0].length>0||r[1].length>0)&&(o||(o=!0,d.emit("start")),d.emit("update",r[0],r[1]),f.updateValues())},containsValue:function(t,e){var n=u[t]||t;return!!s[n]&&s[n].contains(e)},addRange:function(t,e){d.addRanges([{key:t,range:e}])},addRanges:function(t){Gu(t,"add",{ranges:a,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(o||(o=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},removeRange:function(t,e){d.removeRanges([{key:t,range:e}])},removeRanges:function(t){Gu(t,"remove",{ranges:a,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(o||(o=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},setRange:function(t,e){d.setRanges([{key:t,range:e}])},setRanges:function(t){Gu(t,"set",{ranges:a,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(o||(o=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},toggleRange:function(t,e){d.toggleRanges([{key:t,range:e}])},toggleRanges:function(t){Gu(t,"toggle",{ranges:a,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(o||(o=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},containsRangeValue:function(t,e){var n=u[t]||t;return!!a[n]&&a[n].containsValue(e)},containsRange:function(t,e){var n=u[t]||t;return!!a[n]&&a[n].containsRange(e)},containsMappedData:function(t,e,n){for(var r,i,o,l,c=[],h=Object.keys(t),f=0,d=h.length;f<d;f++){if("value"===(r=h[f]))i=t,c[f]={key:"",i:f,bool:!1};else{if("source"===r)continue;i=t[r],c[f]={key:r,i:f,bool:!1}}void 0!==(o=i.source&&i.source.field)&&(void 0!==i.source.key&&(o="".concat(i.source.key,"/").concat(o)),o in u&&(o=u[o]),l=i.value,a[o]?c[f].bool=Array.isArray(l)?a[o].containsRange({min:l[0],max:l[1]}):a[o].containsValue(l):s[o]&&s[o].contains(l)&&(c[f].bool=!0))}return e?(c=c.filter((function(t){return-1!==e.indexOf(t.key)})),"and"===n?!!c.length&&!c.some((function(t){return!1===t.bool})):"xor"===n?!!c.length&&c.some((function(t){return t.bool}))&&c.some((function(t){return!1===t.bool})):c.some((function(t){return t.bool}))):c.some((function(t){return t.bool}))},intercept:function(t,e){var n=$u(t);c[n]&&c[n].push(e)},removeInterceptor:function(t,e){var n=$u(t);if(c[n]){var r=c[n].indexOf(e);-1!==r&&c[n].splice(r,1)}},removeAllInterceptors:function(t){var e=[];if(t){var n=$u(t);c[n]&&c[n].length&&e.push({name:t,handlers:c[n]})}else Object.keys(c).forEach((function(t){c[t].length&&e.push({name:Xu(t),handlers:c[t]})}));e.forEach((function(t){t.handlers.slice().forEach((function(e){return d.removeInterceptor(t.name,e)}))}))},addKeyAlias:function(t,e){u[t]=e},removeKeyAlias:function(t){delete u[t]}};return Su(d),d}function Ju(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function Zu(t,e){return t.data?t.data.value:"text"===t.type?t.text:e}function Qu(t,e,n){var r,i=t.old,o=t.current,a=e.renderer,s=[],u={nodes:[],ips:[]},l={nodes:[],ips:[]},c={nodes:[],ips:[]},h=[],f=null,d=n.trackBy||Zu,p={start:function(){var t={};i.forEach((function(e,n){var r=d(e,n);t[r]=e})),o.forEach((function(e,n){var r=d(e,n);t[r]?(c.ips.push(ws(t[r],e)),c.nodes.push(e),s.push(t[r]),t[r]=!1):(u.nodes.push(e),u.ips.push(ws({r:.001,opacity:0},e)))})),Object.keys(t).forEach((function(e){t[e]&&(l.nodes.push(t[e]),l.ips.push(ws(t[e],yn({},t[e],{r:1e-4,opacity:0}))))})),h.push({easing:Ju,duration:200,tweens:l.ips,nodes:[].concat(s)}),h.push({easing:Ju,duration:400,tweens:c.ips,nodes:[]}),h.push({easing:Ju,duration:200,tweens:u.ips,nodes:Fn(c.nodes)}),h.length&&(f=a.getScene(o),h[0].started=Date.now(),"undefined"!=typeof window&&(r=window.requestAnimationFrame(p.tick)))},tick:function(){var t=h[0];t||p.stop(),t.started||(t.started=Date.now());var e=(Date.now()-t.started)/t.duration,n=[],i=t.tweens.map((function(n){return n(t.easing(Math.min(1,e)))}));n.push.apply(n,Fn(i)),n.push.apply(n,Fn(t.nodes)),a.render(n),e>=1&&(h.shift(),h.length||p.stop()),r&&(r=window.requestAnimationFrame(p.tick))},stop:function(){r&&(window.cancelAnimationFrame(r),r=!1)},inProgress:function(){return!!r},get targetScene(){return f}};return p}ti();var tl={fontFamily:"Arial",fontSize:"13px",color:"#595959",backgroundColor:"#ffffff",stroke:"#000000",strokeWidth:0,$fill:"#333333"},el=/^\$/;function nl(t){var e=wn(t);return"object"!==e&&"function"!==e&&"undefined"!==e}function rl(t,e,n){var r=t[e];r&&r.scale&&r.scale.pxScale?r.scale=r.scale.pxScale(n):r&&r.pxScale&&(t[e]=r.pxScale(n))}function il(t,e){return t.pxScale?t.pxScale(e):t}var ol={normalizeSettings:function(t,e,n){var r=yn({},t),i=yn({},e);return Object.keys(r).forEach((function(t){i[t]={};var o=r[t],a=wn(o);if("function"==typeof o)i[t].fn=o;else if(nl(o)){var s=e[t];"string"==typeof s&&el.test(s)&&(s=tl[s]);var u=wn(s);i[t]="undefined"===u||u===a?o:s}else o&&"object"===wn(o)&&("function"==typeof o.fn&&(i[t].fn=o.fn),void 0!==o.scale&&(i[t].scale=n.scale(o.scale)),"string"==typeof o.ref&&(i[t].ref=o.ref))})),Object.keys(e).forEach((function(t){if(!(t in r)){var n=e[t];"string"===wn(n)&&el.test(n)?i[t]=tl[n]:i[t]=n}})),i},resolveForItem:function(t,e,n){for(var r={},i=Object.keys(e),o=i.length,a=t.datum,s=t.datum,u=0;u<o;u++){var l=i[u],c=e[l],h="object"===wn(s)&&void 0!==c,f=h&&"string"==typeof c.ref,d=h&&l in s,p=f?s[c.ref]:d?s[l]:a;nl(c)?r[l]=c:h&&c.fn?(c.scale&&(t.scale=c.scale),r[l]=c.fn.call(null,t,n)):h&&c.scale&&p?(r[l]=c.scale(p.value),c.scale.bandwidth&&(r[l]+=c.scale.bandwidth()/2)):f&&p?r[l]=p.value:c.fn?r[l]=c.fn.call(null,t,n):r[l]=c}return r},updateScaleSize:rl};function al(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ol,n={};function r(r){var i=r.data,o=r.settings,a=r.defaults,s=void 0===a?{}:a,u=r.scaled,l=n.norm=e.normalizeSettings(o,s,t.chart),c={scale:t.chart.scale,formatter:t.chart.formatter};u&&Object.keys(u).forEach((function(t){l[t]&&e.updateScaleSize(l,t,u[t])}));var h=[];if(!i||!Array.isArray(i.items)){var f={data:i,resources:c},d=e.resolveForItem(f,n.norm,-1);return{settings:n.norm,item:d}}for(var p,m=0,g=i.items.length;m<g;m++){p={datum:i.items[m],data:i,resources:c};var y=e.resolveForItem(p,n.norm,m);y.data=i.items[m],h.push(y)}return{settings:n.norm,items:h}}return{resolve:r}}function sl(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.reduce((function(t,e){return Array.isArray(e.children)?(t.push.apply(t,Fn(sl(e.children))),t):(t.push(e),t)}),[])}function ul(t,e){var n=e.context,r=e.data,i=e.style,o=e.filter,a=e.mode,s=t.chart.brush(n),u=r,l=i.active||{},c=i.inactive||{},h=[];Object.keys(l).forEach((function(t){h.push(t)})),Object.keys(c).forEach((function(t){-1===h.indexOf(t)&&h.push(t)}));var f=[],d=!1,p=function(){var e=sl(t.nodes);return"function"==typeof o&&(e=e.filter(o)),e},m=function(){for(var t,e=p(),n=e.length,r=!1,i="function"==typeof u?u({brush:s}):u,o=function(n){if(!(t=e[n].data))return"continue";e[n].__style||(e[n].__style={},h.forEach((function(t){e[n].__style[t]=e[n][t]})));var o=s.containsMappedData(t,i,a),u=f.indexOf(e[n]),p=!1;if(o&&-1===u?(f.push(e[n]),p=!0):o||-1===u||(f.splice(u,1),p=!0),p||d){var m=yn({},e[n],e[n].__style);h.forEach((function(t){e[n][t]=o&&t in l?"function"==typeof l[t]?l[t].call(null,m):l[t]:!o&&t in c?"function"==typeof c[t]?c[t].call(null,m):c[t]:e[n].__style[t]})),r=!0}},m=0;m<n;m++)o(m);return d=!1,r},g=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{suppressRender:!1},n=e.suppressRender,r=p(),i=r.length,o=function(t){if(!r[t].data)return"continue";r[t].__style=r[t].__style||{},h.forEach((function(e){r[t].__style[e]=r[t][e],e in c&&(r[t][e]="function"==typeof c[e]?c[e].call(null,r[t]):c[e])}))},a=0;a<i;a++)o(a);d=!0,f.length=0,n||t.renderer.render(t.nodes)},y=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{suppressRender:!1},n=e.suppressRender,r=p(),i=r.length,o=function(t){r[t].__style&&(Object.keys(r[t].__style).forEach((function(e){r[t][e]=r[t].__style[e]})),r[t].__style=void 0)},a=0;a<i;a++)o(a);f.length=0,n||t.renderer.render(t.nodes)},v=function(){m()&&("function"==typeof t.config.sortNodes?t.renderer.render(t.config.sortNodes(t)):t.renderer.render(t.nodes))};return s.on("start",g),s.on("end",y),s.on("update",v),{isActive:function(){return s.isActive()},update:function(){f.length=0,d=!0,m()},cleanUp:function(){s.removeListener("start",g),s.removeListener("end",y),s.removeListener("update",v)}}}function ll(t){for(var e=t.nodes,n=t.action,r=t.chart,i=t.trigger,o=[],a=0;a<e.length;a++){var s=e[a].data;null!==s&&o.push(s)}!function(t){var e=t.dataPoints,n=t.action,r=t.chart,i=t.trigger;if(i){var o=i.data||[""],a={items:[],actionFn:"toggleRanges"},s={items:[],actionFn:"toggleValues"};-1!==["add","remove","set","toggle"].indexOf(n)&&(a.actionFn="".concat(n,"Ranges"),s.actionFn="".concat(n,"Values"));for(var u=function(t){var n=e[t];if(!n)return"continue";o.forEach((function(t){var e=n&&!t?n:n[t];if(e){var r={key:e.source.field};void 0!==e.source.key&&(r.key="".concat(e.source.key,"/").concat(e.source.field)),Array.isArray(e.value)?(r.range={min:e.value[0],max:e.value[1]},a.items.push(r)):(r.value=e.value,s.items.push(r))}}))},l=0;l<e.length;l++)u(l);i.contexts.forEach((function(t){a.items.length?r.brush(t)[a.actionFn](a.items):r.brush(t)[s.actionFn](s.items)}))}}({dataPoints:o,action:n,chart:r,trigger:i})}function cl(t){var e=t.collisions,n=t.t,r=t.config,i=t.action,o=[],a=!1;e.length>0&&(o=e,a=!0,"stop"===n.propagation&&(o=[e[e.length-1]]));var s=o.map((function(t){return t.node}));return ll({nodes:s,action:i,chart:r.chart,data:r.data,trigger:n}),a}function hl(t,e,n){var r=n.element().getBoundingClientRect(),i=zn(t)?function(t,e){return 1!==t.changedTouches.length?null:{x:t.changedTouches[0].clientX-e.left,y:t.changedTouches[0].clientY-e.top}}(t,r):function(t,e){return{x:t.clientX-e.left,y:t.clientY-e.top}}(t,r);return null===i||i.x<0||i.y<0||i.x>r.width||i.y>r.height?[]:(e.touchRadius>0&&zn(t)?i={cx:i.x,cy:i.y,r:e.touchRadius}:e.mouseRadius>0&&!zn(t)&&(i={cx:i.x,cy:i.y,r:e.mouseRadius}),n.itemsAt(i))}function fl(t,e,n){return t?"function"==typeof t?t(e):t:n}function dl(t){var e=t.e,n=t.t,r=t.config;return cl({collisions:hl(e,n,r.renderer),t:n,config:r,action:fl(n.action,e,"toggle")})}function pl(t){var e=t.e,n=t.t,r=t.config;return cl({collisions:hl(e,n,r.renderer),t:n,config:r,action:fl(n.action,e,"set")})}var ml={fill:"fill",stroke:"stroke",opacity:"opacity",strokeWidth:"stroke-width",strokeLinejoin:"stroke-linejoin",fontFamily:"font-family",fontSize:"font-size",baseline:"dominant-baseline",dominantBaseline:"dominant-baseline",anchor:"text-anchor",textAnchor:"text-anchor",maxWidth:"maxWidth",transform:"transform",strokeDasharray:"stroke-dasharray",id:"id"};function gl(t,e){Object.keys(ml).forEach((function(n){var r=e[n];void 0!==r&&(t[ml[n]]=r)}))}function yl(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="",r=0;r<t.length;r++){var i=t[r];n+=0===r?"M".concat(i.x," ").concat(i.y):"L".concat(i.x," ").concat(i.y),n+=" "}return e&&(n+="Z"),n}function vl(t,e,n,r){var i=n/2,o=t-r/2,a=e-r/2,s=t-i,u=e-i;return[{x:o,y:a},{x:o,y:u},{x:o+r,y:u},{x:o+r,y:a},{x:s+n,y:a},{x:s+n,y:a+r},{x:o+r,y:a+r},{x:o+r,y:u+n},{x:o,y:u+n},{x:o,y:a+r},{x:s,y:a+r},{x:s,y:a}]}function xl(t){return-t/180*Math.PI}function bl(t){return function(t){var e=(.5*(Math.floor(t/Math.PI*2)+2)+.25)*Math.PI,n=Math.cos(Math.abs(e-t))*Math.sqrt(2),r=n*Math.cos(t),i=n*Math.sin(t);return{x1:r<0?1:0,y1:i<0?1:0,x2:r>=0?r:r+1,y2:i>=0?i:i+1}}(xl(t))}function wl(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Ml(t,e){return{x:t.x-e.x,y:t.y-e.y}}function kl(t,e){return{x:t.x*e,y:t.y*e}}function _l(t,e){return t.x-e.x}function ql(t,e){return t.y-e.y}function Dl(t,e){return Math.pow(_l(t,e),2)+Math.pow(ql(t,e),2)}function Sl(t,e){return Math.sqrt(Dl(t,e))}function Cl(t,e){return t.x*e.x+t.y*e.y}function El(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=Math.cos(e),i=Math.sin(e),o=Ml(t,n),a={x:r*o.x-i*o.y,y:i*o.x+r*o.y};return wl(a,n)}var Al={up:0,down:180,left:90,right:-90};function Nl(t){var e=t.x,n=t.y,r=t.size,i=r/2;return{type:"rect",x:e-i,y:n-i,width:r,height:r}}var Ol=ti();function Il(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach((function(n){void 0!==ml[n]&&"transform"!==n&&(t[n]=e[n])}))}Ol.add("circle",(function(t){return{type:"circle",fill:"black",cx:t.x,cy:t.y,r:t.size/2}})),Ol.add("diamond",(function(t){var e=t.size,n=t.x-e/2,r=t.y-e/2;return{type:"path",fill:"black",d:yl([{x:n,y:r+e/2},{x:n+e/2,y:r},{x:n+e,y:r+e/2},{x:n+e/2,y:r+e},{x:n,y:r+e/2}])}})),Ol.add("saltire",(function(t){var e=xl(45),n=t.size/2,r=isNaN(t.width)?n/2:t.width,i=Math.min(r,n),o=t.size,a=Math.sin(Math.asin(-e))*(i/2);o+=2*(n/Math.sin(-e)-n),o-=2*a;var s={x:t.x,y:t.y},u=vl(t.x,t.y,o,i).map((function(t){return El(t,e,s)}));return{type:"path",fill:"black",d:yl(u)}})),Ol.add("square",(function(t){var e=t.size;return{type:"rect",fill:"black",x:t.x-e/2,y:t.y-e/2,width:e,height:e}})),Ol.add("triangle",(function(t){var e=t.size,n={x:t.x,y:t.y},r=Al[t.direction]||0,i=e/2,o=t.x-i,a=t.y-i,s=[{x:o,y:a+e},{x:o+i,y:a},{x:o+e,y:a+e},{x:o,y:a+e}],u=xl(r);return{type:"path",fill:"black",d:yl(s=s.map((function(t){return El(t,u,n)})))}})),Ol.add("line",(function(t){var e="vertical"===t.direction,n=t.size/2,r=t.x,i=t.y;return{type:"line",stroke:"black",strokeWidth:1,x1:r-(e?0:n),y1:i-(e?n:0),x2:r+(e?0:n),y2:i+(e?n:0),collider:Nl(t)}})),Ol.add("star",(function(t){for(var e=t.size,n=[],r=e/2,i=t.points||5,o=Math.min(t.innerRadius||e/2,e)/2,a=isNaN(t.startAngle)?90:t.startAngle,s=360/i,u=1;u<=i;u++){var l=s*u+a,c=xl(l),h=xl(l+s/2),f=Math.sin(c),d=Math.cos(c),p=Math.sin(h),m=Math.cos(h);n.push({x:t.x+d*r,y:t.y+f*r}),n.push({x:t.x+m*o,y:t.y+p*o})}return{type:"path",fill:"black",d:yl(n)}})),Ol.add("n-polygon",(function(t){for(var e=[],n=t.size/2,r=Math.max(isNaN(t.sides)?6:t.sides,3),i=360/r,o=isNaN(t.startAngle)?0:t.startAngle,a=1;a<=r;a++){var s=xl(i*a+o),u=Math.sin(s),l=Math.cos(s);e.push({x:t.x+l*n,y:t.y+u*n})}return{type:"path",fill:"black",d:yl(e)}})),Ol.add("cross",(function(t){var e=t.x,n=t.y,r=t.size/2,i=isNaN(t.width)?r/2:t.width,o=Math.min(i,r);return{type:"path",fill:"black",d:yl(vl(e,n,t.size,o))}})),Ol.add("bar",(function(t){var e={x:t.x,y:t.y},n="vertical"===t.direction,r=t.size/2,i=r/2/2,o=[{x:e.x-r,y:e.y+i},{x:e.x-r,y:e.y-i},{x:e.x+r,y:e.y-i},{x:e.x+r,y:e.y+i}];if(n){var a=xl(90);o=o.map((function(t){return El(t,a,e)}))}var s=Yn(o);return s.type="rect",s.fill="black",s})),Ol.add("rect",(function(t){var e=t.x,n=t.y,r=t.size,i=void 0===t.width?r:t.width,o=void 0===t.height?r:t.height;return{type:"rect",fill:"black",x:e-i/2,y:n-o/2,width:i,height:o}}));var Tl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ol;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.get(e.type);if(n){var r=n(e);return Il(r,e),void 0!==e.data&&(r.data=e.data),r}return n}};function Rl(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.dock,r=void 0===n?"center":n,i=t.displayOrder,o=void 0===i?0:i,a=t.prioOrder,s=void 0===a?0:a,u=t.preferredSize,l=void 0===u?0:u,c=t.minimumLayoutMode,h=t.show,f=void 0===h||h;r=r||"center";var d={computePreferredSize:function(t){var n=t.inner,r=t.outer,i=t.children;return"function"==typeof l?l({inner:n,outer:r,children:i,dock:this.dock()},e):l},dock:function(t){return void 0!==t?(r=t,this):"function"==typeof r?r(e):r},displayOrder:function(t){return void 0!==t?(o=t,this):"function"==typeof o?o(e):o},prioOrder:function(t){return void 0!==t?(s=t,this):"function"==typeof s?s(e):s},minimumLayoutMode:function(t){return void 0!==t?(c=t,this):"function"==typeof c?c(e):c},show:function(t){return void 0!==t?(f=t,this):"function"==typeof f?f(e):f}};return d}function Pl(t,e,n){var r=e.require,i=void 0===r?[]:r,o=e.mediator||{},a=n.settings,s=n.formatter,u=n.scale,l=n.data,c=n.renderer,h=n.chart,f=n.dockConfig,d=n.mediator,p=n.instance,m=n.rect,g=n.style,y=n.registries,v=n.resolver,x=n.update,b=n._DO_NOT_USE_getInfo,w=n.symbol,M=n.isVisible;t.emit=function(){},M&&(t.isVisible=M),Object.defineProperty(t,"settings",{get:a}),Object.defineProperty(t,"data",{get:l}),Object.defineProperty(t,"formatter",{get:s}),Object.defineProperty(t,"scale",{get:u}),Object.defineProperty(t,"mediator",{get:d}),Object.defineProperty(t,"style",{get:g}),Object.defineProperty(t,"registries",{get:y}),m&&Object.defineProperty(t,"rect",{get:m}),b&&(t._DO_NOT_USE_getInfo=b),Object.keys(e).forEach((function(n){var r;r=n,["on","preferredSize","created","beforeMount","mounted","resize","beforeUpdate","updated","beforeRender","render","beforeUnmount","beforeDestroy","destroyed","defaultSettings","data","settings","formatter","scale","chart","dockConfig","mediator","style","resolver","registries","_DO_NOT_USE_getInfo","symbol","isVisible"].some((function(t){return t===r}))||("function"==typeof e[n]?t[n]=e[n].bind(t):t[n]=e[n])})),i.forEach((function(e){"renderer"===e?Object.defineProperty(t,"renderer",{get:c}):"chart"===e?Object.defineProperty(t,"chart",{get:h}):"dockConfig"===e?Object.defineProperty(t,"dockConfig",{get:f}):"instance"===e?Object.defineProperty(t,"instance",{get:p}):"update"===e&&x?Object.defineProperty(t,"update",{get:x}):"resolver"===e?Object.defineProperty(t,"resolver",{get:v}):"symbol"===e&&Object.defineProperty(t,"symbol",{get:w})})),Object.keys(o).forEach((function(e){t.mediator.on(e,o[e].bind(t))}))}function Fl(t,e,n){var r=function(e){return t[e]?(n.warn("Deprecation Warning the ".concat(e," property should be moved into layout: {} property")),t[e]):t.layout?t.layout[e]:void 0},i={};return i.displayOrder=r("displayOrder"),i.dock=r("dock"),i.prioOrder=r("prioOrder"),i.minimumLayoutMode=r("minimumLayoutMode"),t.layout=t.layout||{},t.layout.displayOrder=void 0!==i.displayOrder?i.displayOrder:t.layout.displayOrder,t.layout.prioOrder=void 0!==i.prioOrder?i.prioOrder:t.layout.prioOrder,t.layout.dock=i.dock||t.layout.dock,t.layout.minimumLayoutMode=i.minimumLayoutMode||t.layout.minimumLayoutMode,i.show=t.show,i.preferredSize=e,i}function Ll(t,e,n){Object.keys(n.on||{}).forEach((function(r){t.eventListeners=t.eventListeners||[];var i=n.on[r].bind(t);t.eventListeners.push({event:r,listener:i}),e.on(r,i)})),t.emit=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.emit.apply(e,[t].concat(r))}}function jl(t,e){t.eventListeners&&(t.eventListeners.forEach((function(t){var n=t.event,r=t.listener;e.removeListener(n,r)})),t.eventListeners.length=0),t.emit=function(){}}function zl(t,e,n){var r=wl(function(t,e){var n=Cl(t,e)/Cl(e,e)||1;return{x:e.x*n,y:e.y*n}}(Ml(n,t),Ml(e,t)),t);return r}function Vl(t,e,n){return Sl(t,n)+Sl(e,n)-Sl(t,e)<1e-12}function Hl(t,e){return t.x>=e.x&&t.x+t.width<=e.x+e.width&&t.y>=e.y&&t.y+t.height<=e.y+e.height}function Bl(t){return t.x1===t.x2&&t.y1===t.y2}function Wl(t){return t.width<=0||t.height<=0}function Ul(t){return t.r<=0}function Yl(t){return t.edges.length<=2}function $l(t,e){for(var n=0,r=e.edges.length;n<r;n++)if(!0===tc(t,$n(e.edges[n])))return!0;return!1}function Xl(t,e){for(var n=e.numPolygons,r=e.polygons,i=0;i<n;i++){if(!0===lc(t,r[i]))return!0}return!1}function Gl(t,e){return!Ul(t)&&Dl({x:t.cx,y:t.cy},e)<=Math.pow(t.r,2)}function Kl(t,e){if(Wl(e)||Ul(t))return!1;var n=e.width/2,r=e.height/2,i=e.x+n,o=e.y+r,a=t.r,s=t.cx,u=t.cy,l=Math.abs(s-i),c=Math.abs(u-o);return!(l>n+a||c>r+a)&&(l<=n||c<=r||Math.pow(l-n,2)+Math.pow(c-r,2)<=Math.pow(a,2))}function Jl(t,e){if(Ul(t)||Bl(e))return!1;var n=Pn(Wn(e),2),r=n[0],i=n[1];if(Gl(t,r)||Gl(t,i))return!0;var o={x:t.cx,y:t.cy},a=zl(r,i,o);return Dl(a,o)<=Math.pow(t.r,2)&&Vl(r,i,a)}function Zl(t,e){if(Yl(e)||Ul(t))return!1;if(Ql(e,{x:t.cx,y:t.cy}))return!0;for(var n=e.edges.length,r=0;r<n;r++){if(Jl(t,$n(e.edges[r])))return!0}return!1}function Ql(t,e){if(Yl(t)||!ic(t.boundingRect(),e))return!1;var n,r,i,o,a,s=e.x,u=e.y,l=t.vertices;for(n=!1,o=-1,i=(r=l.length)-1;++o<r;i=o){if(l[o].x===s&&l[o].y===u)return!0;if(l[o].y===l[i].y&&l[o].y===u&&(s-l[o].x)*(s-l[i].x)<=0)return!0;if(l[o].y<u&&u<=l[i].y||l[i].y<u&&u<=l[o].y){if(s===(a=(l[i].x-l[o].x)*(u-l[o].y)/(l[i].y-l[o].y)+l[o].x))return!0;s<a&&(n=!n)}}return n}function tc(t,e){if(Yl(t))return!1;for(var n=0,r=t.edges.length;n<r;n++){if(ac(e,$n(t.edges[n])))return!0}var i=Pn(Wn(e),2),o=i[0],a=i[1];return Ql(t,o)||Ql(t,a)}function ec(t,e){if(Yl(t))return!1;for(var n=0,r=t.edges.length;n<r;n++){if(oc(e,$n(t.edges[n])))return!0}var i=Pn(Un(e),4),o=i[0],a=i[1],s=i[2],u=i[3];return Ql(t,o)||Ql(t,a)||Ql(t,s)||Ql(t,u)}function nc(t,e){return!Wl(t)&&!Wl(e)&&(t.x<=e.x+e.width&&e.x<=t.x+t.width&&t.y<=e.y+e.height&&e.y<=t.y+t.height)}function rc(t,e){return!Wl(t)&&!Wl(e)&&[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}].every((function(e){return ic(t,e)}))}function ic(t,e){return!Wl(t)&&(e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height)}function oc(t,e){if(Bl(e)||Wl(t))return!1;var n=Pn(Wn(e),2),r=n[0],i=n[1];if(ic(t,r)||ic(t,i))return!0;for(var o=Un(t),a=o.length,s=0;s<a;s++){if(ac($n([o[s],o[3!==s?s+1:0]]),e))return!0}return!1}function ac(t,e){var n,r,i=Pn(Wn(t),2),o=i[0],a=i[1],s=Pn(Wn(e),2),u=s[0],l=s[1],c=_l(a,o),h=ql(a,o),f=_l(l,u),d=ql(l,u),p=_l(o,u),m=ql(o,u),g=d*c-f*h,y=f*m-d*p,v=c*m-h*p;if(0===c&&0===h)return!1;if(0===f&&0===d)return!1;if(0===g){if(0===y&&0===v){if(0===c){if(0===h)return o.x===a.x&&o.y===a.y;n=ql(u,o)/h,r=ql(l,o)/h}else n=(u.x-o.x)/c,r=(l.x-o.x)/c;return!(n<0&&r<0||n>1&&r>1)}return!1}var x=y/g;return g=v/g,x>=0&&x<=1&&g>=0&&g<=1}function sc(t,e){if(Bl(t))return!1;var n=Pn(Wn(t),2);return Vl(n[0],n[1],e)}function uc(t,e){var n=t.boundingRect(),r=e.boundingRect();return!!nc(n,r)&&(rc(n,r)?$l(t,e):$l(e,t))}function lc(t,e){var n=t.boundingRect(),r=e.boundingRect();return!!nc(n,r)&&(rc(r,n)?function(t,e){for(var n=t.numPolygons,r=t.polygons,i=0;i<n;i++)if(!0===uc(e,r[i]))return!0;return!1}(t,e):function(t,e){for(var n=0,r=e.edges.length;n<r;n++)if(!0===fc(t,$n(e.edges[n])))return!0;return!1}(t,e))}function cc(t,e){if(Ul(t))return!1;if(hc(e,{x:t.cx,y:t.cy}))return!0;for(var n=e.numPolygons,r=e.polygons,i=0;i<n;i++)for(var o=r[i],a=o.edges.length,s=0;s<a;s++){if(Jl(t,$n(o.edges[s])))return!0}return!1}function hc(t,e){if(!ic(t.boundingRect(),e))return!1;var n,r,i,o,a,s,u=e.x,l=e.y,c=t.numPolygons,h=!1;for(r=0;r<c;r++)for(a=-1,o=(i=(n=t.vertices[r]).length)-1;++a<i;o=a){if(n[a].x===u&&n[a].y===l)return!0;if(n[a].y===n[o].y&&n[a].y===l&&(u-n[a].x)*(u-n[o].x)<=0)return!0;if(n[a].y<l&&l<=n[o].y||n[o].y<l&&l<=n[a].y){if(u===(s=(n[o].x-n[a].x)*(l-n[a].y)/(n[o].y-n[a].y)+n[a].x))return!0;u<s&&(h=!h)}}return h}function fc(t,e){var n=Pn(Wn(e),2),r=n[0],i=n[1];if(hc(t,r)||hc(t,i))return!0;for(var o=t.numPolygons,a=t.polygons,s=0;s<o;s++)for(var u=a[s],l=0,c=u.edges.length;l<c;l++){if(ac(e,$n(u.edges[l])))return!0}return!1}function dc(t,e){var n=Pn(Un(e),4),r=n[0],i=n[1],o=n[2],a=n[3];if(hc(t,r)||hc(t,i)||hc(t,o)||hc(t,a))return!0;for(var s=t.numPolygons,u=t.polygons,l=0;l<s;l++)for(var c=u[l],h=0,f=c.edges.length;h<f;h++){if(oc(e,$n(c.edges[h])))return!0}return!1}var pc=/^\$/,mc="@extend";function gc(t){throw new Error('Cyclical reference for "'.concat(t,'"'))}function yc(t,e,n){if("string"==typeof t){var r=e[t];return-1!==n.indexOf(t)&&gc(t),pc.test(r)?(n.push(t),yc(r,e,n)):r}var i=t,o=yn(!0,{},e,t),a={};if(t[mc]){var s=t[mc];-1!==n.indexOf(s)&&gc(s);var u=n.slice();u.push(s),i=yn(!0,{},yc(o[s],e,u),t)}return Object.keys(i).forEach((function(t){var e=n.slice();if(t!==mc&&!pc.test(t)){a[t]=i[t];var r=a[t];pc.test(r)&&r in o?(-1!==n.indexOf(r)&&gc(r),e.push(r),"object"===wn(r=o[r])||pc.test(r)&&r in o?a[t]=yc(r,o,e):a[t]=r):"object"===wn(r)&&(a[t]=yc(r,o,e))}})),a}function vc(t,e){return yc(t,e,[])}function xc(t){t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height)}function bc(t,e){var n={x:0,y:0,width:0,height:0},r={x:0,y:0,width:0,height:0};return n.width=t.width||0,n.height=t.height||0,void 0!==e.size&&(n.width=isNaN(e.size.width)?n.width:e.size.width,n.height=isNaN(e.size.height)?n.height:e.size.height),void 0!==e.logicalSize?(r.width=isNaN(e.logicalSize.width)?n.width:e.logicalSize.width,r.height=isNaN(e.logicalSize.height)?n.height:e.logicalSize.height,r.align=isNaN(e.logicalSize.align)?.5:Math.min(Math.max(e.logicalSize.align,0),1),r.preserveAspectRatio=e.logicalSize.preserveAspectRatio):(r.width=n.width,r.height=n.height,r.preserveAspectRatio=!1),xc(r),xc(n),{logicalContainerRect:r,containerRect:n}}function wc(t){var e={center:{minWidthRatio:.5,minHeightRatio:.5,minWidth:0,minHeight:0}};return yn(!0,e,t),e.center.minWidthRatio=Math.min(Math.max(e.center.minWidthRatio,0),1),e.center.minHeightRatio=Math.min(Math.max(e.center.minHeightRatio,0),1),e.center.minWidth=Math.max(e.center.minWidth,0),e.center.minHeight=Math.max(e.center.minHeight,0),e}function Mc(t,e,n,r,i){return{x:isNaN(t)?0:t,y:isNaN(t)?0:e,width:isNaN(t)?0:n,height:isNaN(t)?0:r,margin:isNaN(i)?0:i}}function kc(t,e,n){if(void 0===t.cachedSize){var r,i=t.config.dock(),o=t.comp.preferredSize({inner:e,outer:n,dock:i});isNaN(o)?o&&!isNaN(o.size)&&(o.width=o.size,o.height=o.size):o={width:o,height:o},r="top"===i||"bottom"===i?o.height:"right"===i||"left"===i?o.width:Math.max(o.width,o.height),t.cachedSize=Math.ceil(r),t.edgeBleed=o.edgeBleed||0}return t.cachedSize}function _c(t,e){switch(e.config.dock()){case"top":t.y+=e.cachedSize,t.height-=e.cachedSize;break;case"bottom":t.height-=e.cachedSize;break;case"left":t.x+=e.cachedSize,t.width-=e.cachedSize;break;case"right":t.width-=e.cachedSize}}function qc(t,e){var n=e.edgeBleed;n&&(t.left=Math.max(t.left,n.left||0),t.right=Math.max(t.right,n.right||0),t.top=Math.max(t.top,n.top||0),t.bottom=Math.max(t.bottom,n.bottom||0))}function Dc(t,e,n){e.x<n.left&&(e.width-=n.left-e.x,e.x=n.left);var r=t.width-(e.x+e.width);r<n.right&&(e.width-=n.right-r),e.y<n.top&&(e.height-=n.top-e.y,e.y=n.top);var i=t.height-(e.y+e.height);i<n.bottom&&(e.height-=n.bottom-i)}function Sc(t,e,n,r,i){var o=yn({},e),a=yn({},n);_c(o,r),qc(a,r),Dc(t,o,a);var s=function(t,e,n){var r=Math.min(n.center.minWidth,t.width)||Math.max(t.width*n.center.minWidthRatio,1),i=Math.min(n.center.minHeight,t.height)||Math.max(t.height*n.center.minHeightRatio,1);return e.width>=r&&e.height>=i}(t,o,i);return!!s&&(_c(e,r),qc(n,r),!0)}function Cc(t){var e=t.layoutRect,n=t.visible,r=t.hidden,i=t.settings,o=Mc(e.x,e.y,e.width,e.height),a={left:0,right:0,top:0,bottom:0},s=n.slice();s.sort((function(t,e){return t.config.prioOrder()-e.config.prioOrder()}));for(var u=0;u<s.length;++u){var l=s[u];kc(l,o,e),Sc(e,o,a,l,i)||(r.push(s.splice(u,1)[0]),--u)}!function(t,e){if(0!==e.length)for(var n=0;n<t.length;++n){var r=t[n];if(r.referencedDocks.length){var i=r.referencedDocks.every((function(t){return e.some((function(e){return e.key===t}))}));i&&e.push(t.splice(n,1)[0])}}}(n,r);var c=n.filter((function(t){return-1!==s.indexOf(t)}));return n.length=0,n.push.apply(n,Fn(c)),Dc(e,o,a),o}function Ec(t){return{x:t.margin.left+t.x*t.scaleRatio.x,y:t.margin.top+t.y*t.scaleRatio.y,width:t.width*t.scaleRatio.x,height:t.height*t.scaleRatio.y}}function Ac(t){var e;return Yn((e=[]).concat.apply(e,Fn(t.map(Un))))}function Nc(t){var e=t.visible,n=t.layoutRect,r=t.reducedRect,i=t.containerRect,o=t.translation,a=Mc(r.x,r.y,r.width,r.height),s=Mc(r.x,r.y,r.width,r.height),u={},l=e.slice(),c=l.slice().sort((function(t,e){return t.config.displayOrder()-e.config.displayOrder()}));return e.sort((function(t,e){if(t.referencedDocks.length>0&&e.referencedDocks.length>0)return 0;if(e.referencedDocks.length>0)return-1;if(t.referencedDocks.length>0)return 1;var n=t.config.displayOrder()-e.config.displayOrder();return 0===n?l.indexOf(t)-l.indexOf(e):n})).forEach((function(t){var e={},l={};switch(t.config.dock()){case"top":e.height=l.height=t.cachedSize,e.width=n.width,l.width=a.width,e.x=n.x,l.x=a.x,e.y=l.y=a.y-t.cachedSize,a.y-=t.cachedSize,a.height+=t.cachedSize;break;case"bottom":e.x=n.x,l.x=a.x,e.y=l.y=a.y+a.height,e.width=n.width,l.width=a.width,e.height=l.height=t.cachedSize,a.height+=t.cachedSize;break;case"left":e.x=l.x=s.x-t.cachedSize,e.y=n.y,l.y=s.y,e.width=l.width=t.cachedSize,e.height=n.height,l.height=s.height,s.x-=t.cachedSize,s.width+=t.cachedSize;break;case"right":e.x=l.x=s.x+s.width,e.y=n.y,l.y=s.y,e.width=l.width=t.cachedSize,e.height=n.height,l.height=s.height,s.width+=t.cachedSize;break;case"center":e.x=l.x=r.x,e.y=l.y=r.y,e.width=l.width=r.width,e.height=l.height=r.height;break;default:if(t.referencedDocks.length>0){var c=t.referencedDocks.map((function(t){return u[t]})).filter((function(t){return!!t}));c.length>0&&(e=Ac(c.map((function(t){return t.outerRect}))),l=Ac(c.map((function(t){return t.r}))))}}t.key&&(u[t.key]={r:l,outerRect:e}),function(t,e,n,r){var i={x:r.width/n.width,y:r.height/n.height},o={left:0,top:0};if(n.preserveAspectRatio){var a=i.x<i.y,s=Math.min(i.x,i.y);i.x=s,i.y=s;var u=a?"height":"width",l=(r[u]-n[u]*i.x)*n.align;o.left=a?0:l,o.top=a?l:0}t.scaleRatio=i,t.margin=o,e.scaleRatio=i,e.margin=o,n.scaleRatio=i,n.margin=o}(l,e,n,i),l.edgeBleed=t.edgeBleed,l.computed=Ec(l),e.edgeBleed=t.edgeBleed,e.computed=Ec(e),l.x+=o.x,l.y+=o.y,e.x+=o.x,e.y+=o.y,t.comp.resize(l,e),t.cachedSize=void 0,t.edgeBleed=void 0})),c}function Oc(t){if(!t.resize||"function"!=typeof t.resize)throw new Error("Component is missing resize function");if(!t.dockConfig&&!t.preferredSize)throw new Error("Component is missing preferredSize function")}function Ic(t,e,n){for(var r,i,o,a,s,u=[],l=[],c=0;c<t.length;++c){var h=t[c];Oc(h);var f=h.dockConfig,d=h.key,p=f.dock(),m=/@/.test(p)?p.split(",").map((function(t){return t.replace(/^\s*@/,"")})):[];r=f,i=n,o=void 0,a=void 0,s=void 0,o=e.layoutModes||{},a=r.minimumLayoutMode(),(s=r.show())&&"object"===wn(a)?s=o[a.width]&&o[a.height]&&i.width>=o[a.width].width&&i.height>=o[a.height].height:s&&void 0!==a&&(s=o[a]&&i.width>=o[a].width&&i.height>=o[a].height),s?u.push({comp:h,key:d,config:f,referencedDocks:m}):l.push({comp:h,key:d,config:f,referencedDocks:m})}return[u,l]}var Tc=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.hasKey&&r.key===e)return t[n]}return null},Rc=function t(e){return null==e?void 0:e.map((function(e){var n=e.instance.dockConfig();return{preferredSize:function(r){return n.computePreferredSize(bn(bn({},r),{},{children:t(e.children)}))}}}))},Pc=function(t,e){return{visible:[],hidden:e,ordered:[]}},Fc=function(t){return function(e,n){var r,i=n.map((function(t,e){var n=t.instance.dockConfig();return{index:e,key:t.key,dockConfig:n,resize:t.instance.resize,preferredSize:function(e){return n.computePreferredSize(bn(bn({},e),{},{children:Rc(t.children)}))}}})),o=function(t){return n[t.index]},a=null!==(r=t(e,i))&&void 0!==r?r:{},s=a.visible,u=void 0===s?i:s,l=a.hidden,c=void 0===l?[]:l,h=a.ordered,f=void 0===h?u:h;return{visible:u.map(o),hidden:c.map(o),ordered:f.map(o)}}},Lc=function(t){var e,n,r=(e=wc(t),n={layout:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||isNaN(t.x)||isNaN(t.y)||isNaN(t.width)||isNaN(t.height))throw new Error("Invalid rect");if(!n.length)return{visible:[],hidden:[],ordered:[]};var r=bc(t,e),i=r.logicalContainerRect,o=r.containerRect,a=Pn(Ic(n,e,i),2),s=a[0],u=a[1],l=Nc({visible:s,layoutRect:i,reducedRect:Cc({layoutRect:i,visible:s,hidden:u,settings:e}),containerRect:o,translation:{x:t.x,y:t.y}});return u.forEach((function(t){t.comp.visible=!1;var e=Mc();t.comp.resize(e,e)})),{visible:s.map((function(t){return t.comp})),hidden:u.map((function(t){return t.comp})),ordered:l.map((function(t){return t.comp}))}},settings:function(t){e=wc(t)}},n);return Fc((function(t,e){return r.layout(t,e)}))},jc=function(t){return"function"==typeof t?Fc(t):Lc(t)};function zc(t){var e=t.createComponent,n={},r=[],i=[],o=function t(n){var i=e(n);return i&&(r.push(i),n.components&&(i.children=n.components.map((function(e){return t(e)})).filter((function(t){return!!t})))),i},a=function t(e,n){for(var i=function(i){var o=e[i],a=n.find((function(t){return o.hasKey&&o.key===t.key}));a?o.children&&a.components&&t(o.children,a.components):(e.splice(i,1),function(t){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}(o),o.children&&t(o.children,[]),o.instance.destroy())},o=e.length-1;o>=0;o--)i(o)},s=function t(e){var n=e.compList,r=e.data,i=e.excludeFromUpdate,a=e.formatters,s=e.scales;return e.settingsList.map((function(e){var u=Tc(n,e.key);return i.indexOf(e.key)>-1?u:u?e.rendererSettings&&"function"==typeof e.rendererSettings.transform&&e.rendererSettings.transform()?(u.applyTransform=!0,u.instance.renderer().settings(e.rendererSettings),u):(u.updateWith={formatters:a,scales:s,data:r,settings:e},e.components&&(u.children=t({compList:u.children||[],data:r,excludeFromUpdate:i,formatters:a,scales:s,settingsList:e.components})),u):o(e)})).filter((function(t){return!!t}))},u=function t(e){var n=e.components,r=e.hidden,i=e.layoutFn,o=e.ordered,a=e.rect,s=e.visible,u=i(a,n),l=u.visible,c=u.hidden,h=u.ordered;s.push.apply(s,Fn(l)),r.push.apply(r,Fn(c)),o.push.apply(o,Fn(h)),l.forEach((function(e){if(e.children){var n,i,a=jc(null!==(n=null===(i=e.settings)||void 0===i?void 0:i.strategy)&&void 0!==n?n:{});t({components:e.children,hidden:r,layoutFn:a,ordered:o,rect:e.instance.getRect(),visible:s})}})),c.forEach((function(e){e.children&&t({components:e.children,hidden:r,layoutFn:Pc,ordered:o,rect:null,visible:s})}))};return n.destroy=function(){r.forEach((function(t){return t.instance.destroy()})),r=[],i=[]},n.findComponentByKey=function(t){return Tc(r,t)},n.forEach=function(t){r.forEach(t)},n.layout=function(t){var e=t.layoutSettings,n=t.rect,r=[],o=[],a=[],s=jc(e);return u({components:i,hidden:o,layoutFn:s,ordered:a,rect:n,visible:r}),{visible:r,hidden:o,ordered:a}},n.set=function(t){var e=t.components;i=e.map((function(t){return o(t)})).filter((function(t){return!!t}))},n.update=function(t){var e=t.components,n=t.data,r=t.excludeFromUpdate,o=t.formatters,u=t.scales;a(i,e),i=s({compList:i,data:n,excludeFromUpdate:r,formatters:o,scales:u,settingsList:e})},n}function Vc(t,e,n){var r=e.left-n.left,i=e.top-n.top,o=Xn(t),a=yn(!0,{},t);switch(o){case"circle":a.cx+=r,a.cy+=i;break;case"polygon":for(var s=0,u=a.vertices.length;s<u;s++){var l=a.vertices[s];l.x+=r,l.y+=i}break;case"geopolygon":for(var c=0;c<a.vertices.length;c++)for(var h=a.vertices[c],f=0,d=h.length;f<d;f++){var p=h[f];p.x+=r,p.y+=i}break;case"line":a.x1+=r,a.y1+=i,a.x2+=r,a.y2+=i;break;case"point":case"rect":a.x+=r,a.y+=i}return a}function Hc(t,e){var n=[],r=0;e.forEach((function(t){n.push(r),r++;var e=t.instance.def.additionalElements&&t.instance.def.additionalElements();e&&(r+=e.length)})),e.forEach((function(e,r){return function(t,e,n){var r=e.instance.renderer().element();if(!isNaN(n)&&r&&t&&t.children){var i=t.children[Math.max(0,n)];if(r!==i){var o=e.instance.def.additionalElements&&e.instance.def.additionalElements().filter(Boolean);t.insertBefore&&void 0!==i?(t.insertBefore(r,i),o&&o.forEach((function(e){t.insertBefore(e,r)}))):(o&&o.forEach((function(e){t.appendChild(e,r)})),t.appendChild(r))}}}(t,e,n[r])}))}function Bc(t,e){var n=t.element,r=t.data,i=void 0===r?[]:r,o=t.settings,a=void 0===o?{}:o,s=t.on,u=void 0===s?{}:s,l=e.registries,c=e.logger,h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=t,r=function(t){t.forEach((function(t){var n=Array.isArray(t.colors[0])?t.colors:[t.colors];e[t.key]={colors:n,sizes:n.map((function(t){return t?t.length:0}))}}))},i=function(t,n){var r=e[t];if(!r)return[];for(var i=r.sizes,o=0;o<i.length;o++)if(n<=i[o])return r.colors[o];return r.colors[i.length-1]},o={palette:function(t,e){return i(t,e)},setPalettes:r,style:function(t){return vc(t,n)},setStyle:function(e){n=yn({},t,e)}};return r(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]),o}(e.style,e.palettes),f=[],d=yn({},t),p=function(){var t={};return Su(t),t}(),m=[],g=null,y=null,v=null,x=[],b=function(){},w=function(){},M={},k=!1,_=zc({createComponent:function(t){if(!l.component.has(t.type))return c.warn("Unknown component: ".concat(t.type)),!1;var e=function(t){var e,n,r,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.defaultSettings,u=void 0===s?{}:s,l=t._DO_NOT_USE_getInfo,c=void 0===l?function(){return{}}:l,h=a.chart,f=a.container,d=a.mediator,p=a.registries,m=a.theme,g=a.renderer,y=Su({}),v=a.settings||{},x=yn(!0,{},u,v),b=[],w=al({chart:h}),M=!1,k={nodes:[],chart:h,config:x.brush||{},renderer:null},_={tap:[],over:[]},q=[],D={},S=yn({},v);function C(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){for(var i,o,a,s=void 0!==t[e],u=void 0!==v[e],l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return s&&("function"==typeof t[e]?i=(o=t[e]).call.apply(o,[D].concat(c)):r&&(i=t[e])),u&&("function"==typeof v[e]?i=(a=v[e]).call.apply(a,[S].concat(c)):r&&(i=v[e])),s||u||(i=n.call.apply(n,[D].concat(c))),i}}var E=C("preferredSize",(function(){return 0}),!0),A=C("resize",(function(t){return t.inner})),N=C("created"),O=C("beforeMount"),I=C("mounted"),T=C("beforeUnmount"),R=C("beforeUpdate"),P=C("updated"),F=C("beforeRender"),L=C("beforeDestroy"),j=C("destroyed"),z=t.render,V=function(){x.brush&&(x.brush.consume||[]).forEach((function(t){t.context&&t.style&&q.push(ul(k,t))}))},H=function(){x.brush&&(x.brush.trigger||[]).forEach((function(t){"over"===t.on?_.over.push(t):_.tap.push(t)}))};Object.defineProperty(k,"data",{get:function(){return b}});var B=x.renderer||t.renderer,W=B?g||p.renderer(B)():g||p.renderer()();"function"==typeof W.settings&&W.settings(x.rendererSettings),k.renderer=W;var U={resources:h.logger?{logger:h.logger()}:{}},Y=Rl(Fl(x,E,h.logger()),U),$=function(t){t.key=x.key,t.element=W.element()},X=function(){};X.dockConfig=function(){return Y},X.set=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.settings&&(v=t.settings,x=yn(!0,{},u,t.settings),Y=Rl(Fl(x,E,h.logger()),U)),x.scale&&(e=h.scale(x.scale)),b=x.data?ha(x.data,{dataset:h.dataset,collection:h.dataCollection},{logger:h.logger()},h.dataCollection):e?e.data():[],"string"==typeof x.formatter||"object"===wn(x.formatter)?n=h.formatter(x.formatter):e&&e.data().fields&&(n=e.data().fields[0].formatter()),o=m.style(x.style||{})},X.resize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=A({inner:t,outer:e});i=n?W.size(n):W.size(t),S.rect=yn(!0,{computedPhysical:i.computedPhysical,computedOuter:e.computed||e,computedInner:t.computed||t},t),i=yn(!0,{computedOuter:e.computed||e,computedInner:t.computed||t},i)},X.getRect=function(){return S.rect};var G,K,J,Z=function(){var t=W.renderArgs?W.renderArgs.slice(0):[];return t.push({data:b}),t};X.beforeMount=O,X.beforeRender=function(){F({size:i})},X.render=function(){var t=k.nodes=z.call.apply(z,[D].concat(Fn(Z())));W.render(t),G=t,K=S.rect.computed},X.hide=function(){X.unmount(),W.size({x:0,y:0,width:0,height:0}),W.clear()},X.beforeUpdate=function(){R({settings:x,data:b})},X.update=function(){J&&J.stop();var t=x,e=t.rendererSettings,n=t.brush,r=t.animations;if("function"==typeof(null==e?void 0:e.transform)&&e.transform())return W.render(),void(G=null);var i=k.nodes=z.call.apply(z,[D].concat(Fn(Z())));q.forEach((function(t){return t.cleanUp()})),q.length=0,_.tap=[],_.over=[],n&&(V(),H()),q.forEach((function(t){t.isActive()&&t.update()})),G&&r&&("function"==typeof r.enabled?r.enabled():r.enabled)?(r.compensateForLayoutChanges&&r.compensateForLayoutChanges({currentNodes:G,currentRect:S.rect.computed,previousRect:K}),(J=Qu({old:G,current:i},{renderer:W},r)).start()):W.render(i),G=i,K=S.rect.computed,W.setKey&&"string"==typeof v.key&&W.setKey(v.key)},X.updated=P,X.destroy=function(){X.unmount(),L(r),W.destroy(),j(),r=null};var Q=function(t){k.nodes=t,q.forEach((function(t){t.isActive()&&t.update()})),W.render(t)};return Pl(D,t,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return W},chart:function(){return h},dockConfig:function(){return Y},mediator:function(){return d},instance:function(){return S},rect:function(){return S.rect},style:function(){return o},update:function(){return Q},registries:function(){return p},resolver:function(){return w},symbol:function(){return Tl(p.symbol)}}),Pl(S,v,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return W},chart:function(){return h},dockConfig:function(){return Y},mediator:function(){return d},style:function(){return o},_DO_NOT_USE_getInfo:c.bind(D),isVisible:function(){return M}}),X.getBrushedShapes=function(t,e,n){var r=[];if(x.brush&&x.brush.consume){var i=h.brush(t),o=W.findShapes("*");x.brush.consume.filter((function(e){return e.context===t})).forEach((function(t){for(var a=0;a<o.length;a++){var s=o[a];s.data&&i.containsMappedData(s.data,n||t.data,e)&&($(s),r.push(s),o.splice(a,1),a--)}}))}return r},X.findShapes=function(t){for(var e,n=(null!==(e=J)&&void 0!==e&&e.inProgress()?J.targetScene:W).findShapes(t),r=0,i=n.length;r<i;r++)$(n[r]);return n},X.shapesAt=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=W.itemsAt(t);e=n&&"stop"===n.propagation&&r.length>0?[r.pop().node]:r.map((function(t){return t.node}));for(var i=0,o=e.length;i<o;i++)$(e[i]);return e},X.brushFromShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.contexts=Array.isArray(e.contexts)?e.contexts:[],ll({nodes:t,action:e.action||"toggle",trigger:e,chart:h,data:k.data})},X.mount=function(){r=W.element&&W.element()?r:W.appendTo(f),W.setKey&&"string"==typeof v.key&&W.setKey(v.key),x.brush&&(V(),H()),Ll(S,y,v),Ll(D,y,t),M=!0},X.mounted=function(){return I(r)},X.unmount=function(){[S,D].forEach((function(t){jl(t,y)})),_.tap=[],_.over=[],q.forEach((function(t){t.cleanUp()})),q.length=0,T(),M=!1},X.onBrushTap=function(t){_.tap.forEach((function(e){dl({e:t,t:e,config:k})&&"stop"===e.globalPropagation&&h.toggleBrushing(!0)}))},X.onBrushOver=function(t){_.over.forEach((function(e){pl({e:t,t:e,config:k})&&"stop"===e.globalPropagation&&h.toggleBrushing(!0)}))},X.def=D,X.ctx=S,X.renderer=function(){return W},X.set({settings:v}),N(),X}(l.component(t.type),{settings:t,chart:d,mediator:p,registries:l,theme:h,container:n});return{instance:e,settings:yn(!0,{},t),key:t.key,hasKey:void 0!==t.key}}});function q(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var r,i,o="function"==typeof t[e],a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];o?r=(i=t[e]).call.apply(i,[d].concat(s)):r=n.call.apply(n,[d].concat(s));return r}}var D=function(){var t;a.dockLayout?(c.warn('Deprecation Warning: "dockLayout" property should be renamed to "strategy"'),t=a.dockLayout):t=a.strategy;var e=function(t){if("function"==typeof t.getBoundingClientRect){var e=t.getBoundingClientRect();return{x:0,y:0,width:e.width,height:e.height}}return{x:0,y:0,width:0,height:0}}(n);return _.layout({layoutSettings:t,rect:e})},S=q("created"),C=q("beforeMount"),E=q("mounted"),A=q("beforeUpdate"),N=q("updated"),O=q("beforeRender"),I=q("beforeDestroy"),T=q("destroyed"),R=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.partialData,i=e.formatters,o=void 0===i?{}:i,a=e.scales,s=void 0===a?{}:a,u=e.scroll,f=void 0===u?{}:u;b=Kn(t,{logger:c,types:l.data}),r||Object.keys(M).forEach((function(t){return M[t].clear()})),e.palettes&&h.setPalettes(e.palettes),e.style&&h.setStyle(e.style),w=fa(e.collections,{dataset:b},{logger:c});var d={theme:h,logger:c};g=ku(s,{dataset:b,collection:w},bn(bn({},d),{},{scale:l.scale})),y=pa(o,{dataset:b,collection:w},bn(bn({},d),{},{formatter:l.formatter})),v=Au(f,v)};function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={},r=t.filter((function(t){return!!t.key})).map((function(t){return t.key}));x.forEach((function(t){t.key&&-1!==r.indexOf(t.key)?e[t.key]=t:t.destroy()})),x=t.map((function(t){var r=t.key&&e[t.key]?e[t.key]:l.interaction(t.type)(d,p,n);return r.set(t),r}))}var F=function(t){var e=n.getBoundingClientRect(),r="clientX"in t?t.clientX:t.x,i="clientY"in t?t.clientY:t.y,o={x:r-e.left,y:i-e.top},a=[];return m.forEach((function(t){var e=t.instance.getRect();ic(e.computedPhysical?e.computedPhysical:{x:e.margin.left+e.x*e.scaleRatio.x,y:e.margin.top+e.y*e.scaleRatio.y,width:e.width*e.scaleRatio.x,height:e.height*e.scaleRatio.y},o)&&a.push(t)})),a},L=function(){if(!f.length&&n){Object.keys(u).forEach((function(t){var e=u[t].bind(d);n.addEventListener(t,e),f.push({key:t,listener:e})}));var t={},e=function(e){e.touches?(t.x=e.touches[0].clientX,t.y=e.touches[0].clientY,t.multiTouch=e.touches.length>1):(t.x=e.clientX,t.y=e.clientY,t.multiTouch=!1),t.time=Date.now(),t.comps=F(t)},r=function(e){var n=t.comps||F(e);if(!n.every((function(t){return t.instance.def.disableTriggers}))&&("touchend"===e.type&&e.preventDefault(),function(t,e){var n=zn(t),r=n?t.changedTouches[0]:t,i=Date.now()-e.time,o=isNaN(e.x)?0:Math.abs(r.clientX-e.x),a=isNaN(e.y)?0:Math.abs(r.clientY-e.y);return(0===t.button||n)&&!e.multiTouch&&o<=12&&a<=12&&i<=300}(e,t)))for(var r=n.length-1;r>=0;r--){if(n[r].instance.onBrushTap(e),k){k=!1;break}}},i=[];i.push({key:"mousedown",listener:e}),i.push({key:"mouseup",listener:r}),function(t){return"ontouchstart"in t&&"ontouchend"in t||navigator.maxTouchPoints>1}(n)&&(i.push({key:"touchstart",listener:e}),i.push({key:"touchend",listener:r})),i.push({key:"mousemove",listener:function(t){for(var e=F(t),n=e.length-1;n>=0;n--){if(e[n].instance.onBrushOver(t),k){k=!1;break}}}}),i.forEach((function(t){n.addEventListener(t.key,t.listener),f.push(t)}))}},j=function(){f.forEach((function(t){var e=t.key,r=t.listener;return n.removeEventListener(e,r)})),f.length=0};return d.layoutComponents=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.excludeFromUpdate,n=void 0===e?[]:e;t.data&&(i=t.data),t.settings&&(a=t.settings,P(t.settings.interactions)),A(),R(i,a);var r=a,o=r.formatters,s=r.scales,u=r.components,l=void 0===u?[]:u;_.update({components:l,data:i,excludeFromUpdate:n,formatters:o,scales:s}),_.forEach((function(t){t.updateWith&&t.instance.set(t.updateWith)})),_.forEach((function(t){t.updateWith&&t.instance.beforeUpdate()})),D()},d.update=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.partialData,o=e.excludeFromUpdate,s=void 0===o?[]:o;e.data&&(i=e.data),e.settings&&(a=e.settings,P(e.settings.interactions)),A(),R(i,a,{partialData:r});var u=a,l=u.formatters,c=u.scales,h=u.components,f=void 0===h?[]:h;_.update({components:f,data:i,excludeFromUpdate:s,formatters:l,scales:c}),_.forEach((function(t){t.updateWith&&t.instance.set(t.updateWith)})),_.forEach((function(t){t.updateWith&&t.instance.beforeUpdate()}));var d,p=[],g=[];if(r)_.forEach((function(t){(t.updateWith||t.applyTransform)&&t.visible&&p.push(t)})),d=p;else{var y=D(),v=y.visible,x=y.hidden,b=y.ordered;m=v,d=v,t=b,v.forEach((function(t){t.updateWith&&t.visible?p.push(t):g.push(t)})),x.forEach((function(t){t.instance.hide(),t.visible=!1,delete t.updateWith,t.applyTransform=!1}))}g.forEach((function(t){return t.instance.beforeMount()})),g.forEach((function(t){return t.instance.mount()})),d.forEach((function(t){return t.instance.beforeRender()})),d.forEach((function(t){(t.updateWith||t.applyTransform)&&t.visible?t.instance.update():t.instance.render()})),r||Hc(n,t),g.forEach((function(t){return t.instance.mounted()})),p.forEach((function(t){return t.instance.updated()})),m.forEach((function(t){delete t.updateWith,t.visible=!0,t.applyTransform=!1})),N()},d.destroy=function(){I(),_.destroy(),j(),P(),delete d.update,delete d.destroy,T()},d.getAffectedShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"and",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=[];return m.filter((function(t){return null==r||t.key===r})).forEach((function(r){i.push.apply(i,Fn(r.instance.getBrushedShapes(t,e,n)))})),i},d.findShapes=function(t){var e=[];return m.forEach((function(n){e.push.apply(e,Fn(n.instance.findShapes(t)))})),e},d.componentsFromPoint=function(t){return F(t).map((function(t){return t.instance.ctx}))},d.shapesAt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i=n.getBoundingClientRect(),o=m;if(Array.isArray(e.components)&&e.components.length>0){var a=e.components.map((function(t){return t.key}));o=m.filter((function(t){return-1!==a.indexOf(t.key)})).map((function(t){return{instance:t.instance,opts:e.components[a.indexOf(t.key)]}}))}for(var s=o.length-1;s>=0;s--){var u=o[s],l=u.instance.renderer().element().getBoundingClientRect(),c=Vc(t,i,l),h=u.instance.shapesAt(c,u.opts),f=h.length>0&&"stop"===e.propagation;if(r.push.apply(r,Fn(h)),r.length>0&&f)return r}return r},d.brushFromShapes=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{components:[]},n=function(n){var r=e.components[n].key;m.filter((function(t){return r===t.key})).forEach((function(r){var i=t.filter((function(t){return t.key===r.key}));r.instance.brushFromShapes(i,e.components[n])}))},r=0;r<e.components.length;r++)n(r)},d.scroll=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return Nu(t,v)},d.dataset=function(t){return b(t)},d.dataCollection=function(t){return w(t)},d.scales=function(){return g.all()},d.formatters=function(){return y.all()},d.brush=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return M[t]||(M[t]=Ku()),M[t]},d.scale=function(t){return g.get(t)},d.formatter=function(t){return y.get(t)},d.toggleBrushing=function(t){k=void 0!==t?t:!k},d.component=function(t){var e=_.findComponentByKey(t);return null==e?void 0:e.instance.ctx},d.logger=function(){return c},d.theme=function(){return h},Object.defineProperty(d,"interactions",{get:function(){return{instances:x,on:function(){L(),x.forEach((function(t){return t.on()}))},off:function(){j(),x.forEach((function(t){return t.off()}))}}}}),S(),n&&(C(),n.innerHTML="",function(){var t=a.components,e=void 0===t?[]:t;O(),R(i,a),_.set({components:e});var r=D(),o=r.visible,s=r.hidden,u=r.ordered;m=o,s.forEach((function(t){t.instance.hide(),t.visible=!1})),o.forEach((function(t){return t.instance.beforeMount()})),o.forEach((function(t){return t.instance.mount()})),o.forEach((function(t){return t.instance.beforeRender()})),o.forEach((function(t){return t.instance.render()})),o.forEach((function(t){return t.instance.mounted()})),o.forEach((function(t){t.visible=!0})),Hc(n,u)}(),L(),P(a.interactions),E(n),d.element=n),d}var Wc=function(t){var e=ti(t);return e.prio=function(t){return t?e.default(t[0]):[e.default()]},e.types=function(){return e.getKeys()},e},Uc=ti();function Yc(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];for(var r=0;r<n.fields.length;r++)if(n.fields[r].key()===t)return n.fields[r];for(var i=0;i<n.fields.length;i++)if(n.fields[i].title()===t)return n.fields[i];return null}var $c=function(t){return t.filter((function(t){return"number"==typeof t&&!isNaN(t)}))},Xc=function(t){return t.reduce((function(t,e){return t+e}),0)},Gc={first:function(t){return t[0]},last:function(t){return t[t.length-1]},min:function(t){var e=$c(t);return e.length?Math.min.apply(null,e):NaN},max:function(t){var e=$c(t);return e.length?Math.max.apply(null,e):NaN},sum:function(t){var e=$c(t);return e.length?e.reduce((function(t,e){return t+e}),0):NaN},avg:function(t){var e=$c(t),n=e.length;return n?Xc(e)/n:NaN}};function Kc(t,e,n,r){var i={},o=r.field||(void 0!==t.field?e.field(t.field):null);return Object.keys(n).forEach((function(a){var s=n[a],u=i[a]={};-1!==["number","string","boolean"].indexOf(wn(s))?(u.type="primitive",u.value=s):"function"==typeof s?(u.type="function",u.value=s,u.label=s,u.field=o):"object"===wn(s)&&(s.fields?u.fields=s.fields.map((function(n){return Kc(t,e,{main:n},r).main})):void 0!==s.field?(u.type="field",u.field=e.field(s.field),u.value=u.field.value,u.label=u.field.label):o&&(u.value=o.value,u.label=o.label,u.field=o),"function"==typeof s.filter&&(u.filter=s.filter),void 0!==s.value&&(u.value=s.value),void 0!==s.label&&(u.label=s.label),"function"==typeof s.reduce?u.reduce=s.reduce:s.reduce?u.reduce=Gc[s.reduce]:u.field&&u.field.reduce&&(u.reduce="string"==typeof u.field.reduce?Gc[u.field.reduce]:u.field.reduce),"function"==typeof s.reduceLabel?u.reduceLabel=s.reduceLabel:s.reduceLabel?u.reduceLabel=Gc[s.reduceLabel]:u.field&&u.field.reduceLabel&&(u.reduceLabel="string"==typeof u.field.reduceLabel?Gc[u.field.reduceLabel]:u.field.reduceLabel))})),i}function Jc(t,e){var n=Kc(t,e,{main:{value:t.value,label:t.label,reduce:t.reduce,filter:t.filter}},{}).main;return{props:Kc(t,e,t.props||{},n),main:n}}function Zc(t,e,n,r){for(var i,o=Array(t.length),a=Array(t.length),s=0;s<t.length;s++)i=r?t[s][r]:t[s],o[s]=i.value,a[s]=i.label;var u=e.reduce,l=e.reduceLabel,c=u?u(o):o,h={value:c,label:l?l(a,c):n?n(c):String(c)};return r&&t[0][r].source?(h.source=t[0][r].source,h):!r&&t[0].source?(h.source=t[0].source,h):h}function Qc(t,e){var n=e.main,r=e.propsArr,i=e.props,o=[],a=n.field.formatter(),s={};return r.forEach((function(t){s[t]=i[t].field?i[t].field.formatter():function(t){return t}})),o.push.apply(o,Fn(t.map((function(t){var e=Zc(t.items,n,a);return r.forEach((function(n){e[n]=Zc(t.items,i[n],s[n],n)})),e})))),o}function th(t){var e=t.cfg,n=t.itemData,r=t.obj,i=t.target,o=t.tracker,a="function"===t.trackType?e.trackBy(n):n[e.trackBy],s=o[a];s||(s=o[a]={items:[],id:a},i.push(s)),s.items.push(r)}function eh(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function nh(t,e){var n=Array.isArray(t)?t:[t],r=[];return n.forEach((function(t){void 0!==t.field&&function(){var n=e.field(t.field),i=e.key();if(!n)throw Error("Field '".concat(t.field,"' not found"));for(var o=Jc(t,e),a=o.props,s=o.main,u=Object.keys(a),l=!!t.trackBy,c=wn(t.trackBy),h={},f=[],d=n.items(),p=[],m=function(e){var n=d[e];if(s.filter&&!s.filter(n))return"continue";var r=eh(s,n,{key:i});u.forEach((function(t){var o=a[t],s=o.field?o.field.items()[e]:n;r[t]=eh(o,s,{key:i})})),l&&th({cfg:t,itemData:n,obj:r,target:f,tracker:h,trackType:c}),p.push(r)},g=0;g<d.length;g++)m(g);l?r.push.apply(r,Fn(Qc(f,{main:s,propsArr:u,props:a}))):r.push.apply(r,p)}()})),r}var rh=function(t){return t.filter((function(t){return"number"==typeof t&&!isNaN(t)}))};var ih=function(t){var e=t.key,n=t.data,r=t.cache,i=t.config;if(n){var o=n;"string"==typeof o&&(o=function(t){var e=t.data,n=t.config,r=e.split("\n"),i=r[0],o=r[1],a=",";if(n&&n.parse&&n.parse.delimiter)a=n.parse.delimiter;else if(i)for(var s=[/,/,/\t/,/;/],u=0;u<s.length;u++){var l=s[u];if(i&&o){if(l.test(i)&&l.test(o)&&i.split(l).length===o.split(l).length){a=l;break}}else l.test(i)&&(a=l)}return r.map((function(t){return t.split(a)}))}({data:n,config:i})),Array.isArray(o)&&function(t){var e,n=t.source,r=t.data,i=t.cache,o=t.config,a=r,s=o&&o.parse;Array.isArray(r[0])?s&&!1===s.headers?e=r[0].map((function(t,e){return e})):(e=r[0],a=r.slice(1)):e=Object.keys(r[0]);var u,l=!!s&&"function"==typeof s.row&&s.row,c=e;c=s&&"function"==typeof s.fields?s.fields(c.slice()):e.map((function(t){return{key:t,title:t}})),Array.isArray(r[0])?u=c.map((function(){return[]})):(u={},c.forEach((function(t){u[t.key]=[]})));for(var h=0;h<a.length;h++){var f=l?l(a[h],h,c):a[h];if(f)if(Array.isArray(f))for(var d=0;d<c.length;d++)u[d].push(f[d]);else for(var p=0;p<c.length;p++)u[c[p].key].push(f[c[p].key])}for(var m=Array.isArray(u)?function(t){return u[t]}:function(t){return u[c[t].key]},g=0;g<c.length;g++){var y=m(g),v=rh(y),x=v.length>0,b=x?"measure":"dimension",w=x?Math.min.apply(Math,Fn(v)):NaN,M=x?Math.max.apply(Math,Fn(v)):NaN;i.fields.push(sa(yn({source:n,key:g,title:c[g].title,values:y,min:w,max:M,type:b},c[g]),{value:c[g].value,label:c[g].label}))}}({data:o,cache:r,source:e,config:i})}};function oh(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=t.data,r=t.config,i={fields:[]},o={key:function(){return e},raw:function(){return n},field:function(t){return Yc(t,{cache:i,matrix:n})},fields:function(){return i.fields.slice()},extract:function(t){return nh(t,o)},hierarchy:function(){return null}};return ih({key:e,data:n,config:r,cache:i}),o}oh.util={normalizeConfig:Jc,collect:Qc,track:th};var ah=ti();ah.default("matrix"),ah("matrix",oh),ah("default",oh);var sh=ti();function uh(t,e,n){return Math.max(t,Math.min(e,n))}function lh(t){var e,n=t.item,r=t.value,i=t.boxCenter,o=t.rendWidth,a=t.rendHeight,s="x",u="y",l=o,c=a,h=r<.5?90:-90;return t.flipXY&&(s="y",u="x",l=a,c=o,h=r<.5?180:0),(0,t.symbol)(yn({},n.oob,(qn(e={},s,i*l),qn(e,u,Math.max(n.oob.size/2,Math.min(r*c,c-n.oob.size/2))),qn(e,"startAngle",h),e)))}function ch(t){var e,n=t.item,r=t.boxWidth,i=t.boxPadding,o=t.rendWidth,a=t.rendHeight,s="x",u="y",l="width",c="height",h=o,f=a;t.flipXY&&(s="y",u="x",l="height",c="width",h=a,f=o);var d=function(t){var e=t.start,n=t.end,r=t.minPx,i=void 0===r?.1:r,o=t.maxPx,a=void 0===o?1:o,s=Math.max(e,n),u=Math.min(e,n),l=uh(-.1,1.2,s),c=uh(-.1,1.2,u),h=l*a-c*a,f=Math.max(i,h),d=(f-h)/2;return{actualDiff:f,startModifier:d,actualLow:c*a-d}}({start:n.start,end:n.end,minPx:n.box.minHeightPx,maxPx:f}),p=d.actualDiff,m=d.actualLow;return yn({},n.box,(qn(e={type:"rect"},s,(i+n.major)*h),qn(e,u,m),qn(e,c,p),qn(e,l,r*h),qn(e,"data",n.data||{}),qn(e,"collider",{type:null}),e))}function hh(t){var e,n=t.item,r=t.from,i=t.to,o=t.boxCenter,a=t.rendWidth,s=t.rendHeight,u="x1",l="y1",c="x2",h="y2",f=a,d=s;return t.flipXY&&(u="y1",l="x1",c="y2",h="x2",f=s,d=a),yn({},n.line,(qn(e={type:"line"},h,Math.floor(r*d)),qn(e,u,o*f),qn(e,l,Math.floor(i*d)),qn(e,c,o*f),qn(e,"data",n.data||{}),qn(e,"collider",{type:null}),e))}function fh(t){var e,n=t.item,r=t.key,i=t.position,o=t.width,a=t.boxCenter,s=t.rendWidth,u=t.rendHeight,l="x1",c="y1",h="x2",f="y2",d=s,p=u;t.flipXY&&(l="y1",c="x1",h="y2",f="x2",d=u,p=s);var m=o/2;return yn({type:"line"},n[r],(qn(e={},c,Math.floor(i*p)),qn(e,l,(a-m)*d),qn(e,f,Math.floor(i*p)),qn(e,h,(a+m)*d),qn(e,"r",m*d),qn(e,"cx",a*d),qn(e,"cy",i*p),qn(e,"width",o*d),qn(e,"data",n.data||{}),qn(e,"collider",{type:null}),e))}function dh(t,e,n){var r=e.box,i=r.width,o=r.maxWidthPx,a=r.minWidthPx,s=t>=0?1:-1,u=Math.min(s*t*i,isNaN(o)?n:o/n);return(u=isNaN(a)?u:Math.max(a/n,u))*s}sh("native",(function(t,e,n){var r,i,o={chart:t,mediator:e,element:n},a=[],s=!0;function u(){"function"==typeof r.enable&&(r.enable=r.enable.bind(o)()),r.enable&&Object.keys(r.events).forEach((function(t){var e=r.events[t].bind(o);n.addEventListener(t,e),a.push({key:t,listener:e})}))}function l(){a.forEach((function(t){var e=t.key,r=t.listener;n.removeEventListener(e,r)})),a=[]}return{get key(){return i},set:function(t){!function(t){i=t.key,(r=t).events=r.events||[],void 0===r.enable&&(r.enable=!0)}(t),l(),s&&u()},off:function(){s=!1,l()},on:function(){s=!0,0===a.length&&u()},destroy:function(){l(),o=null,r=null}}}));var ph={oob:{show:!0,type:"n-polygon",fill:"#999",stroke:"#000",strokeWidth:0,size:10,sides:3,startAngle:-90},box:{show:!0,fill:"#fff",stroke:"#000",strokeWidth:1,strokeLinejoin:"miter",width:1,maxWidthPx:void 0,minWidthPx:1,minHeightPx:1},line:{show:!0,stroke:"#000",strokeWidth:1},median:{show:!0,stroke:"#000",strokeWidth:1},whisker:{show:!0,stroke:"#000",strokeWidth:1,fill:"",type:"line",width:1}},mh=Object.keys(ph),gh={require:["chart","resolver","symbol"],defaultSettings:{settings:{},data:{},style:{box:"$shape",line:"$shape-guide",whisker:"$shape-guide",median:"$shape-guide--inverted"}},created:function(){this.state={}},render:function(t){var e=this,n=t.data,r=this.rect,i=r.width,o=r.height,a="horizontal"===this.settings.settings.orientation,s=this.style,u=this.resolver,l=this.symbol,c=mh.filter((function(t){return!e.settings.settings[t]||!1!==e.settings.settings[t].show})),h={};c.forEach((function(t){return h[t]=ph[t]}));var f=function(t){var e,n=t.keys,r=t.data,i=t.defaultSettings,o=t.style,a=t.settings,s=t.width,u=t.height,l=t.resolver,c=yn(!0,{},i||{},o||{}),h={major:"horizontal"===a.orientation?u:s,minor:"horizontal"===a.orientation?s:u},f=a.major;e="object"===wn(f)&&"object"===wn(f.ref)&&void 0!==f.ref.start&&void 0!==f.ref.end?l.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:yn(!0,{},{binStart:{scale:a.major.scale,ref:a.major.ref.start},binEnd:{scale:a.major.scale,ref:a.major.ref.end}})}):"object"===wn(f)&&void 0!==f.binStart&&void 0!==f.binEnd?l.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:yn(!0,{},{binStart:{scale:a.major.scale,ref:"binStart"},binEnd:{scale:a.major.scale,ref:"binEnd"}},a.major)}):l.resolve({data:r,scaled:h,defaults:{major:.5},settings:{major:a.major}});var d=a.minor||{},p={};["start","end","min","max","med"].forEach((function(t){(d[t]||r.items&&r.items.length&&r.items[0][t])&&(p[t]={scale:d.scale,ref:t})}));for(var m,g={major:e,minor:l.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:yn(!0,{},p,d)})},y=0,v=n.length;y<v;y++)a[m]&&!1===a[m].show||(g[m=n[y]]=l.resolve({data:r,defaults:c[m],settings:a[m],scaled:h}));return g}({keys:c,data:n,defaultSettings:h,style:s,settings:this.settings.settings,width:i,height:o,resolver:u}),d=f.settings,p=function(t){var e=t.width,n=t.height,r=t.flipXY,i=t.resolved,o=t.keys,a=t.symbol,s=[],u=i.major.items;if(!u.length)return s;var l,c,h,f,d,p,m,g,y,v=e,x=n,b=r?n:e,w=i.major.settings,M=["start","end","min","max","med"].filter((function(t){return void 0!==i.minor.settings[t]})),k=M.length,_=o.filter((function(t){return"oob"!==t})),q=o?o.length:0,D=_?_.length:0,S={box:function(){h.box&&Vn(h.start)&&Vn(h.end)&&l.push(ch({item:h,boxWidth:f,boxPadding:d,rendWidth:v,rendHeight:x,flipXY:r}))},line:function(){Vn(h.min)&&Vn(h.start)&&l.push(hh({item:h,from:h.min,to:h.start,boxCenter:p,rendWidth:v,rendHeight:x,flipXY:r})),Vn(h.max)&&Vn(h.end)&&l.push(hh({item:h,from:h.max,to:h.end,boxCenter:p,rendWidth:v,rendHeight:x,flipXY:r}))},median:function(){h.median&&Vn(h.med)&&l.push(fh({item:h,key:"median",position:h.med,width:f,boxCenter:p,rendWidth:v,rendHeight:x,flipXY:r}))},whisker:function(){if(h.whisker){var t=f*h.whisker.width;Vn(h.min)&&l.push(fh({item:h,key:"whisker",position:h.min,width:t,boxCenter:p,rendWidth:v,rendHeight:x,flipXY:r})),Vn(h.max)&&l.push(fh({item:h,key:"whisker",position:h.max,width:t,boxCenter:p,rendWidth:v,rendHeight:x,flipXY:r}))}}};function C(){for(var t,e=-Number.MAX_VALUE,n=Number.MAX_VALUE,r=0;r<k;r++)Vn(t=h[M[r]])&&(e<t&&(e=t),n>t&&(n=t));m=e<0&&e!==-Number.MAX_VALUE,g=n>1&&n!==Number.MAX_VALUE,y=m||g}for(var E=0,A=u.length;E<A;E++){l=[],c=null;var N=u[E],O=N.data,I=null,T=null;void 0!==w.binStart?(I=N.binStart,T=N.binEnd,c=w.binStart.scale):I=(c=w.major.scale)?N.major:0;var R=0;c?c.bandwidth?I-=(R=c.bandwidth())/2:R=T-I:R=1,h=yn({},{major:I,majorEnd:T},i.minor.items[E]);for(var P=0;P<q;P++)h[o[P]]=i[o[P]].items[E];if(f=dh(R,h,b),p=(d=(R-f)/2)+h.major+f/2,C(),y)h.oob&&(m?l.push(lh({item:h,value:0,boxCenter:p,rendWidth:v,rendHeight:x,flipXY:r,symbol:a})):g&&l.push(lh({item:h,value:1,boxCenter:p,rendWidth:v,rendHeight:x,flipXY:r,symbol:a})));else for(var F=0;F<D;F++)h[_[F]]&&!1===h[_[F]].show||S[_[F]]();var L={type:"container",data:O,collider:{type:"bounds"},children:l};s.push(L)}return s}({items:f.items,settings:d,width:i,height:o,flipXY:a,resolved:f,keys:c,symbol:l});return p}};var yh={shape:"saltire",width:2,size:.5,fill:"#333",stroke:"#333",strokeWidth:0},vh=/px$/,xh={shape:"circle",label:"",fill:"#333",stroke:"#ccc",strokeDasharray:"",strokeWidth:0,strokeLinejoin:"miter",opacity:1,x:.5,y:.5,size:1,show:!0},bh={maxPx:1e4,minPx:1,maxRelExtent:.1,minRelExtent:.01,maxRelDiscrete:1,minRelDiscrete:.1};function wh(t,e){return t&&"function"==typeof t.bandwidth?{isBandwidth:!0,value:Math.max(1,t.bandwidth()*e)}:{isBandwidth:!1,value:Math.max(1,e)}}function Mh(t,e,n,r){var i=e.width,o=e.height;return t.filter((function(t){return!1!==t.show&&!isNaN(t.x+t.y)})).map((function(t){var e=t,a=vh.test(t.size)?parseInt(t.size,10):n.min+e.size*(n.max-n.min);Hn(a)&&(e=yh,a=n.min+e.size*(n.max-n.min));var s=function(t){var e=xh.shape,n={};return"object"===wn(t.shape)&&"string"==typeof t.shape.type?(e=t.shape.type,n=t.shape):"string"==typeof t.shape&&(e=t.shape),[e,n]}(e),u=Pn(s,2),l=u[0],c=bn(bn({},u[1]),{},{type:l,label:t.label,x:t.x*i,y:t.y*o,fill:e.fill,size:Math.min(n.maxGlobal,Math.max(n.minGlobal,a)),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeDasharray:e.strokeDasharray,opacity:e.opacity});e===t.errorShape&&(c.width=e.width);var h=r(c);return h.data=t.data,h}))}var kh={require:["chart","resolver","symbol"],defaultSettings:{settings:{},data:{},animations:{enabled:!1,trackBy:function(t){return t.data.value}},style:{item:"$shape"}},render:function(t){var e=t.data,n=this.resolver.resolve({data:e,defaults:yn({},xh,this.style.item),settings:this.settings.settings,scaled:{x:this.rect.width,y:this.rect.height}}),r=this.rect,i=r.width,o=r.height,a=yn({},bh,this.settings.settings.sizeLimits),s=n.items,u=function(t,e,n,r,i){var o=wh(t?t.scale:void 0,n),a=wh(e?e.scale:void 0,r),s=Math.min(o.value*i[o.isBandwidth?"maxRelDiscrete":"maxRelExtent"],a.value*i[a.isBandwidth?"maxRelDiscrete":"maxRelExtent"]),u=Math.min(o.value*i[o.isBandwidth?"minRelDiscrete":"minRelExtent"],a.value*i[a.isBandwidth?"minRelDiscrete":"minRelExtent"]);return{min:Math.max(1,Math.floor(u)),max:Math.max(1,Math.floor(s)),maxGlobal:i.maxPx,minGlobal:i.minPx}}(n.settings.x,n.settings.y,i,o,a);return Mh(s,this.rect,u,this.settings.shapeFn||this.symbol)}};Math.PI;var _h={label:"",arc:1,show:!0,fill:"#333",stroke:"#ccc",strokeWidth:1,strokeLinejoin:"round",opacity:1,innerRadius:0,outerRadius:.8,cornerRadius:0,offset:0};function qh(t,e,n,r){var i=e.x,o=e.y,a=e.width,s=e.height,u=function(){var t=yr,e=vr,n=rr(0),r=null,i=xr,o=br,a=wr,s=null;function u(){var u,l,c=+t.apply(this,arguments),h=+e.apply(this,arguments),f=i.apply(this,arguments)-dr,d=o.apply(this,arguments)-dr,p=ir(d-f),m=d>f;if(s||(s=u=nr()),h<c&&(l=h,h=c,c=l),h>hr)if(p>pr-hr)s.moveTo(h*ar(f),h*lr(f)),s.arc(0,0,h,f,d,!m),c>hr&&(s.moveTo(c*ar(d),c*lr(d)),s.arc(0,0,c,d,f,m));else{var g,y,v=f,x=d,b=f,w=d,M=p,k=p,_=a.apply(this,arguments)/2,q=_>hr&&(r?+r.apply(this,arguments):cr(c*c+h*h)),D=ur(ir(h-c)/2,+n.apply(this,arguments)),S=D,C=D;if(q>hr){var E=gr(q/c*lr(_)),A=gr(q/h*lr(_));(M-=2*E)>hr?(b+=E*=m?1:-1,w-=E):(M=0,b=w=(f+d)/2),(k-=2*A)>hr?(v+=A*=m?1:-1,x-=A):(k=0,v=x=(f+d)/2)}var N=h*ar(v),O=h*lr(v),I=c*ar(w),T=c*lr(w);if(D>hr){var R,P=h*ar(x),F=h*lr(x),L=c*ar(b),j=c*lr(b);if(p<fr&&(R=Mr(N,O,L,j,P,F,I,T))){var z=N-R[0],V=O-R[1],H=P-R[0],B=F-R[1],W=1/lr(mr((z*H+V*B)/(cr(z*z+V*V)*cr(H*H+B*B)))/2),U=cr(R[0]*R[0]+R[1]*R[1]);S=ur(D,(c-U)/(W-1)),C=ur(D,(h-U)/(W+1))}}k>hr?C>hr?(g=kr(L,j,N,O,h,C,m),y=kr(P,F,I,T,h,C,m),s.moveTo(g.cx+g.x01,g.cy+g.y01),C<D?s.arc(g.cx,g.cy,C,or(g.y01,g.x01),or(y.y01,y.x01),!m):(s.arc(g.cx,g.cy,C,or(g.y01,g.x01),or(g.y11,g.x11),!m),s.arc(0,0,h,or(g.cy+g.y11,g.cx+g.x11),or(y.cy+y.y11,y.cx+y.x11),!m),s.arc(y.cx,y.cy,C,or(y.y11,y.x11),or(y.y01,y.x01),!m))):(s.moveTo(N,O),s.arc(0,0,h,v,x,!m)):s.moveTo(N,O),c>hr&&M>hr?S>hr?(g=kr(I,T,P,F,c,-S,m),y=kr(N,O,L,j,c,-S,m),s.lineTo(g.cx+g.x01,g.cy+g.y01),S<D?s.arc(g.cx,g.cy,S,or(g.y01,g.x01),or(y.y01,y.x01),!m):(s.arc(g.cx,g.cy,S,or(g.y01,g.x01),or(g.y11,g.x11),!m),s.arc(0,0,c,or(g.cy+g.y11,g.cx+g.x11),or(y.cy+y.y11,y.cx+y.x11),m),s.arc(y.cx,y.cy,S,or(y.y11,y.x11),or(y.y01,y.x01),!m))):s.arc(0,0,c,w,b,m):s.lineTo(I,T)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-fr/2;return[ar(r)*n,lr(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:rr(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:rr(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:rr(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:rr(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:rr(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:rr(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:rr(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}(),l={x:i+a/2,y:o+s/2},c=Math.min(a,s)/2,h=Math.min(a,s)/2,f=h/100;return t.map((function(t,e){var i=n[e];i.type="path";var o=h*i.outerRadius,a=c*i.innerRadius;u.innerRadius(a),u.outerRadius(o),u.cornerRadius(f*i.cornerRadius),i.d=u(t);var s=u.centroid(t),d=i.offset?function(t,e,n,r){var i=Pn(t,2),o=i[0],a=i[1],s=Math.sqrt(o*o+a*a),u=n-r;return{x:(o/=s)*e*u,y:(a/=s)*e*u}}(s,i.offset,o,a):{x:0,y:0};return i.transform="translate(".concat(d.x,", ").concat(d.y,") translate(").concat(l.x,", ").concat(l.y,")"),i.desc={share:t.value/r,slice:{start:t.startAngle,end:t.endAngle,innerRadius:a,outerRadius:o,offset:{x:l.x+d.x,y:l.y+d.y}}},i}))}function Dh(t,e){return t.slice&&"arc"in t.slice?e.arc:e.data.value}var Sh={require:["chart","resolver"],defaultSettings:{settings:{startAngle:0,endAngle:2*Math.PI,padAngle:0,slice:{}},style:{slice:"$shape"},data:{}},render:function(t){for(var e=t.data,n=[],r=[],i=this.settings.settings,o=this.resolver.resolve({data:e,defaults:yn({},_h,this.style.slice),settings:i.slice}).items,a=0,s=0,u=o.length;s<u;s++){var l=Dh(i,o[s]);l>0&&o[s].outerRadius>=o[s].innerRadius&&(n.push(l),r.push(o[s]),a+=l)}var c=function(){var t=Ar,e=Er,n=null,r=rr(0),i=rr(pr),o=rr(0);function a(a){var s,u,l,c,h,f=a.length,d=0,p=new Array(f),m=new Array(f),g=+r.apply(this,arguments),y=Math.min(pr,Math.max(-pr,i.apply(this,arguments)-g)),v=Math.min(Math.abs(y)/f,o.apply(this,arguments)),x=v*(y<0?-1:1);for(s=0;s<f;++s)(h=m[p[s]=s]=+t(a[s],s,a))>0&&(d+=h);for(null!=e?p.sort((function(t,n){return e(m[t],m[n])})):null!=n&&p.sort((function(t,e){return n(a[t],a[e])})),s=0,l=d?(y-f*x)/d:0;s<f;++s,g=c)u=p[s],c=g+((h=m[u])>0?h*l:0)+x,m[u]={data:a[u],index:s,value:h,startAngle:g,endAngle:c,padAngle:v};return m}return a.value=function(e){return arguments.length?(t="function"==typeof e?e:rr(+e),a):t},a.sortValues=function(t){return arguments.length?(e=t,n=null,a):e},a.sort=function(t){return arguments.length?(n=t,e=null,a):n},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:rr(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:rr(+t),a):i},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:rr(+t),a):o},a}().sortValues(null);return c.startAngle(i.startAngle),c.endAngle(i.endAngle),c.padAngle(i.padAngle),qh(c(n),yn({},this.rect,{x:0,y:0}),r,a)}};var Ch=function(t){function e(e){if(t[e.type]&&t[e.type].condition(e)){var n=t[e.type],r=void 0===n.conditionAppend||n.conditionAppend(e);n.items.forEach((function(t){var n=Math.round(e[t.key]),i=e[t.key]-n;e[t.key]=n,r&&"append"===t.type&&(i>0?e[t.key]+=.5:e[t.key]-=.5)}))}}return void 0===t&&((t={}).line={append:["x1","x2","y1","y2"],round:[],condition:function(t){return t.x1===t.x2||t.y1===t.y2},conditionAppend:function(t){return t.strokeWidth%2!=0}},t.rect={append:["x","y"],round:["width","height"],condition:function(){return!0},conditionAppend:function(t){return t.strokeWidth%2!=0}}),Object.keys(t).forEach((function(e){var n=t[e];n.items=[],n.append.forEach((function(t){n.items.push({key:t,type:"append"})})),n.round.forEach((function(t){n.items.push({key:t,type:"round"})}))})),e.multiple=function(t){return t.forEach((function(t){return e(t)}))},e}(),Eh=function(){function t(){Mn(this,t),this.reset(),this.push.apply(this,arguments)}return _n(t,[{key:"transposeCoordinate",value:function(t,e,n){if("number"==typeof e&&isFinite(e)){var r=t.substring(0,1);if("x"===r||"cx"===t)return e*this.width;if("width"===t)return e*this.width;if("r"===t)return e*(n?this.height:this.width);if("y"===r||"cy"===t)return e*this.height;if("height"===t)return e*this.height}return e}},{key:"push",value:function(){var t;return(t=this.storage).push.apply(t,arguments),this}},{key:"processItem",value:function(e){var n={},r=void 0!==e.flipXY?e.flipXY:this.flipXY,i=void 0!==e.crisp?e.crisp:this.crisp;if(e.fn&&"function"==typeof e.fn){var o=r?this.height:this.width,a=r?this.width:this.height;e=e.fn({width:o,height:a,flipXY:r});for(var s=Object.keys(e),u=0,l=s.length;u<l;u++){var c=s[u];n[t.evaluateKey(c,r)]=e[c]}}else for(var h=Object.keys(e),f=0,d=h.length;f<d;f++){var p=h[f],m=t.evaluateKey(p,r),g=this.transposeCoordinate(m,e[p],r);n[m]=g}return i&&Ch(n),n}},{key:"output",value:function(){for(var t=[],e=0,n=this.storage.length;e<n;e++){var r=this.processItem(this.storage[e]);t.push(r)}return t}},{key:"reset",value:function(){this.storage=[],this.flipXY=!1,this.crisp=!1,this.width=0,this.height=0}}],[{key:"evaluateKey",value:function(t,e){if(e){var n=t.substring(0,1),r=t.substring(1);if("x"===n)return"y".concat(r);if("y"===n)return"x".concat(r);if("cx"===t)return"cy";if("cy"===t)return"cx";if("width"===t)return"height";if("height"===t)return"width"}return t}}]),t}();function Ah(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(Eh,e)}function Nh(t,e){return t&&e?t.cachedTicks&&t.cachedTicks()||t.ticks({distance:e}):[]}var Oh={created:function(){},require:["chart","renderer","resolver"],defaultSettings:{layout:{displayOrder:0},style:{ticks:"$guide-line",minorTicks:"$guide-line--minor"}},beforeRender:function(){this.blueprint=Ah(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this;if(this.x=this.settings.x?this.chart.scale(this.settings.x):null,this.y=this.settings.y?this.chart.scale(this.settings.y):null,rl(this,"x",this.rect.width),rl(this,"y",this.rect.height),!this.x&&!this.y)return[];this.settings.ticks=yn({show:!0},this.style.ticks,this.settings.ticks||{}),this.settings.minorTicks=yn({show:!1},this.style.minorTicks,this.settings.minorTicks||{}),this.lines={x:[],y:[]},this.lines.x=Nh(this.x,this.rect.width),this.lines.y=Nh(this.y,this.rect.height),this.lines.y=this.lines.y.map((function(t){return yn(t,{flipXY:!0})}));var e=function(e){var n=e.dir,r=e.isMinor,i=t.lines[n].filter((function(t){return!!t.isMinor===r})),o=r?t.settings.minorTicks:t.settings.ticks;t.resolver.resolve({settings:o,data:{items:i,dir:n}}).items.forEach((function(e){var r=e.data;e.show&&t.blueprint.push({type:"line",x1:r.position,y1:0,x2:r.position,y2:1,stroke:e.stroke||"black",strokeWidth:void 0!==e.strokeWidth?e.strokeWidth:1,strokeDasharray:void 0!==e.strokeDasharray?e.strokeDasharray:void 0,flipXY:r.flipXY||!1,value:r.value,dir:n})}))};return e({dir:"x",isMinor:!1}),e({dir:"x",isMinor:!0}),e({dir:"y",isMinor:!1}),e({dir:"y",isMinor:!0}),this.blueprint.output()}};function Ih(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.8,"left"===r||"right"===r){var i="right"===r;return"\n      M ".concat(t," ").concat(e-n,"\n      A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(i?0:1,", ").concat(t," ").concat(e+n,"\n      L ").concat(i?t+n:t-n," ").concat(e," Z\n    ")}var o="bottom"===r;return"\n    M ".concat(t-n," ").concat(e,"\n    A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(o?1:0,", ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(o?e+n:e-n," Z\n  ")}function Th(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.75,"left"===r||"right"===r){var i="right"===r;return"\n      M ".concat(t+=i?1.5*n:-1.5*n," ").concat(e-n,"\n      L ").concat(t," ").concat(e+n,"\n      L ").concat(i?t+n:t-n," ").concat(e," Z\n    ")}var o="bottom"===r;return e+=o?1.5*n:-1.5*n,"\n    M ".concat(t-n," ").concat(e,"\n    L ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(o?e+n:e-n," Z\n  ")}function Rh(t){if(void 0===t)return 0;if("number"==typeof t&&isFinite(t))return t;if("string"==typeof t)switch(t){case"center":case"middle":return.5;case"bottom":case"right":return 1;default:return 0}return 0}function Ph(t){var e={value:t.value};return t.label&&(e.label=t.label.text),e}function Fh(t){return void 0!==("function"==typeof t.value?t.value():t.value)}function Lh(t,e){var n=t.min();if(n===t.max()){var r=function(t){var e=t.range();return 2===(null==e?void 0:e.length)&&e[0]>e[1]}(t);if(e<n)return r?2:-1;if(e>n)return r?-1:2}return t(e)}var jh={require:["chart","renderer"],defaultSettings:{layout:{displayOrder:0},style:{oob:{show:!0,width:10,fill:"#1A1A1A",stroke:"transparent",strokeWidth:0,opacity:1,text:{fontFamily:"Arial",stroke:"transparent",fill:"#fff",strokeWidth:0,opacity:1},triangle:{fill:"#4D4D4D",stroke:"transparent",strokeWidth:0,opacity:1},padding:{x:28,y:5}},line:{stroke:"#000"},label:{strokeWidth:0}}},preferredSize:function(){return 30},beforeRender:function(){this.blueprint=Ah(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this,e=this.settings;if(this.lines={x:[],y:[]},this.lines.x=e.lines&&e.lines.x||[],this.lines.y=e.lines&&e.lines.y||[],0===this.lines.x.length&&0===this.lines.y.length)return[];var n={x0:[],x1:[],y0:[],y1:[]};this.lines.x=this.lines.x.filter(Fh).map((function(e){if("function"==typeof e.value&&(e.value=e.value()),e.scale){var n=t.chart.scale(e.scale),r=Lh(n,e.value);return yn(e,{scale:n,position:r})}return yn(e,{position:e.value})})),this.lines.y=this.lines.y.filter(Fh).map((function(e){if("function"==typeof e.value&&(e.value=e.value()),e.scale){var n=t.chart.scale(e.scale),r=Lh(n,e.value);return yn(e,{scale:n,position:r,flipXY:!0})}return yn(e,{position:e.value,flipXY:!0})})),this.lines.x=this.lines.x.filter((function(t){return!(t.position<0||t.position>1)||(n["x".concat(t.position>1?1:0)].push(Ph(t)),!1)})),this.lines.y=this.lines.y.filter((function(t){return!(t.position<0||t.position>1)||(n["y".concat(t.position>1?1:0)].push(Ph(t)),!1)}));var r=[];return[].concat(Fn(this.lines.x),Fn(this.lines.y)).forEach((function(n){(!0===n.show||void 0===n.show)&&function(t){var e,n=t.chart,r=t.blueprint,i=t.renderer,o=t.p,a=t.settings,s=t.items,u=!0,l=!1,c=!1,h=!1,f=yn(!0,{},a.style.line,o.line||{});if(e=r.processItem({type:"line",x1:o.position,y1:0,x2:o.position,y2:1,stroke:f.stroke||"black",strokeWidth:f.strokeWidth||1,strokeDasharray:f.strokeDasharray,flipXY:o.flipXY||!1}),o.label){var d,p=yn(!0,{fill:"#000",fontFamily:"Arial",fontSize:"12px",opacity:1,maxWidth:1,maxWidthPx:9999,padding:5,background:{fill:"#fff",stroke:"transparent",strokeWidth:0,opacity:.5}},a.style.label||{},{fill:f.stroke},o.label),m={width:0,height:0},g="";if("string"==typeof o.formatter)d=n.formatter(o.formatter);else if("object"===wn(o.formatter))d=n.formatter(o.formatter);else if(void 0!==o.scale&&o.scale.data){var y=o.scale.data()&&o.scale.data().fields;d=y&&y[0]?y[0].formatter():null}!1!==o.label.showValue&&(d?g=" (".concat(d(o.value),")"):o.scale&&(g=" (".concat(o.value,")"))),g&&(m=i.measureText({text:g,fontFamily:p.fontFamily,fontSize:p.fontSize}));var v=i.measureText({text:p.text||"",fontFamily:p.fontFamily,fontSize:p.fontSize}),x={width:v.width+m.width,height:Math.max(v.height,m.height)},b=p.padding,w=Rh(o.flipXY?p.vAlign:p.align),M=Rh(o.flipXY?p.align:p.vAlign),k=Math.min(1+x.width+2*b,p.maxWidth*r.width,p.maxWidthPx),_=x.height+2*b,q=o.flipXY?_:k,D=o.flipXY?k:_;if(l=r.processItem({fn:function(t){var e=t.width,n=t.height,i=o.position*e-(o.flipXY?_:k)*(1-w);return{type:"rect",x:i=o.flipXY?i:Math.max(i,0),y:Math.max(Math.abs(M*n-D*M),0),width:o.flipXY?q:Math.min(q,r.width-i),height:D,stroke:p.background.stroke,strokeWidth:p.background.strokeWidth,fill:p.background.fill,opacity:p.background.opacity}},flipXY:o.flipXY||!1}),l.x<-1||l.x+l.width>r.width+1||l.y<-1||l.y+l.height>r.height+1)l=void 0;else{c={type:"text",text:p.text||"",fill:p.fill,opacity:p.opacity,fontFamily:p.fontFamily,fontSize:p.fontSize,x:l.x+b,y:l.y+l.height/2+x.height/3,maxWidth:l.width-2*b-m.width,anchor:"start"},g&&(h={type:"text",text:g||"",fill:p.fill,opacity:p.opacity,fontFamily:p.fontFamily,fontSize:p.fontSize,x:c.x+3+(l.width-(m.width+2*b)),y:c.y});for(var S=0,C=s.length;S<C;S++){var E=s[S];"rect"===E.type?nc(l,E)&&(u=!1):"line"===E.type&&o.flipXY===E.flipXY&&oc(l,E)&&(u=!1)}}}s.push(e),u&&l&&c&&(s.push(l,c),h&&s.push(h))}({chart:t.chart,blueprint:t.blueprint,renderer:t.renderer,p:n,settings:e,items:r})})),e.style.oob.show&&function(t){for(var e=t.blueprint,n=t.oob,r=t.settings,i=t.items,o=Object.keys(n),a=r.style.oob||{},s=function(t,r){var s=o[t],u=n[s];if(u.length>0){var l=s.charAt(1),c="y"===s.charAt(0),h=a.padding.x+a.width,f=a.padding.y+a.width,d="bottom";d=c?"1"===l?"bottom":"top":"1"===l?"right":"left";var p=e.processItem({fn:function(t){var e=t.width,n=t.height,r=l*e+("1"===l?-h:h),i=c?f:n-f;return"arc"===a.type?{type:"path",d:Ih(c?i:r,c?r:i,a.width,d),x:r,y:i,stroke:a.stroke,fill:a.fill,strokeWidth:a.strokeWidth||0}:{type:"circle",cx:r,cy:i,r:a.width,stroke:a.stroke,fill:a.fill,strokeWidth:a.strokeWidth||0,opacity:a.opacity,data:u}},flipXY:c}),m=p.cx||p.x,g=p.cy||p.y,y={type:"text",text:u.length||"",x:m-.4*a.width,y:g+.4*a.width,fontFamily:a.text.fontFamily,fontSize:"".concat(1.3*a.width,"px"),stroke:a.text.stroke,fill:a.text.fill,strokeWidth:a.text.strokeWidth||0,opacity:a.text.opacity},v={type:"path",d:Th(m,g,a.width,d),x:m,y:g,stroke:a.triangle.stroke,fill:a.triangle.fill,strokeWidth:a.triangle.strokeWidth||0,opacity:a.triangle.opacity};i.push(p,y,v)}},u=0,l=o.length;u<l;u++)s(u)}({blueprint:this.blueprint,oob:n,settings:e,items:r}),r}};function zh(t){var e={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===t.align||"bottom"===t.align?(e.x1=t.innerRect.x-t.outerRect.x,e.x2=e.x1+t.innerRect.width,e.y1=e.y2="top"===t.align?t.innerRect.height-t.padding:t.padding):(e.x1=e.x2="left"===t.align?t.innerRect.width-t.padding:t.padding,e.y1=t.innerRect.y-t.outerRect.y,e.y2=e.y1+t.innerRect.height),function(t,e){yn(t,e.style)}(e,t),e}function Vh(t){return"string"==typeof t||"number"==typeof t?t:"-"}function Hh(t,e,n){n.layered||!n.stepSize?function(t,e){e.collider={type:"polygon",vertices:[{x:e.boundingRect.x,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y+e.boundingRect.height},{x:e.boundingRect.x,y:e.boundingRect.y+e.boundingRect.height}]}}(0,e):n.tilted?function(t,e,n){var r=n.angle*(Math.PI/180),i=Math.max(n.stepSize/2,e.boundingRect.height/2),o="start"===e.anchor,a="end"===e.anchor&&r<0,s="start"===e.anchor&&r>=0,u=e.boundingRect.y+(s||a?e.boundingRect.height:0),l=[{x:e.x-i,y:u},{x:e.x+i,y:u}].map((function(t){return El(t,r,{x:e.x,y:e.y})})),c={x:o?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y+e.boundingRect.height},h={x:o?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y},f=r>=0?[c,h]:[h,c];l.push.apply(l,f),e.collider={type:"polygon",vertices:l}}(0,e,n):function(t,e,n){if("bottom"===n.align||"top"===n.align){var r=t.position*n.innerRect.width+(n.innerRect.x-n.outerRect.x-n.stepSize/2);e.collider={type:"rect",x:r,y:0,width:r<0?n.stepSize+r:n.stepSize,height:n.innerRect.height}}else{var i=t.position*n.innerRect.height+(n.innerRect.y-n.outerRect.y-n.stepSize/2);e.collider={type:"rect",x:0,y:i,width:n.innerRect.width,height:i<0?n.stepSize+i:n.stepSize}}var o=e.collider;o.x=Math.max(o.x,0),o.y=Math.max(o.y,0);var a=o.x+o.width-(n.outerRect.x+n.outerRect.width);o.width=a>0?o.width-a:o.width;var s=o.y+o.height-(n.outerRect.y+n.outerRect.height);o.height=s>0?o.height-s:o.height}(t,e,n)}function Bh(t,e){var n=isNaN(t.style.align)?.5:Math.min(Math.max(t.style.align,0),1),r=0;if(t.tilted)r=t.stepSize*n;else{var i=e?t.textRect.height:t.textRect.width;r=Math.max(0,t.stepSize-i)*n}return r}function Wh(t,e){var n={type:"text",text:Vh(t.label),x:0,y:0,maxWidth:e.maxWidth,maxHeight:e.maxHeight,tickValue:t.value};return"top"===e.align||"bottom"===e.align?(n.x=t.start*e.innerRect.width+(e.innerRect.x-e.outerRect.x)+Bh(e,!1),n.y="top"===e.align?e.innerRect.height:0,n.anchor=e.stepSize?"start":"middle",n.x+=isNaN(e.style.offset)?0:+e.style.offset):(n.y=t.start*e.innerRect.height+(e.innerRect.y-e.outerRect.y)+Bh(e,!0),n.x="left"===e.align?e.innerRect.width:0,n.anchor="left"===e.align?"end":"start",n.baseline=e.stepSize?"text-before-edge":"central",n.y+=isNaN(e.style.offset)?0:+e.style.offset),function(t,e){["fill","fontSize","fontFamily"].forEach((function(n){t[n]=e.style[n]}))}(n,e),function(t,e){if(!e.tilted&&!e.stepSize)if("top"===e.align||"bottom"===e.align){var n=e.outerRect.width,r=Math.min(e.maxWidth/2,e.textRect.width/2),i=t.x-r,o=t.x+r;i<0?(t.anchor="start",t.x=e.innerRect.x-e.outerRect.x):o>n&&(t.anchor="end",t.x=e.innerRect.width+e.innerRect.x)}else{var a=e.outerRect.height,s=e.maxHeight/2,u=t.y-s,l=t.y+s;u<0?(t.y=e.innerRect.y-e.outerRect.y,t.baseline="text-before-edge"):l>a&&(t.y=e.innerRect.height+(e.innerRect.y-e.outerRect.y),t.baseline="text-after-edge")}}(n,e),function(t,e){"top"===e.align?t.y-=e.padding:"bottom"===e.align?t.y+=e.padding+e.maxHeight:"left"===e.align?t.x-=e.padding:"right"===e.align&&(t.x+=e.padding)}(n,e),function(t,e){if(e.tilted){var n=-e.angle,r=n*(Math.PI/180);"bottom"===e.align?(t.x-=e.maxHeight*Math.sin(r)/2,t.y-=e.maxHeight,t.y+=e.maxHeight*Math.cos(r)/2):t.x-=e.maxHeight*Math.sin(r)/3,t.transform="rotate(".concat(n,", ").concat(t.x,", ").concat(t.y,")"),t.anchor="bottom"===e.align==e.angle<0?"start":"end";var i=Math.cos(r)*e.maxWidth;if("bottom"===e.align==e.angle<0){var o=e.outerRect.width-e.paddingEnd;t.x+i>o&&(t.maxWidth=(o-t.x-10)/Math.cos(r))}else{var a=e.paddingEnd;t.x-i<a&&(t.maxWidth=(t.x-a-10)/Math.cos(r))}}}(n,e),function(t,e){t.boundingRect=e.textBounds(t)}(n,e),Hh(t,n,e),n}function Uh(t,e){var n={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null},tickValue:t.value};return"top"===e.align||"bottom"===e.align?(n.x1=n.x2=t.position*e.innerRect.width+(e.innerRect.x-e.outerRect.x),n.y1="top"===e.align?e.innerRect.height:0,n.y2="top"===e.align?n.y1-e.tickSize:n.y1+e.tickSize):(n.y1=n.y2=t.position*e.innerRect.height+(e.innerRect.y-e.outerRect.y),n.x1="left"===e.align?e.innerRect.width:0,n.x2="left"===e.align?n.x1-e.tickSize:n.x1+e.tickSize),function(t,e){yn(t,e.style)}(n,e),function(t,e){"top"===e.align?(t.y1-=e.padding,t.y2-=e.padding):"bottom"===e.align?(t.y1+=e.padding,t.y2+=e.padding):"left"===e.align?(t.x1-=e.padding,t.x2-=e.padding):"right"===e.align&&(t.x1+=e.padding,t.x2+=e.padding)}(n,e),function(t,e){var n=t.strokeWidth/2;t.x1===e.innerRect.width?(t.x1-=n,t.x2-=n):0===t.x1?(t.x1+=n,t.x2+=n):t.y1===e.innerRect.height?(t.y1-=n,t.y2-=n):0===t.y1&&(t.y1+=n,t.y2+=n)}(n,e),n}function Yh(t){return!t.isMinor&&t.position>=0&&t.position<=1}function $h(t){var e=t.rect,n=t.state,r=t.majorTicks,i=t.measure;return t.horizontal?function(t){for(var e=t.majorTicks,n=t.measureText,r=t.rect,i="layered"===t.state.labels.activeMode?2:1,o=r.width,a=e.map((function(t){return t.label})).map((function(t){return"".concat(t.slice(0,1)).concat(t.length>1?"":"")})).map(n).map((function(t){return t.width})),s=0;s<e.length;++s){var u=e[s];if(i*o*Math.abs(u.start-u.end)<a[s])return!0}return!1}({majorTicks:r,measureText:i,rect:e,state:n}):function(t){var e=t.majorTicks,n=t.measureText,r=t.rect.height,i=n("M").height;return!(e.length<2)&&r*Math.abs(e[0].position-e[1].position)<i}({majorTicks:r,measureText:i,rect:e,state:n})}function Xh(t){var e=t.value,n=t.maxValue,r=t.minValue,i=t.range,o=t.modifier;return isNaN(i)||isNaN(o)||(e=i*o),e>n&&(e=n),e<r&&(e=r),e}function Gh(t){var e=t.isDiscrete,n=t.rect,r=t.formatter,i=t.measureText,o=t.scale,a=t.settings,s=t.state,u=0,l={left:0,top:0,right:0,bottom:0},c=a.labels,h=c.maxLengthPx,f=c.minLengthPx;if(a.labels.show){var d,p,m=a.align,g="top"===m||"bottom"===m,y=g?n.inner.width:n.inner.height,v=o.ticks({settings:a,distance:y,formatter:r}).filter(Yh),x=function(t){var e=i({text:t,fontSize:a.labels.fontSize,fontFamily:a.labels.fontFamily});return e.width=Xh({value:e.width,maxValue:h,minValue:f}),e};if(e&&g&&"auto"===a.labels.mode&&(!function(t){var e=t.majorTicks,n=t.measure,r=t.rect,i=t.state,o=t.settings,a=o.labels.maxGlyphCount,s="layered"===i.labels.activeMode?2:1,u=o.labels.tiltThreshold?o.labels.tiltThreshold:.7,l=n("").width,c=r.width,h=0;if(isNaN(a))for(var f=0;f<e.length;f++){var d=e[f],p=d.label;if(n(p).width*(p.length>1?u:1)+l>(h=s*c*Math.abs(d.start-d.end)))return!0}else if(h=s*c*e.reduce((function(t,e){return Math.min(Math.abs(e.start-e.end),t)}),1/0),n("M").width*u*a+l>h)return!0;return!1}({majorTicks:v,measure:x,rect:n.inner,state:s,settings:a})?s.labels.activeMode="horizontal":s.labels.activeMode="tilted"),!a.labels.filterOverlapping&&"tilted"!==s.labels.activeMode&&$h({rect:n.inner,state:s,majorTicks:v,measure:x,horizontal:g}))return{size:Math.max(n.outer.width,n.outer.height),isToLarge:!0};if("tilted"===s.labels.activeMode){var b=Math.abs(a.labels.tiltAngle)*(Math.PI/180);d=function(t){return Xh({value:t.width,maxValue:h,minValue:f})*Math.sin(b)+t.height*Math.cos(b)}}else d=g?function(t){return t.height}:function(t){return Xh({value:t.width,maxValue:h,minValue:f})};if(g&&"tilted"!==s.labels.activeMode)p=["M"];else if(isNaN(a.labels.maxGlyphCount))p=v.map((function(t){return t.label}));else{for(var w="",M=0;M<a.labels.maxGlyphCount;M++)w+="M";p=[w]}var k=p.map(x),_=k.map(d),q=Math.max.apply(Math,Fn(_).concat([0]));if(u+=q,u+=a.labels.margin,"layered"===s.labels.activeMode&&(u*=2),"tilted"===s.labels.activeMode){var D="bottom"===a.align==a.labels.tiltAngle>=0,S=Math.abs(a.labels.tiltAngle)*(Math.PI/180),C=(q-i("M").height*Math.cos(S))/Math.sin(S),E=Math.min(a.labels.maxEdgeBleed,Math.max.apply(Math,Fn(k.map((function(t){return Math.min(C,t.width)*Math.cos(S)+t.height})).map((function(t,e){var r=v[e]?v[e].position:0;return D?t-r*n.inner.width:t-(1-r)*n.inner.width}))).concat([0])))+a.paddingEnd;if(l[D?"left":"right"]=E,!a.labels.filterOverlapping&&function(t){var e=t.majorTicks,n=t.measureText,r=t.rect,i=t.bleedSize,o=t.angle;if(e.length<2)return!1;if(0===o)return!0;var a=Math.abs(o),s=1/(Math.min(r.outer.width-i,r.inner.width)*Math.abs(e[0].position-e[1].position));return n("M").height>Math.sin(a*(Math.PI/180))/s}({majorTicks:v,measureText:i,rect:n,bleedSize:E,angle:a.labels.tiltAngle}))return{size:Math.max(n.outer.width,n.outer.height),isToLarge:!0}}}return{size:u,edgeBleed:l}}var Kh=function(t,e,n){return t.width*Math.abs(e.position-n.position)};function Jh(t){var e=t.layered,n=t.major,r=t.innerRect,i=t.outerRect,o=t.tick,a=t.index,s=e?2:1,u=n[a-s],l=n[a+s],c=u?Kh(r,o,u)/2-2:1/0,h=l?Kh(r,o,l)/2-2:1/0;return n.length<2?r.width:u?l?2*Math.min(c,h):function(t){var e=t.innerRect,n=t.outerRect,r=t.tick,i=t.prevWidth,o=e.x-n.x,a=n.width-e.width-o,s=e.width-e.width*r.position+a,u=2*Math.min(i,s),l=1===r.position?e.width/2-2:0;return Math.max(i,u,l)}({innerRect:r,outerRect:i,tick:o,prevWidth:c}):function(t){var e=t.innerRect,n=t.outerRect,r=t.tick,i=t.nextWidth,o=e.x-n.x,a=e.width*r.position+o,s=2*Math.min(i,a),u=0===r.position?e.width/2-2:0;return Math.max(i,s,u)}({innerRect:r,outerRect:i,tick:o,nextWidth:h})}function Zh(t){var e=0;return e+=t.paddingStart,e+=t.line.show?t.line.strokeWidth/2:0,e+=t.ticks.show?t.ticks.margin:0}function Qh(t){var e=0;return e+=t.ticks.show?t.ticks.tickSize:0,e+=Zh(t)+t.labels.margin}function tf(t,e){return t.map((function(t){return Uh(t,e)}))}function ef(t,e){return e?Math.abs(e.end-e.start):t.bandwidth()}function nf(t){var e=t.textMetrics,n=t.settings,r=t.innerRect,i=t.scale,o=t.tilted,a=t.layered,s=t.tick,u=e.height,l=ef(i,s),c={width:0,height:u};if("left"===n.align||"right"===n.align)c.width=r.width-Qh(n)-n.paddingEnd;else if(a)c.width=l*r.width*2;else if(o){var h=Math.abs(n.labels.tiltAngle)*(Math.PI/180);c.width=(r.height-Qh(n)-n.paddingEnd-u*Math.cos(h))/Math.sin(h)}else c.width=l*r.width;return c.width=Xh({value:c.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),c}function rf(t){var e=t.textMetrics,n=t.settings,r=t.innerRect,i=t.outerRect,o=t.tilted,a=t.layered,s=t.tick,u=t.index,l=t.major,c=e.height,h={width:0,height:c};if("left"===n.align||"right"===n.align)h.width=r.width-Qh(n)-n.paddingEnd;else if(o){var f=Math.abs(n.labels.tiltAngle)*(Math.PI/180);h.width=(r.height-Qh(n)-n.paddingEnd-c*Math.cos(f))/Math.sin(f)}else h.width=Jh({layered:a,major:l,innerRect:r,outerRect:i,tick:s,index:u});return h.width=Xh({value:h.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),h}function of(t){var e;function n(){return e=rf,n}function r(){return e=nf,r}function i(t){var n,r=t.settings,i=t.scale,o=t.innerRect,a=t.outerRect,s=t.measureText,u=t.ticks,l=t.state,c=t.textBounds,h=[],f=function(t){return t.filter((function(t){return!t.isMinor}))}(u),d=function(t){return t.filter((function(t){return t.isMinor}))}(u),p={innerRect:o,align:r.align,outerRect:a},m="tilted"===l.labels.activeMode,g="layered"===l.labels.activeMode;if(r.line.show&&(p.style=r.line,p.padding=r.paddingStart,h.push(zh(p))),r.ticks.show&&(p.style=r.ticks,p.tickSize=r.ticks.tickSize,p.padding=Zh(r),n=tf(f,p)),r.labels.show){var y=Qh(r);p.style=r.labels,p.padding=y,p.tilted=m,p.layered=g,p.angle=r.labels.tiltAngle,p.paddingEnd=r.paddingEnd,p.textBounds=c;var v=function(t,n){p.textRect=function(t){var e=t.style;return(0,t.measureText)({text:t.tick.label,fontSize:e.fontSize,fontFamily:e.fontFamily})}({tick:t,measureText:s,style:p.style});var l=e({textMetrics:p.textRect,settings:r,innerRect:o,outerRect:a,scale:i,tilted:m,layered:g,tick:t,major:f,index:n});p.maxWidth=l.width,p.maxHeight=l.height,p.stepSize=function(t){var e=t.innerRect,n=t.scale,r=t.settings,i=t.tick;return("top"===r.align||"bottom"===r.align?e.width:e.height)*ef(n,i)}({innerRect:o,scale:i,ticks:u,settings:r,tick:t})},x=[];x=!g||"top"!==r.align&&"bottom"!==r.align?function(t,e,n){return t.map((function(t,r){n(t,r);var i=Wh(t,e);return i.data=t.data,i}))}(f,p,v):function(t,e,n,r){var i=e.padding,o=Qh(n);return t.map((function(t,a){r(t,a);var s=o+e.maxHeight+n.labels.margin;e.layer=a%2,e.padding=a%2==0?i:s;var u=Wh(t,e);return u.data=t.data,u}))}(f,p,r,v),r.labels.filterOverlapping&&function(t,e,n){var r=function(e,n){return nc(Gn(1,t[e].boundingRect),Gn(1,t[n].boundingRect))};if(n&&n.tilted){var i=Math.abs(n.angle);r=function(e,n){var r=1/Math.abs(t[e].x-t[n].x),o=Math.sin(i*(Math.PI/180))/r;return t[e].boundingRect.height>o}}for(var o=0;o<=t.length-1;o++)for(var a=o+1;a<=Math.min(o+5,o+(t.length-1));a++)t[o]&&t[a]&&r(o,a)&&(a===t.length-1?(t.splice(o,1),e&&e.splice(o,1)):(t.splice(a,1),e&&e.splice(a,1)),a--,o--)}(x,n,p),h.push.apply(h,Fn(x))}return r.minorTicks&&r.minorTicks.show&&d.length>0&&(p.style=r.minorTicks,p.tickSize=r.minorTicks.tickSize,p.padding=function(t){return t.line.strokeWidth+t.minorTicks.margin}(r),h.push.apply(h,Fn(tf(d,p)))),n&&h.push.apply(h,Fn(n)),h}return n.build=i,r.build=i,t?r():n()}var af={labels:{show:!0,tiltAngle:40,tiltThreshold:.7,maxEdgeBleed:1/0,margin:4,maxLengthPx:150,minLengthPx:0,mode:"auto",maxGlyphCount:NaN,align:.5,offset:0,filterOverlapping:!1},ticks:{show:!1,margin:0,tickSize:4},line:{show:!1},paddingStart:0,paddingEnd:10,align:"auto"},sf={labels:{show:!0,margin:4,maxLengthPx:150,minLengthPx:0,align:.5,offset:0,filterOverlapping:!0},ticks:{show:!0,margin:0,tickSize:8},minorTicks:{show:!1,tickSize:3,margin:0},line:{show:!0},paddingStart:0,paddingEnd:10,align:"auto"};var uf={require:["chart","renderer","dockConfig"],defaultSettings:{layout:{displayOrder:0,prioOrder:0},settings:{},style:{labels:"$label",ticks:"$guide-line",minorTicks:"$guide-line--minor",line:"$guide-line"}},created:function(){this.state={isDiscrete:!!this.scale.bandwidth,isHorizontal:!1,labels:{activeMode:"horizontal"},ticks:[],innerRect:{width:0,height:0,x:0,y:0},outerRect:{width:0,height:0,x:0,y:0},defaultDock:void 0,concreteNodeBuilder:void 0,settings:void 0},this.state.isDiscrete?this.state.defaultDock="bottom":this.state.defaultDock="left",this.setState(this.settings)},setState:function(){var t,e,n,r;this.state.isDiscrete=!!this.scale.bandwidth,this.state.settings=function(t){var e=t.state,n=t.style,r=t.settings,i=yn(!0,{},e.isDiscrete?af:sf,n),o=yn(!0,{},i,r.settings),a=r.layout.dock||e.defaultDock;o.dock=a,o.align=function(t,e){var n=["top","bottom"],r=["left","right"];return-1!==n.indexOf(t)&&-1===r.indexOf(e)||-1!==r.indexOf(t)&&-1===n.indexOf(e)?t:e}(r.settings.align,a),o.labels.tiltAngle=Math.max(-90,Math.min(o.labels.tiltAngle,90));var s=o.paddingStart,u=o.paddingEnd;return o.paddingStart="function"==typeof s?s.call(null):s,o.paddingEnd="function"==typeof u?u.call(null):u,o}(this),this.state.concreteNodeBuilder=of(this.state.isDiscrete),this.dockConfig.dock(this.state.settings.dock),this.state.isHorizontal="top"===this.state.settings.align||"bottom"===this.state.settings.align,this.state.labels.activeMode=(t=this.state,e=this.state.settings,n=this.state.isDiscrete,r=e.labels.mode,n&&t.isHorizontal?"auto"===r?t.labels.activeMode:-1!==["layered","tilted"].indexOf(e.labels.mode)&&-1!==["top","bottom"].indexOf(e.dock)?r:"horizontal":"horizontal")},preferredSize:function(t){var e=this.formatter,n=this.state,r=this.scale,i=this.state.isHorizontal?t.inner.width:t.inner.height;this.state.pxScale=il(r,i);var o=function(t){var e=t.isDiscrete,n=t.rect,r=t.formatter,i=t.measureText,o=t.scale,a=t.settings,s=0,u=Gh({isDiscrete:e,rect:n,formatter:r,measureText:i,scale:o,settings:a,state:t.state}),l=u.size,c=u.edgeBleed;if(s+=l,u.isToLarge)return{size:s};if(a.ticks.show&&(s+=a.ticks.margin,s+=a.ticks.tickSize),a.minorTicks&&a.minorTicks.show){var h=a.minorTicks.margin+a.minorTicks.tickSize;h>s&&(s=h)}if(a.line.show){var f=a.line.strokeWidth/2;s+=f,c[function(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"left":return"right";case"right":return"left";default:return t}}(a.align)]=Math.ceil(f)}return s+=a.paddingStart,{size:s+=a.paddingEnd,edgeBleed:c}}({isDiscrete:this.state.isDiscrete,rect:{inner:t.inner,outer:t.outer},formatter:e,measureText:this.renderer.measureText,scale:this.state.pxScale,settings:this.state.settings,state:n});return o},beforeUpdate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.settings;this.setState(e)},resize:function(t){var e=t.inner,n=t.outer,r=yn({},e,function(t){var e=t.align,n=t.inner;return"left"===e?{x:n.width+n.x}:"right"===e||"bottom"===e?n:{y:n.y+n.height}}({align:this.state.settings.align,inner:e})),i=n||r;return yn(this.state.innerRect,r),yn(this.state.outerRect,i),n},beforeRender:function(){var t=this.scale,e=this.formatter,n=this.state.isHorizontal?this.state.innerRect.width:this.state.innerRect.height;this.state.pxScale=il(t,n),this.state.ticks=this.state.pxScale.ticks({distance:n,formatter:e}).filter((function(t){return t.position>=0&&t.position<=1}))},render:function(){var t=this.state,e=[];return e.push.apply(e,Fn(this.state.concreteNodeBuilder.build({settings:this.state.settings,scale:this.state.pxScale,innerRect:this.state.innerRect,outerRect:this.state.outerRect,measureText:this.renderer.measureText,textBounds:this.renderer.textBounds,ticks:this.state.ticks,state:t}))),Ch.multiple(e),e}};var lf={render:function(){return[]}};function cf(t,e,n){var r="";if("function"==typeof t)r=t();else if("string"==typeof t)r=t;else if(n){var i=(n.data().fields||[]).map((function(t){return t.title()}));r=i.join(e)}return r}function hf(t,e){var n="middle";return"left"===t?"top"===e?n="end":"bottom"===e&&(n="start"):"right"===t?"top"===e?n="start":"bottom"===e&&(n="end"):"left"===e?n="start":"right"===e&&(n="end"),n}var ff={require:["renderer","chart"],defaultSettings:{layout:{dock:"bottom",displayOrder:0,prioOrder:0},settings:{paddingStart:5,paddingEnd:5,paddingLeft:0,paddingRight:0,anchor:"center",join:", ",maxLengthPx:NaN},style:{text:"$title"}},created:function(){this.definitionSettings=this.settings.settings;var t=this.settings.text,e=this.definitionSettings.join;this.title=cf(t,e,this.scale)},preferredSize:function(){return this.renderer.measureText({text:this.title,fontSize:this.style.text.fontSize,fontFamily:this.style.text.fontFamily}).height+this.definitionSettings.paddingStart+this.definitionSettings.paddingEnd},render:function(){var t=this.title,e=this.definitionSettings,n=this.rect,r=[];return r.push(function(t){var e=t.title,n=t.definitionSettings,r=t.dock,i=t.rect,o=t.measureText,a=t.style,s={type:"text",text:e,x:0,y:0,dx:0,dy:0,anchor:hf(r,n.anchor),baseline:"alphabetical"};yn(s,a.text);var u=o(s);if("top"===r||"bottom"===r){var l=i.width/2;"left"===n.anchor?l=n.paddingLeft||0:"right"===n.anchor&&(l=i.width-(n.paddingRight||0)),s.x=l,s.y="top"===r?i.height-n.paddingStart:n.paddingStart+u.height,s.dy="top"===r?-u.height/6:-u.height/3,s.maxWidth=.8*i.width}else{var c=i.height/2;"top"===n.anchor?c=n.paddingStart:"bottom"===n.anchor&&(c=i.height-n.paddingStart),s.y=c,s.x="left"===r?i.width-n.paddingStart:n.paddingStart,s.dx="left"===r?-u.height/3:u.height/3;var h="left"===r?270:90;s.transform="rotate(".concat(h,", ").concat(s.x+s.dx,", ").concat(s.y+s.dy,")"),s.maxWidth=.8*i.height}return isNaN(n.maxLengthPx)||(s.maxWidth=Math.min(s.maxWidth,n.maxLengthPx)),s}({title:t,dock:this.settings.layout.dock,definitionSettings:e,rect:n,measureText:this.renderer.measureText,style:this.style})),r},beforeUpdate:function(t){t.settings&&(yn(this.settings,t.settings),this.definitionSettings=t.settings.settings);var e=this.settings.text,n=this.definitionSettings.join;this.title=cf(e,n,this.scale)}};function df(t,e){var n,r=t.settings.layout.dock,i=t.settings.settings.invert,o="top"===r||"bottom"===r,a=o?"width":"height",s=t.rect[a],u=t.chart.scroll(t.settings.scroll),l=e[o?"x":"y"];i&&(l=s-l);var c=u.getState();n={startOffset:l,startScroll:c.start,swipe:!1};var h=l/s*(c.max-c.min)+c.min;h<c.start?n.startScroll=h:h>c.start+c.viewSize&&(n.startScroll=h-c.viewSize);return{update:function(t){var e=t[o?"x":"y"];if(i&&(e=s-e),!n.swipe){if(Math.abs(n.startOffset-e)<=1)return;n.swipe=!0}var r=u.getState(),a=(e-n.startOffset)/s*(r.max-r.min),l=n.startScroll+a;u.moveTo(l)},end:function(t){var e=t[o?"x":"y"];i&&(e=s-e);var r=u.getState();if(n.swipe){var a=(e-n.startOffset)/s*(r.max-r.min),l=n.startScroll+a;u.moveTo(l)}else{var c=e/s*(r.max-r.min)+r.min-r.viewSize/2;u.moveTo(c)}}}}function pf(t,e){var n=e.element().getBoundingClientRect();return{x:t.center.x-n.left,y:t.center.y-n.top}}var mf={require:["chart","renderer"],on:{panStart:function(t){var e=pf(t,this.renderer),n={x:e.x-t.deltaX,y:e.y-t.deltaY};this.currentMove=df(this,n),this.currentMove.update(e)},panMove:function(t){if(this.currentMove){var e=pf(t,this.renderer);this.currentMove.update(e)}},panEnd:function(t){if(this.currentMove){var e=pf(t,this.renderer);this.currentMove.end(e),this.currentMove=null}},panCancel:function(){this.currentMove=null},tap:function(t){var e=pf(t,this.renderer);df(this,e).end(e)}},defaultSettings:{settings:{backgroundColor:"#eee",thumbColor:"#ccc",width:16}},preferredSize:function(t){var e=this.chart.scroll(this.settings.scroll).getState();return e.viewSize>=e.max-e.min?Math.max(t.width,t.height):this.settings.settings.width},render:function(t){var e,n=this.settings.layout.dock,r=this.settings.settings.invert,i="top"===n||"bottom"===n,o=i?"width":"height",a=this.rect[o],s=this.chart.scroll(this.settings.scroll).getState(),u=a*(s.start-s.min)/(s.max-s.min),l=a*s.viewSize/(s.max-s.min);return r&&(u=a-u-l),t("div",{style:{position:"relative",width:"100%",height:"100%",background:this.settings.settings.backgroundColor,pointerEvents:"auto"}},[].concat(t("div",{class:"scroller",style:(e={position:"absolute"},qn(e,i?"left":"top","".concat(u,"px")),qn(e,i?"top":"left","25%"),qn(e,i?"height":"width","50%"),qn(e,o,"".concat(Math.max(1,l),"px")),qn(e,"background",this.settings.settings.thumbColor),e)})))},renderer:"dom"};function gf(t){var e=t.h,n=t.isVertical,r=t.value,i=t.pos,o=t.align,a=t.borderHit,s=t.state,u=t.idx,l="end"!==o,c=l?{left:"0",top:"0"}:{right:"0",bottom:"0"},h=0,f="100%",d="100%";return s.targetRect&&"start"===s.settings.bubbles.align?(f="".concat(s.targetRect.x+s.targetRect.width,"px"),d="".concat(s.targetRect.y+s.targetRect.height,"px")):s.targetRect&&"end"===s.settings.bubbles.align&&(h=n?s.targetRect.x:s.targetRect.y,f="".concat(s.rect.width-h,"px"),d="".concat(s.rect.height-h,"px")),l||(i-=a),e("div",{onmouseover:function(t){t.srcElement.children[0].style.backgroundColor="#000",t.srcElement.children[0].style[n?"height":"width"]="2px"},onmouseout:function(t){t.srcElement.children[0].style.backgroundColor=s.style.line.stroke,t.srcElement.children[0].style[n?"height":"width"]="1px"},"data-value":r,"data-key":[s.key,"edge",u].join("-"),style:{cursor:n?"ns-resize":"ew-resize",position:"absolute",left:"".concat(n?h:i,"px"),top:"".concat(n?i:h,"px"),height:n?"".concat(a,"px"):d,width:n?f:"".concat(a,"px"),pointerEvents:"auto"}},[e("div",{style:yn({backgroundColor:s.style.line.stroke,position:"absolute",height:n?"".concat(1,"px"):"100%",width:n?"100%":"".concat(1,"px"),pointerEvents:"none"},c)})])}function yf(t){var e,n,r=t.h,i=t.isVertical,o=t.label,a=t.otherValue,s=t.rangeIdx,u=t.idx,l=t.pos,c=t.align,h=t.state,f=t.value,d="end"!==c,p="outside"===h.settings.bubbles.placement,m="none";i?(n=d?"left":"right",p&&(m=d?"translate(-100%,  0px)":"translate(100%,  0px)")):(n=d?"top":"bottom",p&&(m=d?"translate(0px, -100%)":"translate(0px,  100%)"));var g=h.edit&&h.edit.rangeIdx===s&&h.edit.bubbleIdx===u,y={position:"relative",borderRadius:"".concat(h.style.bubble.borderRadius,"px"),border:"".concat(h.style.bubble.strokeWidth,"px solid ").concat(h.style.bubble.stroke),backgroundColor:h.style.bubble.fill,color:h.style.bubble.color,fontFamily:h.style.bubble.fontFamily,fontSize:h.style.bubble.fontSize,padding:"4px 8px",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px",minWidth:"50px",minHeight:"1em",pointerEvents:"auto",transform:i?"translate(0,-50%)":"translate(-50%,0)",cursor:i?"ns-resize":"ew-resize"},v=h.style.bubble.stroke,x=g?r("input",{type:"text",value:f,style:bn(bn({},y),{},{textAlign:"start",textOverflow:"",fontSize:"13px"}),onkeyup:function(t){if("Enter"===t.key){t.preventDefault(),t.stopPropagation();var e=parseFloat(t.target.value);isNaN(e)?(v="rgba(230, 78, 78, 0.6)",t.target.style.border="".concat(h.style.bubble.strokeWidth,"px solid ").concat(v)):h.onEditConfirmed(s,e,a)}else"Escape"===t.key&&(t.preventDefault(),t.stopPropagation(),h.onEditCanceled())}}):r("div",{"data-key":[h.key,"bubble",s].join("-"),"data-other-value":a,"data-idx":s,"data-bidx":u,style:y},[o]);return r("div",{style:(e={position:"absolute"},qn(e,n,"0"),qn(e,i?"top":"left","".concat(l,"px")),qn(e,"transform",m),e)},[x])}function vf(t){var e=t.h,n=t.isVertical,r=t.top,i=t.height,o=t.color,a=t.on,s=t.opacity;return e("div",yn({style:{backgroundColor:o,opacity:s,position:"absolute",left:n?0:"".concat(r,"px"),top:n?"".concat(r,"px"):0,height:n?"".concat(i,"px"):"100%",width:n?"100%":"".concat(i,"px"),pointerEvents:"auto"}},a),[])}function xf(t){var e=t.borderHit,n=t.els,r=t.isVertical,i=t.state,o=t.vStart,a=t.vEnd,s=t.idx,u=0;i.targetRect&&(u=r?i.targetRect.y:i.targetRect.x);var l=!!i.scale,c=l?i.scale.norm(o)*i.size:o,h=l?i.scale.norm(a)*i.size:a,f=Math.abs(c-h),d=Math.min(c,h)+u,p=d+f;if(i.targetRect){var m=i.targetFillRect||i.targetRect,g=r?m.height:m.width,y=l?i.scale.norm(o)*g:o,v=l?i.scale.norm(a)*g:a,x=Math.abs(y-v),b=Math.min(y,v),w={h:i.h,isVertical:r,top:b,height:x,color:i.style.target.fill,opacity:i.style.target.opacity};i.style.target.opacity<.8&&(w.on={onmouseover:function(t){t.srcElement.style.opacity=i.style.target.opacity+.1},onmouseout:function(t){t.srcElement.style.opacity=i.style.target.opacity}}),n.push(i.h("div",{style:{position:"absolute",left:"".concat(m.x,"px"),top:"".concat(m.y,"px"),height:"".concat(m.height,"px"),width:"".concat(m.width,"px")}},[vf(w)]))}var M=c<h?o:a,k=c<h?a:o,_=Pn(l?i.scale.domain():[Math.min(o,a),Math.max(o,a)],2),q=_[0],D=_[1],S=M+1e-5>=q&&M-1e-5<=D,C=k-1e-5<=D&&k+1e-5>=q;S&&n.push(gf({h:i.h,isVertical:r,borderHit:e,value:M,pos:d,align:"start",state:i,idx:s})),C&&n.push(gf({h:i.h,isVertical:r,borderHit:e,value:k,pos:p,align:"end",state:i,idx:s}));var E=i.settings.bubbles;if(E&&E.show){var A={fontSize:E.fontSize,fontFamily:E.fontFamily,color:E.fill},N=[o,a];S&&n.push(yf({h:i.h,isVertical:r,align:E.align,style:A,rangeIdx:s,idx:0,otherValue:k,value:M,label:"".concat(i.format(M,N)),pos:d,state:i})),C&&n.push(yf({h:i.h,isVertical:r,align:E.align,style:A,rangeIdx:s,idx:1,otherValue:M,value:k,label:"".concat(i.format(k,N)),pos:p,state:i}))}}function bf(t){var e=t.active.limitHigh-t.active.end,n=t.active.limitLow-t.active.start,r=t.current-t.start;return r=r<0?Math.max(r,n):Math.min(r,e)}function wf(t){var e=[],n=0===t.direction;if(Array.isArray(t.ranges)&&t.ranges.forEach((function(r,i){t.active&&i===t.active.idx||xf({borderHit:5,els:e,isVertical:n,state:t,vStart:Math.min(r.min,r.max),vEnd:Math.max(r.min,r.max),idx:i})})),t.active){var r=t.start,i=t.current;if(-1!==t.active.idx)if("foo"===t.active.mode)r=Math.min(t.active.start,t.active.end),i=Math.max(t.active.start,t.active.end);else if("modify"===t.active.mode)r=Math.min(t.start,t.current),i=Math.max(t.start,t.current);else{var o=bf(t);r=t.active.start+o,i=t.active.end+o}xf({borderHit:5,els:e,isVertical:n,state:t,vStart:r,vEnd:i,idx:t.active.idx})}return e}function Mf(t){return{min:t.scale.min(),max:t.scale.max()}}function kf(t){return{min:0,max:t.direction?t.rect.width:t.rect.height}}function _f(t,e,n){var r,i,o=t.ranges,a=-1;for(r=0;r<o.length;r++){if(o[r].min<=e&&e<=o[r].max){a=r,n.min=r?o[r-1].max:n.min,n.max=r+1<o.length?o[r+1].min:n.max;break}if(e<o[r].min){n.max=o[r].min,n.min=r?o[r-1].max:n.min;break}}-1===a&&o.length&&r>=o.length&&(n.min=o[o.length-1].max),-1!==a&&(i={idx:a,start:o[a].min,end:o[a].max,limitLow:n.min,limitHigh:n.max,mode:"foo"}),t.active=i}function qf(t){t.renderer.render(wf(t))}function Df(t,e){if(!e||!e.isActive())return[];var n=t.scale.data(),r=(n&&n.fields||[]).map((function(t){return t.id()})),i=e.brushes().filter((function(t){return"range"===t.type&&-1!==r.indexOf(t.id)}))[0];return i?i.brush.ranges():[]}function Sf(t,e){for(var n,r=1/0,i=e.domain(),o=e.bandwidth()/2,a=0;a<i.length;++a){var s=Math.abs(t-o-e(i[a]));s<r&&(r=s,n=i[a])}return n}function Cf(t,e){return Math.min.apply(Math,Fn(t))<=Math.max.apply(Math,Fn(e))&&Math.max.apply(Math,Fn(t))>=Math.min.apply(Math,Fn(e))}function Ef(t){return Yn(t.reduce((function(t,e){return t.push.apply(t,Fn(Un(e.bounds))),t}),[]))}var Af={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{rangeStart:function(t){this.start(t)},rangeMove:function(t){this.move(t)},rangeEnd:function(t){this.end(t)},rangeClear:function(t){this.clear(t)},bubbleStart:function(t){this.bubbleStart(t)}},created:function(){this.state={key:this.settings.key||"brush-range"}},beforeRender:function(t){this.state.rect=t.size.computedInner},renderRanges:function(){this.state.started||(this.state.ranges=Df(this.state,this.state.brushInstance),this.state.active=null,qf(this.state))},render:function(t){var e=this,n=this.settings.settings;this.state.direction="vertical"===n.direction?0:1;var r=this.renderer.element().getBoundingClientRect(),i=this.state.rect[0===this.state.direction?"height":"width"],o=il(this.chart.scale(n.scale),i),a=function(t){var e={targetRect:null,targetFillRect:null,scale:null,size:null},n=t.settings.settings,r=n.target&&(n.target.components||(n.target.component?[n.target.component]:[])).map((function(e){return t.chart.component(e)})).filter((function(t){return!!t&&!!t.rect})),i=n.target&&n.target.selector?t.chart.findShapes(n.target.selector):[],o=n.target&&n.target.fillSelector?t.chart.findShapes(n.target.fillSelector):[];if(i.length>0){var a=Ef(i);if(e.size=a[0===t.state.direction?"height":"width"],e.scale=il(t.chart.scale(n.scale),e.size),e.targetRect=a,o.length>0){var s=Ef(o);e.targetFillRect=s}}else if(r&&r.length>0){var u=r.slice(1).reduce((function(t,e){return{x0:Math.min(t.x0,e.rect.computedInner.x),y0:Math.min(t.y0,e.rect.computedInner.y),x1:Math.max(t.x1,e.rect.computedInner.x+e.rect.computedInner.width),y1:Math.max(t.y1,e.rect.computedInner.y+e.rect.computedInner.height)}}),{x0:r[0].rect.computedInner.x,y0:r[0].rect.computedInner.y,x1:r[0].rect.computedInner.x+r[0].rect.computedInner.width,y1:r[0].rect.computedInner.y+r[0].rect.computedInner.height});e.targetRect={x:u.x0-t.state.rect.x,y:u.y0-t.state.rect.y,width:u.x1-u.x0,height:u.y1-u.y0}}return e}(this);if(o=a.scale?a.scale:o,this.state.targetRect=a.targetRect,this.state.targetFillRect=a.targetFillRect,this.state.size=null===a.size?i:a.size,this.state.settings=n,this.state.style=this.style,this.state.offset=r,this.state.brush="object"===wn(n.brush)?n.brush.context:n.brush,this.state.brushInstance=this.chart.brush(this.state.brush),this.state.renderer=this.renderer,this.state.multi=!!n.multiple,this.state.h=t,this.state.onEditConfirmed=function(t,n,r){e.state.edit=null,function(t,e,n,r){var i=t.ranges.map((function(t){return{min:t.min,max:t.max}})),o=t.scale.min(),a=t.scale.max();i[e]={min:Math.max(o,Math.min(n,r)),max:Math.min(a,Math.max(n,r))},t.ranges[e]=bn({},i[e]);var s=t.scale.data();s&&s.fields&&s.fields.forEach((function(e){t.fauxBrushInstance||t.brushInstance.setRange(e.id(),i)}))}(e.state,t,n,r),e.emit("bubbleEnd"),qf(e.state)},this.state.onEditCanceled=function(){e.state.edit=null,qf(e.state)},this.state.cssCoord={offset:0===this.state.direction?"top":"left",coord:0===this.state.direction?"y":"x",pos:0===this.state.direction?"deltaY":"deltaX"},this.state.format="function"==typeof n.bubbles.label&&function(t,r){return n.bubbles.label.call(void 0,{datum:t,data:r,scale:o,resources:{scale:e.chart.scale,formatter:e.chart.formatter}})},{}.hasOwnProperty.call(o,"norm")){this.state.editable=!0,this.state.observeBrush="object"===wn(n.brush)&&n.brush.observe,this.state.fauxBrushInstance=null,this.state.findValues=null,this.state.scale=o;var s=this.state.scale.data();!this.state.format&&s&&s.fields&&s.fields[0]&&(this.state.format=s.fields[0].formatter())}else this.state.editable=!1,this.state.scale=eu(),this.state.scale.data=o.data,this.state.format||(this.state.format=function(t,e){return Cf(o.range(),e)?function(t,e){var n=e.ticks(),r=e.domain().indexOf(Sf(t,e));return-1!==r?n[r].label:"-"}(t,o):"-"}),this.state.fauxBrushInstance=Ku(),this.state.findValues=function(t){return function(t,e){var n=e.domain(),r=e.range(),i=[];return t.forEach((function(t){if(Cf(r,[t.min,t.max])){var o=n.indexOf(Sf(t.min,e)),a=n.indexOf(Sf(t.max,e));i.push.apply(i,n.slice(Math.min(o,a),Math.max(o,a)+1))}})),i}(t,o)};return this.state.ranges=Df(this.state,this.state.brushInstance),this.state.observeBrush||this.state.sourcedFromThisComponent?[wf(this.state)]:[]},mounted:function(){this.state.observeBrush&&this.state.brushInstance&&this.state.brushInstance.on("update",this.renderRanges)},beforeDestroy:function(){this.state.observeBrush&&this.state.brushInstance&&this.state.brushInstance.removeListener("update",this.renderRanges)},start:function(t){!function(t){var e=t.state,n=t.e,r=t.renderer,i=t.ranges,o=t.targetSize;if(!e.started){e.edit=null;var a=n.center.x-n.deltaX,s=n.center.y-n.deltaY,u=document.elementFromPoint(a,s);r.element().contains(u)||(u=null);var l={started:!0};e.offset=yn({},r.element().getBoundingClientRect());var c=a-e.offset.left,h=s-e.offset.top;e.offset.left+=e.targetRect?e.targetRect.x:0,e.offset.top+=e.targetRect?e.targetRect.y:0,e.ranges=i(e,e.fauxBrushInstance||e.brushInstance);var f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset];l.current=e.scale.normInvert(d/e.size),l.start=e.scale.normInvert(f/e.size);var p,m,g=e.ranges,y=Mf(e),v=-1;if(u&&u.hasAttribute("data-idx"))v=parseInt(u.getAttribute("data-idx"),10),y.min=v>0?g[v-1].max:y.min,y.max=v+1<g.length?g[v+1].min:y.max;else{for(p=0;p<g.length;p++){if(g[p].min<=l.start&&l.start<=g[p].max){v=p,y.min=p?g[p-1].max:y.min,y.max=p+1<g.length?g[p+1].min:y.max;break}if(l.start<g[p].min){y.max=g[p].min,y.min=p?g[p-1].max:y.min;break}}-1===v&&g.length&&p>=g.length&&(y.min=g[g.length-1].max)}if(-1!==v||e.multi||(l.ranges=[],y.min=e.scale.min(),y.max=e.scale.max()),-1!==v)if(m={idx:v,start:g[v].min,end:g[v].max,limitLow:y.min,limitHigh:y.max,mode:"move"},u&&u.hasAttribute("data-other-value"))l.start=parseFloat(u.getAttribute("data-other-value")),m.mode="modify";else{var x=e.scale.norm(m.start)*e.size,b=e.scale.norm(m.end)*e.size;Math.abs(f-x)<=o?(l.start=m.end,m.mode="modify"):Math.abs(f-b)<=o&&(l.start=m.start,m.mode="modify")}else m={idx:-1,start:l.start,end:l.current,limitLow:y.min,limitHigh:y.max,mode:"current"};l.active=m,"modify"!==m.mode&&e.targetRect&&!ic(e.targetRect,{x:c,y:h})||Object.keys(l).forEach((function(t){return e[t]=l[t]}))}}({e:t,state:this.state,renderer:this.renderer,ranges:Df,targetSize:5})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t,t.fauxBrushInstance||t.brushInstance);var n=Mf(t);_f(t,t.current,n)}(this.state,Df),qf(this.state),this.state.sourcedFromThisComponent=!0,this.state.active=null)},move:function(t){this.state.started&&(!function(t,e){var n=(e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset])/t.size,r=t.scale.normInvert(n);t.current=Math.max(Math.min(r,t.active.limitHigh),t.active.limitLow)}(this.state,t),function(t){var e=t.ranges.map((function(t){return{min:t.min,max:t.max}}));if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=bf(t);e[t.active.idx].min+=n,e[t.active.idx].max+=n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});var r=t.scale.data();r&&r.fields&&r.fields.forEach((function(n){if(t.fauxBrushInstance){var r=Df(t,t.fauxBrushInstance),i=t.findValues(r),o=t.findValues(e),a=o.filter((function(t){return-1===i.indexOf(t)})),s=i.filter((function(t){return-1===o.indexOf(t)})),u=a.map((function(t){return{key:n.id(),value:t}})),l=s.map((function(t){return{key:n.id(),value:t}}));t.brushInstance.addAndRemoveValues(u,l),t.fauxBrushInstance.setRange(n.id(),e)}else t.brushInstance.setRange(n.id(),e)}))}(this.state),qf(this.state))},clear:function(){this.state.fauxBrushInstance&&this.state.fauxBrushInstance.clear(),this.state.renderer.render([]),this.state.started=!1,this.state.active=null,this.state.sourcedFromThisComponent=!1},bubbleStart:function(t){if(this.state.editable){var e=t.srcEvent||t,n=e.target,r={rangeIdx:parseInt(n.getAttribute("data-idx"),10),bubbleIdx:parseInt(n.getAttribute("data-bidx"),10)};if(!isNaN(r.rangeIdx)&&JSON.stringify(r)!==JSON.stringify(this.state.edit)){this.state.edit=r,e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();var i=n.parentNode;qf(this.state);var o=i.querySelector("input");o.focus(),o.select()}}}};function Nf(t){t.renderer.render(wf(t))}function Of(t){return t.rc.ranges()}var If={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaClear:function(t){this.clear(t)}},created:function(){this.state={key:this.settings.key||"brush-area-dir"}},render:function(t){var e=this;this.state.rect=this.rect;var n=this.settings.settings,r="vertical"===n.direction?0:1,i=this.state.rect[0===r?"height":"width"],o=this.renderer.element().getBoundingClientRect(),a=(n.target?n.target.components||[n.target.component]:[]).map((function(t){return e.chart.component(t)})).filter((function(t){return!!t&&!!t.rect})),s=a[0]?a.slice(1).reduce((function(t,e){return{x0:Math.min(t.x0,e.rect.x),y0:Math.min(t.y0,e.rect.y),x1:Math.max(t.x1,e.rect.x+e.rect.width),y1:Math.max(t.y1,e.rect.y+e.rect.height)}}),{x0:a[0].rect.x,y0:a[0].rect.y,x1:a[0].rect.x+a[0].rect.width,y1:a[0].rect.y+a[0].rect.height}):null;return this.state.targetRect=s?{x:s.x0-this.rect.x,y:s.y0-this.rect.y,width:s.x1-s.x0,height:s.y1-s.y0}:null,this.state.style=this.style,this.state.chart=this.chart,this.state.direction=r,this.state.settings=n,this.state.offset=o,this.state.rc=Pu(),this.state.renderer=this.renderer,this.state.multi=!!n.multiple,this.state.h=t,this.state.size=i,this.state.cssCoord={offset:0===this.state.direction?"top":"left",coord:0===this.state.direction?"y":"x",pos:0===this.state.direction?"deltaY":"deltaX",area:0===this.state.direction?"height":"width"},this.state.format=function(t,e){return function(t,e,n){var r=Math.min.apply(Math,Fn(n)),i=Math.max.apply(Math,Fn(n)),o={x:t.direction?r+t.rect.x:t.rect.x,y:t.direction?t.rect.y:r+t.rect.y,width:t.direction?i-r:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:i-r},a=t.chart.shapesAt(o,t.settings.brush);if(0===a.length)return"-";var s=a.reduce((function(n,i){var o=n.bounds,a=i.bounds;return e===r?o[t.cssCoord.coord]<=a[t.cssCoord.coord]?n:i:o[t.cssCoord.coord]+o[t.cssCoord.area]>=a[t.cssCoord.coord]+a[t.cssCoord.area]?n:i})),u=t.settings.brush.components.reduce((function(t,e){return t.key===s.key?t:e}));return"function"==typeof t.settings.bubbles.label?t.settings.bubbles.label(s.data):Array.isArray(u.data)&&u.data.length?s.data[u.data[0]].label:s.data&&s.data.label?s.data.label:"-"}(this,t,e)},[]},start:function(t){!function(t){var e=t.state,n=t.e,r=t.renderer,i=t.ranges,o=t.targetSize;if(!e.started){var a=n.center.x-n.deltaX,s=n.center.y-n.deltaY,u=document.elementFromPoint(a,s);r.element().contains(u)||(u=null);var l={started:!0};e.offset=r.element().getBoundingClientRect(),e.ranges=i(e);var c=a-e.offset.left,h=s-e.offset.top,f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset],p=d,m=f;l.start=f,l.current=d;var g,y,v=e.ranges,x=kf(e),b=-1;if(u&&u.hasAttribute("data-idx"))b=parseInt(u.getAttribute("data-idx"),10),x.min=b>0?v[b-1].max:x.min,x.max=b+1<v.length?v[b+1].min:x.max;else{for(g=0;g<v.length;g++){if(v[g].min<=m&&m<=v[g].max){b=g,x.min=g?v[g-1].max:x.min,x.max=g+1<v.length?v[g+1].min:x.max;break}if(m<v[g].min){x.max=v[g].min,x.min=g?v[g-1].max:x.min;break}}-1===b&&v.length&&g>=v.length&&(x.min=v[v.length-1].max)}if(-1!==b||e.multi||(l.ranges=[],x.min=0,x.max=e.direction?e.rect.width:e.rect.height),-1!==b)if(y={idx:b,start:v[b].min,end:v[b].max,limitLow:x.min,limitHigh:x.max,mode:"move"},u&&u.hasAttribute("data-other-value"))l.start=parseFloat(u.getAttribute("data-other-value")),y.mode="modify";else{var w=y.start,M=y.end;Math.abs(f-w)<=o?(l.start=y.end,y.mode="modify"):Math.abs(f-M)<=o&&(l.start=y.start,y.mode="modify")}else y={idx:-1,start:m,end:p,limitLow:x.min,limitHigh:x.max,mode:"current"};l.active=y,"modify"!==y.mode&&e.targetRect&&!ic(e.targetRect,{x:c,y:h})||Object.keys(l).forEach((function(t){return e[t]=l[t]}))}}({e:t,state:this.state,renderer:this.renderer,ranges:Of,targetSize:5})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t);var n=kf(t);_f(t,t.current,n)}(this.state,Of),Nf(this.state))},move:function(t){this.state.started&&(!function(t,e){var n=e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset];t.current=Math.max(Math.min(n,t.active.limitHigh),t.active.limitLow)}(this.state,t),function(t){var e=t.ranges.map((function(t){return{min:t.min,max:t.max}}));if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=bf(t);e[t.active.idx].min=t.active.start+n,e[t.active.idx].max=t.active.end+n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});t.rc.set(e);var r=[];e.forEach((function(e){r.push.apply(r,Fn(function(t,e){var n={x:t.direction?e.min+t.rect.x:t.rect.x,y:t.direction?t.rect.y:e.min+t.rect.y,width:t.direction?e.max-e.min:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:e.max-e.min};return t.chart.shapesAt(n,t.settings.brush)}(t,e)))})),function(t,e){t.chart.brushFromShapes(e,t.settings.brush)}(t,r)}(this.state),Nf(this.state))},clear:function(){this.state.rc&&this.state.rc.clear(),this.state.renderer.render([])}};function Tf(t){var e="vertical"===t.direction,n=t.rect[e?"height":"width"],r=t.rect[e?"width":"height"];return function(t){var e=t.brush;if(!e||!e.isActive())return[];var n=t.scale.data(),r=(n&&n.fields||[]).map((function(t){return t.id()})),i=e.brushes().filter((function(t){return"range"===t.type&&-1!==r.indexOf(t.id)}))[0];return i?i.brush.ranges():[]}(t).map((function(i){var o=t.scale(i.min)*n,a=t.scale(i.max)*n,s=Math.min(o,a),u=Math.abs(o-a);return{type:"rect",fill:t.fill,opacity:t.opacity,x:e?0:s,width:e?r:u,y:e?s:0,height:e?u:r}}))}function Rf(t,e,n,r){function i(){!function(t){t.renderer.render(Tf(t))}(t)}function o(){!function(t){t.renderer.render(Tf(t))}(t)}function a(){!function(t){t.renderer.render(Tf(t))}(t)}t.brush=e,e&&(e.on("start",i),e.on("update",o),e.on("end",a),t.start=i,t.update=o,t.end=a,t.brush=e,t.scale=n,t.renderer=r)}function Pf(t){t.brush&&(t.brush.removeListener("start",t.start),t.brush.removeListener("update",t.update),t.brush.removeListener("end",t.end)),t.start=void 0,t.update=void 0,t.end=void 0,t.brush=void 0,t.scale=void 0,t.renderer=void 0}var Ff={require:["chart","settings","renderer"],defaultSettings:{settings:{}},preferredSize:function(){return 50},created:function(){this.state={}},render:function(){var t=this.settings.settings,e=this.chart.brush(t.brush),n=t.direction||"horizontal",r="horizontal"===n?this.rect.width:this.rect.height,i=il(this.chart.scale(t.scale),r);return Pf(this.state),Rf(this.state,e,i,this.renderer),this.state.rect=this.rect,this.state.fill=t.fill||"#ccc",this.state.opacity=void 0!==t.opacity?t.opacity:1,this.state.direction=n,Tf(this.state)},beforeDestroy:function(){Pf(this.state)}};function Lf(t,e){var n=e.center.x,r=e.center.y;return{x:n-t.left,y:r-t.top}}function jf(t,e,n){return Dl(t,e.points[0])<Math.pow(n.settings.snapIndicator.threshold,2)}function zf(t,e){null==t.path.d?t.path.d="M".concat(e.x," ").concat(e.y," "):t.path.d+="L".concat(e.x," ").concat(e.y," "),t.points.push(e)}function Vf(t){var e=t.state,n=t.start,r=void 0===n?null:n,i=t.end,o=void 0===i?null:i;null!==r&&(e.snapIndicator.x1=r.x,e.snapIndicator.y1=r.y),null!==o&&(e.snapIndicator.x2=o.x,e.snapIndicator.y2=o.y)}function Hf(t,e){t.snapIndicator.visible=e}var Bf={require:["chart","renderer","settings"],defaultSettings:{layout:{displayOrder:0},settings:{brush:{components:[]},snapIndicator:{threshold:75,strokeDasharray:"5, 5",stroke:"black",strokeWidth:2,opacity:.5},lasso:{fill:"transparent",stroke:"black",strokeWidth:2,opacity:.7,strokeDasharray:"20, 10"},startPoint:{r:10,fill:"green",stroke:"black",strokeWidth:1,opacity:1}}},on:{lassoStart:function(t){this.start(t)},lassoEnd:function(t){this.end(t)},lassoMove:function(t){this.move(t)},lassoCancel:function(){this.cancel()}},created:function(){this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}}},start:function(t){var e,n,r,i;this.state.active=!0,this.state.path={visible:!0,type:"path",d:null,fill:(e=this.settings.settings.lasso).fill,stroke:e.stroke,strokeWidth:e.strokeWidth,opacity:e.opacity,strokeDasharray:e.strokeDasharray,collider:{type:null}},this.state.snapIndicator=function(t){return{visible:!1,type:"line",x1:0,y1:0,x2:0,y2:0,strokeDasharray:t.strokeDasharray,stroke:t.stroke,strokeWidth:t.strokeWidth,opacity:t.opacity,collider:{type:null}}}(this.settings.settings.snapIndicator),this.state.startPoint=function(t){return{visible:!0,type:"circle",cx:0,cy:0,r:t.r,fill:t.fill,opacity:t.opacity,stroke:t.stroke,strokeWidth:t.strokeWidth,collider:{type:null}}}(this.settings.settings.startPoint),this.state.rendererBounds=this.renderer.element().getBoundingClientRect(),this.state.componentDelta=(n=this.chart,r=this.state.rendererBounds,i=n.element.getBoundingClientRect(),{x:r.left-i.left,y:r.top-i.top}),this.state.brushConfig=this.settings.settings.brush.components.map((function(t){return{key:t.key,contexts:t.contexts||["lassoBrush"],data:t.data||[""],action:t.action||"add"}}));var o=Lf(this.state.rendererBounds,t);zf(this.state,o),Vf({state:this.state,start:o}),function(t,e){t.startPoint.cx=e.x,t.startPoint.cy=e.y}(this.state,o)},move:function(t){if(this.state.active){var e=Lf(this.state.rendererBounds,t);jf(e,this.state,this.settings)?Hf(this.state,!0):Hf(this.state,!1),zf(this.state,e),Vf({state:this.state,end:e}),function(t,e){var n=[t.startPoint,t.path,t.snapIndicator].filter((function(t){return t.visible}));e.render(n)}(this.state,this.renderer),function(t,e){if(t.active){var n=t.points[t.points.length-2],r=t.points[t.points.length-1];t.lineBrushShape.x1=n.x+t.componentDelta.x,t.lineBrushShape.y1=n.y+t.componentDelta.y,t.lineBrushShape.x2=r.x+t.componentDelta.x,t.lineBrushShape.y2=r.y+t.componentDelta.y;var i=e.shapesAt(t.lineBrushShape,{components:t.brushConfig});e.brushFromShapes(i,{components:t.brushConfig})}}(this.state,this.chart)}},end:function(t){this.state.active&&(Hf(this.state,!1),jf(Lf(this.state.rendererBounds,t),this.state,this.settings)&&function(t,e){if(t.active){var n=t.componentDelta.x,r=t.componentDelta.y,i=t.points.map((function(t){return{x:t.x+n,y:t.y+r}})),o=e.shapesAt({vertices:i},{components:t.brushConfig});e.brushFromShapes(o,{components:t.brushConfig})}}(this.state,this.chart),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach((function(t){t.contexts.forEach((function(t){e.brush(t).end()}))})),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},render:function(){}};function Wf(t,e,n,r,i){for(var o,a=0,s=e.length-1;a<s;){var u=Math.floor((a+s)/2);(o=i(e[u]))[n]+o[r]<t[n]?a=u+1:s=u}return a}function Uf(t){var e=t.orientation,n=t.targetNodes,r=t.labels,i=t.container,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wf,a=[],s="v"===e?"x":"y",u="v"===e?"width":"height",l=function(t){return t.textBounds},c=function(t){return t.node.localBounds};return function(t,e){var h=r[e],f=h.textBounds,d=h.node;if(f[s]<i[s]||f[s]+f[u]>i[s]+i[u])return!1;for(var p=o(f,a,s,u,l);p<a.length;p++)if(nc(f,a[p].textBounds))return!1;for(var m=o(f,n,s,u,c),g=f[s]+f[u],y=m;y<n.length;y++){var v=n[y].node;if(g<v.localBounds[s])break;if(nc(f,v.localBounds)&&d!==v)return!1}return a.push(r[e]),!0}}function Yf(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function $f(t){var e=wn(t);return("string"===e||"number"===e)&&""!==t}function Xf(t){return bn({type:"rect",rx:2,ry:2,fill:t.backgroundColor},t.backgroundBounds)}function Gf(t,e,n){return n?t.width>=e.height:t.width>=e.width}function Kf(t,e,n){return n?t.height>=e.width:t.height>=e.height}function Jf(t,e,n,r,i){var o,a;return"v"===t?(o=r||i||Gf(e,n,!0),a=Kf(e,n,!r)):(o=Gf(e,n),a=i||Kf(e,n,!1)),o&&a}function Zf(t,e,n,r){return t+.5*e+(r-.5)*(e-n)-.5*n}function Qf(t,e,n){var r={type:"text",text:e,maxWidth:n.rotate?t.height:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:n.rotate?"end":"start",baseline:"central",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},i=n.textMetrics;if(!n.overflow&&!function(t,e,n){return Gf(t,e,n.rotate)&&Kf(t,e,n.rotate)}(t,i,n))return!1;var o=.5*i.height;return n.rotate?(r.x=Zf(t.x,t.width,i.height,n.align)+o,r.y=Zf(t.y,t.height,i.width,n.justify),r.transform="rotate(-90, ".concat(r.x+r.dx,", ").concat(r.y+r.dy,")")):(r.x=Zf(t.x,t.width,i.width,n.align),r.y=Zf(t.y,t.height,i.height,n.justify)+o),r}function td(t){var e=t.bar,n=t.view,r=t.direction,i=t.position,o=t.padding,a=void 0===o?4:o,s={};if(yn(s,e),i&&"inside"!==i)if("up"===r||"down"===r){var u=Math.max(0,Math.min(e.y,n.height)),l=Math.max(0,Math.min(e.y+e.height,n.height));"outside"===i&&"up"===r||"opposite"===i&&"down"===r?(s.y=0,s.height=u):("outside"===i&&"down"===r||"opposite"===i&&"up"===r)&&(s.y=l,s.height=n.height-l)}else{var c=Math.max(0,Math.min(e.x,n.width)),h=Math.max(0,Math.min(e.x+e.width,n.width));"outside"===i&&"left"===r||"opposite"===i&&"right"===r?(s.x=0,s.width=c):("outside"===i&&"right"===r||"opposite"===i&&"left"===r)&&(s.x=h,s.width=n.width-h)}else;return function(t,e){var n=Math.max(0,Math.min(t.y,e.height)),r=Math.max(0,Math.min(t.y+t.height,e.height)),i=Math.max(0,Math.min(t.x,e.width)),o=Math.max(0,Math.min(t.x+t.width,e.width));t.x=i,t.width=o-i,t.y=n,t.height=r-n}(s,n),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.top,r=void 0===n?4:n,i=e.bottom,o=void 0===i?4:i,a=e.left,s=void 0===a?4:a,u=e.right,l=void 0===u?4:u;t.x+=s,t.width-=s+l,t.y+=r,t.height-=r+o}(s,a),s}function ed(t){var e,n,r,i,o,a=t.direction,s=t.fitsHorizontally,u=t.measured,l=t.node,c=t.orientation,h=t.placementSettings,f=t.rect,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:td,p=[],m="h"===c?"width":"height";for(o=0;o<h.length;o++)if(r=h[o],i=d({bar:l.localBounds,view:f,direction:a,position:r.position,padding:r.padding}),p.push(i),e=!o||i[m]>e[m]?i:e,Jf(c,i,u,s,r.overflow)){n=i;break}return n||(n=e,o=p.indexOf(n)),{bounds:n,placement:r=h[o]}}function nd(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=i.top,a=void 0===o?4:o,s=i.bottom,u=void 0===s?4:s,l=i.left,c=void 0===l?4:l,h=i.right,f=void 0===h?4:h,d=t.x+t.dx,p=t.y+t.dy,m=n?Math.min(e.width,r.height):Math.min(e.height,r.width),g=n?Math.min(e.height,r.height):Math.min(e.width,r.width),y=.5*e.height,v=1e-9,x=n?d-y:d,b=n?p:p-y,w={x:x-c-v,y:b-a-v,width:g+(c+f)-v,height:m+(a+u)-v};return w}function rd(t){for(var e,n,r,i,o,a,s,u,l,c,h,f,d,p=t.chart,m=t.targetNodes,g=t.rect,y=t.fitsHorizontally,v=t.collectiveOrientation,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ed,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qf,w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uf,M=[],k={container:g,targetNodes:m,labels:[],orientation:v},_=0,q=m.length;_<q;_++){a=null,f=Yf(r=(n=m[_]).node,p),d="left"===(l=n.direction)||"right"===l?"h":"v";for(var D=0;D<n.texts.length;D++)if($f(i=n.texts[D])){var S=x({direction:l,fitsHorizontally:y,lblStngs:c=n.labelSettings[D],measured:u=n.measurements[D],node:r,orientation:d,placements:c.placements,placementSettings:n.placementSettings[D],rect:g});if(a=S.bounds,h=S.placement,a&&h){o=h.justify;var C="function"==typeof c.linkData?c.linkData(f,_):void 0,E="function"==typeof h.overflow?h.overflow(f,_):h.overflow;"up"===l&&(o=1-o),"opposite"===h.position&&(o=1-o),"left"===l&&(o=1-o);var A=!("h"===v||y);if(e=b(a,i,{justify:"h"===d?h.align:o,align:"h"===d?o:h.align,fontSize:c.fontSize,fontFamily:c.fontFamily,textMetrics:u,rotate:A,overflow:!!E})){var N=nd(e,u,A,a,h.padding);s="function"==typeof h.fill?h.fill(bn(bn({},f),{},{textBounds:N}),_):h.fill,e.fill=s,void 0!==C&&(e.data=C),"object"===wn(h.background)&&(e.backgroundColor="function"==typeof h.background.fill?h.background.fill(bn(bn({},f),{},{textBounds:N}),_):h.background.fill,void 0!==e.backgroundColor&&(e.backgroundBounds=nd(e,u,A,a,h.background.padding))),M.push(e),k.labels.push({node:r,textBounds:N})}}}}var O=M.filter(w(k)),I=O.filter((function(t){return void 0!==t.backgroundBounds})).map(Xf);return[].concat(Fn(I),Fn(O))}function id(t){for(var e,n,r,i,o,a,s,u=t.nodes,l=t.rect,c=t.chart,h=t.labelSettings,f=t.placementSettings,d=t.settings,p=t.renderer,m={},g=[],y=!0,v=!1,x=0;x<u.length;x++)if(nc(i=(n=u[x]).localBounds,l)){var b=Yf(n,c);e={node:n,texts:[],measurements:[],labelSettings:[],placementSettings:[]};for(var w=0;w<h.length;w++)$f(r="function"==typeof(a=h[w]).label?a.label(b,x):void 0)&&(s="function"==typeof d.direction?d.direction(b,x):d.direction||"up",v=v||"left"===s||"right"===s,m.fontFamily=a.fontFamily,m.fontSize="".concat(a.fontSize,"px"),m.text=r,o=p.measureText(m),e.measurements.push(o),e.texts.push(r),e.labelSettings.push(a),e.placementSettings.push(f[w]),e.direction=s,y=y&&o.width<=i.width-8);g.push(e)}return{targetNodes:g,fitsHorizontally:y,hasHorizontalDirection:v}}function od(t){var e=t.orientation,n=void 0===e?"auto":e,r=t.defaultOrientation,i=void 0===r?"h":r;switch(n.toLocaleLowerCase()){case"vertical":return"v";case"horizontal":return"h";default:return i}}function ad(t){var e=2*Math.PI;return(t%e+e)%e}function sd(t,e){t.x+=e,t.width-=2*e,t.y+=e,t.height-=2*e}function ud(t){return{x:t.x,y:t.y-t.height/2,width:t.width,height:t.height}}function ld(t,e,n){var r=e.x,i=e.y;if(r*r+i*i>t*t)return null;var o=Math.sin(n),a=Math.cos(n),s=r*a-i*o,u=t*t-s*s;if(u<0)return null;var l=Math.sqrt(u);return{x:s*a+o*l,y:-s*o+a*l}}function cd(t){var e,n,r=t.radius,i=t.size,o=t.angle,a=i.width,s=i.height,u={x:a/2,y:s/2};switch(Math.floor(o/(Math.PI/2))){case 0:if(!(e=ld(r,u,o)))return null;e.y*=-1,n={x:-a,y:0};break;case 1:if(!(e=ld(r,u,Math.PI-o)))return null;n={x:-a,y:-s};break;case 2:if(!(e=ld(r,u,o-Math.PI)))return null;e.x*=-1,n={x:0,y:-s};break;case 3:if(!(e=ld(r,u,2*Math.PI-o)))return null;e.x*=-1,e.y*=-1,n={x:0,y:0};break;default:throw new Error("invalid angle")}return{x:e.x+n.x,y:e.y+n.y,width:a,height:s}}function hd(t){var e=t.slice,n=t.measured,r=t.padding,i=e.start,o=e.end,a=e.innerRadius,s=e.outerRadius,u=s-a-2*r,l=o-i;if(l<Math.PI){var c=(n.height/2+r)/Math.tan(l/2);c>a&&(u=s-c-2*r)}if(u<0||u<n.minReqWidth)return null;var h=ad((i+o)/2),f=s-r,d={x:Math.sin(h)*f,y:-Math.cos(h)*f,width:u,height:n.height};return h<Math.PI?(d.angle=h-Math.PI/2,d.anchor="end"):(d.angle=h+Math.PI/2,d.anchor="start"),d}function fd(t){var e=t.context,n=t.node,r=t.bounds,i=n.desc.slice,o=ad((i.start+i.end)/2);switch(Math.floor(o/(Math.PI/2))){case 0:e.q1maxY=r.y-2,void 0===e.q2minY&&(e.q2minY=r.y+r.height+2);break;case 1:e.q2minY=r.y+r.height+2;break;case 2:e.q3minY=r.y+r.height+2;break;case 3:e.q4maxY=r.y-2,void 0===e.q3minY&&(e.q3minY=r.y+r.height+2)}}function dd(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function pd(t,e,n){var r={type:"text",text:e,maxWidth:t.width,x:t.x,y:t.y+("top"===t.baseline?t.height/2:0),fill:n.fill,anchor:t.anchor||"start",baseline:"middle",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily};if(!isNaN(t.angle)){var i=t.angle*(360/(2*Math.PI));r.transform="rotate(".concat(i,", ").concat(r.x,", ").concat(r.y,")")}return r}function md(t){var e,n,r=t.slice,i=t.direction,o=t.position,a=t.padding,s=t.measured,u=t.view,l=t.context,c=t.store,h=r.start,f=r.end,d=r.innerRadius,p=r.offset;switch(o){case"into":e="rotate"===i?hd({slice:r,measured:s,padding:a}):function(t){var e=t.slice,n=t.padding,r=t.measured,i=e.start,o=e.end,a=e.innerRadius,s=e.outerRadius,u=ad((i+o)/2),l=cd({radius:s,size:{width:r.width+2*n,height:r.height+2*n},angle:u});return l?(l.baseline="top",oc(l,{x1:0,y1:0,x2:Math.sin(i)*s,y2:-Math.cos(i)*s})||oc(l,{x1:0,y1:0,x2:Math.sin(o)*s,y2:-Math.cos(o)*s})||Kl({cx:0,cy:0,r:a},l)?null:(sd(l,n),l)):null}({slice:r,measured:s,padding:a});break;case"inside":n={start:h,end:f,innerRadius:0,outerRadius:d},e="rotate"===i?hd({slice:n,measured:s,padding:a}):function(t){var e=t.slice,n=t.padding,r=t.measured,i=t.store,o=e.start,a=e.end,s=e.outerRadius,u=ad((o+a)/2),l=cd({radius:s,size:{width:r.width+2*n,height:r.height+2*n},angle:u});return l?(l.baseline="top",sd(l,n),i.insideLabelBounds.some((function(t){return nc(t,l)}))?null:(i.insideLabelBounds.push({x:l.x-4,y:l.y,width:l.width+8,height:l.height}),l)):null}({slice:n,measured:s,padding:a,store:c});break;case"outside":e="rotate"===i?function(t){var e=t.slice,n=t.measured,r=t.padding,i=t.view,o=e.start,a=e.end,s=e.outerRadius,u=e.offset,l=s+r,c=a-o;if(c<Math.PI&&(n.height/2+r)/Math.tan(c/2)>l)return null;var h=ad((o+a)/2),f=Math.sin(h)*l,d=-Math.cos(h)*l,p=n.width,m=h%Math.PI;if(m>Math.PI/2&&(m=Math.PI-m),Math.cos(m)>.001){var g=d<0?i.y:i.y+i.height,y=Math.abs(g-u.y)/Math.cos(m)-Math.tan(m)*(n.height/2)-2*r-s;y<p&&(p=y)}if(Math.sin(m)>.001){var v=f<0?i.x:i.x+i.width,x=Math.abs(v-u.x)/Math.sin(m)-n.height/2/Math.tan(m)-2*r-s;x<p&&(p=x)}if(p<=0||p<n.minReqWidth)return null;var b={x:f,y:d,width:p,height:n.height};return h<Math.PI?(b.angle=h-Math.PI/2,b.anchor="start"):(b.angle=h+Math.PI/2,b.anchor="end"),b}({slice:r,measured:s,padding:a,view:u}):function(t){var e=t.slice,n=t.measured,r=t.padding,i=t.view,o=t.context,a=e.start,s=e.end,u=e.outerRadius,l=e.offset,c=ad((a+s)/2);if(function(t,e,n){switch(e){case 0:return t.q1maxY<0;case 1:return t.q2minY>n.height;case 2:return t.q3minY>n.height;case 3:return t.q4maxY<0;default:return!0}}(o,Math.floor(c/(Math.PI/2)),i))return null;var h=u+r+n.height/2,f=Math.sin(c)*h,d=-Math.cos(c)*h,p=n.width;if(c<Math.PI){var m=Math.abs(i.x+i.width-(f+l.x));m<p&&(p=m)}else{var g=Math.abs(i.x-(f+l.x));g<p&&(p=g)}if(p<n.minReqWidth)return null;var y={x:f,y:d,width:p,height:n.height};return c<Math.PI?y.anchor="start":y.anchor="end",y}({slice:r,measured:s,padding:a,view:u,context:l});break;default:throw new Error("not implemented")}return e&&(e.x+=p.x,e.y+=p.y,"outside"===o&&"rotate"!==i&&function(t,e,n){var r=n.start,i=n.end,o=n.offset,a=n.outerRadius,s=ad((r+i)/2);switch(Math.floor(s/(Math.PI/2))){case 0:if(void 0!==e.q1maxY){var u=Math.min(t.y,e.q1maxY-t.height),l=t.y-u;if(t.y=u,l>1){var c=a+2;t.line={type:"line",x1:t.x-2,y1:t.y+2,x2:o.x+Math.sin(s)*c,y2:o.y-Math.cos(s)*c,strokeWidth:1}}}break;case 1:if(void 0!==e.q2minY){var h=Math.max(t.y,e.q2minY),f=h-t.y;if(t.y=h,f>1){var d=a+2;t.line={type:"line",x1:t.x-2,y1:t.y-2,x2:o.x+Math.sin(s)*d,y2:o.y-Math.cos(s)*d,strokeWidth:1}}}break;case 2:if(void 0!==e.q3minY){var p=Math.max(t.y,e.q3minY),m=p-t.y;if(t.y=p,m>1){var g=a+2;t.line={type:"line",x1:t.x+2,y1:t.y-2,x2:o.x+Math.sin(s)*g,y2:o.y-Math.cos(s)*g,strokeWidth:1}}}break;case 3:if(void 0!==e.q4maxY){var y=Math.min(t.y,e.q4maxY-t.height),v=t.y-y;if(t.y=y,v>1){var x=a+2;t.line={type:"line",x1:t.x+2,y1:t.y+2,x2:o.x+Math.sin(s)*x,y2:o.y-Math.cos(s)*x,strokeWidth:1}}}}}(e,l,r)),e}function gd(t){for(var e=t.context,n=t.direction,r=t.measured,i=t.node,o=t.placementSettings,a=t.rect,s=t.store,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:md,l=0;l<o.length;l++){var c=o[l],h=u({context:e,slice:i.desc.slice,view:a,direction:n,position:c.position,measured:r,padding:c.padding,store:s});if(h)return{bounds:h,placement:c}}return{bounds:null,placement:null}}function yd(t){for(var e=[],n=[],r=[],i=[],o=0;o<t.length;++o){var a=t[o].desc.slice,s=ad((a.start+a.end)/2);switch(Math.floor(s/(Math.PI/2))){case 0:e.push(t[o]);break;case 1:n.push(t[o]);break;case 2:r.push(t[o]);break;case 3:i.push(t[o])}}var u=function(t,e){return ad((t.desc.slice.start+t.desc.slice.end)/2)-ad((e.desc.slice.start+e.desc.slice.end)/2)},l=function(t,e){return u(e,t)};return e.sort(l),n.sort(u),r.sort(l),i.sort(u),e.concat(n,i,r)}function vd(t,e,n){var r=e.fontFamily,i="".concat(e.fontSize,"px"),o=n.measureText({text:t,fontFamily:r,fontSize:i});return o.minReqWidth=Math.min(o.width,n.measureText({text:"".concat(t[0],""),fontFamily:r,fontSize:i}).width),o}var xd=/\n+|\r+|\r\n/,bd=/\s/,wd=/[a-zA-Z\u00C0-\u00F6\u00F8-\u00FF\u00AD]/;function Md(t){return"string"==typeof t?-1!==t.search(xd):-1!==String(t).search(xd)}function kd(t){return-1!==t.search(bd)}function _d(t){return-1!==t.search(wd)}function qd(t,e,n,r,i){return r.some((function(r){return r(t,e,n)}))?1:i.some((function(r){return r(t,e,n)}))?0:2}function Dd(t){""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()}function Sd(t,e,n){return Math.max(e,Math.min(n,t))}function Cd(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.string,n=t.separator,r=void 0===n?"":n,i=t.reverse,o=void 0!==i&&i,a=t.measureText,s=void 0===a?function(t){return{width:t.length,height:1}}:a,u=t.mandatoryBreakIdentifiers,l=void 0===u?[Md]:u,c=t.noBreakAllowedIdentifiers,h=void 0===c?[]:c,f=t.suppressIdentifier,d=void 0===f?[kd,Md,function(t){return""===t}]:f,p=t.hyphenationIdentifiers,m=void 0===p?[_d]:p,g=String(e).split(r);Dd(g);var y=g.length,v=o?function(t){return t>=0}:function(t){return t<y},x=o?y:-1;function b(t){var e=Sd(t,0,y-1),n=g[e],r=s(n),i=qd(n,e,g,l,h);return{index:e,value:n,breakOpportunity:i,suppress:d.some((function(t){return t(n,e,g)})),hyphenation:m.some((function(t){return t(n,e,g)})),width:r.width,height:r.height,done:!1}}function w(t){return isNaN(t)?o?x--:x++:x=Sd(t,0,y-1),v(x)?b(x):{done:!0}}return{next:w,peek:b,length:y}}var Ed="",Ad=/^\s*\d+(\.\d+)?px\s*$/i;function Nd(t){return"string"===wn(t)&&Ad.test(t)}function Od(t){var e=t["font-size"]||t.fontSize;return Nd(e)?parseFloat(e)*Math.max(isNaN(t.lineHeight)?1.2:t.lineHeight,0):19.2}function Id(t){var e=t.maxHeight,n=Math.max(t.maxLines,1)||1/0;if(isNaN(e))return n;var r=Od(t);return Math.max(1,Math.min(Math.floor(e/r),n))}function Td(t,e){return{lines:[],line:"",width:0,maxLines:Id(t),maxWidth:t.maxWidth,hyphens:{enabled:"auto"===t.hyphens,char:"",metrics:e("")}}}function Rd(t){t.lines.push(t.line),t.line="",t.width=0}function Pd(t,e){t.line+=e.value,t.width+=e.width}function Fd(t,e,n){if(e.width>t.maxWidth)return e;for(var r=e.index,i=1;i<5;i++){var o=n.peek(e.index-1);if(!e.hyphenation||!o.hyphenation||0===e.index)return e;if(t.width+t.hyphens.metrics.width<=t.maxWidth)return t.line+=t.hyphens.char,e;if(1===t.line.length)return e;e=n.next(r-i),t.line=t.line.slice(0,-1),t.width-=e.width}return e}function Ld(t,e,n){for(var r=Cd({string:e.value,measureText:n});t.lines.length<t.maxLines;){var i=r.next();if(i.done)break;t.width+i.width>t.maxWidth&&2===i.breakOpportunity&&t.line.length>0?(i=t.hyphens.enabled?Fd(t,i,r):i,Rd(t),Pd(t,i)):Pd(t,i)}}function jd(t,e){for(var n=Cd({string:t.text,separator:"",measureText:e,noBreakAllowedIdentifiers:[function(t,e){return 0===e}]}),r=Td(t,e),i=!0;r.lines.length<r.maxLines;){var o=n.next();if(o.done){Rd(r),i=!1;break}1===o.breakOpportunity?Rd(r):r.width+o.width>r.maxWidth&&2===o.breakOpportunity?o.suppress?r.width+=o.width:(o=r.hyphens.enabled?Fd(r,o,n):o,Rd(r),Pd(r,o)):Pd(r,o)}return{lines:r.lines,reduced:i}}function zd(t,e){for(var n=Cd({string:t.text,separator:/(\s|-|\u2010)/,measureText:e}),r=Td(t,e),i=!0;r.lines.length<r.maxLines;){var o=n.next();if(o.done){Rd(r),i=!1;break}1===o.breakOpportunity?Rd(r):r.width+o.width>r.maxWidth&&2===o.breakOpportunity?o.suppress?Rd(r):o.width>r.maxWidth?Ld(r,o,e):(Rd(r),Pd(r,o)):Pd(r,o)}return{lines:r.lines,reduced:i}}function Vd(t){return{"break-all":jd,"break-word":zd}[t.wordBreak]}function Hd(t){return function(e){var n=e.node;if(function(t){return"text"===t.type&&!t._lineBreak}(n)){var r=Vd(n);if(!r)return;var i=t(n);if(i.width>n.maxWidth||Md(n.text)){var o=(Od(n)-i.height)/2,a=r(n,function(t,e){return function(n){return e({text:n,fontSize:t.fontSize,fontFamily:t.fontFamily})}}(n,t));e.node=function(t,e,n,r){var i={type:"container",children:[]};void 0!==e.id&&(i.id=e.id);var o=0;return t.lines.forEach((function(a,s){var u=yn({},e);u.text=a,u._lineBreak=!0,o+=n,t.reduced&&s===t.lines.length-1?u.text+=Ed:delete u.maxWidth,u.dy=isNaN(u.dy)?o:u.dy+o,o+=r,o+=n,i.children.push(u)})),i}(a,n,o,i.height)}}}}function Bd(t,e){var n=t.text,r=t["font-size"],i=t["font-family"],o=t.maxWidth;if(n="string"==typeof n?n:"".concat(n),void 0===o)return n;var a=e({text:n,fontSize:r,fontFamily:i}).width;if(a<=o)return n;for(var s=0,u=n.length-1;s<=u;){var l=Math.floor((s+u)/2);(a=e({text:n.substr(0,l)+Ed,fontSize:r,fontFamily:i}).width)<=o?s=l+1:u=l-1}return n.substr(0,u)+Ed}function Wd(t){var e=t.baseline||t["dominant-baseline"],n=0,r=parseInt(t.fontSize||t["font-size"],10)||0;switch(e){case"hanging":n=.75*r;break;case"text-before-edge":n=.85*r;break;case"middle":n=.25*r;break;case"central":n=.35*r;break;case"mathemetical":n=r/2;break;case"text-after-edge":case"ideographic":n=.2*-r;break;default:n=0}return n}var Ud,Yd={},$d={},Xd={fontSize:void 0,fontFamily:void 0};function Gd(t,e,n){var r=t+e+n;return"number"!=typeof $d[r]&&(Ud=Ud||document.createElement("canvas").getContext("2d"),function(t,e){Xd.fontSize===t&&Xd.fontFamily===e||(Ud.font=t+" "+e,Xd.fontSize=t,Xd.fontFamily=e)}(e,n),$d[r]=Ud.measureText(t).width),$d[r]}function Kd(t){return"number"!=typeof Yd[t]&&(Yd[t]=function(t){if(Nd(t)){var e=parseFloat(t);return e+4*Math.ceil((e+1e-12)/24)}return 16}(t)),Yd[t]}function Jd(t){var e=t.text,n=t.fontSize;return{width:Gd(e,n,t.fontFamily),height:Kd(n)}}function Zd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jd,n=t["font-size"]||t.fontSize,r=t["font-family"]||t.fontFamily,i=e({text:t.text,fontFamily:r,fontSize:n}),o=Math.min(t.maxWidth||i.width,i.width),a=t.x||0,s=t.y||0,u=t.dx||0,l=(t.dy||0)+Wd(t),c={x:0,y:s+l-.75*i.height,width:o,height:i.height},h=t["text-anchor"]||t.anchor;return c.x="middle"===h?a+u-o/2:"end"===h?a+u-o:a+u,c}function Qd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jd,n=Vd(t),r=t["font-size"]||t.fontSize,i=t["font-family"]||t.fontFamily,o=e({text:t.text,fontFamily:i,fontSize:r});if(n&&(o.width>t.maxWidth||Md(t.text))){for(var a=n(t,(function(t){return e({text:t,fontFamily:i,fontSize:r})})),s=yn({},t),u=0,l="",c=0,h=a.lines.length;c<h;c++){var f=a.lines[c];f+=c===h-1&&a.reduced?Ed:"";var d=e({text:f,fontSize:r,fontFamily:i}).width;d>=u&&(u=d,l=f)}s.text=l;var p=Zd(s,e);return p.height=Od(t)*a.lines.length,p}return Zd(t,e)}var tp=.9;function ep(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function np(t,e,n){var r={type:"text",text:e,maxWidth:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:"start",baseline:"alphabetical",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},i=n.textMetrics;if(t.width<n.fontSize)return!1;var o=Math.max(0,t.width-i.width);return r.x=t.x+n.align*o,r.y=t.y+i.height/1.2,r}function rp(t){return{type:"circle",bounds:{cx:t.cx,cy:t.cy,r:t.r}}}function ip(t){return t.desc&&t.desc.slice?function(t){var e=t.start,n=t.end,r=t.innerRadius,i=t.outerRadius,o=t.offset;if(Math.abs(e+2*Math.PI-n)>1e-12)return{type:null,bounds:null};var a=0!==r?r:i;return rp({cx:o.x,cy:o.y,r:a})}(t.desc.slice):"circle"===t.type?rp(t.attrs):"rect"===t.type?{type:"rect",bounds:t.bounds}:{type:null,bounds:null}}var op={bar:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.rect,o=t.renderer,a=t.style,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rd,u=yn({fontSize:12,fontFamily:"Arial",align:.5,justify:0,fill:"#333"},a.label);u.fontSize=parseInt(u.fontSize,10);var l=e.labels.map((function(t){return yn({},u,e,t)})),c=e.labels.map((function(t){return t.placements.map((function(n){return yn({},u,e,t,n)}))})),h=id({nodes:r,chart:n,renderer:o,settings:e,rect:i,labelSettings:l,placementSettings:c}),f=h.fitsHorizontally,d=h.hasHorizontalDirection,p=h.targetNodes,m=od({orientation:e.orientation,defaultOrientation:d?"h":"v"}),g="h"===m?"y":"x",y="h"===m?"height":"width";return p.sort((function(t,e){return t.node.localBounds[g]+t.node.localBounds[y]-(e.node.localBounds[g]+e.node.localBounds[y])})),s({chart:n,targetNodes:p,stngs:e,rect:i,fitsHorizontally:f,collectiveOrientation:m})},slice:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.rect,o=t.renderer,a=t.style,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gd,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pd,l=yn({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,position:"into"},a.label);l.fontSize=parseInt(l.fontSize,10);for(var c=e.labels.map((function(t){return yn({},l,e,t)})),h=e.labels.map((function(t){return t.placements.map((function(n){return yn({},l,e,t,n)}))})),f=[],d={insideLabelBounds:[]},p={},m=0,g=(r=yd(r)).length;m<g;m++)for(var y=r[m],v=dd(y,n),x=0;x<c.length;x++){var b=c[x],w="function"==typeof b.label?b.label(v,m):"";if(w){var M="function"==typeof b.direction?b.direction(v,m):b.direction||"horizontal",k="function"==typeof b.linkData?b.linkData(v,m):void 0,_=vd(w,b,o),q=s({context:p,direction:M,lblStngs:b,measured:_,node:y,placementSettings:h[x],rect:i,store:d}),D=q.bounds,S=q.placement;if(D&&S){if("outside"===S.position&&"rotate"!==M){fd({context:p,node:y,bounds:D});var C=ud(D);if(!Hl(C,i))continue}var E="function"==typeof S.fill?S.fill(v,m):S.fill,A=u(D,w,{fill:E,fontSize:b.fontSize,fontFamily:b.fontFamily,textMetrics:_});A&&(void 0!==k&&(A.data=k),f.push(A),D.line&&(D.line.stroke=E,f.push(D.line)))}}}return f},rows:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.renderer,o=t.style,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:np,s=yn({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,align:.5,justify:.5},o.label);s.fontSize=parseInt(s.fontSize,10);for(var u=yn({},s,e),l=e.labels.map((function(t){return yn({},u,t)})),c={},h=[],f=0,d=r.length;f<d;f++){var p=r[f],m=ep(p,n),g=ip(p),y=g.type,v=g.bounds;if(v){var x=0,b=[],w=[],M="circle"===y?2*v.r*tp:v.height;x+=u.padding;var k=void 0;for(k=0;k<l.length;k++){var _=l[k],q="function"==typeof _.label?_.label(m,f):"";c.fontFamily=_.fontFamily,c.fontSize="".concat(_.fontSize,"px"),c.text=q;var D=i.measureText(c);if((x+=D.height+_.padding)>M)break;w.push(q),b.push(D)}var S=k,C=Math.max(0,M-x),E=void 0;for(E="circle"===y?v.cy-v.r*tp:v.y,E+=u.justify*C+u.padding,k=0;k<S;k++){var A=l[k],N=void 0;if("circle"===y){var O=Math.max(Math.abs(E-v.cy),Math.abs(E+b[k].height-v.cy)),I=Math.sqrt(v.r*v.r-O*O);N={x:v.cx-I+u.padding,y:E,width:2*I-2*u.padding,height:b[k].height}}else N={x:v.x+u.padding,y:E,width:v.width-2*u.padding,height:b[k].height};E+=b[k].height+u.padding;var T="function"==typeof A.fill?A.fill(m,f):A.fill,R="function"==typeof A.linkData?A.linkData(m,f):void 0,P=a(N,w[k],{fill:T,align:A.align,fontSize:A.fontSize,fontFamily:A.fontFamily,textMetrics:b[k]});if(P){if(P.text&&P.text!==Ed){var F=Bd(P,i.measureText);if(Ed===F)continue;P.ellipsed=F}void 0!==R&&(P.data=R),h.push(P)}}}}return h}};var ap={require:["chart","renderer","settings"],defaultSettings:{settings:{},style:{label:"$label"}},render:function(){var t=this,e=this.settings.settings,n=[];return(e.sources||[]).forEach((function(e){e.strategy&&op[e.strategy.type]&&e.component&&n.push.apply(n,Fn(function(t,e){var n=t.chart,r=t.source,i=t.rect,o=t.renderer,a=t.style;if(!n.component(r.component))return[];var s=n.findShapes(r.selector).filter((function(t){return t.key===r.component}));return e({chart:n,settings:r.strategy.settings,nodes:s,rect:{x:0,y:0,width:i.width,height:i.height},renderer:o,style:a})}({chart:t.chart,rect:t.rect,renderer:t.renderer,source:e,style:t.style},op[e.strategy.type])))})),n}};var sp={layout:{size:1,direction:"ltr",scrollOffset:0},item:{show:!0,justify:.5,align:.5,label:{fontSize:"12px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:136,lineHeight:1.2},shape:{type:"square",size:12}},title:{show:!0,text:void 0,anchor:"start",fontSize:"16px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:156,lineHeight:1.25},navigation:{button:{class:void 0,content:void 0,tabIndex:void 0},disabled:!1}};function up(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=t.item,o=t.globalMetrics,a=t.createSymbol,s=t.direction,u=void 0===s?"ltr":s,l=i.label.displayObject,c=i.label.bounds,h=i.symbol.meta,f="rtl"===u,d={x:f?n+o.maxLabelBounds.width:n+o.maxSymbolSize+o.spacing,y:r,width:o.maxLabelBounds.width,height:Math.max(o.maxSymbolSize,o.maxLabelBounds.height)},p=function(t,e,n){var r=Math.max(0,t.width-e),i=Math.max(0,t.height-e);return{x:t.x+e/2+n.align*r,y:t.y+e/2+n.justify*i}}({x:f?n+o.maxLabelBounds.width+o.spacing:n,y:r,width:o.maxSymbolSize,height:d.height},h.size,{align:void 0===h.align?.5:h.align,justify:void 0===h.justify?.5:h.justify}),m=a(yn({},h,p));return delete m.collider,l.anchor=f?"end":"start",function(t,e,n){var r=n.textMetrics;if(t.height<r.height)return!1;var i=Math.max(0,t.width-r.width);e.baseline="text-before-edge";var o=Math.max(0,t.height-r.height);e.x=t.x+n.align*i,e.y=t.y+n.justify*o+.175*parseInt(e.fontSize,10)}(d,l,{textMetrics:c,fontSize:parseInt(l.fontSize,10),align:0,justify:.5}),{item:{type:"container",data:i.label.displayObject.data,children:[m,l],collider:{type:"rect",x:n,y:r,width:o.maxItemBounds.width,height:o.maxItemBounds.height}},metrics:d}}function lp(t,e){var n=t.items.length,r=Math.ceil(n/e),i="horizontal"===t.layout.orientation?"width":"height",o="width"===i?"horizontal":"vertical";return t.globalMetrics.maxItemBounds[i]*r+(r-1)*t.layout.margin[o]}function cp(t,e){var n,r,i,o,a=e.onScroll,s=void 0===a?function(){}:a,u=null,l=0,c={itemize:function(e){n=function(t,e){for(var n,r,i=t.resolved,o=t.dock,a=[],s=i.items.items,u=i.symbols.items,l=i.labels.items,c=0,h=0,f=0,d=0;d<s.length;d++)if(!1!==s[d].show){var p=void 0!==l[d].text?l[d].text:l[d].data.label||"";n=yn({},l[d],{type:"text",fontSize:"".concat(parseInt(l[d].fontSize,10),"px"),text:p,title:p}),r={symbol:{meta:u[d]},label:{displayObject:n,bounds:e.textBounds(n)}},a.push(r),c=Math.max(u[d].size,c),h=Math.max(r.label.bounds.width,h),f=Math.max(r.label.bounds.height,f)}return{items:a,globalMetrics:{spacing:8,maxSymbolSize:c,maxItemBounds:{height:Math.max(c,f),width:c+8+h},maxLabelBounds:{width:h,height:f}},layout:{margin:{vertical:void 0!==i.layout.item.vertical?i.layout.item.vertical:4,horizontal:void 0!==i.layout.item.horizontal?i.layout.item.horizontal:4},mode:i.layout.item.mode,size:i.layout.item.size,orientation:"top"===o||"bottom"===o?"horizontal":"vertical",direction:i.layout.item.direction,scrollOffset:i.layout.item.scrollOffset}}}(e,t.renderer),u=isNaN(n.layout.scrollOffset)?u:n.layout.scrollOffset},getItemsToRender:function(e){i=e.viewRect,l=c.getContentOverflow(i);var a=c.extent();u=Math.max(0,Math.min(u,l)),o=yn({},i);var s="horizontal"===c.orientation()?"x":"y";return o[s]-=u,o["x"===s?"width":"height"]=a,function(t,e,n){for(var r=t.viewRect,i=n.itemized,o=n.create,a=void 0===o?up:o,s=n.parallels,u=n.createSymbol,l=i.layout.direction,c=i.globalMetrics,h=i.items,f="horizontal"===i.layout.orientation,d=0,p=[],m=c.maxItemBounds.height,g=c.maxItemBounds.width,y=i.layout.margin.vertical+m,v=i.layout.margin.horizontal+g,x=e.x,b=e.y,w=r.x-e.x,M=0;M<h.length;M++){var k=a({y:b,x:"rtl"===l?r.x+w+r.width-g-(x-e.x):x,item:h[M],globalMetrics:c,direction:l,createSymbol:u});if((f&&x>=r.x-g||!f&&b>=r.y-m)&&p.push(k.item),++d>=s?(d=0,f?(x+=v,b=e.y):(b+=y,x=e.x)):f?b+=y:x+=v,!f&&b>r.y+r.height)break;if(f&&x>r.x+r.width)break}return p}(e,o,{itemized:n,parallels:r,createSymbol:t.symbol})},parallelize:function(t,e){return r=function(t,e,n){var r=n.items.length,i="horizontal"===n.layout.orientation?"width":"height",o="width"===i?"horizontal":"vertical",a=n.globalMetrics.maxItemBounds[i]*r+(r-1)*n.layout.margin[o],s=Math.ceil(a/t);if(null!=e){var u="horizontal"===n.layout.orientation?"height":"width",l="width"===u?"horizontal":"vertical",c=n.layout.margin[l]||4,h=Math.floor((e+c)/(c+n.globalMetrics.maxItemBounds[u]));s=Math.min(s,h)}var f=isNaN(n.layout.size)?1:n.layout.size;return Math.max(1,Math.min(s,f))}(t,e,n),r},hasContentOverflow:function(){var t="horizontal"===n.layout.orientation?"width":"height";return lp(n,r)>i[t]},getContentOverflow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e="horizontal"===n.layout.orientation?"width":"height";return Math.max(0,lp(n,r)-t[e])},getNextSize:function(){var t="horizontal"===n.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return n.globalMetrics.maxItemBounds[t]+n.layout.margin[e]},getPrevSize:function(){var t="horizontal"===n.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return n.globalMetrics.maxItemBounds[t]+n.layout.margin[e]},hasNext:function(){return"horizontal"===c.orientation()?i.x+i.width<o.x+o.width:i.y+i.height<o.y+o.height},hasPrev:function(){return"horizontal"===c.orientation()?o.x<i.x:o.y<i.y},next:function(){c.scroll(-c.getNextSize())},prev:function(){c.scroll(c.getPrevSize())},scroll:function(t){var e=Math.max(0,Math.min(l,u-t));e!==u&&(u=e,s())},offset:function(){return u},orientation:function(){return n.layout.orientation},direction:function(){return n.layout.direction},extent:function(){return lp(n,r)},spread:function(){return function(t,e){var n=e,r="horizontal"===t.layout.orientation?"height":"width",i="width"===r?"horizontal":"vertical";return t.globalMetrics.maxItemBounds[r]*n+(n-1)*t.layout.margin[i]}(n,r)}};return c}function hp(t){return Object.keys(t).filter((function(e){return t[e]})).join(" ")}var fp={up:"",right:"",down:"",left:""};function dp(t,e){var n=e.size,r=e.isActive,i=e.direction,o=e.nav,a={},s="",u=e.attrs;o&&o.button&&("function"==typeof o.button.class?a=o.button.class({direction:i}):o.button.class&&(a=o.button.class),"function"==typeof o.button.content&&(s=o.button.content(t,{direction:i})),void 0!==o.button.tabIndex&&(u.tabindex=o.button.tabIndex));var l={width:"".concat(n,"px"),minWidth:"".concat(n,"px"),height:"".concat(n,"px")};return Object.keys(a).length||(l.border="0",l.background="none"),(!r||o&&o.disabled)&&(u.disabled="disabled"),t("button",yn({class:hp(a),style:l},u),[s||t("span",{style:{pointerEvents:"none"}},[fp[i]])])}function pp(t){var e,n={itemize:function(t){var n,r;r=(n=t).dock,e={layout:{orientation:"top"===r||"bottom"===r?"vertical":"horizontal"},navigation:n.navigation}},render:function(r){return function(t,e,n,r){var i=e.rect,o=e.itemRenderer;if(t&&t.renderArgs){t.size(i);var a=t.renderArgs[0],s="vertical"===n.layout.orientation,u="rtl"===o.direction(),l=o.hasNext(),c=o.hasPrev();if(c||l){var h=s?["right","left"]:["down","up"];u&&s&&h.reverse();var f=[a("div",{style:{position:"relative",display:"flex","flex-direction":s?"column":"row","justify-content":"center",height:"100%",pointerEvents:"auto"},dir:u&&!s?"rtl":"ltr"},[dp(a,{size:32,isActive:l,direction:h[0],attrs:{"data-action":"next","data-component-key":r.settings.key},nav:n.navigation}),dp(a,{size:32,isActive:c,direction:h[1],attrs:{"data-action":"prev","data-component-key":r.settings.key},nav:n.navigation})])];t.render(f)}else t.render([])}}(n.renderer,r,e,t)},extent:function(){return 32},spread:function(){return 64}};return n}function mp(t){var e,n={itemize:function(n){e=function(t,e){var n=t.resolved;if(!1===n.title.item.show)return null;var r=yn({},n.title.item,{type:"text"});if("rtl"===n.layout.item.direction&&(r.anchor&&"start"!==r.anchor?"end"===r.anchor&&(r.anchor="start"):r.anchor="end"),void 0===n.title.settings.text){var i=e.scale.data().fields;r.text=i&&i[0]?i[0].title():""}return{displayObject:r,bounds:e.renderer.textBounds(r)}}(n,t)},render:function(t){!function(t,e,n){var r=t.rect;if(e){var i=[];if(e.size(r),n){var o={start:0,end:r.width,middle:r.width/2};i.push(yn({},n.displayObject,{x:o[n.displayObject.anchor]||0,y:0,baseline:"text-before-edge",title:n.displayObject.text}))}e.render(i)}}(t,n.renderer,e)},spread:function(){return e?e.bounds.height:0},extent:function(){return e?e.bounds.width:0}};return n}function gp(t,e,n,r){var i,o,a,s=r.itemRenderer,u=r.navigationRenderer,l=r.titleRenderer,c=r.isPreliminary,h=void 0!==c&&c,f=0,d={x:e.spacing,y:e.spacing,width:t.width-2*e.spacing,height:t.height-2*e.spacing};if(i={x:d.x,y:d.y,width:d.width,height:l.spread()},"horizontal"===n){i={x:d.x,y:d.y,width:l.extent(),height:l.spread()};var p=d.width-i.width-(i.width?e.spacing:0),m=d.height;s.parallelize(p,h?void 0:m);var g=s.extent()>p?u.extent():0,y=s.spread(),v=g?u.spread():0;a={x:(o={x:i.x+i.width+(i.width?e.spacing:0),y:d.y+Math.max(0,(v-y)/2),width:d.width-g-i.width-(g?e.spacing:0)-(i.width?e.spacing:0),height:m}).x+o.width+(g?e.spacing:0),y:d.y,width:g,height:d.height},i.y=o.y,"rtl"===s.direction()&&(a.x=d.x,o.x=a.x+a.width+(a.width?e.spacing:0),i.x=o.x+o.width+(i.width?e.spacing:0)),f=Math.max(i.height,v,s.spread())}else{var x=d.height-i.height-(i.height?e.spacing:0),b=d.width;s.parallelize(x,h?void 0:b);var w=s.extent()>x?u.extent():0;a={x:d.x,y:d.y+d.height-w,width:d.width,height:w},o={x:d.x,y:i.y+i.height+(i.height?e.spacing:0),width:d.width,height:d.height-i.height-(i.height?e.spacing:0)-a.height-(a.height?e.spacing:0)},f=Math.max(l.extent(),w?u.spread():0,s.spread())}return o=yn({},t,{x:t.x+o.x,y:t.y+o.y,width:o.width,height:o.height}),a.x+=t.x,a.y+=t.y,i.x+=t.x,i.y+=t.y,{title:yn({},t,i),content:yn({},t,o),navigation:yn({},t,a),orientation:n,preferredSize:f}}function yp(t){t.state.resolved=function(t){var e=t.scale.domain(),n={items:[]},r=t.settings.layout.dock;if("threshold-color"===t.scale.type){var i=t.scale.data().fields[0],o=function(t){return String(t)};t.settings.formatter?o=t.chart.formatter(t.settings.formatter):i&&(o=i.formatter());for(var a=0;a<e.length-1;a++){var s={value:e[a],label:"".concat(o(e[a])," - < ").concat(o(e[a+1]))};i&&(s.source={field:i.id()}),n.items.push(s)}"vertical"==("top"===r||"bottom"===r?"horizontal":"vertical")&&n.items.reverse()}else{var u=t.scale.labels?t.scale.labels():null;n.items=e.map((function(e,n){var r=t.scale.datum?yn({},t.scale.datum(e)):{value:e};return r.value=e,t.scale.label?r.label=t.scale.label(e):u&&(r.label=u[n]),r}))}var l=t.resolver.resolve({data:{fields:t.scale.data().fields},defaults:yn(!0,{},sp.title,t.style.title),settings:t.settings.settings.title}),c=t.resolver.resolve({data:{fields:t.scale.data().fields},defaults:sp.layout,settings:t.settings.settings.layout}),h=t.resolver.resolve({data:n,defaults:yn(!0,{},sp.item.label,t.style.item.label),settings:(t.settings.settings.item||{}).label}),f=yn(!0,{},(t.settings.settings.item||{}).shape);void 0===f.fill&&t.settings.scale&&(f.fill={scale:t.settings.scale});var d=t.resolver.resolve({data:n,defaults:yn(!0,{},sp.item.shape,t.style.item.shape),settings:f}),p=t.resolver.resolve({data:n,defaults:yn(!0,{},{show:sp.item.show}),settings:{show:(t.settings.settings.item||{}).show}});function m(t,n){var r=t.data.value,i=e[n+1];t.data.value=[r,i]}return"threshold-color"===t.scale.type&&("vertical"==("top"===r||"bottom"===r?"horizontal":"vertical")?(p.items.reverse().forEach(m),p.items.reverse()):p.items.forEach(m)),{title:l,labels:h,symbols:d,items:p,layout:c}}(t),t.titleRenderer.itemize({resolved:t.state.resolved,dock:t.settings.layout.dock||"center"}),t.itemRenderer.itemize({resolved:t.state.resolved,dock:t.settings.layout.dock||"center"}),t.navigationRenderer.itemize({resolved:t.state.resolved,dock:t.settings.layout.dock||"center",navigation:t.settings.settings.navigation}),t.state.display={spacing:8}}function vp(t){var e=t.rect,n=t.settings,r=t.state,i=t.itemRenderer,o=t.navigationRenderer,a=t.titleRenderer,s=n.layout.dock,u="top"===s||"bottom"===s?"horizontal":"vertical",l=gp(e,r.display,u,{itemRenderer:i,navigationRenderer:o,titleRenderer:a});t.renderer.size(l.content);var c=i.getItemsToRender({viewRect:yn({},l.content,{x:0,y:0})});return o.render({rect:l.navigation,itemRenderer:i}),a.render({rect:l.title}),t.state.views={layout:l},c}var xp={require:["chart","settings","renderer","update","resolver","registries","symbol"],defaultSettings:{settings:{},style:{item:{label:"$label",shape:"$shape"},title:"$title"}},mounted:function(t){t&&t.parentNode&&(this.navigationRenderer.renderer.appendTo(t.parentNode),this.titleRenderer.renderer.appendTo(t.parentNode),t.parentNode.insertBefore(this.navigationRenderer.renderer.element(),t),t.parentNode.insertBefore(this.titleRenderer.renderer.element(),t)),this.navigationRenderer.render({rect:this.state.views.layout.navigation,itemRenderer:this.itemRenderer}),this.titleRenderer.render({rect:this.state.views.layout.title})},beforeUnmount:function(){this.navigationRenderer.renderer.clear(),this.titleRenderer.renderer.clear()},on:{panstart:function(){this.state.interaction.started||this.itemRenderer.getContentOverflow()&&(this.state.interaction.started=!0,this.state.interaction.delta=0)},panmove:function(t){if(this.state.interaction.started){var e="horizontal"===this.itemRenderer.orientation()?("rtl"===this.itemRenderer.direction()?-1:1)*t.deltaX:t.deltaY;this.itemRenderer.scroll(e-this.state.interaction.delta),this.state.interaction.delta=e}},panend:function(){this.state.interaction.started=!1},scroll:function(t){this.itemRenderer.scroll(-t)},next:function(){this.itemRenderer.next()},prev:function(){this.itemRenderer.prev()}},created:function(){var t=this;this.state={interaction:{}},this.onScroll=function(){var e=vp(t);t.update(e)},this.itemRenderer=cp(this,{onScroll:this.onScroll}),this.navigationRenderer=pp(this),this.titleRenderer=mp(this),this.navigationRenderer.renderer=this.registries.renderer("dom")(),this.titleRenderer.renderer=this.registries.renderer(this.settings.renderer)(),yp(this)},preferredSize:function(t){return function(t,e){var n=0,r=t.settings.layout.dock||"center",i="top"===r||"bottom"===r?"horizontal":"vertical",o=t.state.display,a=gp(e.inner,o,i,{itemRenderer:t.itemRenderer,navigationRenderer:t.navigationRenderer,titleRenderer:t.titleRenderer,isPreliminary:!0});return n+=o.spacing,n+=a.preferredSize,n+o.spacing}(this,t)},beforeUpdate:function(){yp(this)},render:function(){return vp(this)},beforeDestroy:function(){this.navigationRenderer.renderer.destroy(),this.titleRenderer.renderer.destroy()},additionalElements:function(){return[this.titleRenderer.renderer.element(),this.navigationRenderer.renderer.element()]},_DO_NOT_USE_getInfo:function(){return{offset:this.itemRenderer.offset()}}};function bp(t,e){var n=0,r=t.state.isVertical?"justify":"align",i=t.state.isVertical?"y":"x",o=t.state.isVertical?"height":"width",a=t.state.isVertical?"requiredHeight":"requiredWidth";n=t.state.rect[o]-t.state.legend.length()-t.state.title[a](),n*=Math.min(1,Math.max(t.stgns[r],0)),e[i]+=n}function wp(t,e,n){var r=n[t];return"object"===wn(r)?-1!==r.valid.indexOf(e)?e:r.default:n.default}function Mp(t){return wp(t.layout.dock,t.settings.title.anchor,{left:{valid:["top"],default:"top"},right:{valid:["top"],default:"top"},top:{valid:["left","right"],default:"left"},bottom:{valid:["left","right"],default:"left"},default:"top"})}function kp(t,e){var n={x:0,y:0,width:0,height:0},r=t.stgns.padding;return n.x=r.left,n.y=r.top,n.width=e.width-r.left-r.right,n.height=e.height-r.top-r.bottom,n}function _p(t){var e,n="top"!==t.settings.layout.dock&&"bottom"!==t.settings.layout.dock,r=t.stgns.title,i=t.chart.scale(t.stgns.fill),o=t.chart.scale(t.stgns.major),a=function(t,e){var n=e.domain(),r=n,i=t.stgns.tick.label;!i&&t.formatter?i=t.formatter:!i&&e.data().fields&&(i=e.data().fields[0].formatter()),"function"==typeof i&&(r=n.map(i).map(String));var o=n.map((function(n,i){var o=r[i];return{value:n,label:o,pos:e.norm(parseFloat(n,10)),textMetrics:t.renderer.measureText({text:o,fontSize:t.stgns.tick.fontSize,fontFamily:t.stgns.tick.fontFamily})}}));return o}(t,o),s=wp((e=t.settings).layout.dock,e.settings.tick.anchor,{left:{valid:["left","right"],default:"left"},right:{valid:["left","right"],default:"right"},top:{valid:["top","bottom"],default:"top"},bottom:{valid:["top","bottom"],default:"bottom"},default:"right"});if(void 0===r.text){var u=o.data().fields;r.text=u&&u[0]?u[0].title():""}var l=t.renderer.measureText({text:r.text,fontSize:r.fontSize,fontFamily:r.fontFamily}),c=t.renderer.textBounds({text:r.text,fontSize:r.fontSize,fontFamily:r.fontFamily,maxLines:r.maxLines,maxWidth:r.maxLengthPx,wordBreak:r.wordBreak,hyphens:r.hyphens,lineHeight:r.lineHeight}),h={isVertical:n,nodes:[],title:{anchor:Mp(t.settings),textMetrics:l,textBounds:c,requiredWidth:function(){if(!r.show)return 0;var t=c.width,e=r.maxLengthPx;return n||(t+=r.padding,e+=r.padding),Math.min(t,e,h.rect.width)},requiredHeight:function(){if(!r.show)return 0;var t=c.height;return n&&(t+=r.padding),Math.min(t,h.rect.height)}},ticks:{values:a,anchor:s,length:Math.min(Math.max.apply(Math,Fn(a.map((function(t){return t.textMetrics.width})))),t.stgns.tick.maxLengthPx),requiredHeight:function(){return"top"===s?Math.max.apply(Math,Fn(h.ticks.values.map((function(t){return t.textMetrics.height}))))+t.stgns.tick.padding:0},height:Math.max.apply(Math,Fn(a.map((function(t){return t.textMetrics.height}))))},legend:{fillScale:i,majorScale:o,length:function(){var e=n?"height":"width",r=n?"requiredHeight":"requiredWidth",i=Math.min(h.rect[e],h.rect[e]*t.stgns.length)-h.title[r]();return Math.max(0,Math.min(i,t.stgns.maxLengthPx))}}};return h}var qp={require:["chart","settings","renderer"],defaultSettings:{layout:{displayOrder:0,dock:"right"},settings:{size:15,length:.5,maxLengthPx:250,align:.5,justify:0,padding:{left:5,right:5,top:5,bottom:5},tick:{label:null,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,anchor:null,padding:5},title:{show:!0,text:void 0,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,padding:5,maxLines:2,wordBreak:"none",lineHeight:1.2,hyphens:"auto",anchor:null}}},preferredSize:function(t){var e=this.state;e.rect=kp(this,t.inner);var n=this.stgns.size,r=e.isVertical?this.stgns.padding.left+this.stgns.padding.right:this.stgns.padding.top+this.stgns.padding.bottom;n+=r;var i=Math.max(t.inner.width,t.inner.height);if("left"===e.ticks.anchor||"right"===e.ticks.anchor){var o=e.ticks.values.reduce((function(t,e){return t+e.textMetrics.height}),0);if(o>this.state.legend.length())return i;n+=e.ticks.length}else{if(e.ticks.length>this.state.legend.length())return i;n+=Math.max.apply(Math,Fn(e.ticks.values.map((function(t){return t.textMetrics.height}))))}return n+=this.stgns.tick.padding,this.stgns.title.show&&(n="left"===e.title.anchor||"right"===e.title.anchor?Math.max(e.title.textBounds.height+r,n):Math.max(n,e.title.requiredWidth()+r)),this.state.preferredSize=n,n},created:function(){this.stgns=this.settings.settings,this.state=_p(this)},beforeUpdate:function(t){this.stgns=t.settings.settings,this.state=_p(this)},beforeRender:function(t){if(this.state.nodes=[],this.state.rect=kp(this,t.size),this.stgns.title.show){var e=function(t){var e=t.state,n=t.stgns,r="left"===e.ticks.anchor,i="top"===e.ticks.anchor,o=e.rect.x,a=e.rect.y,s="start";"left"===e.title.anchor?(o+=e.title.requiredWidth()-n.title.padding,a+=e.title.textMetrics.height,a+=i?e.rect.height-e.title.textBounds.height:0,s="end"):"right"===e.title.anchor?(o+=e.legend.length(),o+=n.title.padding,a+=e.title.textMetrics.height,a+=i?e.rect.height-e.title.textBounds.height:0):"top"===e.title.anchor&&(o+=r?e.rect.width:0,a+=e.title.textMetrics.height,s=r?"end":"start");var u={tag:"legend-title",type:"text",x:o,y:Math.min(a,e.rect.y+e.rect.height),text:n.title.text,fill:n.title.fill,fontSize:n.title.fontSize,fontFamily:n.title.fontFamily,maxWidth:n.title.maxLengthPx,maxLines:n.title.maxLines,wordBreak:n.title.wordBreak,hyphens:n.title.hyphens,lineHeight:n.title.lineHeight,anchor:s,title:n.title.text};return bp(t,u),u}(this);this.state.nodes.push(e)}var n,r,i,o,a=(r=(n=this).state.legend.fillScale,i=n.state.legend.majorScale,o=r.domain().map((function(t){return{type:"stop",color:r(t),offset:Math.min(1,Math.max(0,i.norm(t)))}})),o.sort((function(t,e){return t.offset-e.offset}))),s=function(t,e){var n=t.state,r=t.stgns,i=n.rect,o=i.x,a=i.y,s=n.isVertical?r.size:n.legend.length(),u=n.isVertical?n.legend.length():r.size;"left"===n.ticks.anchor?o+=n.rect.width-r.size:"top"===n.ticks.anchor&&(a+=n.rect.height-r.size),"top"===n.title.anchor?a+=n.title.requiredHeight():"left"===n.title.anchor&&(o+=n.title.requiredWidth());var l={type:"rect",x:o,y:a,width:s,height:u,fill:{type:"gradient",stops:e,degree:n.isVertical?90:180}};return bp(t,l),l}(this,a),u=function(t,e){var n=t.state,r=t.stgns,i="start",o={type:"rect",x:e.x,y:e.y,width:n.isVertical?0:e.width,height:n.isVertical?e.height:0,fill:"transparent"},a=n.ticks.values.map((function(a){var s=0,u=0,l=0,c="alphabetical";return n.isVertical?(u=e.y+e.height*a.pos,c=0===a.pos?"text-before-edge":"text-after-edge"):s=e.x+e.width*a.pos,"right"===n.ticks.anchor?(s=e.x+r.size+r.tick.padding,o.x=e.x+e.width):"left"===n.ticks.anchor?(s=e.x-r.tick.padding,i="end"):"top"===n.ticks.anchor?(u=e.y-r.tick.padding,l-=.25*a.textMetrics.height,i=0===a.pos?"start":"end"):"bottom"===n.ticks.anchor&&(u=e.y+e.height+r.tick.padding,l=.8*a.textMetrics.height,i=0===a.pos?"start":"end",o.y=e.y+e.height),{type:"text",x:s,y:u,dx:0,dy:l,text:a.label,fontSize:r.tick.fontSize,fontFamily:r.tick.fontFamily,fill:r.tick.fill,maxWidth:n.isVertical?r.tick.maxLengthPx:Math.min(r.tick.maxLengthPx,n.legend.length()/2),anchor:i,textBoundsFn:t.renderer.textBounds,title:a.label,baseline:c}}));return{type:"container",id:"legend-seq-ticks",children:[].concat(Fn(a),[o])}}(this,s),l={id:"legend-seq-target",type:"container",children:[s,u]};this.state.nodes.push(l)},render:function(){return this.state.nodes}};var Dp={step:function(t){return new Xr(t,.5)},stepAfter:function(t){return new Xr(t,1)},stepBefore:function(t){return new Xr(t,0)},linear:qr,basis:function(t){return new Ir(t)},cardinal:Pr.tension(0),catmullRom:Lr,monotonex:function(t){return new Br(t)},monotoney:function(t){return new Wr(t)},natural:function(t){return new Yr(t)}},Sp={coordinates:{minor:.5,major:.5,layerId:0,defined:!0},connect:!1,orientation:"horizontal",layers:{curve:"linear",show:!0,sort:void 0,line:{stroke:"#ccc",strokeWidth:1,strokeLinejoin:"miter",strokeDasharray:void 0,opacity:1,show:!0,showMinor0:!0},area:{fill:"#ccc",opacity:.8,show:!0}}};function Cp(t,e){var n=e.generator,r=e.item,i=e.data,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=n(t),s={type:"path",d:a,opacity:r.opacity,stroke:r.stroke,strokeWidth:r.strokeWidth,strokeLinejoin:r.strokeLinejoin,fill:o||r.fill,data:i};return r.strokeDasharray&&(s.strokeDasharray=r.strokeDasharray),s}function Ep(t){var e=function(t){for(var e=t.data,n=t.stngs,r=t.rect,i=t.resolver,o=t.style,a=t.domain,s=r.width,u=r.height,l=i.resolve({data:e,defaults:Sp.coordinates,settings:n.coordinates||{},scaled:{major:"vertical"===n.orientation?u:s,minor:"vertical"===n.orientation?s:u}}),c=!n.connect&&a.length>2&&("function"==typeof n.coordinates.layerId||"object"===wn(n.coordinates.layerId)),h={},f=0,d=0;d<l.items.length;d++){var p=l.items[d],m=p.layerId;if(c){var g=h[m]?h[m].items[h[m].items.length-1]:null,y=g?a.indexOf(g.data.major?g.data.major.value:g.data.value):null;g&&a.indexOf(p.data.major?p.data.major.value:p.data.value)-1!==y&&h[m].items.push({dummy:!0})}h[m]=h[m]||{order:f++,id:m,items:[],dataItems:[],consumableData:{}},h[m].dataItems.push(p.data),h[m].items.push(p)}var v=Object.keys(h).map((function(t){return h[t].consumableData=bn({points:h[t].dataItems},h[t].dataItems[0]),h[t]})),x={items:v.map((function(t){return t.consumableData}))},b=n.layers||{};return{coordinates:l,metaLayers:v,layers:i.resolve({data:x,defaults:{curve:Sp.layers.curve,show:Sp.layers.show},settings:{curve:b.curve,show:b.show}}),lines:i.resolve({data:x,defaults:yn({},Sp.layers.line,o.line),settings:b.line}),areas:i.resolve({data:x,defaults:yn({},Sp.layers.area,o.area),settings:b.area})}}(t),n=e.metaLayers,r=e.coordinates,i=e.layers,o=e.lines,a=e.areas,s=[];return n.forEach((function(e,n){var u=i.items[n];if(!1!==u.show){u.datum=u.data,u.data=[],u.id=e.id;for(var l,c,h=[],f=[],d=0;d<e.items.length;d++){if(c=(l=e.items[d]).data,!l.dummy){if(isNaN(l.major))continue;t.missingMinor0&&(l.minor0=r.settings.minor.scale?r.settings.minor.scale(c.minor0?c.minor0.value:0):0),isNaN(l.minor)||h.push(l.minor),u.data.push(l.data)}f.push(l)}var p=h.sort((function(t,e){return t-e}))[Math.floor((h.length-1)/2)];s.push({layerObj:u,lineObj:o.items[n],areaObj:a.items[n],median:p,points:f,consumableData:e.consumableData})}})),s}var Ap={require:["chart","resolver"],defaultSettings:{style:{area:"$shape",line:"$shape-outline"}},created:function(){},render:function(t){var e=t.data,n=this.rect,r=n.width,i=n.height;this.stngs=this.settings.settings||{};var o=!this.stngs.coordinates||void 0===this.stngs.coordinates.minor0,a=Ep({data:e,stngs:this.stngs,rect:this.rect,resolver:this.resolver,style:this.style,missingMinor0:o,domain:this.stngs.coordinates&&this.stngs.coordinates.major&&this.stngs.coordinates.major.scale?this.chart.scale(this.stngs.coordinates.major.scale).domain():[]});if(this.stngs.layers&&this.stngs.layers.sort){var s=a.map((function(t){return{id:t.layerObj.id,data:t.layerObj.data}})).sort(this.stngs.layers.sort).map((function(t){return t.id}));a.sort((function(t,e){return s.indexOf(t.layerObj.id)-s.indexOf(e.layerObj.id)}))}else a.sort((function(t,e){return t.median-e.median}));return function(t,e){var n=e.width,r=e.height,i=e.missingMinor0,o=e.stngs,a=[],s=o.layers||{};return t.forEach((function(t){var e,u,l=t.lineObj,c=t.layerObj,h=t.areaObj,f=t.points,d=Cr(),p=o.coordinates?o.coordinates.defined:null,m={size:r,p:"y"},g={size:n,p:"x"};if("vertical"===o.orientation){var y=yn(!0,{},g);g=yn(!0,{},m),m=yn(!0,{},y)}d[g.p]((function(t){return t.major*g.size}))["".concat(m.p,"1")]((function(t){return t.minor*m.size}))["".concat(m.p,"0")]((function(t){return t.minor0*m.size})).curve(Dp["monotone"===c.curve?"monotone".concat(g.p):c.curve]),p?d.defined((function(t){return!t.dummy&&"number"==typeof t.minor&&!isNaN(t.minor)&&t.defined})):d.defined((function(t){return!t.dummy&&"number"==typeof t.minor&&!isNaN(t.minor)}));var v=o.connect?f.filter(d.defined()):f;e=d["line".concat(m.p.toUpperCase(),"1")](),u=d["line".concat(m.p.toUpperCase(),"0")](),s.area&&!1!==h.show&&a.push(Cp(v,{data:t.consumableData,item:h,generator:d})),l&&!1!==l.show&&(a.push(Cp(v,{data:t.consumableData,item:l,generator:e},"none")),!i&&s.area&&!1!==h.show&&!1!==l.showMinor0&&a.push(Cp(v,{data:t.consumableData,item:l,generator:u},"none")))})),a}(a,{width:r,height:i,missingMinor0:o,stngs:this.stngs})}};function Np(t,e){var n,r,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"object"===wn(e.center)?(n=e.center.x,r=e.center.y):(n=e.clientX,r=e.clientY);var o=n-t.state.boundingRect.left,a=r-t.state.boundingRect.top;return{x:i?Math.max(0,Math.min(o,t.rect.width)):o,y:i?Math.max(0,Math.min(a,t.rect.height)):a}}function Op(t,e){return{x:e.x+t.rect.x,y:e.y+t.rect.y}}function Ip(t,e){var n=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return{x:n,y:r,width:Math.max(t.x,e.x)-n,height:Math.max(t.y,e.y)-r}}var Tp={require:["chart","renderer"],defaultSettings:{layout:{displayOrder:99},settings:{brush:{components:[]}},style:{area:"$selection-area-target"}},on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaCancel:function(){this.cancel()}},created:function(){this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1}},preferredSize:function(){return 0},render:function(){},start:function(t){this.state.boundingRect=this.renderer.element().getBoundingClientRect();var e=Np(this,t,!1);ic({x:0,y:0,width:this.rect.width,height:this.rect.height},e)&&(this.state.brushConfig=this.settings.settings.brush.components.map((function(t){return{key:t.key,contexts:t.contexts,data:t.data,action:t.action||"set"}})),this.state.start=Np(this,t),this.state.active=!0)},move:function(t){var e;this.state.active&&(this.state.end=Np(this,t),function(t){if(t.state.active){var e=Op(t,t.state.start),n=Op(t,t.state.end),r=t.chart.shapesAt(Ip(e,n),{components:t.state.brushConfig});t.chart.brushFromShapes(r,{components:t.state.brushConfig})}}(this),(e=this).renderer.render([yn({type:"rect"},Ip(e.state.start,e.state.end),e.style.area)]))},end:function(){this.state.active&&(this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach((function(t){Array.isArray(t.contexts)&&t.contexts.forEach((function(t){e.brush(t).end()}))})),this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))}};function Rp(t,e,n){var r=n.renderer,i=n.style,o=n.props,a=n.h,s=function(t,e){return{tooltip:"function"==typeof t.tooltipClass?t.tooltipClass({dock:e.dock}):t.tooltipClass,content:"function"==typeof t.contentClass?t.contentClass({dock:e.dock}):t.contentClass,arrow:"function"==typeof t.arrowClass?t.arrowClass({dock:e.dock}):t.arrowClass}}(o,e),u=function(t,e,n,r){return r.content({h:t,style:n,data:e})}(a,t,i,o),l=a("div",{dir:o.direction,class:hp(yn({"pic-tooltip":!0},s.tooltip)),style:yn({position:"relative",display:"inline-block"},e.computedTooltipStyle)},a("div",{style:i.content,class:hp(yn({"pic-tooltip-content":!0},s.content))},u),a("div",{class:hp(yn({"pic-tooltip-arrow":!0},s.arrow)),style:yn({},i.arrow,i["arrow-".concat(e.dock)],e.computedArrowStyle)}));return r.render(l),r.element().children[0]}function Pp(t){var e=t.defaultDuration,n=t.defaultDelay,r=null,i=null,o=!1,a=function(){var t=function(){},e={pending:[],debounced:[],active:[],cancelled:[],rejected:[],fulfilled:[]};return t.set=function(t){e[t].forEach((function(e){return e(t)}))},t.on=function(t,n){Array.isArray(t)?t.forEach((function(t){return e[t].push(n)})):e[t].push(n)},t.destroy=function(){Object.keys(e).forEach((function(t){e[t].length=0}))},t}(),s=function(){},u=function(){r=null,i=null,o=!1,a.set("fulfilled")};return s.invoke=function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;r&&(clearTimeout(r),a.set("debounced")),a.set("pending"),r=setTimeout((function(){t(),o=!0,r=null,a.set("active")}),l),s>0&&(i&&clearTimeout(i),i=setTimeout(u,s+Math.max(l,0)))},s.clear=function(){o?a.set("cancelled"):r&&(clearTimeout(r),a.set("rejected")),i&&clearTimeout(i),r=null,i=null,o=!1},s.on=function(t,e){a.on(t,e)},s.destroy=function(){s.clear(),a.destroy()},s}function Fp(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{left:"translate(-100%,-50%) translateX(".concat(-t,"px)"),right:"translate(".concat(t,"px, -50%)"),top:"translate(-50%, -100%) translateY(".concat(-t,"px)"),bottom:"translate(-50%, ".concat(t,"px)")}}function Lp(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{left:{x:-t-n,y:-e/2},right:{x:n,y:-e/2},top:{x:-t/2,y:-e-n},bottom:{x:-t/2,y:n}}}function jp(t){return{left:{left:"100%",top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},right:{left:"".concat(2*-t,"px"),top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},top:{left:"calc(50% - ".concat(t,"px)"),top:"100%",borderWidth:"".concat(t,"px")},bottom:{left:"calc(50% - ".concat(t,"px)"),top:"".concat(2*-t,"px"),borderWidth:"".concat(t,"px")}}}function zp(t,e,n,r,i,o){var a=e+o.x,s=n+o.y,u=i;return!(a<0||s<0)&&!(a+r>t.width||s+u>t.height)}function Vp(t){var e=t.area,n=t.vx,r=t.vy,i=t.width,o=t.height,a=t.offset,s=n+a.x,u=r+a.y,l=i,c=o,h=s<0?-s:0,f=u<0?-u:0;return{x:h+=s+l>e.width?-(s+l-e.width):0,y:f+=u+c>e.height?-(u+c-e.height):0}}function Hp(t){var e=t.options,n=t.pointer,r=t.width,i=t.height,o=t.dockOrder,a=t.x,s=t.y,u=n.targetBounds,l=Fp(e.offset),c=l[e.dock];if(c)return{computedTooltipStyle:{left:"".concat(a,"px"),top:"".concat(s,"px"),transform:c},computedArrowStyle:jp(e.offset)[e.dock],dock:e.dock};for(var h={width:"target"===e.area?u.width:window.innerWidth,height:"target"===e.area?u.height:window.innerHeight},f=Lp(r,i,e.offset),d=[],p="target"===e.area?a:u.left+a,m="target"===e.area?s:u.top+s,g=0;g<o.length;g+=1){var y=o[g],v=Vp({area:h,vx:p,vy:m,width:r,height:i,offset:f[y]}),x={left:"".concat(a,"px"),top:"".concat(s,"px"),transform:l[y]},b=jp(e.offset)[y];0!==v.x&&(x.width="".concat(r-20-Math.abs(v.x),"px"),"top"!==y&&"bottom"!==y||(x.left="".concat(a+v.x,"px"),b.left="calc(50% ".concat(v.x>0?"-":"+"," ").concat(Math.abs(v.x),"px)")));var w={computedTooltipStyle:x,computedArrowStyle:b,dock:y,rect:{width:r,height:i}};if(0===v.x&&0===v.y)return w;w.offset=v,d.push(w)}return d.sort((function(t,e){return Math.abs(t.offset.x)-Math.abs(e.offset.x)})),d[0]}function Bp(t,e,n){var r=t.key?n.component(t.key):n.componentsFromPoint({x:e.clientX,y:e.clientY})[0];if(!r)return{x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1}};var i=r.rect;return yn({scaleRatio:i.scaleRatio},i.computedInner)}var Wp,Up={bounds:function(t){var e=t.resources,n=t.nodes,r=t.pointer,i=t.width,o=t.height,a=t.options,s=r.targetBounds,u=e.getNodeBoundsRelativeToTarget(n[0]),l=u.x,c=u.y,h=u.width,f=u.height,d={left:{x:l,y:c+f/2},right:{x:l+h,y:c+f/2},top:{x:l+h/2,y:c},bottom:{x:l+h/2,y:c+f}},p=Fp(a.offset),m=p[a.dock];if(m)return{computedTooltipStyle:{left:"".concat(d[a.dock].x,"px"),top:"".concat(d[a.dock].y,"px"),transform:m},computedArrowStyle:jp(a.offset)[a.dock],dock:a.dock};for(var g={width:"target"===a.area?s.width:window.innerWidth,height:"target"===a.area?s.height:window.innerHeight},y=Lp(i,o,a.offset),v=["top","left","right","bottom"],x=0;x<v.length;x+=1){var b=v[x];if(zp(g,"target"===a.area?d[b].x:s.left+d[b].x,"target"===a.area?d[b].y:s.top+d[b].y,i,o,y[b]))return{computedTooltipStyle:{left:"".concat(d[b].x,"px"),top:"".concat(d[b].y,"px"),transform:p[b]},computedArrowStyle:jp(a.offset)[b],dock:b}}return{computedTooltipStyle:{left:"".concat(d.top.x,"px"),top:"".concat(d.top.y,"px"),transform:p.top},computedArrowStyle:jp(a.offset).top,dock:"top"}},pointer:function(t){var e=t.options,n=t.pointer,r=t.width,i=t.height;return Hp({x:n.x,y:n.y,pointer:n,width:r,height:i,options:e,dockOrder:["top","left","right","bottom"]})},slice:function(t){var e=t.options,n=t.pointer,r=t.width,i=t.height,o=t.nodes,a=t.resources,s=o[0],u=n.dx,l=n.dy,c=a.getComponentBoundsFromNode(s),h=u+c.x+c.width/2,f=l+c.y+c.height/2,d=s.desc.slice,p=d.start,m=d.end,g=d.outerRadius,y=(p+m)/2-Math.PI/2,v=2*Math.PI,x=(y%v+v)%v,b=["top","left","right","bottom"];return"auto"===e.dock&&(b=x<=Math.PI/4||x>=7*Math.PI/4?["right","top","bottom","left"]:x<=3*Math.PI/4?["bottom","left","right","top"]:x<=5*Math.PI/4?["left","top","bottom","right"]:["top","left","right","bottom"]),Hp({x:h+g*c.scaleRatio.x*Math.cos(x),y:f+g*c.scaleRatio.y*Math.sin(x),pointer:n,width:r,height:i,options:e,dockOrder:b})}};function Yp(t,e){var n=t.width,r=t.height,i=e.chart,o=e.state,a=e.props,s={resources:{formatter:i.formatter,scale:i.scale,component:i.component,getComponentBoundsFromNode:function(t){return Bp(t,o.pointer,i)},getNodeBoundsRelativeToTarget:function(t){return function(t,e,n){var r=Bp(t,e,n),i=t.bounds;return{x:r.x+e.dx+i.x,y:r.y+e.dy+i.y,width:i.width,height:i.height}}(t,o.pointer,i)}},nodes:o.activeNodes,pointer:o.pointer,width:n,height:r},u=wn(a.placement);if("object"===u&&"function"==typeof a.placement.fn)return a.placement.fn(s);var l={type:"pointer",offset:8,dock:"auto",area:"viewport"};"function"===u&&(l=yn(l,a.placement(s))),"object"===u&&Up[a.placement.type]?l=yn(l,a.placement):"string"===u&&Up[a.placement]&&(l=yn(l,{type:a.placement})),s.options=l;var c=Up[l.type](s),h=s.resources.getComponentBoundsFromNode(s.nodes[0]),f=h.x,d=h.y,p=h.width,m=h.height;return p+=f+=s.pointer.dx,m+=d+=s.pointer.dy,c.computedTooltipStyle.left="".concat(Math.min(Math.max(0,f,parseFloat(c.computedTooltipStyle.left)),p),"px"),c.computedTooltipStyle.top="".concat(Math.min(Math.max(0,d,parseFloat(c.computedTooltipStyle.top)),m),"px"),c}function $p(){Wp=null}var Xp={duration:8e3,delay:500,filter:function(t){return t.filter((function(t){return t.data&&void 0!==t.data.value}))},extract:function(t){return t.node.data.value},content:function(t){var e=t.h;return t.data.map((function(t){return e("div",{},t)}))},isEqual:function(t,e){return t.length&&t.length===e.length&&t.every((function(t,n){return e[n]&&JSON.stringify(t.data)===JSON.stringify(e[n].data)}))},placement:{type:"pointer",dock:"auto",offset:8,area:"viewport"},tooltipClass:{},contentClass:{},arrowClass:{},direction:"ltr",appendTo:void 0,beforeShow:void 0,afterShow:void 0,beforeHide:void 0,onHide:void 0,afterHide:void 0};function Gp(t,e){var n=e.chart,r=e.state,i=0,o=0;t.center?(i+=t.center.x,o+=t.center.y):(i+=t.clientX,o+=t.clientY);var a=n.element.getBoundingClientRect(),s=r.targetElement.getBoundingClientRect(),u=i,l=o,c=a.left-s.left,h=a.top-s.top,f=i-a.left,d=o-a.top;return{x:i-=s.left,y:o-=s.top,dx:c,dy:h,cx:f,cy:d,clientX:u,clientY:l,targetBounds:s,chartBounds:a}}var Kp={require:["chart","renderer"],defaultSettings:{settings:Xp,style:{tooltip:{},content:{backgroundColor:"$gray-25",color:"$font-color--inverted",fontFamily:"$font-family",fontSize:"$font-size",lineHeight:"$line-height",borderRadius:"4px",padding:"8px",opacity:.9},arrow:{position:"absolute",width:"0px",height:"0px",borderStyle:"solid",color:"$gray-25",opacity:.9},"arrow-bottom":{borderTopColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-top":{borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-right":{borderTopColor:"transparent",borderLeftColor:"transparent",borderBottomColor:"transparent"},"arrow-left":{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightColor:"transparent"}}},renderer:"dom",on:{hide:function(){this.hide()},show:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.show(t,e)},prevent:function(t){this.prevent(t)}},hide:function(){this.dispatcher.clear(),this.state.activeNodes=[],this.state.pointer={}},show:function(t){var e,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.nodes,o=r.duration,a=r.delay;!this.state.prevent&&this.state.targetElement&&(this.state.pointer=Gp(t,this),e=Array.isArray(i)?this.props.filter(i):this.props.filter(this.chart.shapesAt({x:this.state.pointer.cx,y:this.state.pointer.cy})),this.props.isEqual(this.state.activeNodes,e)||(this.dispatcher.clear(),this.state.activeNodes=e,this.state.activeNodes.length&&this.dispatcher.invoke((function(){return n.invokeRenderer(n.state.activeNodes)}),o,a)))},prevent:function(t){this.state.prevent=!!t},init:function(t){var e=this;this.state={activeNodes:[],pointer:{},targetElement:null,prevent:!1},this.props=t.settings,this.dispatcher=Pp({defaultDuration:this.props.duration,defaultDelay:this.props.delay});var n=this.dispatcher.clear;this.dispatcher.on("pending",(function(){!function(t){Wp&&Wp!==t&&Wp()}(n),Wp=n,"function"==typeof e.props.beforeShow&&e.props.beforeShow.call(void 0,{resources:{formatter:e.chart.formatter,scale:e.chart.scale}})})),this.dispatcher.on(["cancelled","fulfilled"],(function(){var t={resources:{formatter:e.chart.formatter,scale:e.chart.scale}};"function"==typeof e.props.beforeHide&&e.props.beforeHide.call(void 0,yn({element:e.state.tooltipElm},t)),"function"==typeof e.props.onHide?e.props.onHide.call(void 0,yn({element:e.state.tooltipElm},t)):e.renderer.clear([]),"function"==typeof e.props.afterHide&&e.props.afterHide.call(void 0,t),Wp===n&&(Wp=null),e.state.tooltipElm=void 0})),this.dispatcher.on("active",(function(){"function"==typeof e.props.afterShow&&e.props.afterShow.call(void 0,{element:e.state.tooltipElm,resources:{formatter:e.chart.formatter,scale:e.chart.scale}})}))},created:function(){this.init(this.settings)},beforeUpdate:function(t){var e=t.settings;this.dispatcher&&(this.dispatcher.destroy(),$p()),this.init(e)},render:function(t){return this.h=t,[]},beforeDestroy:function(){this.dispatcher.destroy(),$p()},appendTo:function(){if(this.props.appendTo){this.state.targetElement="function"==typeof this.props.appendTo?this.props.appendTo({resources:{formatter:this.chart.formatter,scale:this.chart.scale}}):this.props.appendTo;var t=this.state.targetElement.getBoundingClientRect(),e=t.width,n=t.height;this.renderer.destroy(),this.renderer.size({width:e,height:n}),this.renderer.appendTo(this.state.targetElement)}else this.state.targetElement=this.renderer.element()},mounted:function(){this.appendTo()},updated:function(){this.appendTo()},invokeRenderer:function(t){var e=function(t,e){var n=e.chart,r=e.scale,i=e.props,o=e.h,a={resources:{dataset:n.dataset,scale:n.scale,formatter:n.formatter},scale:r,h:o},s=[];return t.forEach((function(t){if("function"==typeof i.extract){var e=yn({node:t},a);s.push(i.extract(e))}})),s}(t,this),n=Yp(Rp(e,{style:{left:"0px",top:"0px",visibility:"hidden"}},this).getBoundingClientRect(),this);this.state.tooltipElm=Rp(e,n,this)}};var Jp={require:["renderer","chart"],defaultSettings:{settings:{target:"",selector:"*",fill:"rgba(0, 255, 0, 0.1)",stroke:"lime",opacity:1,useOuterRect:!1}},on:{update:function(){this.draw()}},draw:function(){var t=this,e=this.chart.findShapes(this.props.selector).filter((function(e){return e.key===t.props.target})),n=e.filter((function(t){return t.collider})).map((function(t){return t.collider}));n.forEach((function(e){e.fill=t.props.fill,e.stroke=t.props.stroke,e.opacity=t.props.opacity,e.collider={type:null}})),this.renderer.render(n)},created:function(){this.props=this.settings.settings},resize:function(t){var e=t.outer,n=t.inner;return this.props.useOuterRect?e:n},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}},Zp=2*Math.PI;function Qp(t,e,n,r){return Math.abs(t.x+n.x-(e.x+e.x))+Math.abs(t.y+n.y-(e.y+e.y))+Math.abs(e.x+r.x-(n.x+n.x))+Math.abs(e.y+r.y-(n.y+n.y))}function tm(t,e){return{x:.5*(t.x+e.x),y:.5*(t.y+e.y)}}function em(t,e,n,r,i){var o=1-t;return Math.pow(o,3)*e+3*Math.pow(o,2)*t*n+3*o*Math.pow(t,2)*r+Math.pow(t,3)*i}function nm(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8;if(o<1||Qp(t,e,n,r)<=10)return i[i.length-1]!==t&&i.push(t),i.push(r),i;var a=.5,s=tm(t,e),u=tm(e,n),l=tm(n,r),c={x:em(a,t.x,e.x,n.x,r.x),y:em(a,t.y,e.y,n.y,r.y)},h=tm(s,u),f=tm(u,l);return nm(t,s,h,c,i,o-1),nm(c,f,l,r,i,o-1),i}function rm(t,e,n){var r=function(t,e,n){return{cp1:{x:t.x+2/3*(e.x-t.x),y:t.y+2/3*(e.y-t.y)},cp2:{x:n.x+2/3*(e.x-n.x),y:n.y+2/3*(e.y-n.y)}}}(t,e,n);return nm(t,r.cp1,r.cp2,n)}function im(t,e,n){var r,i,o,a,s=[],u=!!t[4],l=!!t[5],c=t[3],h=t[6],f=t[7],d=t[1],p=t[2];if("a"===t[0]&&(h+=e,f+=n),e===f&&n===f)return s;if(!d||!p)return s.push({x:h,y:f}),s;var m=function(t,e,n,r,i,o,a,s,u){var l,c,h,f,d,p,m=xl(n%360),g=Math.cos(m),y=Math.sin(m),v=(s-o)/2,x=(u-a)/2,b=g*v+y*x,w=g*x-y*v;t=Math.abs(t),e=Math.abs(e),(p=Math.pow(b,2)/Math.pow(t,2)+Math.pow(w,2)/Math.pow(e,2))>1&&(t*=p=Math.sqrt(p),e*=p);var M=t*e,k=t*w,_=e*b,q=Math.pow(k,2)+Math.pow(_,2),D=Math.pow(M,2)-q,S=Math.sqrt(Math.max(D/q,0));r===i&&(S=-S);var C=S*(k/e),E=S*(-_/t);f=g*C-y*E+(s+o)/2,d=y*C+g*E+(u+a)/2;var A=(b-C)/t,N=(w-E)/e,O=(-b-C)/t,I=(-w-E)/e;return l=Math.atan2(N,A),l+=l<0?Zp:0,c=Math.atan2(I,O),h=(c+=c<0?Zp:0)-l,!i&&l<c?h-=Zp:i&&c<l&&(h+=Zp),{startAngle:l,sweepAngle:h%=Zp,cx:f,cy:d,rx:t,ry:e}}(d,p,c,u,l,h,f,e,n);r=m.cx,i=m.cy,d=m.rx,p=m.ry,o=m.sweepAngle,a=m.startAngle;for(var g=Math.abs(o*Math.sqrt((Math.pow(d,2)+Math.pow(p,2))/2)),y=Math.ceil(g/10),v=o/y,x=1;x<=y;x++){var b=(a+v*x)%Zp,w=Math.cos(b),M=Math.sin(b);s.push({x:r+w*d+-M*w,y:i+M*p+w*M})}return s}function om(t){for(var e=un.parsePath(t),n=[],r=[],i=0,o=0,a=null,s=null,u=null,l=null,c=0;c<e.length;++c){var h=e[c],f=h[0];switch("S"!==f&&"s"!==f&&"C"!==f&&"c"!==f&&(a=null,s=null),"T"!==f&&"t"!==f&&"Q"!==f&&"q"!==f&&(u=null,l=null),f){case"m":r.length&&n.push(r.splice(0));case"l":i+=h[1],o+=h[2],r.push({x:i,y:o});break;case"M":r.length&&n.push(r.splice(0));case"L":i=h[1],o=h[2],r.push({x:i,y:o});break;case"H":i=h[1],r.push({x:i,y:o});break;case"h":i+=h[1],r.push({x:i,y:o});break;case"V":o=h[1],r.push({x:i,y:o});break;case"v":o+=h[1],r.push({x:i,y:o});break;case"a":r.push.apply(r,Fn(im(h,i,o))),i+=h[6],o+=h[7];break;case"A":r.push.apply(r,Fn(im(h,i,o))),i=h[6],o=h[7];break;case"c":r.push.apply(r,Fn(nm({x:i,y:o},{x:h[1]+i,y:h[2]+o},{x:h[3]+i,y:h[4]+o},{x:h[5]+i,y:h[6]+o}))),a=h[3]+i,s=h[4]+o,i+=h[5],o+=h[6];break;case"C":r.push.apply(r,Fn(nm({x:i,y:o},{x:h[1],y:h[2]},{x:h[3],y:h[4]},{x:h[5],y:h[6]}))),a=h[3],s=h[4],i=h[5],o=h[6];break;case"s":null!==a&&null!==a||(a=i,s=o),r.push.apply(r,Fn(nm({x:i,y:o},{x:2*i-a,y:2*o-s},{x:h[1]+i,y:h[2]+o},{x:h[3]+i,y:h[4]+o}))),a=h[1]+i,s=h[2]+o,i+=h[3],o+=h[4];break;case"S":null!==a&&null!==a||(a=i,s=o),r.push.apply(r,Fn(nm({x:i,y:o},{x:2*i-a,y:2*o-s},{x:h[1],y:h[2]},{x:h[3],y:h[4]}))),a=h[1],s=h[2],i=h[3],o=h[4];break;case"Q":r.push.apply(r,Fn(rm({x:i,y:o},{x:h[1],y:h[2]},{x:h[3],y:h[4]}))),u=h[1],l=h[2],i=h[3],o=h[4];break;case"q":r.push.apply(r,Fn(rm({x:i,y:o},{x:h[1]+i,y:h[2]+o},{x:h[3]+i,y:h[4]+o}))),u=h[1]+i,l=h[2]+o,i+=h[3],o+=h[4];break;case"T":null!==u&&null!==u||(u=i,l=o),u=2*i-u,l=2*o-l,r.push.apply(r,Fn(rm({x:i,y:o},{x:u,y:l},{x:h[1],y:h[2]}))),i=h[1],o=h[2];break;case"t":null!==u&&null!==u||(u=i,l=o),u=2*i-u,l=2*o-l,r.push.apply(r,Fn(rm({x:i,y:o},{x:u,y:l},{x:h[1]+i,y:h[2]+o}))),i+=h[1],o+=h[2];break;case"z":case"Z":r.length&&r.push({x:r[0].x,y:r[0].y})}}return function(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];Math.abs(n.x-r.x)<1e-12&&Math.abs(n.y-r.y)<1e-12&&(t.splice(e,1),e--)}}(r),n.push(r.splice(0)),n}var am={require:["renderer","chart"],defaultSettings:{settings:{target:"",fill:"transparent",stroke:"lime",opacity:1,radius:2,useOuterRect:!1}},on:{update:function(){this.draw()}},draw:function(){var t=this,e=this.chart.findShapes("path").filter((function(e){return e.key===t.props.target})),n=[];e.forEach((function(e){om(e.attrs.d).forEach((function(e){e.forEach((function(e){n.push({type:"circle",cx:e.x,cy:e.y,r:t.props.radius,fill:t.props.fill,stroke:t.props.stroke,opacity:t.props.opacity,collider:{type:null}})}))}))})),this.renderer.render(n)},created:function(){this.props=this.settings.settings},resize:function(t){var e=t.outer,n=t.inner;return this.props.useOuterRect?e:n},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}};var sm=[function(t){t.component("box",gh),t.component("box-marker",gh)},function(t){t.component("point",kh),t.component("point-marker",kh)},function(t){t.component("pie",Sh)},function(t){t.component("grid-line",Oh)},function(t){t.component("ref-line",jh)},function(t){t.component("axis",uf)},function(t){t.component("container",lf)},function(t){t.component("text",ff)},function(t){t.component("scrollbar",mf)},function(t){t.component("brush-range",Af),t.component("brush-area-dir",If)},function(t){t.component("range",Ff)},function(t){t.component("brush-lasso",Bf)},function(t){t.component("labels",ap)},function(t){t.component("legend-cat",xp)},function(t){t.component("legend-seq",qp)},function(t){t.component("line",Ap)},function(t){t.component("brush-area",Tp)},function(t){t.component("tooltip",Kp)},function(t){t.component("debug-collider",Jp)},function(t){t.component("debug-path-to-points",am)}],um=function(){function t(e){Mn(this,t),this._parent=null,this._children=[],this._ancestors=null,this.type=e,this.data=null}return _n(t,[{key:"detach",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"parent",get:function(){return this._parent}},{key:"isBranch",get:function(){return this._children&&this._children.length}},{key:"children",get:function(){return this._children}},{key:"ancestors",get:function(){var t;this._ancestors||(this._ancestors=[],this.parent&&(t=this._ancestors).push.apply(t,[this.parent].concat(Fn(this.parent.ancestors))));return this._ancestors}},{key:"descendants",get:function(){var t,e,n=[],r=this.children.length;for(t=0;t<r;t++)e=this.children[t],n.push(e),e.children.length&&n.push.apply(n,Fn(e.descendants));return n}},{key:"equals",value:function(t){var e=this.children,n=t.children;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].equals(n[r]))return!1;return!0}},{key:"toJSON",value:function(){return{type:this.type,children:this.children.map((function(t){return t.toJSON()}))}}}]),t}(),lm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x,r=void 0===n?0:n,i=e.y,o=void 0===i?0:i,a=e.width,s=void 0===a?0:a,u=e.height,l=void 0===u?0:u,c=e.minWidth,h=void 0===c?0:c,f=e.minHeight,d=void 0===f?0:f;Mn(this,t),this.set({x:r,y:o,width:s,height:l,minWidth:h,minHeight:d})}return _n(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,o=t.width,a=void 0===o?0:o,s=t.height,u=void 0===s?0:s,l=t.minWidth,c=void 0===l?0:l,h=t.minHeight,f=void 0===h?0:h;this.type="rect",a>=0?(this.x=n,this.width=Math.max(a,c)):(this.x=n+Math.min(a,-c),this.width=-Math.min(a,-c)),u>=0?(this.y=i,this.height=Math.max(u,f)):(this.y=i+Math.min(u,-f),this.height=-Math.min(u,-f))}},{key:"containsPoint",value:function(t){return ic(this,t)}},{key:"intersectsLine",value:function(t){return oc(this,$n(t))}},{key:"intersectsRect",value:function(t){return nc(this,Yn(t))}},{key:"intersectsCircle",value:function(t){return Kl(t,this)}},{key:"intersectsPolygon",value:function(t){return ec(t,this)}},{key:"intersectsGeoPolygon",value:function(t){return dc(t,this)}},{key:"points",value:function(){return[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}]}}]),t}();var cm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cx,r=void 0===n?0:n,i=e.cy,o=void 0===i?0:i,a=e.r,s=void 0===a?0:a,u=e.minRadius,l=void 0===u?0:u;Mn(this,t),this.set({cx:r,cy:o,r:s,minRadius:l})}return _n(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,n=void 0===e?0:e,r=t.cy,i=void 0===r?0:r,o=t.r,a=void 0===o?0:o,s=t.minRadius,u=void 0===s?0:s;this.type="circle",this.cx=n,this.cy=i,this.r=Math.max(a,u),this.vector={x:this.cx,y:this.cy}}},{key:"containsPoint",value:function(t){return Gl(this,t)}},{key:"intersectsLine",value:function(t){return Jl(this,$n(t))}},{key:"intersectsRect",value:function(t){return Kl(this,Yn(t))}},{key:"intersectsCircle",value:function(t){return function(t,e){if(Ul(t)||Ul(e))return!1;var n=t.cx-e.cx,r=t.cy-e.cy;return Math.pow(n,2)+Math.pow(r,2)<=Math.pow(t.r+e.r,2)}(this,t)}},{key:"intersectsPolygon",value:function(t){return Zl(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return cc(this,t)}},{key:"points",value:function(){return[{x:this.cx,y:this.cy}]}}]),t}();var hm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x1,r=void 0===n?0:n,i=e.y1,o=void 0===i?0:i,a=e.x2,s=void 0===a?0:a,u=e.y2,l=void 0===u?0:u,c=e.tolerance,h=void 0===c?0:c;Mn(this,t),this.set({x1:r,y1:o,x2:s,y2:l,tolerance:h})}return _n(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,n=void 0===e?0:e,r=t.y1,i=void 0===r?0:r,o=t.x2,a=void 0===o?0:o,s=t.y2,u=void 0===s?0:s,l=t.tolerance,c=void 0===l?0:l;this.type="line",this.x1=n,this.y1=i,this.x2=a,this.y2=u,this.tolerance=Math.max(0,Math.round(c)),this.vectors=this.points(),this.zeroSize=n===a&&i===u}},{key:"containsPoint",value:function(t){return this.tolerance>0?Jl({cx:t.x,cy:t.y,r:this.tolerance},this):sc(this,t)}},{key:"intersectsLine",value:function(t){return ac(this,$n(t))}},{key:"intersectsRect",value:function(t){return oc(Yn(t),this)}},{key:"intersectsCircle",value:function(t){return Jl(t,this)}},{key:"intersectsPolygon",value:function(t){return tc(t,this)}},{key:"intersectsGeoPolygon",value:function(t){return fc(t,this)}},{key:"points",value:function(){return[{x:this.x1,y:this.y1},{x:this.x2,y:this.y2}]}}]),t}();function fm(t){var e=t[0],n=t[t.length-1];e.x===n.x&&e.y===n.y||t.push(e)}function dm(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];n.x===r.x&&n.y===r.y&&(t.splice(e,1),e--)}}var pm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.vertices,r=void 0===n?[]:n;Mn(this,t),this.set({vertices:r})}return _n(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertices,n=void 0===e?[]:e;if(this.type="polygon",this.vertices=n.slice(),this.edges=[],dm(this.vertices),!(this.vertices.length<=2)){fm(this.vertices),this.xMin=NaN,this.yMin=NaN,this.xMax=NaN,this.yMax=NaN;for(var r=0;r<this.vertices.length;r++)r<this.vertices.length-1&&this.edges.push([this.vertices[r],this.vertices[r+1]]),this.xMin=isNaN(this.xMin)?this.vertices[r].x:Math.min(this.xMin,this.vertices[r].x),this.xMax=isNaN(this.xMax)?this.vertices[r].x:Math.max(this.xMax,this.vertices[r].x),this.yMin=isNaN(this.yMin)?this.vertices[r].y:Math.min(this.yMin,this.vertices[r].y),this.yMax=isNaN(this.yMax)?this.vertices[r].y:Math.max(this.yMax,this.vertices[r].y);this._bounds=null,this._boundingRect=null}}},{key:"containsPoint",value:function(t){return Ql(this,t)}},{key:"intersectsCircle",value:function(t){return Zl(t,this)}},{key:"intersectsLine",value:function(t){return tc(this,$n(t))}},{key:"intersectsRect",value:function(t){return ec(this,Yn(t))}},{key:"intersectsPolygon",value:function(t){return uc(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return lc(t,this)}},{key:"points",value:function(){return this.vertices}},{key:"bounds",value:function(){return this._bounds||(this._bounds=[{x:this.xMin,y:this.yMin},{x:this.xMax,y:this.yMin},{x:this.xMax,y:this.yMax},{x:this.xMin,y:this.yMax}]),this._bounds}},{key:"boundingRect",value:function(){return this._boundingRect||(this._boundingRect={x:this.xMin,y:this.yMin,width:this.xMax-this.xMin,height:this.yMax-this.yMin}),this._boundingRect}}]),t}();function mm(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(pm,e)}function gm(t){var e=t[0],n=t[t.length-1];e.x===n.x&&e.y===n.y||t.push(e)}function ym(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];n.x===r.x&&n.y===r.y&&(t.splice(e,1),e--)}}var vm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.vertices,r=void 0===n?[[]]:n;Mn(this,t),this.set({vertices:r})}return _n(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertices,n=void 0===e?[]:e;this.type="geopolygon",this.vertices=n.slice(),this.numPolygons=this.vertices.length,this.polygons=[],this.xMin=NaN,this.yMin=NaN,this.xMax=NaN,this.yMax=NaN;for(var r=0;r<this.numPolygons;r++)ym(this.vertices[r]),this.vertices[r].length>2&&gm(this.vertices[r]),this.polygons[r]=mm({vertices:this.vertices[r]}),this.xMin=isNaN(this.xMin)?this.polygons[r].xMin:Math.min(this.xMin,this.polygons[r].xMin),this.xMax=isNaN(this.xMax)?this.polygons[r].xMax:Math.max(this.xMax,this.polygons[r].xMax),this.yMin=isNaN(this.yMin)?this.polygons[r].yMin:Math.min(this.yMin,this.polygons[r].yMin),this.yMax=isNaN(this.yMax)?this.polygons[r].yMax:Math.max(this.yMax,this.polygons[r].yMax);this._bounds=null,this._boundingRect=null}},{key:"containsPoint",value:function(t){return hc(this,t)}},{key:"intersectsCircle",value:function(t){return cc(t,this)}},{key:"intersectsLine",value:function(t){return fc(this,$n(t))}},{key:"intersectsRect",value:function(t){return dc(this,Yn(t))}},{key:"intersectsPolygon",value:function(t){return lc(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return n=t,r=(e=this).boundingRect(),i=n.boundingRect(),!!nc(r,i)&&(rc(i,r)?Xl(n,e):Xl(e,n));var e,n,r,i}},{key:"points",value:function(){return this.vertices}},{key:"bounds",value:function(){return this._bounds||(this._bounds=[{x:this.xMin,y:this.yMin},{x:this.xMax,y:this.yMin},{x:this.xMax,y:this.yMax},{x:this.xMin,y:this.yMax}]),this._bounds}},{key:"boundingRect",value:function(){return this._boundingRect||(this._boundingRect={x:this.xMin,y:this.yMin,width:this.xMax-this.xMin,height:this.yMax-this.yMin}),this._boundingRect}}]),t}();function xm(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(vm,e)}function bm(t,e){return t.x!==e.x||t.y!==e.y}var wm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.points,r=void 0===n?[]:n;Mn(this,t),this.set({points:r})}return _n(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.points,n=void 0===e?[]:e;if(this.type="polyline",this.segments=[],this._points=n.slice(),this._points.length>1)for(var r=0,i=this._points.length-1;r<i;r++)bm(this._points[r],this._points[r+1])&&this.segments.push({x1:this._points[r].x,y1:this._points[r].y,x2:this._points[r+1].x,y2:this._points[r+1].y})}},{key:"containsPoint",value:function(t){return this.segments.some((function(e){return sc(e,t)}))}},{key:"intersectsCircle",value:function(t){return this.segments.some((function(e){return Jl(t,e)}))}},{key:"intersectsLine",value:function(t){var e=$n(t);return this.segments.some((function(t){return ac(t,e)}))}},{key:"intersectsRect",value:function(t){var e=Yn(t);return this.segments.some((function(t){return oc(e,t)}))}},{key:"intersectsPolygon",value:function(t){return this.segments.some((function(e){return tc(t,e)}))}},{key:"intersectsGeoPolygon",value:function(t){return this.segments.some((function(e){return fc(t,e)}))}},{key:"points",value:function(){return this._points}}]),t}();var Mm=ti();function km(t,e){return Mm.get(t)(e)}Mm.add("rect",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(lm,e)})),Mm.add("circle",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(cm,e)})),Mm.add("line",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(hm,e)})),Mm.add("polygon",mm),Mm.add("geopolygon",xm),Mm.add("polyline",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(wm,e)}));var _m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Mn(this,t),this.set(e)}return _n(t,[{key:"set",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.geometries=[],e.forEach((function(e){var n=km(e.type,e);n&&t.geometries.push(n)}))}},{key:"containsPoint",value:function(t){return this.geometries.some((function(e){return e.containsPoint(t)}))}},{key:"intersectsLine",value:function(t){return this.geometries.some((function(e){return e.intersectsLine(t)}))}},{key:"intersectsRect",value:function(t){return this.geometries.some((function(e){return e.intersectsRect(t)}))}},{key:"intersectsCircle",value:function(t){return this.geometries.some((function(e){return e.intersectsCircle(t)}))}},{key:"intersectsPolygon",value:function(t){return this.geometries.some((function(e){return e.intersectsPolygon(t)}))}},{key:"intersectsGeoPolygon",value:function(t){return this.geometries.some((function(e){return e.intersectsGeoPolygon(t)}))}}]),t}();var qm=function(){function t(){Mn(this,t),this._elements=[[1,0,0],[0,1,0],[0,0,1]],this._stack=[]}return _n(t,[{key:"clone",value:function(){return(new t).multiply(this)}},{key:"set",value:function(t){return this._elements=t,this}},{key:"save",value:function(){return this._stack.push(this.elements),this}},{key:"restore",value:function(){return this._stack.length&&(this._elements=this._stack.pop()),this}},{key:"add",value:function(t){var e,n;for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)this._elements[e][n]+=t;return this}},{key:"translate",value:function(t,e){return this.multiply([[1,0,t],[0,1,e],[0,0,1]]),this}},{key:"rotate",value:function(t){var e=Math.cos(-t),n=Math.sin(-t);return this.multiply([[e,n,0],[-n,e,0],[0,0,1]]),this}},{key:"multiply",value:function(e){var n,r,i,o;if(e instanceof t&&(e=e._elements),Array.isArray(e)){for(i=[[0,0,0],[0,0,0],[0,0,0]],n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)for(o=0;o<3;o++)i[n][r]+=this._elements[n][o]*e[o][r];this._elements=i}else for(n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)this._elements[n][r]*=e;return this}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.multiply([[t,0,0],[0,e,0],[0,0,1]]),this}},{key:"transform",value:function(t,e,n,r,i,o){return this.multiply([[t,n,i],[e,r,o],[0,0,1]]),this}},{key:"determinant",value:function(){var t=this._elements[0][0],e=this._elements[0][1],n=this._elements[0][2],r=this._elements[1][0],i=this._elements[1][1],o=this._elements[1][2],a=this._elements[2][0],s=this._elements[2][1],u=this._elements[2][2];return t*i*u+e*o*a+n*r*s-n*i*a-e*r*u-t*o*s}},{key:"invert",value:function(){var t=this.determinant(),e=this._elements[0][0],n=this._elements[0][1],r=this._elements[0][2],i=this._elements[1][0],o=this._elements[1][1],a=this._elements[1][2],s=this._elements[2][0],u=this._elements[2][1],l=this._elements[2][2];return this._elements=[[o*l-a*u,r*u-n*l,n*a-r*o],[a*s-i*l,e*l-r*s,r*i-e*a],[i*u-o*s,s*n-e*u,e*o-n*i]],this.multiply(1/t),this}},{key:"transpose",value:function(){var t=Object.create(this._elements);return this._elements=[[t[0][0],t[1][0],t[2][0]],[t[0][1],t[1][1],t[2][1]],[t[0][2],t[1][2],t[2][2]]],this}},{key:"identity",value:function(){return this._elements=[[1,0,0],[0,1,0],[0,0,1]],this}},{key:"toString",value:function(){return"".concat(this._elements.map((function(t){return t.join("\t")})).join("\n"))}},{key:"isIdentity",value:function(){var t=this._elements;return 1===t[0][0]&&0===t[0][1]&&0===t[0][2]&&0===t[1][0]&&1===t[1][1]&&0===t[1][2]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]}},{key:"transformPoint",value:function(t){var e,n,r=[t.x,t.y,1],i=this._elements,o=[0,0,0];for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)o[e]+=r[n]*i[e][n];return{x:o[0],y:o[1]}}},{key:"transformPoints",value:function(t){var e,n,r,i,o,a=this._elements,s=[];for(i=0;i<t.length;i++){for(e=[t[i].x,t[i].y,1],o=[0,0,0],n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)o[n]+=e[r]*a[n][r];s.push({x:o[0],y:o[1]})}return s}},{key:"elements",get:function(){var t=this._elements;return[[t[0][0],t[0][1],t[0][2]],[t[1][0],t[1][1],t[1][2]],[t[2][0],t[2][1],t[2][2]]]}}]),t}(),Dm=/(translate|scale|rotate|matrix)\(([0-9,.eE+-\s]+)(?:,|\s?)+\)/g;function Sm(t,e){var n=e.args[0]*(Math.PI/180);if(e.args.length>2){var r=e.args[1],i=e.args[2];t.translate(r,i),t.rotate(n),t.translate(-r,-i)}else 1===e.args.length&&t.rotate(n)}function Cm(t,e){var n=e.args[0],r=isNaN(e.args[1])?e.args[0]:e.args[1];t.scale(n,r)}function Em(t,e){var n=e.args[0],r=isNaN(e.args[1])?0:e.args[1];t.translate(n,r)}function Am(t,e){e.args.length>=6&&t.transform.apply(t,Fn(e.args))}function Nm(t,e){for(var n,r=function(t){for(var e,n=[];null!==(e=Dm.exec(t));){var r=e[2].trim(),i=-1===r.indexOf(",")?r.split(" "):r.split(",");n.push({cmd:e[1],args:i.filter((function(t){return t.trim().length>0})).map((function(t){return Number(t)}))})}return n}(t),i=0,o=r.length;i<o;i++)"rotate"===(n=r[i]).cmd?Sm(e,n):"scale"===n.cmd?Cm(e,n):"matrix"===n.cmd?Am(e,n):"translate"===n.cmd&&Em(e,n)}var Om={type:/^\w[\w-]+/,attr:/^\[\w(?:[\w\._-]+)?(?:[!]?=['\"][\w\s*#_-]*['\"])?\]/,universal:/^(\*)/,tag:/^\.(\w+)/},Im={type:function(t,e){return e.filter((function(e){var n=e.type;return!!n&&n.toLowerCase()===t.toLowerCase()}))},attr:function(t,e,n,r){return r.filter((function(r){var i=r.attrs[t];if(!e)return void 0!==i;if(void 0===i)return!1;switch(e){case"=":return n===String(i);case"!=":return n!==String(i);default:return!1}}))},universal:function(t){return t},tag:function(t,e){return e.filter((function(e){var n=e.tag;return!!n&&-1!==n.trim().split(/\s+/).indexOf(t.replace(".",""))}))}};var Tm={find:function(t,e){var n,r,i=[],o=[];if(e.isBranch){var a;n=function(t){var e,n,r,i,o=[];return t.split(/\s*,\s*/).forEach((function(t){t=t.trim(),e=[];for(var a=function(o){(r=t.match(Om[o]))&&(i=!0,t=t.slice(r[0].length),n={type:o,value:r[0]},"attr"===o&&(r=r[0].match(/\[(\w[\w\._-]+)?(?:([!]?=)['\"]([\w\s#_-]*)['\"])?\]/),n.attribute=r[1],n.operator=r[2],n.attributeValue=r[3]),e.push(n))};t&&(i=!1,(r=t.match(/^\s*([>+~]|\s)\s*/))&&(i=!0,e.push({type:" ",value:r[0]}),t=t.slice(r[0].length)),Object.keys(Om).forEach(a),e&&e.length&&o.indexOf(e)<0&&o.push(e),i););})),o}(t),r=e.descendants;for(var s=function(t,e){a=n[t];var i=[],s=r.slice(),u=!1;a.reverse().forEach((function(t){if(" "===t.type)return i.push(s),s=r.slice(),void(u=!1);s=function(t,e){if(!e||!e.length||!t||"function"!=typeof Im[t.type])return[];switch(t.type){case"type":case"tag":return Im[t.type](t.value,e);case"attr":return Im[t.type](t.attribute,t.operator,t.attributeValue,e);case"universal":return Im[t.type](e);default:return[]}}(t,s),u=!0})),u&&i.push(s);var l=i[0].filter((function(t){for(var e,n=t.parent,r=1;r<i.length;r++){for(e=i[r].indexOf(n);n&&e<0;)n=n.parent,e=i[r].indexOf(n);if(e<0)return!1}return!0}));o.push(l)},u=0,l=n.length;u<l;u++)s(u);for(var c=0,h=o.length;c<h;c++)for(var f=0,d=o[c].length;f<d;f++)i.indexOf(o[c][f])<0&&i.push(o[c][f])}return i||[]}};function Rm(t,e,n){var r=t.type,i=t.points();n&&(i=i.every((function(t){return Array.isArray(t)}))?i.map((function(t){return n.transformPoints(t)})):n.transformPoints(i)),function(t,e){for(var n=0,r=t.length;n<r;n++)t[n].x/=e,t[n].y/=e}(i,e);var o=null;if("rect"===r||"bounds"===r)(o=Yn(i)).type=r;else if("circle"===r)o=function(t,e){return{cx:t[0].x,cy:t[0].y,r:e}}(i,t.r),o.type=r;else if("line"===r)(o=$n(i)).type=r;else if("polygon"===r||"polyline"===r){o={type:"path",d:yl(i,"polygon"===r)}}else if("geopolygon"===r){for(var a="",s=0;s<i.length;s++)a+=yl(i[s],!0);o={type:"path",d:a}}return o}var Pm=function(){function t(e){var n=this;Mn(this,t),this._bounds=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e.boundingRect?e.boundingRect(t):{x:0,y:0,width:0,height:0},r=n.x,i=n.y,o=n.width,a=n.height;return{x:r,y:i,width:o,height:a}},this._attrs=e.attrs,this._type=e.type,this._data=e.data,this._dpi=e.stage?e.stage.dpi:1,this._collider=function(){return function(t,e){if(t.collider){var n=t.modelViewMatrix;return"collection"===t.colliderType?{type:"container",children:t.collider.geometries.map((function(t){return Rm(t,e,n)}))}:Rm(t.collider,e,n)}return null}(e,n._dpi)},this._desc=e.desc,this._tag=e.tag,this._children=function(){return e.children.map((function(e){return new t(e)}))},this._parent=function(){return e.parent?new t(e.parent):null},this._cache={elementBoundingRect:null},this._getElementBoundingRect=function(){return!n._cache.elementBoundingRect&&n.element&&(n._cache.elementBoundingRect=n.element.getBoundingClientRect()),n._cache.elementBoundingRect||{left:0,top:0}}}return _n(t,[{key:"children",get:function(){return this._children()}},{key:"parent",get:function(){return this._parent()}},{key:"type",get:function(){return this._type}},{key:"data",get:function(){return this._data}},{key:"attrs",get:function(){return this._attrs}},{key:"element",get:function(){return this._element},set:function(t){this._cache.elementBoundingRect=null,this._element=t}},{key:"key",get:function(){return this._key},set:function(t){this._key=t}},{key:"bounds",get:function(){var t=this._bounds();return t.x/=this._dpi,t.y/=this._dpi,t.width/=this._dpi,t.height/=this._dpi,t}},{key:"localBounds",get:function(){return this._bounds(!1)}},{key:"boundsRelativeTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=wn(t),r=e?this.bounds:this.localBounds,i=this._getElementBoundingRect(),o=i.left,a=i.top;if("object"===n&&null!==t&&"function"==typeof t.getBoundingClientRect){var s=t.getBoundingClientRect(),u=s.left,l=void 0===u?0:u,c=s.top,h=void 0===c?0:c;o-=l,a-=h}return r.x+=o,r.y+=a,r}},{key:"collider",get:function(){return this._collider()}},{key:"desc",get:function(){return this._desc}},{key:"tag",get:function(){return this._tag}}]),t}();function Fm(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(Pm,e)}var Lm=function(){function t(e){Mn(this,t),this._node=Fm(e),this._parent=null,this._input=null}return _n(t,[{key:"node",get:function(){return this._node}},{key:"parent",get:function(){return this._parent},set:function(t){this._parent=t}},{key:"input",get:function(){return this._input},set:function(t){this._input=t}}]),t}();function jm(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(Lm,e)}function zm(t,e){var n=t.parent;if(n&&"stage"!==n.type){e.parent=jm(n);var r=n.parent;r&&"stage"!==r.type&&zm(r,e.parent)}}function Vm(t,e,n){if(null===t.colliderType)return null;var r=function(t,e){var n={};if(t.modelViewMatrix)if(Array.isArray(e))n=t.inverseModelViewMatrix.transformPoints(e);else if(isNaN(e.r))Array.isArray(e.vertices)?n.vertices=t.inverseModelViewMatrix.transformPoints(e.vertices):n=t.inverseModelViewMatrix.transformPoint(e);else{var r={x:e.cx,y:e.cy},i=t.inverseModelViewMatrix.transformPoint(r);n.cx=i.x,n.cy=i.y,n.r=e.r}else n=e;return Array.isArray(n.vertices)&&(n=n.vertices.every((function(t){return Array.isArray(t)}))?xm(n):mm(n)),n}(t,n);return"frontChild"===t.colliderType?function(t,e,n){for(var r=t.descendants.length-1;r>=0;r--){var i=t.descendants[r];if(null!==i.collider&&i.collider[e](n)){var o=jm(i);return zm(i,o),o}}return null}(t,e,r):function(t,e,n){if(t.collider[e](n)){var r=jm(t);return zm(t,r),r}return null}(t,e,r)}function Hm(t,e,n,r){for(var i=t.length,o=0;o<i;o++){var a=t[o],s=Vm(a,e,r);s&&n.push(s),!a.children||s||a.collider||Hm(a.children,e,n,r)}}function Bm(t,e,n){for(var r=t.length,i=0;i<r;i++){var o=t[i];if(null!==Vm(o,e,n))return!0;if(o.children&&!o.collider)return Bm(o.children,e,n)}return!1}function Wm(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Xn(t),r={};switch(n){case"circle":return r.cx=t.cx*e,r.cy=t.cy*e,r.r=t.r,["intersectsCircle",r];case"rect":return r=Un(t).map((function(t){return kl(t,e)})),["intersectsRect",r];case"line":return r=Wn(t).map((function(t){return kl(t,e)})),["intersectsLine",r];case"point":return["containsPoint",r=kl(t,e)];case"polygon":return r.vertices=t.vertices.map((function(t){return kl(t,e)})),["intersectsPolygon",r];case"geopolygon":return r.vertices=t.vertices.map((function(t){return t.map((function(t){return kl(t,e)}))})),["intersectsGeoPolygon",r];default:return[]}}function Um(t,e){var n=Pn(Wm(e,t.dpi),2),r=n[0],i=n[1],o=[];return r&&(Hm([t],r,o,i),function(t,e){for(var n=0,r=e.length;n<r;n++)e[n].input=t}(e,o)),o}function Ym(t,e){var n=Pn(Wm(e,t.dpi),2);return Bm([t],n[0],n[1])}var $m=function(t){Dn(n,t);var e=In(n);function n(t){var r;return Mn(this,n),(r=e.call(this,t))._stage=null,r._collider={type:null,definition:null,fn:null},r._attrs={},r._node=null,r}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.node=t;var e=t.data,n=t.desc,r=t.tag,i=t.strokeReference,o=t.fillReference;gl(this.attrs,t),void 0!==e&&(this.data=e),"object"===wn(n)&&(this.desc=yn(!0,{},n)),"string"==typeof r&&(this.tag=r),"string"==typeof i&&(this.strokeReference=i),"string"==typeof o&&(this.fillReference=o)}},{key:"findShapes",value:function(t){return Tm.find(t,this).map((function(t){return Fm(t)}))}},{key:"getItemsFrom",value:function(t){return Um(this,t)}},{key:"containsPoint",value:function(t){return Ym(this,t)}},{key:"intersectsLine",value:function(t){return Ym(this,t)}},{key:"intersectsRect",value:function(t){return Ym(this,t)}},{key:"intersectsCircle",value:function(t){return Ym(this,t)}},{key:"intersectsPolygon",value:function(t){return Ym(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return Ym(this,t)}},{key:"resolveLocalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qm;void 0!==this.attrs.transform&&Nm(this.attrs.transform,t),this.modelViewMatrix=t.clone()}},{key:"resolveGlobalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qm,e=this.ancestors;if(e.length>0)for(var n=e.length-1;n>=0;n--)e[n].resolveLocalTransform(t),t=e[n].modelViewMatrix;this.resolveLocalTransform(t)}},{key:"attr",value:function(t){return this.attrs[t]}},{key:"equals",value:function(t){var e=this.attrs,r=Object.keys(e),i=t.attrs,o=Object.keys(i);if(r.length!==o.length)return!1;for(var a=0;a<r.length;a++){var s=r[a];if(!Object.hasOwnProperty.call(i,s))return!1;if(e[s]!==i[s])return!1}return Rn(Sn(n.prototype),"equals",this).call(this,t)}},{key:"toJSON",value:function(){var t=Rn(Sn(n.prototype),"toJSON",this).call(this);return t.attrs=this.attrs,t}},{key:"attrs",get:function(){return this._attrs}},{key:"stage",get:function(){return this._parent&&!this._stage?this._stage=this._parent.stage:this._parent||this._stage===this||(this._stage=null),this._stage}},{key:"modelViewMatrix",get:function(){return this._mvm},set:function(t){this._mvm=t,this._imvm=null}},{key:"inverseModelViewMatrix",get:function(){return this._imvm=this._imvm?this._imvm:this._mvm.clone().invert(),this._imvm}},{key:"node",get:function(){return this._node},set:function(t){this._node=t}},{key:"collider",get:function(){if(null!==this._collider.fn)return this._collider.fn;switch(this._collider.type){case"collection":this._collider.fn=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(_m,e)}(this._collider.definition);break;case"frontChild":return!0;case"bounds":this._collider.fn=km("rect",this.boundingRect());break;case"line":case"rect":case"circle":case"polygon":case"geopolygon":case"polyline":this._collider.fn=km(this._collider.type,this._collider.definition);break;default:return null}return this._collider.fn},set:function(t){var e=Array.isArray(t)?"collection":t&&t.type;return"string"!=typeof e?(this._collider.type=null,this._collider.definition=null,void(this._collider.fn=null)):null!==this._collider&&this._collider.type===e&&null!==this._collider.fn?(this._collider.fn.set(t),void(this._collider.definition=t)):(this._collider.type=e,void(this._collider.definition=t))}},{key:"colliderType",get:function(){return this._collider.type}}]),n}(um),Xm=function(t){Dn(n,t);var e=In(n);function n(){return Mn(this,n),e.apply(this,arguments)}return _n(n,[{key:"addChild",value:function(t){if(!(t&&t instanceof um))throw new TypeError("Expecting a Node as argument, but got ".concat(t));if(t===this)throw new Error("Can not add itself as child!");if(t._children&&t._children.length&&this.ancestors.indexOf(t)>=0)throw new Error("Can not add an ancestor as child!");return t._parent&&t._parent!==this&&t._parent.removeChild(t),this._children.push(t),t._parent=this,t._ancestors=null,this}},{key:"addChildren",value:function(t){var e,n=t?t.length:0;for(e=0;e<n;e++)this.addChild(t[e]);return this}},{key:"removeChild",value:function(t){var e=this._children.indexOf(t);return e>=0&&(this._children.splice(e,1),t._parent=null,t._ancestors=null),this}},{key:"removeChildren",value:function(t){var e,n;if(!this._children)return this;if(t)for(n=t.length,e=0;e<n;e++)this.removeChild(t[e]);else for(;this._children.length;)this.removeChild(this._children[0]);return this}}]),n}(um),Gm=Xm.prototype,Km=function(t){Dn(n,t);var e=In(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Mn(this,n);var i=r.type,o=void 0===i?"container":i;return(t=e.call(this,o)).set(r),t}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Rn(Sn(n.prototype),"set",this).call(this,t);var e=t.collider,r=yn({type:null},e);this.collider=r,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"appendChildRect",value:function(t,e){if(void 0!==t.bounds){var n=this.__boundingRect[e]||{},r=Pn(t.bounds(e),3),i=r[0],o=r[2],a=i.x,s=i.y,u=o.x,l=o.y,c=isNaN(n.width)?u:Math.max(u,n.width+n.x),h=isNaN(n.height)?l:Math.max(l,n.height+n.y);n.x=isNaN(n.x)?a:Math.min(a,n.x),n.y=isNaN(n.y)?s:Math.min(s,n.y),n.width=c-n.x,n.height=h-n.y,this.__boundingRect[e]=n}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];for(var e=this.children.length,n=0;n<e;n++)this.appendChildRect(this.children[n],t);return this.__boundingRect[t]=yn({x:0,y:0,width:0,height:0},this.__boundingRect[t]),this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}},{key:"addChild",value:function(t){var e=Gm.addChild.call(this,t);if(this._collider&&"bounds"===this._collider.type){this.appendChildRect(t,!0);var n=yn({type:"bounds",x:0,y:0,width:0,height:0},this.__boundingRect.true);this.collider=n}return e}},{key:"addChildren",value:function(t){var e=Gm.addChildren.call(this,t),n=t.length;if(this._collider&&"bounds"===this._collider.type&&n>0){for(var r=0;r<n;r++)this.appendChildRect(t[r],!0);var i=yn({type:"bounds",x:0,y:0,width:0,height:0},this.__boundingRect.true);this.collider=i}return e}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;if(Gm.removeChild.call(this,t),this._collider&&"bounds"===this._collider.type){this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null};var i=yn(this.boundingRect(!0),{type:"bounds"});this.collider=i}return this}},{key:"removeChildren",value:function(t){if(Gm.removeChildren.call(this,t),this._collider&&"bounds"===this._collider.type){this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null};var e=yn(this.boundingRect(!0),{type:"bounds"});this.collider=e}return this}}]),n}($m);function Jm(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(Km,e)}var Zm=function(t){Dn(n,t);var e=In(n);function n(t){var r;return Mn(this,n),(r=e.call(this,"stage"))._stage=Nn(r),r._dpiRatio=t||1,r}return _n(n,[{key:"dpi",get:function(){return this._dpiRatio}}]),n}(Km);var Qm=Xm.prototype,tg=["x1","x2","y1","y2","id","offset","style"],eg=function(t){Dn(n,t);var e=In(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Mn(this,n);var i=r.type,o=void 0===i?"container":i;return(t=e.call(this,o)).set(r),t._boundingRect={},t}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Rn(Sn(n.prototype),"set",this).call(this,t);for(var e=this.attrs,r="",i=0,o=tg.length;i!==o;i++)void 0!==t[r=tg[i]]&&(e[r]=t[r])}},{key:"addChild",value:function(t){return Qm.addChild.call(this,t)}},{key:"addChildren",value:function(t){return Qm.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;return Qm.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return Qm.removeChildren.call(this,t),this}}]),n}($m);function ng(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(eg,e)}var rg=Xm.prototype,ig=["patternUnits","x","y","width","height","id"],og=function(t){Dn(n,t);var e=In(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Mn(this,n);var i=r.type,o=void 0===i?"container":i;return(t=e.call(this,o)).set(r),t._boundingRect={},t}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Rn(Sn(n.prototype),"set",this).call(this,t);for(var e=this.attrs,r="",i=0,o=ig.length;i!==o;i++)void 0!==t[r=ig[i]]&&(e[r]=t[r])}},{key:"addChild",value:function(t){return rg.addChild.call(this,t)}},{key:"addChildren",value:function(t){return rg.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;return rg.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return rg.removeChildren.call(this,t),this}}]),n}($m);var ag=function(t){Dn(n,t);var e=In(n);function n(){var t,r;return Mn(this,n),(t=r=e.call(this,"rect")).set.apply(t,arguments),r}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,r=void 0===e?0:e,i=t.y,o=void 0===i?0:i,a=t.width,s=void 0===a?0:a,u=t.height,l=void 0===u?0:u,c=t.rx,h=void 0===c?0:c,f=t.ry,d=void 0===f?0:f,p=t.collider,m=yn({type:"rect",x:r,y:o,width:s,height:l},p);Rn(Sn(n.prototype),"set",this).call(this,t),s>=0?(this.attrs.x=r,this.attrs.width=s):(this.attrs.x=r+s,this.attrs.width=-s),l>=0?(this.attrs.y=o,this.attrs.height=l):(this.attrs.y=o+l,this.attrs.height=-l),h>0&&(this.attrs.rx=h),d>0&&(this.attrs.ry=d),this.collider=m,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=Un(this.attrs),n=t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e,r=Bn(n),i=Pn(r,4),o=i[0],a=i[1],s=i[2],u=i[3];return this.__boundingRect[t]={x:o,y:a,width:s-o,height:u-a},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}($m);var sg=function(t){Dn(n,t);var e=In(n);function n(){var t,r;return Mn(this,n),(t=r=e.call(this,"circle")).set.apply(t,arguments),r}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,r=void 0===e?0:e,i=t.cy,o=void 0===i?0:i,a=t.r,s=void 0===a?0:a,u=t.collider,l=yn({type:"circle",cx:r,cy:o,r:s},u);Rn(Sn(n.prototype),"set",this).call(this,t),this.attrs.cx=r,this.attrs.cy=o,this.attrs.r=s,this.collider=l,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=this.bounds(t);return this.__boundingRect[t]={x:e[0].x,y:e[0].y,width:e[2].x-e[0].x,height:e[2].y-e[0].y},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.attrs,n=e.cx,r=e.cy,i=e.r,o=e.r,a=n-i,s=r-o,u=2*i,l=2*o,c=[{x:a,y:s},{x:a+u,y:s},{x:a+u,y:s+l},{x:a,y:s+l}];if(t&&this.modelViewMatrix){var h=Bn(c=this.modelViewMatrix.transformPoints(c)),f=Pn(h,4),d=f[0],p=f[1],m=f[2],g=f[3];u=m-d,l=g-p,this.__bounds[t]=[{x:d,y:p},{x:d+u,y:p},{x:d+u,y:p+l},{x:d,y:p+l}]}else this.__bounds[t]=c;return this.__bounds[t]}}]),n}($m);var ug=function(t){Dn(n,t);var e=In(n);function n(){var t,r;return Mn(this,n),(t=r=e.call(this,"line")).set.apply(t,arguments),r}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,r=void 0===e?0:e,i=t.y1,o=void 0===i?0:i,a=t.x2,s=void 0===a?0:a,u=t.y2,l=void 0===u?0:u,c=t.collider;Rn(Sn(n.prototype),"set",this).call(this,t),this.attrs.x1=r,this.attrs.y1=o,this.attrs.x2=s,this.attrs.y2=l;var h={type:"line",x1:r,y1:o,x2:s,y2:l};this.collider=yn(h,c),this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=Wn(this.attrs);t&&this.modelViewMatrix&&(e=this.modelViewMatrix.transformPoints(e));var n=Bn(e),r=Pn(n,4),i=r[0],o=r[1],a=r[2],s=r[3],u=i!==a||o!==s;return this.__boundingRect[t]={x:i,y:o,width:u?Math.max(1,a-i):0,height:u?Math.max(1,s-o):0},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}($m);var lg=Math.PI/2;function cg(t,e){var n=Math.atan2(e.y-t.y,e.x-t.x);return n<0?n+2*Math.PI:n}function hg(t,e,n){return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}}function fg(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],i=[];if("h"===n.forceOrientation){var o=t[0].x<t[1].x?-1:1,a=t[t.length-1].x>t[t.length-2].x?1:-1;t.unshift({x:t[0].x+o,y:t[0].y}),t.push({x:t[t.length-1].x+a,y:t[t.length-1].y})}else if("v"===n.forceOrientation){var s=t[0].y<t[1].y?-1:1,u=t[t.length-1].y>t[t.length-2].y?1:-1;t.unshift({x:t[0].x,y:t[0].y+s}),t.push({x:t[t.length-1].x,y:t[t.length-1].y+u})}for(var l=t.length-1,c=1;c<l;c++){var h=t[c-1],f=t[c],d=t[c+1],p=cg(f,h),m=cg(f,d),g=(p+m)/2,y=g+Math.PI,v=Math.max(g,y),x=Math.min(g,y),b=p>m;if(1===c){var w=cg(h,f);r.push(hg(h,w-lg,e)),i.unshift(hg(h,w+lg,e))}var M=b?v:x,k=b?x:v;if(r.push(hg(f,M,e)),i.unshift(hg(f,k,e)),c===l-1){var _=cg(d,f);r.push(hg(d,_+lg,e)),i.unshift(hg(d,_-lg,e))}}return{type:"polygon",vertices:[].concat(r,i)}}function dg(t){for(var e,n=[],r=t.length,i=0;i<r;i++){e=t[i];for(var o=0;o<e.length;o++)n.push(e[o])}return n}function pg(t){if(t.length<2)return!1;var e=t[0],n=t[t.length-1];return Math.abs(e.x-n.x)<1e-12&&Math.abs(e.y-n.y)<1e-12}var mg=function(t){Dn(n,t);var e=In(n);function n(){var t,r;return Mn(this,n),(t=r=e.call(this,"path")).set.apply(t,arguments),r}return _n(n,[{key:"set",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Rn(Sn(n.prototype),"set",this).call(this,e),this.segments=[],this.points=[],this.attrs.d=e.d,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null},Array.isArray(e.collider)||"object"===wn(e.collider)&&void 0!==e.collider.type)this.collider=e.collider;else if(e.d){if(this.segments=om(e.d),this.segments.length>1&&this.segments.every((function(t){return pg(t)})))return void(this.collider=yn({type:"geopolygon",vertices:this.segments},e.collider));this.segments.forEach((function(n){if(n.length<=1);else if(pg(n))t.collider=yn({type:"polygon",vertices:n},e.collider);else if("object"===wn(e.collider)&&e.collider.visual){var r=t.attrs["stroke-width"]/2;t.collider=fg(n,r,e.collider)}else t.collider=yn({type:"polyline",points:n},e.collider)}))}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];this.points.length||(this.segments=this.segments.length?this.segments:om(this.attrs.d),this.points=dg(this.segments));var e=t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(this.points):this.points,n=Bn(e),r=Pn(n,4),i=r[0],o=r[1],a=r[2],s=r[3];return this.__boundingRect[t]={x:i||0,y:o||0,width:a-i||0,height:s-o||0},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}($m);function gg(t){var e=t.data,n=t._boundingRect,r=t._textBoundsFn;return null!=e&&(n||r)}var yg=function(t){Dn(n,t);var e=In(n);function n(){var t,r;return Mn(this,n),(t=r=e.call(this,"text")).set.apply(t,arguments),r}return _n(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,r=void 0===e?0:e,i=t.y,o=void 0===i?0:i,a=t.dx,s=void 0===a?0:a,u=t.dy,l=void 0===u?0:u,c=t.textBoundsFn,h=t.text,f=t.title,d=t.collider,p=t.boundingRect,m=t.ellipsed;Rn(Sn(n.prototype),"set",this).call(this,t),this.attrs.x=r,this.attrs.y=o,this.attrs.dx=s,this.attrs.dy=l,this.attrs.text=h,void 0!==f&&(this.attrs.title=String(f)),"object"===wn(p)?this._textBoundsFn=function(){return p}:"function"==typeof c&&(this._textBoundsFn=c),"string"==typeof m&&(this.ellipsed=m),this.collider=yn({type:gg(this)?"bounds":null},d),this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];if("function"!=typeof this._textBoundsFn)return{x:0,y:0,width:0,height:0};var e=Un(this._textBoundsFn(this.attrs)),n=t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e,r=Bn(n),i=Pn(r,4),o=i[0],a=i[1],s=i[2],u=i[3];return this.__boundingRect[t]={x:o,y:a,width:s-o,height:u-a},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}($m);var vg=ti();function xg(t,e){return vg.get(t)(e)}vg.add("rect",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(ag,e)})),vg.add("circle",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(sg,e)})),vg.add("text",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(yg,e)})),vg.add("line",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(ug,e)})),vg.add("path",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(mg,e)})),vg.add("stage",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(Zm,e)})),vg.add("container",Jm),vg.add("defs",Jm),vg.add("linearGradient",ng),vg.add("radialGradient",ng),vg.add("stop",ng),vg.add("pattern",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return An(og,e)}));var bg=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[{}];function n(){return e[e.length-1]}return n.save=function(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n(),o={},a="",s=0;s<t.length;s++)void 0!==i[a=t[s]]&&(o[a]=i[a]);return yn(o,r),e.push(o),n()},n.restore=function(){e.splice(e.length-1,1)},n}(["stroke","fill","strokeWidth","opacity","fontFamily","fontSize","baseline"]);function wg(t,e){if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)e[n](t)}function Mg(t,e,n){t.node=n[e],t.index=e}function kg(t,e,n,r){for(var i={siblings:t,node:null,index:0},o=0,a=t.length;o<a;o++)if(Mg(i,o,t),wg(i,r.create),!("function"==typeof i.node.disabled?i.node.disabled():i.node.disabled)){i.node=bg.save(i.node);var s=xg(i.node.type,i.node);s&&(i.node.transform&&(n.save(),Nm(i.node.transform,n)),n.isIdentity()||(s.modelViewMatrix=n.clone()),e.addChild(s),i.node.children&&kg(i.node.children,s,n,r),i.node.transform&&n.restore()),bg.restore()}}function _g(t){var e=t.items,n=t.stage,r=t.dpi,i=t.on,o=void 0===i?{}:i;return n||(n=xg("stage",r)),kg(e,n,new qm,o),n}function qg(t,e,n){var r=n.orientation,i=n.degree,o=n.stops,a=void 0===o?[]:o,s=null;if("radial"===r){var u=e.boundingRect();s=t.createRadialGradient(u.x+u.width/2,u.y+u.height/2,1e-5,u.x+u.width/2,u.y+u.height/2,Math.max(u.width,u.height)/2)}else{var l=bl(i);["x1","x2","y1","y2"].forEach((function(t){t in n&&(l[t]=n[t])}));var c=e.boundingRect();s=t.createLinearGradient(c.x+l.x1*c.width,c.y+l.y1*c.height,c.x+l.x2*c.width,c.y+l.y2*c.height)}for(var h=0,f=a.length;h<f;h++){var d=a[h];s.addColorStop(d.offset,d.color)}return s}function Dg(t,e,n){return e.width=t.width,e.height=t.height,n.save(),n.fillStyle=t.fill,t.shapes.forEach((function(t){if("rect"===t.type)n.rect(t.x,t.y,t.width,t.height)})),n.fill(),n.restore(),n.createPattern(e,"repeat")}function Sg(t){var e=t.createElement("canvas"),n=e.getContext("2d"),r={};return{create:function(t){var i=t.key;return i?(r[i]=r[i]||Dg(t,e,n),r[i]):Dg(t,e,n)},clear:function(){r={}}}}function Cg(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,r=t.width,i=t.height,o=t.scaleRatio,a=t.margin,s=t.edgeBleed,u={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1},margin:{left:0,top:0},edgeBleed:{left:0,right:0,top:0,bottom:0,bool:!1}};return u.x=isNaN(e)?u.x:e,u.y=isNaN(n)?u.y:n,u.width=isNaN(r)?u.width:r,u.height=isNaN(i)?u.height:i,void 0!==o&&(u.scaleRatio.x=isNaN(o.x)?u.scaleRatio.x:o.x,u.scaleRatio.y=isNaN(o.y)?u.scaleRatio.y:o.y),void 0!==a&&(u.margin.left=isNaN(a.left)?0:a.left,u.margin.top=isNaN(a.top)?0:a.top),"object"===wn(s)&&["left","right","top","bottom"].forEach((function(t){!isNaN(s[t])&&s[t]>0&&(u.edgeBleed[t]=s[t],u.edgeBleed.bool=!0)})),u.computedPhysical={x:Math.round(u.margin.left+(u.x-u.edgeBleed.left)*u.scaleRatio.x),y:Math.round(u.margin.top+(u.y-u.edgeBleed.top)*u.scaleRatio.y),width:Math.round((u.width+u.edgeBleed.left+u.edgeBleed.right)*u.scaleRatio.x),height:Math.round((u.height+u.edgeBleed.top+u.edgeBleed.bottom)*u.scaleRatio.y)},u}function Eg(){var t={element:function(){},root:function(){},settings:function(){},appendTo:function(){},getScene:function(){return[]},render:function(){return!1},itemsAt:function(){return[]},findShapes:function(){return[]},clear:function(){},destory:function(){},size:function(){},measureText:Jd,textBounds:Qd,setKey:function(e){t.element().setAttribute("data-key",e)}};return t}function Ag(t){return function(e){var n=e.node;"text"!==n.type||null==n.data||n.textBoundsFn||(n.textBoundsFn=t.textBounds)}}var Ng=200,Og=200,Ig=function(){function t(e){Mn(this,t),this.targetCanvas=e,this.bufferCanvas=e.cloneNode()}return _n(t,[{key:"updateSize",value:function(t){var e,n=t.rect,r=t.dpiRatio,i=t.canvasBufferSize;e=i?"function"==typeof i?i(n):i:{width:n.computedPhysical.width+2*Ng,height:n.computedPhysical.height+2*Og},this.bufferCanvas.style.width="".concat(e.width,"px"),this.bufferCanvas.style.height="".concat(e.height,"px"),this.bufferCanvas.width=Math.round(e.width*r),this.bufferCanvas.height=Math.round(e.height*r)}},{key:"apply",value:function(){this.targetCanvas.getContext("2d").drawImage(this.bufferCanvas,0,0)}},{key:"clear",value:function(){this.bufferCanvas.width=this.bufferCanvas.width}},{key:"getContext",value:function(){return this.bufferCanvas.getContext("2d")}}]),t}(),Tg=ti();function Rg(t){return Array.isArray(t)?t:"string"==typeof t?-1!==t.indexOf(",")?t.split(","):t.split(" "):[]}function Pg(t){return("undefined"==typeof window?1:window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function Fg(t,e){e.setTransform(t[0][0],t[1][0],t[0][1],t[1][1],t[0][2],t[1][2])}function Lg(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Object.keys(r),o=0,a=n.length;o<a;o++){var s=n[o],u=s[0],l=s[1],c=s[2];if(u in e.attrs&&!(l in r)&&t[l]!==e.attrs[u]){var h=c?c(e.attrs[u]):e.attrs[u];"function"==typeof t[l]?t[l](h):t[l]=h}}for(var f=0,d=i.length;f<d;f++){var p=i[f];t[p]=r[p]}}function jg(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s={};e.save(),a.attrs&&(a.attrs.fill||a.attrs.stroke)&&(a.attrs.fill&&"object"===wn(a.attrs.fill)&&"gradient"===a.attrs.fill.type?s.fillStyle=qg(e,a,a.attrs.fill):a.attrs.fill&&"object"===wn(a.attrs.fill)&&"pattern"===a.attrs.fill.type&&(s.fillStyle=r.patterns.create(a.attrs.fill)),a.attrs.stroke&&"object"===wn(a.attrs.stroke)&&"gradient"===a.attrs.stroke.type?s.strokeStyle=qg(e,a,a.attrs.stroke):a.attrs.stroke&&"object"===wn(a.attrs.stroke)&&"pattern"===a.attrs.stroke.type&&(s.strokeStyle=r.patterns.create(a.attrs.stroke))),Lg(e,a,n,s),a.modelViewMatrix&&Fg(a.modelViewMatrix.elements,e),Tg.has(a.type)&&Tg.get(a.type)(a.attrs,{g:e,doFill:"fill"in a.attrs&&"none"!==a.attrs.fill,doStroke:"stroke"in a.attrs&&0!==a.attrs["stroke-width"],ellipsed:a.ellipsed}),a.children&&jg(a.children,e,n,r),e.restore()}}function zg(t){var e=t.el,n=t.dpiRatio,r=t.transform;if("object"===wn(r)){var i=[r.horizontalScaling,r.horizontalSkewing,r.verticalSkewing,r.verticalScaling,r.horizontalMoving*n,r.verticalMoving*n],o=e.getContext("2d");o.setTransform.apply(o,i)}}function Vg(){var t,e,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_g,o={transform:void 0,canvasBufferSize:void 0},a=!1,s=Cg(),u=[["fill","fillStyle"],["stroke","strokeStyle"],["opacity","globalAlpha"],["globalAlpha","globalAlpha"],["stroke-width","lineWidth"],["stroke-linejoin","lineJoin"],["stroke-dasharray","setLineDash",Rg]],l=Eg();return l.element=function(){return t},l.root=function(){return t},l.settings=function(t){return t&&Object.keys(o).forEach((function(e){void 0!==t[e]&&(o[e]=t[e])})),o},l.appendTo=function(n){return t||((t=n.ownerDocument.createElement("canvas")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none"),"function"!=typeof o.transform||e||(e=new Ig(t)),n.appendChild(t),t},l.getScene=function(n){var r=Pg(e&&e.getContext()||t.getContext("2d")),o=s.scaleRatio.x,a=s.scaleRatio.y,u={type:"container",children:n,transform:s.edgeBleed.bool?"translate(".concat(s.edgeBleed.left*r*o,", ").concat(s.edgeBleed.top*r*a,")"):""};return 1===r&&1===o&&1===a||(u.transform+="scale(".concat(r*o,", ").concat(r*a,")")),i({items:[u],dpi:r,on:{create:[Hd(l.measureText),Ag(l)]}})},l.render=function(i){if(!t)return!1;r||(r=Sg(t.ownerDocument));var c=e&&e.getContext()||t.getContext("2d"),h=Pg(c),f=e&&o.transform();if(f)return t.width=t.width,zg({el:t,dpiRatio:h,transform:f}),e.apply(),!0;a&&(t.style.left="".concat(s.computedPhysical.x,"px"),t.style.top="".concat(s.computedPhysical.y,"px"),t.style.width="".concat(s.computedPhysical.width,"px"),t.style.height="".concat(s.computedPhysical.height,"px"),t.width=Math.round(s.computedPhysical.width*h),t.height=Math.round(s.computedPhysical.height*h),e&&e.updateSize({rect:s,dpiRatio:h,canvasBufferSize:o.canvasBufferSize}));var d=l.getScene(i),p=!n||!d.equals(n);r.clear();var m=a||p;return m&&(l.clear(),jg(d.children,c,u,{patterns:r})),e&&(t.width=t.width,e.apply()),a=!1,n=d,m},l.itemsAt=function(t){return n?n.getItemsFrom(t):[]},l.findShapes=function(t){return n?n.findShapes(t):[]},l.clear=function(){return t&&(t.width=t.width),e&&e.clear(),n=null,l},l.size=function(t){if(t){var e=Cg(t);JSON.stringify(s)!==JSON.stringify(e)&&(a=!0,s=e)}return s},l.destroy=function(){t&&(t.parentElement&&t.parentElement.removeChild(t),t=null),e&&(e=null),n=null},l}function Hg(t,e){Tg.add(t,e)}function Bg(t,e){return Math.max(0,Math.min(t,e))}var Wg=new RegExp("[A-Za-z---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]"),Ug=new RegExp("[-------]"),Yg=new RegExp("[-----------]");function $g(t){return Wg.test(t)}function Xg(t){return Ug.test(t)||Yg.test(t)}function Gg(t){var e,n,r=t?t.length:0;for(e=0;e<r;e++){if($g(n=t[e]))return"ltr";if(Xg(n))return"rtl"}return"ltr"}var Kg={start:"end",end:"start",center:"center",middle:"middle"};function Jg(t,e){return"rtl"===e?Kg[t]:t}function Zg(t,e){var n,r,i,o=[],a=[],s=[],u=[],l=function(t){return t.id},c=function(t,e){var n;return n="object"===wn(t)?"id"in t?t.id:e:t,{content:t,id:"".concat(n,"__").concat(t.type||"")}};t.isTree||(t=t.map(c)),e=e.map(c),r=t.map(l),i=e.map(l);for(var h=0,f=e.length;h<f;h++){-1===r.indexOf(e[h].id)?o.push(e[h]):s.push(e[h])}for(var d=0,p=t.length;d<p;d++){-1===i.indexOf(t[d].id)?a.push(t[d]):u.push(t[d])}for(var m=0,g=o.length;m<g;m++)o[m].content.children&&(o[m].diff=Zg([],o[m].content.children),o[m].children=o[m].diff.updatedNew.concat(o[m].diff.added),o[m].children.isTree=!0);for(var y=0,v=s.length;y<v;y++)s[y].diff=Zg(u[y].children||[],s[y].content.children||[]),s[y].object=u[y].object,s[y].children=s[y].diff.items;return n=s.concat(o),o.isTree=!0,a.isTree=!0,s.isTree=!0,u.isTree=!0,n.isTree=!0,{added:o,updatedNew:s,updatedOld:u,removed:a,items:n}}function Qg(t,e,n){for(var r=0,i=t.length;r<i;r++)t[r].object=n(t[r].content.type,e)}function ty(t,e){for(var n=0,r=t.length;n<r;n++)null!==t[n].object&&void 0!==t[n].object&&(e(t[n].object),t[n].object=null)}function ey(t,e,n,r){for(var i,o=0,a=t.length;o<a;o++)null!==(i=t[o]).object&&void 0!==i.object&&(n(i.object,i.content),i.diff&&(Qg(i.diff.added,i.object,e),ty(i.diff.removed,r),ey(i.diff.items,e,n,r)))}function ny(t,e,n,r,i,o){var a=Zg(t,e);return Qg(a.added,n,r),ty(a.removed,o),ey(a.items,r,i,o),a.items}Hg("rect",(function(t,e){var n=e.g,r=e.doFill,i=e.doStroke;n.beginPath(),t.rx>0||t.ry>0?function(t,e,n,r,i,o,a){o=Bg(r/2,o>0?o:a),a=Bg(i/2,a>0?a:o),t.moveTo(e,n+a),t.lineTo(e,n+i-a),t.quadraticCurveTo(e,n+i,e+o,n+i),t.lineTo(e+r-o,n+i),t.quadraticCurveTo(e+r,n+i,e+r,n+i-a),t.lineTo(e+r,n+a),t.quadraticCurveTo(e+r,n,e+r-o,n),t.lineTo(e+o,n),t.quadraticCurveTo(e,n,e,n+a)}(n,t.x,t.y,t.width,t.height,t.rx,t.ry):n.rect(t.x,t.y,t.width,t.height),r&&n.fill(),i&&n.stroke()})),Hg("circle",(function(t,e){var n=e.g,r=e.doFill,i=e.doStroke;n.beginPath(),n.moveTo(t.cx+t.r,t.cy),n.arc(t.cx,t.cy,t.r,0,2*Math.PI,!1),r&&n.fill(),i&&n.stroke()})),Hg("line",(function(t,e){var n=e.g,r=e.doStroke;n.beginPath(),n.moveTo(t.x1,t.y1),n.lineTo(t.x2,t.y2),r&&n.stroke()})),Hg("path",(function(t,e){var n=e.g,r=e.doStroke,i=e.doFill,o=new Path2D(t.d);i&&n.fill(o),r&&n.stroke(o)})),Hg("text",(function(t,e){var n=e.g,r=e.ellipsed||Bd(t,Jd);n.font="".concat(t["font-size"]," ").concat(t["font-family"]);var i=Gg(t.text);n.canvas.dir!==i&&(n.canvas.dir=i);var o=Jg("middle"===t["text-anchor"]?"center":t["text-anchor"],n.canvas.dir);o&&n.textAlign!==o&&(n.textAlign=o);var a=Wd(t);n.fillText(r,t.x+t.dx,t.y+t.dy+a)}));var ry="http://www.w3.org/2000/svg",iy=function(t,e){if(!t||"string"!=typeof t)throw new Error("Invalid type: ".concat(t));var n=e.ownerDocument.createElementNS(ry,"container"===t?"g":t);return e.appendChild(n),n},oy=function(t){t.parentNode&&t.parentNode.removeChild(t)},ay=function(t,e){if(function(t){switch(t.type){case"circle":return!isNaN(t.attrs.cx)&&!isNaN(t.attrs.cy)&&!isNaN(t.attrs.r);case"line":return!(isNaN(t.attrs.x1)||isNaN(t.attrs.y1)||isNaN(t.attrs.x2)||isNaN(t.attrs.y2));case"rect":return!(isNaN(t.attrs.x)||isNaN(t.attrs.y)||isNaN(t.attrs.width)||isNaN(t.attrs.height));case"text":return!isNaN(t.attrs.x)&&!isNaN(t.attrs.y);default:return!0}}(e)){for(var n in e.attrs)if("stroke"===n&&e.strokeReference)t.setAttribute("stroke",e.strokeReference);else if("fill"===n&&e.fillReference)t.setAttribute("fill",e.fillReference);else if("text"===n){t.setAttribute("style","white-space: pre"),t.textContent=e.ellipsed||Bd(e.attrs,Jd);var r=Gg(e.attrs.text);"rtl"===r&&(t.setAttribute("direction","rtl"),t.setAttribute("dir","rtl"),t.setAttribute("text-anchor",Jg(t.getAttribute("text-anchor"),r)))}else if("text"!==e.type||"dy"!==n&&"dominant-baseline"!==n)if("text"===e.type&&"title"===n&&e.attrs.title){var i=t.ownerDocument.createElementNS(ry,"title");i.textContent=e.attrs.title,t.appendChild(i)}else t.setAttribute(n,e.attrs[n]);else{var o=+t.getAttribute(n)||0,a=0;a="dominant-baseline"===n?Wd(e.attrs):e.attrs[n],t.setAttribute("dy",a+o)}if("string"==typeof e.data||"number"==typeof e.data||"boolean"==typeof e.data)t.setAttribute("data",e.data);else if("object"===wn(e.data)&&null!==e.data)for(var s in e.data)"string"!=typeof e.data[s]&&"number"!=typeof e.data[s]&&"boolean"!=typeof e.data[s]||t.setAttribute("data-".concat(s),e.data[s])}},sy=function(){function t(e,n,r,i){Mn(this,t),this.create=e,this.nodeCreator=n,this.nodeMaintainer=r,this.nodeDestroyer=i}return _n(t,[{key:"render",value:function(t,e){return this.create([],t,e,this.nodeCreator,this.nodeMaintainer,this.nodeDestroyer)}}]),t}();function uy(){return new sy(ny,iy,ay,oy)}function ly(t){var e,n,r=0;if(0===(t=JSON.stringify(t)).length)return r;for(e=0,n=t.length;e<n;e++)r=(r<<5)-r+t.charCodeAt(e),r&=r;return r}function cy(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ly,n={},r=Date.now(),i={getOrCreateGradient:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=e(i[o]),u="picasso-gradient-".concat(r,"-").concat(s);if(!n[s]){var l=i[o],c=l.orientation,h=l.degree,f=l.stops,d=void 0===f?[]:f,p={};void 0===h&&(h=90),"radial"===c?p.type="radialGradient":(p=bl(h),["x1","x2","y1","y2"].forEach((function(t){t in i[o]&&(p[t]=i[o][t])})),p.type="linearGradient"),p.id=u,p.children=d.map((function(t){var e=t.offset,n=t.color,r=t.opacity;return{type:"stop",offset:"".concat(100*e,"%"),style:"stop-color:".concat(n,";stop-opacity:").concat(void 0!==r?r:1)}})),t.push(p),n[s]=u}return"url('".concat(a,"#").concat(u,"')")},onCreate:function(t){var e="";"undefined"!=typeof window&&(e=window.location.href.split("#")[0]);var n=t.node;n.fill&&"object"===wn(n.fill)&&"gradient"===n.fill.type&&(n.fillReference=i.getOrCreateGradient(n,"fill",e)),n.stroke&&"object"===wn(n.stroke)&&"gradient"===n.stroke.type&&(n.strokeReference=i.getOrCreateGradient(n,"stroke",e))},clear:function(){n={}}};return i}function hy(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ly,n={},r=Date.now(),i={onCreate:function(i){var o={};i.node&&"object"===wn(i.node.fill)&&"pattern"===i.node.fill.type&&i.node.fill.shapes&&(o.fill=i.node.fill),i.node&&"object"===wn(i.node.stroke)&&"pattern"===i.node.stroke.type&&i.node.stroke.shapes&&(o.stroke=i.node.stroke),Object.keys(o).forEach((function(a){var s="",u=o[a],l=e(u),c="picasso-pattern-".concat(r,"-").concat(l);if("undefined"!=typeof window&&(s=window.location.href.split("#")[0]),!n[l]){var h={patternUnits:"userSpaceOnUse",x:0,y:0,width:u.width,height:u.height,type:"pattern",id:c,children:[],fill:u.fill};u.shapes.forEach((function(t){h.children.push(t)})),t.push(h),n[l]=!0}i.node["".concat(a,"Reference")]="url('".concat(s,"#").concat(c,"')")}))},clear:function(){n={}}};return i}function fy(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uy,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ry,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_g,a=r(),s=!1,u=Cg(),l={transform:void 0},c=Eg(),h={type:"defs",children:[]},f=hy(h.children),d=cy(h.children);return c.element=function(){return t},c.root=function(){return e},c.settings=function(t){return t&&Object.keys(l).forEach((function(e){void 0!==t[e]&&(l[e]=t[e])})),l},c.appendTo=function(n){return t||((t=n.ownerDocument.createElementNS(i,"svg")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none",t.setAttribute("xmlns",i),(e=n.ownerDocument.createElementNS(i,"g")).style.pointerEvents="auto",t.appendChild(e)),n.appendChild(t),t},c.getScene=function(t){var e=u.scaleRatio.x,n=u.scaleRatio.y,r={type:"container",children:Array.isArray(t)?[].concat(Fn(t),[h]):t,transform:u.edgeBleed.bool?"translate(".concat(u.edgeBleed.left*e,", ").concat(u.edgeBleed.top*n,")"):""};return 1===e&&1===n||(r.transform+="scale(".concat(e,", ").concat(n,")")),o({items:[r],on:{create:[function(t){t.node.fillReference=void 0,t.node.strokeReference=void 0},d.onCreate,f.onCreate,Hd(c.measureText),Ag(c)]}})},c.render=function(r){if(!t)return!1;var i="function"==typeof l.transform&&l.transform();if(i){var o=i.a,p=i.b,m=i.c,g=i.d,y=i.e,v=i.f;return e.style.transform="matrix(".concat(o,", ").concat(p,", ").concat(m,", ").concat(g,", ").concat(y,", ").concat(v,")"),!0}e.style.transform="",s&&(t.style.left="".concat(u.computedPhysical.x,"px"),t.style.top="".concat(u.computedPhysical.y,"px"),t.setAttribute("width",u.computedPhysical.width),t.setAttribute("height",u.computedPhysical.height)),d.clear(),f.clear(),h.children.length=0;var x=c.getScene(r),b=!n||!x.equals(n),w=s||b;return w&&(c.clear(),a.render(x.children,e)),s=!1,n=x,w},c.itemsAt=function(t){return n?n.getItemsFrom(t):[]},c.findShapes=function(t){return n?n.findShapes(t):[]},c.clear=function(){if(!e)return c;n=null;var r=e.cloneNode(!1);return t.replaceChild(r,e),e=r,c},c.destroy=function(){t&&t.parentNode&&t.parentNode.removeChild(t),t=null,e=null},c.size=function(t){if(t){var e=Cg(t);JSON.stringify(u)!==JSON.stringify(e)&&(s=!0,u=e)}return u},c}var dy,py,my,gy,yy,vy,xy={},by=[],wy=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function My(t,e){for(var n in e)t[n]=e[n];return t}function ky(t){var e=t.parentNode;e&&e.removeChild(t)}function _y(t,e,n){var r,i,o,a={};for(o in e)"key"==o?r=e[o]:"ref"==o?i=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?dy.call(arguments,2):n),"function"==typeof t&&null!=t.defaultProps)for(o in t.defaultProps)void 0===a[o]&&(a[o]=t.defaultProps[o]);return qy(t,a,r,i,null)}function qy(t,e,n,r,i){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++my:i};return null==i&&null!=py.vnode&&py.vnode(o),o}function Dy(t){return t.children}function Sy(t,e){this.props=t,this.context=e}function Cy(t,e){if(null==e)return t.__?Cy(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?Cy(t):null}function Ey(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return Ey(t)}}function Ay(t){(!t.__d&&(t.__d=!0)&&gy.push(t)&&!Ny.__r++||vy!==py.debounceRendering)&&((vy=py.debounceRendering)||yy)(Ny)}function Ny(){for(var t;Ny.__r=gy.length;)t=gy.sort((function(t,e){return t.__v.__b-e.__v.__b})),gy=[],t.some((function(t){var e,n,r,i,o,a;t.__d&&(o=(i=(e=t).__v).__e,(a=e.__P)&&(n=[],(r=My({},i)).__v=i.__v+1,jy(a,i,r,e.__n,void 0!==a.ownerSVGElement,null!=i.__h?[o]:null,n,null==o?Cy(i):o,i.__h),zy(n,i),i.__e!=o&&Ey(i)))}))}function Oy(t,e,n,r,i,o,a,s,u,l){var c,h,f,d,p,m,g,y=r&&r.__k||by,v=y.length;for(n.__k=[],c=0;c<e.length;c++)if(null!=(d=n.__k[c]=null==(d=e[c])||"boolean"==typeof d?null:"string"==typeof d||"number"==typeof d||"bigint"==typeof d?qy(null,d,null,null,d):Array.isArray(d)?qy(Dy,{children:d},null,null,null):d.__b>0?qy(d.type,d.props,d.key,null,d.__v):d)){if(d.__=n,d.__b=n.__b+1,null===(f=y[c])||f&&d.key==f.key&&d.type===f.type)y[c]=void 0;else for(h=0;h<v;h++){if((f=y[h])&&d.key==f.key&&d.type===f.type){y[h]=void 0;break}f=null}jy(t,d,f=f||xy,i,o,a,s,u,l),p=d.__e,(h=d.ref)&&f.ref!=h&&(g||(g=[]),f.ref&&g.push(f.ref,null,d),g.push(h,d.__c||p,d)),null!=p?(null==m&&(m=p),"function"==typeof d.type&&d.__k===f.__k?d.__d=u=Iy(d,u,t):u=Ty(t,d,f,y,p,u),"function"==typeof n.type&&(n.__d=u)):u&&f.__e==u&&u.parentNode!=t&&(u=Cy(f))}for(n.__e=m,c=v;c--;)null!=y[c]&&("function"==typeof n.type&&null!=y[c].__e&&y[c].__e==n.__d&&(n.__d=Cy(r,c+1)),By(y[c],y[c]));if(g)for(c=0;c<g.length;c++)Hy(g[c],g[++c],g[++c])}function Iy(t,e,n){for(var r,i=t.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=t,e="function"==typeof r.type?Iy(r,e,n):Ty(n,r,r,i,r.__e,e));return e}function Ty(t,e,n,r,i,o){var a,s,u;if(void 0!==e.__d)a=e.__d,e.__d=void 0;else if(null==n||i!=o||null==i.parentNode)t:if(null==o||o.parentNode!==t)t.appendChild(i),a=null;else{for(s=o,u=0;(s=s.nextSibling)&&u<r.length;u+=2)if(s==i)break t;t.insertBefore(i,o),a=o}return void 0!==a?a:i.nextSibling}function Ry(t,e,n){"-"===e[0]?t.setProperty(e,n):t[e]=null==n?"":"number"!=typeof n||wy.test(e)?n:n+"px"}function Py(t,e,n,r,i){var o;t:if("style"===e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof r&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Ry(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||Ry(t.style,e,n[e])}else if("o"===e[0]&&"n"===e[1])o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r||t.addEventListener(e,o?Ly:Fy,o):t.removeEventListener(e,o?Ly:Fy,o);else if("dangerouslySetInnerHTML"!==e){if(i)e=e.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&e in t)try{t[e]=null==n?"":n;break t}catch(t){}"function"==typeof n||(null!=n&&(!1!==n||"a"===e[0]&&"r"===e[1])?t.setAttribute(e,n):t.removeAttribute(e))}}function Fy(t){this.l[t.type+!1](py.event?py.event(t):t)}function Ly(t){this.l[t.type+!0](py.event?py.event(t):t)}function jy(t,e,n,r,i,o,a,s,u){var l,c,h,f,d,p,m,g,y,v,x,b=e.type;if(void 0!==e.constructor)return null;null!=n.__h&&(u=n.__h,s=e.__e=n.__e,e.__h=null,o=[s]),(l=py.__b)&&l(e);try{t:if("function"==typeof b){if(g=e.props,y=(l=b.contextType)&&r[l.__c],v=l?y?y.props.value:l.__:r,n.__c?m=(c=e.__c=n.__c).__=c.__E:("prototype"in b&&b.prototype.render?e.__c=c=new b(g,v):(e.__c=c=new Sy(g,v),c.constructor=b,c.render=Wy),y&&y.sub(c),c.props=g,c.state||(c.state={}),c.context=v,c.__n=r,h=c.__d=!0,c.__h=[]),null==c.__s&&(c.__s=c.state),null!=b.getDerivedStateFromProps&&(c.__s==c.state&&(c.__s=My({},c.__s)),My(c.__s,b.getDerivedStateFromProps(g,c.__s))),f=c.props,d=c.state,h)null==b.getDerivedStateFromProps&&null!=c.componentWillMount&&c.componentWillMount(),null!=c.componentDidMount&&c.__h.push(c.componentDidMount);else{if(null==b.getDerivedStateFromProps&&g!==f&&null!=c.componentWillReceiveProps&&c.componentWillReceiveProps(g,v),!c.__e&&null!=c.shouldComponentUpdate&&!1===c.shouldComponentUpdate(g,c.__s,v)||e.__v===n.__v){c.props=g,c.state=c.__s,e.__v!==n.__v&&(c.__d=!1),c.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach((function(t){t&&(t.__=e)})),c.__h.length&&a.push(c);break t}null!=c.componentWillUpdate&&c.componentWillUpdate(g,c.__s,v),null!=c.componentDidUpdate&&c.__h.push((function(){c.componentDidUpdate(f,d,p)}))}c.context=v,c.props=g,c.state=c.__s,(l=py.__r)&&l(e),c.__d=!1,c.__v=e,c.__P=t,l=c.render(c.props,c.state,c.context),c.state=c.__s,null!=c.getChildContext&&(r=My(My({},r),c.getChildContext())),h||null==c.getSnapshotBeforeUpdate||(p=c.getSnapshotBeforeUpdate(f,d)),x=null!=l&&l.type===Dy&&null==l.key?l.props.children:l,Oy(t,Array.isArray(x)?x:[x],e,n,r,i,o,a,s,u),c.base=e.__e,e.__h=null,c.__h.length&&a.push(c),m&&(c.__E=c.__=null),c.__e=!1}else null==o&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=Vy(n.__e,e,n,r,i,o,a,u);(l=py.diffed)&&l(e)}catch(t){e.__v=null,(u||null!=o)&&(e.__e=s,e.__h=!!u,o[o.indexOf(s)]=null),py.__e(t,e,n)}}function zy(t,e){py.__c&&py.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){py.__e(t,e.__v)}}))}function Vy(t,e,n,r,i,o,a,s){var u,l,c,h=n.props,f=e.props,d=e.type,p=0;if("svg"===d&&(i=!0),null!=o)for(;p<o.length;p++)if((u=o[p])&&"setAttribute"in u==!!d&&(d?u.localName===d:3===u.nodeType)){t=u,o[p]=null;break}if(null==t){if(null===d)return document.createTextNode(f);t=i?document.createElementNS("http://www.w3.org/2000/svg",d):document.createElement(d,f.is&&f),o=null,s=!1}if(null===d)h===f||s&&t.data===f||(t.data=f);else{if(o=o&&dy.call(t.childNodes),l=(h=n.props||xy).dangerouslySetInnerHTML,c=f.dangerouslySetInnerHTML,!s){if(null!=o)for(h={},p=0;p<t.attributes.length;p++)h[t.attributes[p].name]=t.attributes[p].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===t.innerHTML)||(t.innerHTML=c&&c.__html||""))}if(function(t,e,n,r,i){var o;for(o in n)"children"===o||"key"===o||o in e||Py(t,o,null,n[o],r);for(o in e)i&&"function"!=typeof e[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===e[o]||Py(t,o,e[o],n[o],r)}(t,f,h,i,s),c)e.__k=[];else if(p=e.props.children,Oy(t,Array.isArray(p)?p:[p],e,n,r,i&&"foreignObject"!==d,o,a,o?o[0]:n.__k&&Cy(n,0),s),null!=o)for(p=o.length;p--;)null!=o[p]&&ky(o[p]);s||("value"in f&&void 0!==(p=f.value)&&(p!==h.value||p!==t.value||"progress"===d&&!p)&&Py(t,"value",p,h.value,!1),"checked"in f&&void 0!==(p=f.checked)&&p!==t.checked&&Py(t,"checked",p,h.checked,!1))}return t}function Hy(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){py.__e(t,n)}}function By(t,e,n){var r,i;if(py.unmount&&py.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||Hy(r,null,e)),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){py.__e(t,e)}r.base=r.__P=null}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&By(r[i],e,"function"!=typeof t.type);n||null==t.__e||ky(t.__e),t.__e=t.__d=void 0}function Wy(t,e,n){return this.constructor(t,n)}function Uy(t,e,n){var r,i,o;py.__&&py.__(t,e),i=(r="function"==typeof n)?null:n&&n.__k||e.__k,o=[],jy(e,t=(!r&&n||e).__k=_y(Dy,null,[t]),i||xy,xy,void 0!==e.ownerSVGElement,!r&&n?[n]:i?null:e.firstChild?dy.call(e.childNodes):null,o,!r&&n?n:i?i.__e:e.firstChild,r),zy(o,t)}function Yy(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.createElement,i=void 0===r?document.createElement.bind(document):r,o=Cg(),a={transform:void 0},s=Eg();return s.element=function(){return t},s.root=function(){return t},s.settings=function(t){return t&&Object.keys(a).forEach((function(e){void 0!==t[e]&&(a[e]=t[e])})),a},s.appendTo=function(e){return t||((t=i("div")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none"),e.appendChild(t),t},s.render=function(n){if(!t)return!1;var r,i="function"==typeof a.transform&&a.transform();if(i){var s=i.a,u=i.b,l=i.c,c=i.d,h=i.e,f=i.f;return t.style.transform="matrix(".concat(s,", ").concat(u,", ").concat(l,", ").concat(c,", ").concat(h,", ").concat(f,")"),!0}return t.style.transform="",t.style.left="".concat(o.computedPhysical.x,"px"),t.style.top="".concat(o.computedPhysical.y,"px"),t.style.width="".concat(o.computedPhysical.width,"px"),t.style.height="".concat(o.computedPhysical.height,"px"),r=Array.isArray(n)?_y("div",null,n):n,e=Uy(r,t,e),!0},s.renderArgs=[_y],s.clear=function(){if(t){for(var n=t.firstChild;n;)t.removeChild(n),n=t.firstChild;e=null}return s},s.destroy=function(){t&&t.parentElement&&t.parentElement.removeChild(t),t=null,e=null},s.size=function(t){return t&&(o=Cg(t)),o},s}dy=by.slice,py={__e:function(t,e){for(var n,r,i;e=e.__;)if((n=e.__c)&&!n.__)try{if((r=n.constructor)&&null!=r.getDerivedStateFromError&&(n.setState(r.getDerivedStateFromError(t)),i=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(t),i=n.__d),i)return n.__E=n}catch(e){t=e}throw t}},my=0,Sy.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=My({},this.state),"function"==typeof t&&(t=t(My({},n),this.props)),t&&My(n,t),null!=t&&this.__v&&(e&&this.__h.push(e),Ay(this))},Sy.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ay(this))},Sy.prototype.render=Dy,gy=[],yy="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ny.__r=0;var $y=[function(t){t.renderer("svg",fy)},function(t){t.renderer("canvas",Vg)},function(t){t.renderer("dom",Yy)}],Xy={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},Gy=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.level,r=void 0===n?Xy.OFF:n,i=e.pipe,o=void 0===i?console:i,a=r,s=(qn(t={},Xy.OFF,(function(){})),qn(t,Xy.ERROR,(function(){return o.error.apply(o,arguments)})),qn(t,Xy.WARN,(function(){return o.warn.apply(o,arguments)})),qn(t,Xy.INFO,(function(){return o.info.apply(o,arguments)})),qn(t,Xy.DEBUG,(function(){return o.log.apply(o,arguments)})),t),u=function(t){if(t&&!(a<t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];(s[t]||s[Xy.DEBUG]).apply(void 0,n)}};return{log:u,error:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[Xy.ERROR].concat(e))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[Xy.WARN].concat(e))},info:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[Xy.INFO].concat(e))},debug:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[Xy.DEBUG].concat(e))},level:function(t){return"number"==typeof t&&(a=t),a},LOG_LEVEL:Xy}};function Ky(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;t(n,e)}var Jy=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Gy(e.logger),i={component:ti(n.component,"component",r),data:ti(n.data,"data",r),formatter:ti(n.formatter,"formatter",r),interaction:ti(n.interaction,"interaction",r),renderer:Wc(n.renderer),scale:ti(n.scale,"scale",r),symbol:ti(n.symbol,"symbol",r),logger:r};function o(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={palettes:e.palettes.concat(n.palettes||[]),style:yn({},e.style,n.style),logger:n.logger||e.logger,renderer:n.renderer||e.renderer};return t(r,i)}return e.renderer&&e.renderer.prio&&i.renderer.default(e.renderer.prio[0]),o.use=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ky(t,e,i)},o.chart=function(t){return Bc(t,{registries:i,logger:r,style:e.style,palettes:e.palettes})},o.config=function(){return e},Object.keys(i).forEach((function(t){o[t]=i[t]})),o.version=vn,o}({renderer:{prio:["svg","canvas"]},logger:{level:0},style:{"$font-family":"'Source Sans Pro', Arial, sans-serif","$font-size":"12px","$line-height":"16px","$font-size--l":"16px","$gray-100":"#ffffff","$gray-98":"#f9f9f9","$gray-95":"#f2f2f2","$gray-90":"#e6e6e6","$gray-35":"#595959","$gray-30":"#4d4d4d","$gray-25":"#404040","$gray-20":"#333333","$border-95":"rgba(255, 255, 255, 0.05)","$border-90":"rgba(255, 255, 255, 0.1)","$border-80":"rgba(255, 255, 255, 0.2)","$border-20":"rgba(0, 0, 0, 0.2)","$border-10":"rgba(0, 0, 0, 0.1)","$border-5":"rgba(0, 0, 0, 0.05)","$primary-blue":"#3F8AB3","$primary-green":"#6CB33F","$primary-red":"#DC423F","$primary-orange":"#EF960F","$spacing--s":4,$spacing:8,"$spacing--l":12,"$font-color":"$gray-35","$font-color--inverted":"$gray-90","$guide-color":"$gray-90","$guide-color--inverted":"$gray-35",$border:"$border-80","$border--inverted":"$border-10",$shape:{fill:"$primary-blue",strokeWidth:1,stroke:"$border"},"$shape-outline":{stroke:"$primary-blue",strokeWidth:2},"$shape-guide":{stroke:"$guide-color",strokeWidth:1},"$shape-guide--inverted":{"@extend":"$shape-guide",stroke:"$guide-color--inverted"},$label:{fontSize:"$font-size",fontFamily:"$font-family",fill:"$font-color"},"$label--inverted":{$extend:"$label",fill:"$font-color--inverted"},"$label-overlay":{fontSize:"$font-size--l",fontFamily:"$font-family",fill:"$gray-100",color:"$font-color",stroke:"$guide-color--inverted",strokeWidth:1,borderRadius:4},$title:{"@extend":"$label",fontSize:"$font-size--l"},"$guide-line":{strokeWidth:1,stroke:"$guide-color"},"$guide-line--minor":{strokeWidth:1,stroke:"$gray-95"},"$padding--s":{left:"$spacing--s",right:"$spacing--s",top:"$spacing--s",bottom:"$spacing--s"},$padding:{left:"$spacing",right:"$spacing",top:"$spacing",bottom:"$spacing"},"$selection-area-target":{fill:"$primary-green",strokeWidth:0,opacity:.2}},palettes:[{key:"categorical",colors:[["#a54343","#d76c6c","#ec983d","#ecc43d","#f9ec86","#cbe989","#70ba6e","#578b60","#79d69f","#26a0a7","#138185","#65d3da"]]},{key:"diverging",colors:[["#3d52a1","#3a89c9","#77b7e5","#b4ddf7","#e6f5fe","#ffe3aa","#f9bd7e","#ed875e","#d24d3e","#ae1c3e"]]},{key:"sequential",colors:[["rgb(180,221,212)","rgb(34, 83, 90)"]]}]},{component:Uc,data:ah,formatter:oa,interaction:sh,renderer:Wc(),scale:wu,symbol:Ol});function Zy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Qy(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zy(Object(n),!0).forEach((function(e){iv(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function tv(t){return tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tv(t)}function ev(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rv(t,e,n){return e&&nv(t.prototype,e),n&&nv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function iv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ov(t,e){return ov=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ov(t,e)}function av(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function sv(t,e,n){return sv=av()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&ov(i,n.prototype),i},sv.apply(null,arguments)}function uv(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(t,e)||cv(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lv(t){return function(t){if(Array.isArray(t))return hv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||cv(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cv(t,e){if(t){if("string"==typeof t)return hv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hv(t,e):void 0}}function hv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}sm.forEach(Jy.use),$y.forEach(Jy.use),[].forEach(Jy.use);var fv=Object.prototype.hasOwnProperty,dv=Object.prototype.toString,pv=Object.defineProperty,mv=Object.getOwnPropertyDescriptor,gv=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===dv.call(t)},yv=function(t){if(!t||"[object Object]"!==dv.call(t))return!1;var e,n=fv.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&fv.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||fv.call(t,e)},vv=function(t,e){pv&&"__proto__"===e.name?pv(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},xv=function(t,e){if("__proto__"===e){if(!fv.call(t,e))return;if(mv)return mv(t,e).value}return t[e]},bv=function t(){var e,n,r,o,a,s,u=arguments[0],l=1,c=arguments.length,h=!1;for("boolean"==typeof u&&(h=u,u=arguments[1]||{},l=2),(null==u||"object"!==i(u)&&"function"!=typeof u)&&(u={});l<c;++l)if(null!=(e=arguments[l]))for(n in e)r=xv(u,n),u!==(o=xv(e,n))&&(h&&o&&(yv(o)||(a=gv(o)))?(a?(a=!1,s=r&&gv(r)?r:[]):s=r&&yv(r)?r:{},vv(u,{name:n,newValue:t(h,s,o)})):void 0!==o&&vv(u,{name:n,newValue:o}));return u};function wv(t,e,n){if(!t)return-1;var r=n.cache,i=t.origin?t.origin():null;i&&(t=i);var o=r.fields.indexOf(t),a=-1,s=-1;if(-1===o)for(var u=0;u<r.wrappedFields.length;u++)if(s=r.wrappedFields[u].attrDims.map((function(t){return t.instance})).indexOf(t),a=r.wrappedFields[u].attrExps.map((function(t){return t.instance})).indexOf(t),-1!==s||-1!==a){o=u;break}return(o-=e.qArea.qLeft)<0||o>=e.qArea.qWidth?-1:s>=0?function(t){return t[o].qAttrDims.qValues[s]}:a>=0?function(t){return t[o].qAttrExps.qValues[a]}:function(t){return t[o]}}function Mv(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function kv(t){var e=t.cache,n=t.f,r=t.mainCell,i=t.p;t.prop;var o=t.page,a=t.rowIdx,s=t.row,u=t.sourceKey,l=t.target,c=t.targetProp,h=r;if(i.field&&i.field!==n){var f=wv(i.field,o,{cache:e});if(-1===f)return;h=bv({qRow:a},f(s))}l[c]=Mv(i,h,{key:u})}function _v(t,e,n,r){for(var i=Array.isArray(t)?t:[t],o=[],a=0;a<i.length;a++)if(void 0!==i[a].field){for(var s=e.raw(),u=e.key(),l="object"===tv(i[a].field)?i[a].field:e.field(i[a].field),c=r.normalizeConfig(i[a],e),h=c.props,f=c.main,d=Object.keys(h),p=!!i[a].trackBy,m=tv(i[a].trackBy),g={},y=[],v=[],x=0;x<s.qDataPages.length;x++){var b=wv(l,s.qDataPages[x],{cache:n});if(-1!==b)for(var w=0;w<s.qDataPages[x].qMatrix.length;w++){var M=s.qDataPages[x].qArea.qTop+w,k=bv({qRow:M},b(s.qDataPages[x].qMatrix[w])),_=Mv(f,k,{key:u});if(!(f.filter&&!f.filter(k))){for(var q=0;q<d.length;q++){var D=h[d[q]],S=D.fields||[D];D.fields&&(_[d[q]]=[]);for(var C=0;C<S.length;C++)kv({cache:n,f:l,mainCell:k,p:S[C],prop:d[q],props:h,page:s.qDataPages[x],rowIdx:M,row:s.qDataPages[x].qMatrix[w],sourceKey:u,target:D.fields?_[d[q]]:_,targetProp:D.fields?C:d[q]});if(D.fields){var E=_[d[q]].map((function(t){return t.value})),A=_[d[q]].map((function(t){return t.label}));_[d[q]]={value:"function"==typeof D.value?D.value(E):void 0!==D.value?D.value:E,label:"function"==typeof D.label?D.label(A):void 0!==D.label?String(D.label):String(_[d[q]].value)}}}p&&r.track({cfg:i[a],itemData:k,obj:_,target:y,tracker:g,trackType:m}),v.push(_)}}}p?o.push.apply(o,lv(r.collect(y,{main:f,propsArr:d,props:h}))):o.push.apply(o,v)}return o}function qv(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Dv(t,e){var n,r,i,o,a,s=new Av(t),u=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=Sv);n=l.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)l.push(r=n.children[o]=new Av(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(Ev)}function Sv(t){return t.children}function Cv(t){t.data=t.data.data}function Ev(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Av(t){this.data=t,this.depth=this.height=0,this.parent=null}function Nv(t){if("function"!=typeof t)throw new Error;return t}Av.prototype=Dv.prototype={constructor:Av,count:function(){return this.eachAfter(qv)},each:function(t){var e,n,r,i,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(t){for(var e,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Dv(this).eachBefore(Cv)}};var Ov={depth:-1},Iv={};function Tv(t){return t.id}function Rv(t){return t.parentId}function Pv(t,e){"/"===t.charAt(0)&&(t=t.substring(1));for(var n,r=t.split("/"),i=e,o=0;o<r.length;o++){if("*"===r[o]&&Array.isArray(i)){var a=[];n=r.slice(o+1).join("/");for(var s=0;s<i.length;s++){var u=Pv(n,i[s]);Array.isArray(u)?a.push.apply(a,lv(u)):a.push(u)}return a}if(!r[o]&&Array.isArray(i)){var l=new Array(i.length);n=r.slice(o+1).join("/");for(var c=0;c<i.length;c++)l[c]=Pv(n,i[c]);return l}r[o]in i&&(i=i[r[o]])}return i}function Fv(t,e,n){var r=[];if(!t||!t.length)return r;if(e<=0){var i=n>=0?[t[n]]:t;r.push.apply(r,lv(i))}else for(var o=0;o<t.length;o++)t[o].children&&t[o].children.length&&r.push.apply(r,lv(Fv(t[o].children,e-1,n)));return r}function Lv(t,e,n){if(t===e)return function(t){return t};if(t>e){var r=Math.max(0,Math.min(100,t-e));return function(t){for(var e=t,n=0;n<r;++n)e=e.parent;return e}}if(e>t){var i=Math.max(0,Math.min(100,e-t));return function(t){return Fv(t.children,i-1,n)}}return!1}function jv(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];var r=n.allFields;if("function"==typeof t){for(var i=0;i<r.length;i++)if(t(r[i]))return r[i];return!1}if("string"==typeof t){for(var o=0;o<r.length;o++)if(r[o].key()===t||r[o].title()===t)return r[o]}else if(t&&-1!==r.indexOf(t))return t;throw Error("Field not found: ".concat(t))}var zv=/^qDimensionInfo(?:\/(\d+))?/,Vv=/^\/?qMeasureInfo\/(\d+)/,Hv=/\/qAttrExprInfo\/(\d+)/,Bv=/\/qAttrDimInfo\/(\d+)/;function Wv(t){return(t.qColumnOrder&&t.qColumnOrder.length?t.qColumnOrder:t.qDimensionInfo.map((function(t,e){return e}))).filter((function(e){return e<t.qDimensionInfo.length}))}function Uv(t,e){var n=e.cube;if(!t)return-1;var r=t.origin&&t.origin()?t.origin().key():t.key(),i=!1,o=-1,a=-1,s=-1,u=-1,l=-1,c=r,h=n.qEffectiveInterColumnSortOrder,f=Wv(n);return zv.test(c)&&(i=!0,o=+zv.exec(c)[1],c=r.replace(zv,"")),Vv.test(c)&&("K"===n.qMode?u=+Vv.exec(c)[1]:h&&-1!==h.indexOf(-1)?(u=+Vv.exec(c)[1],l=0):l=+Vv.exec(c)[1],c=c.replace(Vv,"")),c&&(Bv.exec(c)?s=+Bv.exec(c)[1]:Hv.exec(c)&&(a=+Hv.exec(c)[1])),{fieldDepth:(i?"S"===n.qMode?f[o]:h?h.indexOf(o):o:h&&-1!==h.indexOf(-1)?h.indexOf(-1):n.qDimensionInfo.length-("K"===n.qMode?0:1))+1,pseudoMeasureIndex:u,measureIdx:l,attrDimIdx:s,attrIdx:a}}function Yv(t,e){var n,r,i=Lv(t.fieldDepth,e.fieldDepth,e.pseudoMeasureIndex);return n=e.measureIdx>=0?function(t){return t.data.qValues[e.measureIdx]}:function(t){return t.data},e.attrDimIdx>=0?r=function(t){var n;return null==t||null===(n=t.qAttrDims)||void 0===n?void 0:n.qValues[e.attrDimIdx]}:e.attrIdx>=0&&(r=function(t){var n;return null==t||null===(n=t.qAttrExps)||void 0===n?void 0:n.qValues[e.attrIdx]}),{nodeFn:i,attrFn:r,valueFn:n}}function $v(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function Xv(t){for(var e=t.propsArr,n=t.props,r=t.item,i=t.itemData,o=t.ret,a=t.sourceKey,s=0;s<e.length;s++){var u=n[e[s]],l=u.fields||[u],c=void 0,h=void 0;u.fields&&(c=[],h=[]);for(var f=function(t){var n=l[t],f=void 0,d=void 0,p=void 0,m=void 0,g=void 0,y=void 0;if("primitive"===n.type?(p=n.value,y=String(n.value)):("function"==typeof n.value&&(f=function(t){return n.value(t,r)}),"function"==typeof n.label&&(d=function(t){return n.label(t,r)}),n.accessor?(m=n.accessor(r),Array.isArray(m)?(g=m.map(n.valueAccessor),n.attrAccessor&&(g=g.map(n.attrAccessor)),f&&(p=g.map(f),f=null),d&&(y=g.map(d),d=null),p=n.reduce?n.reduce(p):p,y=n.reduceLabel?n.reduceLabel(y,p):String(p)):y=p=n.attrAccessor?n.attrAccessor(n.valueAccessor(m)):n.valueAccessor(m)):(p=i,y=i)),u.fields){var v=f?f(p):p;c.push(v),h.push(d&&null!=y?d(y):null!=y?y:String(v))}else{var x=f?f(p):p;o[e[s]]={value:x,label:d?d(y):null!=y?y:String(x)},n.field&&(o[e[s]].source={field:n.field.key(),key:a})}},d=0;d<l.length;d++)f(d);c&&(o[e[s]]={value:"function"==typeof u.value?u.value(c,r):c,label:"function"==typeof u.label?u.label(h,r):h})}}var Gv=function(t,e,n){var r="K"===t.qMode?"/qStackedDataPages/*/qData":"/qTreeDataPages/*",i="K"===t.qMode?"qSubNodes":"qNodes",o=Pv(r,t);return o&&o[0]?(e.tree=Dv(o[0],n.children||function(t){return t[i]}),e.tree):null};function Kv(t){for(var e=t.raw().qDataPages.length?t.raw().qDataPages[0].qMatrix:[],n=function(t){var e=t.raw().qColumnOrder,n=t.fields();return e&&e.length===n.length?e:n.map((function(t,e){return e}))}(t),r=t.fields(),i=t.fields().filter((function(t){return"dimension"===t.type()})).map((function(t){return n.indexOf(r.indexOf(t))})),o=t.fields().filter((function(t){return"measure"===t.type()})).map((function(t){return n.indexOf(r.indexOf(t))})),a={__root:{__id:"__root",qValues:[]}},s=0;s<e.length;s++){for(var u=e[s],l="__root",c=!1,h=0;h<i.length;h++){var f=u[i[h]],d="".concat(l,"__").concat(f.qText);a[d]||(a[d]=Qy({__id:d,__parent:l,qValues:[]},f),c=!0),l=d}if(c)for(var p=0;p<o.length;p++){var m=u[o[p]];a[l].qValues.push(m)}}var g=Object.keys(a).map((function(t){return a[t]})),y=function(){var t=Tv,e=Rv;function n(n){var r,i,o,a,s,u,l,c=n.length,h=new Array(c),f={};for(i=0;i<c;++i)r=n[i],s=h[i]=new Av(r),null!=(u=t(r,i,n))&&(u+="")&&(f[l="$"+(s.id=u)]=l in f?Iv:s);for(i=0;i<c;++i)if(s=h[i],null!=(u=e(n[i],i,n))&&(u+="")){if(!(a=f["$"+u]))throw new Error("missing: "+u);if(a===Iv)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=Ov,o.eachBefore((function(t){t.depth=t.parent.depth+1,--c})).eachBefore(Ev),o.parent=null,c>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=Nv(e),n):t},n.parentId=function(t){return arguments.length?(e=Nv(t),n):e},n}().id((function(t){return t.__id})).parentId((function(t){return t.__parent}))(g);return y}var Jv=function(t){for(var e=t.propsArr,n=t.props,r=t.cube,i=t.cache,o=t.itemDepthObject,a=t.f,s=0;s<e.length;s++)for(var u=n[e[s]],l=u.fields?u.fields:[u],c=0;c<l.length;c++){var h=l[c];if(h.field!==a){var f=Yv(o,Uv(h.field,{cube:r,cache:i}));h.accessor=f.nodeFn,h.valueAccessor=f.valueFn,h.attrAccessor=f.attrFn}}};function Zv(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=e.raw(),o=e.key(),a="S"===i.qMode?Kv(e):Gv(i,n,t);if(!a)return null;for(var s=a.height,u=[],l=0;l<=s;l++){var c=null;if(l>0)if("S"===i.qMode){var h=Wv(i),f=h[l-1];c=n.fields[f]}else{var d=i.qEffectiveInterColumnSortOrder[l-1];l>i.qEffectiveInterColumnSortOrder.length&&(d=i.qDimensionInfo.length),c=n.fields[d]}var p=r.normalizeConfig(Qy(Qy({},t),{},{field:c?c.key():void 0}),e),m=p.props,g=p.main,y=Object.keys(m);u[l]={propsArr:y,props:m,main:g};var v=c?Uv(c,{cube:i,cache:n}):{fieldDepth:0};Jv({propsArr:y,props:m,cube:i,cache:n,itemDepthObject:v,f:c})}for(var x=a.copy(),b=x.descendants(),w=a.descendants(),M=0;M<w.length;M++){var k=u[w[M].depth].propsArr,_=u[w[M].depth].props,q=u[w[M].depth].main,D=b[M],S=D.data,C=$v(q,S,{key:o});Xv({propsArr:k,props:_,item:D,itemData:S,ret:C,sourceKey:o,isTree:!0}),w[M].data=C}return a}function Qv(t,e,n,r){for(var i=Array.isArray(t)?t:[t],o=[],a=0;a<i.length;a++)if(void 0!==i[a].field){var s=e.raw(),u=e.key();if(!Gv(s,n,t))continue;var l="object"===tv(i[a].field)?i[a].field:e.field(i[a].field),c=r.normalizeConfig(i[a],e),h=c.props,f=c.main,d=Object.keys(h),p=Uv(l,{cube:s,cache:n}),m=Yv({fieldDepth:0},p),g=m.nodeFn,y=m.attrFn,v=m.valueFn;Jv({propsArr:d,props:h,cube:s,cache:n,itemDepthObject:p,f:l});for(var x=!!i[a].trackBy,b=tv(i[a].trackBy),w={},M=[],k=g(n.tree),_=[],q=0;q<k.length;q++){var D=k[q],S=y?y(v(D)):v(D);if(!(f.filter&&!f.filter(S))){var C=$v(f,S,{key:u});Xv({propsArr:d,props:h,item:D,itemData:S,ret:C,sourceKey:u}),x&&r.track({cfg:i[a],itemData:S,obj:C,target:M,tracker:w,trackType:b}),_.push(C)}}x?o.push.apply(o,lv(r.collect(M,{main:f,propsArr:d,props:h}))):o.push.apply(o,_)}return o}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var tx=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){
/*! javascript-number-formatter - v1.1.11 - http://mottie.github.com/javascript-number-formatter/ *  ecava */
t.exports=function(t,e){if(!t||isNaN(+e))return e;var n,r,i,o,a,s,u,l,c,h,f=t.length,d=t.search(/[0-9\-\+#]/),p=d>0?t.substring(0,d):"",m=t.split("").reverse().join(""),g=m.search(/[0-9\-\+#]/),y=f-g,v=t.substring(y,y+1),x=y+("."===v||","===v?1:0),b=g>0?t.substring(x,f):"";if(n=(e="-"===(t=t.substring(d,x)).charAt(0)?-e:+e)<0?e=-e:0,i=(r=t.match(/[^\d\-\+#]/g))&&r[r.length-1]||".",o=r&&r[1]&&r[0]||",",t=t.split(i),e=+(e=e.toFixed(t[1]&&t[1].length))+"",s=t[1]&&t[1].lastIndexOf("0"),(!(l=e.split("."))[1]||l[1]&&l[1].length<=s)&&(e=(+e).toFixed(s+1)),c=t[0].split(o),t[0]=c.join(""),(a=t[0]&&t[0].indexOf("0"))>-1)for(;l[0].length<t[0].length-a;)l[0]="0"+l[0];else 0==+l[0]&&(l[0]="");if((e=e.split("."))[0]=l[0],u=c[1]&&c[c.length-1].length){for(m="",y=(h=e[0]).length%u,f=h.length,x=0;x<f;x++)m+=h.charAt(x),!((x-y+1)%u)&&x<f-u&&(m+=o);e[0]=m}return e[1]=t[1]&&e[1]?i+e[1]:"","0"!==(r=e.join(""))&&""!==r||(n=!1),p+(n?"-":"")+r+b}}));function ex(t){return t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}var nx={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},rx=/%$/,ix=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,ox=/^\(oct\)/i,ax=/^\(dec\)/i,sx=/^\(hex\)/i,ux=/^\(bin\)/i,lx=/^\(rom\)/i,cx=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i,hx=/#|0/g;function fx(t,e,n,r){return t=t.toString(e),n[1]===n[1].toUpperCase()&&(t=t.toUpperCase()),t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11)),t.replace(".",r||".")}function dx(t,e,n){var r;return ix.test(e)?t=fx(t,Number(/\d{2}/.exec(e)[0]),e,n):ox.test(e)?t=fx(t,8,e,n):ax.test(e)?t=fx(t,10,e,n):sx.test(e)?t=fx(t,16,e,n):ux.test(e)?t=fx(t,2,e,n):lx.test(e)&&(r="",t<0&&(r="-",t=-t),0===(t=Math.floor(t))?t="0":t<=5e5?(t=function(t,e){for(var n,r="",i=Number(String(t).slice(-3)),o=(t-i)/1e3,a=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),s=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();i>0;)for(n=0;n<a.length;n++)if(a[n]<=i){r+=s[n],i-=a[n];break}for(n=0;n<o;n++)r="M".concat(r);return e[1]!==e[1].toUpperCase()&&(r=r.toLowerCase()),r}(t,e),t=r+t):t=e+r+t.toExponential(0)),t}function px(t,e,n){var r=ex(t);return n?r:new RegExp(r||"",e)}function mx(t,e,n,r){var i,o,a,s,u,l,c,h,f,d,p,m=t.pattern;r&&(t.abbreviate=!0),d=e,(p=n)&&(p=ex(p)),d&&(d=ex(d)),f=new RegExp("(?:[#0]+".concat(d,")?[#0]+(?:").concat(p,"[#0]+)?")),s=(a=(a=m.match(f))?a[0]:"")?m.substr(0,m.indexOf(a)):m,u=a?m.substring(m.indexOf(a)+a.length):"",a||(a=m?"#":"##########"),e&&e===n&&(o=(i=a.split(n)).pop(),a=i.join("")+n+o,e=""),l=e,e=/,/.test(n)?"":",",l&&(a=a.replace(px(l,"g"),e)),c=n,n=".",c&&(a=a.replace(px(c,"g"),n)),h=(h=a.match(/#/g))?h.length:0;var g,y=m.split(c);y[1]&&(g=y[1].match(hx)),t.prefix=s||"",t.postfix=u||"",t.pattern=m,t.maxPrecision=g?g.length:2,t.percentage=rx.test(m),t.numericPattern=a||"",t.numericRegex=new RegExp("".concat(px(e,null,!0),"|").concat(px(n,null,!0)),"g"),t.groupTemp=l,t.decTemp=c,t.t=e,t.d=n,t.temp=h}var gx=function(){function t(e,n,r,i,o){ev(this,t),this.localeInfo=e,this.pattern=n,this.thousandDelimiter=r||",",this.decimalDelimiter=i||".",this.type=o||"numeric",this.patternSeparator=";",this.abbreviations=function(t,e){if(!t||!t.qNumericalAbbreviation)return nx;var n={};return t.qNumericalAbbreviation.split(e).forEach((function(t){var e=t.split(":");2===e.length&&(n[e[0]]=e[1])})),n}(e,this.patternSeparator),this.prepare()}return rv(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e,n,r){return this.prepare(e,n,r),this.formatValue(t)}},{key:"prepare",value:function(t,e,n){var r;if(void 0===t&&(t=this.pattern),void 0===e&&(e=this.thousandDelimiter),void 0===n&&(n=this.decimalDelimiter),t){this._prepared={positive:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},zero:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}},r=this._prepared,t=t.split(this.patternSeparator),r.positive.pattern=t[0],r.negative.pattern=t[1],r.zero.pattern=t[2],cx.test(t[0])&&(r.positive.isFunctional=!0),t[1]?cx.test(t[1])&&(r.negative.isFunctional=!0):r.negative=!1,t[2]?cx.test(t[2])&&(r.zero.isFunctional=!0):r.zero=!1;var i="U"===this.type;r.positive.isFunctional||mx(r.positive,e,n,i),r.negative&&!r.negative.isFunctional&&mx(r.negative,e,n,i),r.zero&&!r.zero.isFunctional&&mx(r.zero,e,n,i)}else this._prepared={pattern:!1}}},{key:"formatValue",value:function(t){var e,n,r,i,o,a,s,u,l,c=this._prepared,h="",f="",d=t;if(isNaN(t))return"".concat(d);if(t=+t,!1===c.pattern)return t.toString();if(0===t&&c.zero)return(c=c.zero).pattern;if(t<0&&c.negative?(c=c.negative,t=-t):c=c.positive,o=c.d,a=c.t,c.isFunctional)t=dx(t,c.pattern,o);else{if(c.percentage&&(t*=100),c.abbreviate){var p,m,g=Object.keys(this.abbreviations).map((function(t){return parseInt(t,10)})).sort((function(t,e){return t-e})),y=g[0];for(s=0,n=Number(Number(t).toExponential().split("e")[1]);y<=n&&s<g.length;)y=g[++s];s>0&&(p=g[s-1]),p&&n>0&&p>0?m=p:(n<0&&p<0||!p)&&(y<0&&y-n<=c.maxPrecision?m=y:p<=n&&!(y>0&&-n<=c.maxPrecision)&&(m=p)),m&&(h=this.abbreviations[m],t/=Math.pow(10,m))}if(r=Math.abs(t),e=c.temp,l=(u=c.numericPattern).split(o)[1],"I"===this.type&&(t=Math.round(t)),i=t,l||"#"!==u.slice(-1)[0])if(r>=1e15||r>0&&r<=1e-14)t=r?r.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var v=Number(t.toFixed(Math.min(20,l?l.length:0)).split(".")[0]),x=u.split(o)[0];if(t=tx(x+=o,v)||"0",l){var b=Math.max(0,Math.min(14,l.length)),w=l.replace(/#+$/,"").length,M=("I"===this.type?0:r%1).toFixed(b).slice(2).replace(/0+$/,"");for(s=M.length;s<w;s++)M+="0";M&&(t+=o+M)}else 0===v&&(i=0)}else if(r>=Math.pow(10,e)||r<1||r<1e-4)0===t?t="0":r<1e-4||r>=1e20?(t=(t=i.toExponential(Math.max(1,Math.min(14,e))-1)).replace(/\.?0+(?=e)/,""),f=""):(t=t.toPrecision(Math.max(1,Math.min(14,e)))).indexOf(".")>=0&&(t=(t=t.replace(t.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"")).replace(".",o));else{for(u+=o,e=Math.max(0,Math.min(20,e-Math.ceil(Math.log(r)/Math.log(10)))),s=0;s<e;s++)u+="#";t=tx(u,t)}t=t.replace(c.numericRegex,(function(t){return t===a?c.groupTemp:t===o?c.decTemp:""})),i<0&&!/^-/.test(t)&&(t="-".concat(t))}return c.prefix+t+f+h+c.postfix}}],[{key:"getStaticFormatter",value:function(){return{prepare:function(){},formatValue:function(t){return"".concat(t)}}}}]),t}();function yx(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.size,o=void 0===i?5e3:i,a=r.multipleArguments,s=void 0!==a&&a,u=r.toKey,l=void 0===u?function(t){return t}:u,c=Object.create(null),h=Object.create(null),f=0,d=0;return e=s?function(){return n=l.apply(void 0,arguments),e.has(n)?e.get(n):e.set(n,t.apply(void 0,arguments))}:function(r){return n=l(r),e.has(n)?e.get(n):e.set(n,t(r))},e.set=function(t,e){return f>=o&&(delete c[h[d]],delete h[d],f--,d++),c[t]=e,h[f]=t,f++,e},e.get=function(t){return c[t]},e.has=function(t){return t in c},e.clear=function(){c=Object.create(null),h=Object.create(null),f=0,d=0},e.size=function(){return f},e}function vx(t,e,n,r,i){var o=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return sv(gx,e)}(i,t,e,n,r),a=yx(o.formatValue.bind(o),{toKey:function(t){return isNaN(t)?t:+t}});function s(t){return a(t)}return s.format=function(t,e,n,r){return a.clear(),o.format(e,t,n,r)},s.pattern=function(t){return t&&(a.clear(),o.pattern=t,o.prepare()),o.pattern},s}var xx="D",bx="T",wx="TS",Mx="IV",kx=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],_x=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],qx=["January","February","March","April","May","June","July","August","September","October","November","December"],Dx=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Sx(t,e){for(var n=t.length;n<e;n++)t="0".concat(t);return t}function Cx(t){var e=t.toString().split(".");return e[1]?e=Number("0.".concat(e[1])):0}function Ex(t,e){var n,r=function(t){var e=t,n=24*Cx(e),r=60*Cx(n),i=60*Cx(r),o=1e3*Cx(i);return{d:Math.floor(e),h:Math.floor(n),m:Math.floor(r),s:Math.floor(i),f:Math.round(o)}}(t),i=r.d,o=r.h,a=r.m,s=r.s,u=r.f,l=0;/w+|t+/gi.test(e)&&(n=new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,Math.round(86400*(t-Math.floor(t))))),isNaN(n.getTime())&&(n=null)),/D+/gi.test(e)||(o+=24*i),/h+/gi.test(e)||(a+=60*o),/m+/gi.test(e)||(s+=60*a),/w+/gi.test(e)&&(l=n?n.getDay()-1:0)<0&&(l=6);var c="";return n&&(c=n.getUTCHours()>=12?"pm":"am"),{year:0,month:0,day:l,date:i,h:o,m:a,s:s,f:u,t:c}}var Ax=function(){function t(e,n,r){ev(this,t);var i,o=e||{};(o.qCalendarStrings||(o.qCalendarStrings={qLongDayNames:kx,qDayNames:_x,qLongMonthNames:qx,qMonthNames:Dx}),this.localeInfo=o,this.locale_days=o.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=o.qCalendarStrings.qDayNames.slice(),this.locale_months=o.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=o.qCalendarStrings.qMonthNames.slice(),n)||(n=(iv(i={},bx,o.qTimeFmt||"hh:mm:ss"),iv(i,xx,o.qDateFmt||"YYYY-MM-DD"),iv(i,wx,o.qTimestampFmt||"YYYY-MM-DD hh:mm:ss"),i)[r]);this.pattern=n}return rv(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e){e||(e=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),e=e.replace(/\[.+]|\[|]/g,"");var n,r=/t+/gi.test(e);t instanceof Date?n=function(t,e){var n=t.getUTCHours(),r=t.getUTCDay()-1;return e&&((n%=12)||(n=12)),r<0&&(r=6),{year:t.getUTCFullYear(),month:t.getUTCMonth(),day:r,date:t.getUTCDate(),h:n,m:t.getUTCMinutes(),s:t.getUTCSeconds(),f:t.getUTCMilliseconds(),t:t.getUTCHours()>=12?"pm":"am"}}(t,r):(t<0&&(t=-t,e="-".concat(e)),n=Ex(t,e));var i=function(t,e){return{"Y+|y+":{Y:"".concat(Number("".concat(e.year).slice(-2))),YY:Sx("".concat(e.year).slice(-2),2),YYY:Sx("".concat(e.year).slice(-3),3),def:function(t){return Sx("".concat(e.year),t.length)}},"M+":{M:e.month+1,MM:Sx("".concat(e.month+1),2),MMM:t.locale_months_abbr[e.month],def:t.locale_months[e.month]},"W+|w+":{W:e.day,WW:Sx("".concat(e.day),2),WWW:t.locale_days_abbr[e.day],def:t.locale_days[e.day]},"D+|d+":{D:e.date,def:function(t){return Sx("".concat(e.date),t.length)}},"h+|H+":{h:e.h,def:function(t){return Sx("".concat(e.h),t.length)}},"m+":{m:e.m,def:function(t){return Sx("".concat(e.m),t.length)}},"s+|S+":{s:e.s,def:function(t){return Sx("".concat(e.s),t.length)}},"f+|F+":{def:function(t){var n="".concat(e.f),r=t.length-n.length;if(r>0)for(var i=0;i<r;i++)n+="0";else r<0&&(n=n.slice(0,t.length));return n}},"t{1,2}|T{1,2}":{def:function(t){var n=e.t;return t[0].toUpperCase()===t[0]&&(n=n.toUpperCase()),n.slice(0,t.length)}}}}(this,n),o=[];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&o.push(a);var s=new RegExp(o.join("|"),"g"),u=e.replace(s,(function(t){var e,n,r;for(n in i)if(Object.prototype.hasOwnProperty.call(i,n)&&(e=new RegExp(n)).test(t))break;if(!e)return"";for(var o in i[n])if(o===t||o.toLowerCase()===t){void 0===(r=i[n][o])&&(r=i[n][o.toLowerCase()]);break}return void 0===r&&(r=i[n].def),"function"==typeof r&&(r=r(t)),r}));return u}}]),t}();function Nx(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return sv(Ax,e)}function Ox(t){return new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,0,Math.round(864e5*(t-Math.floor(t)))))}function Ix(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TS",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=Nx(n,t,e),i=yx(r.format.bind(r),{toKey:function(t){return"object"===tv(t)&&"function"==typeof t.getTime?t.getTime():t}});function o(t){return e!==Mx?Ox(t):t}function a(t){return t=o(t),i(t)}return a.format=function(t,e){return i.clear(),e=o(e),r.format(e,t)},a.locale=function(n){return r=Nx(n,t,e),i=yx(r.format.bind(r),{toKey:function(t){return"object"===tv(t)?t.getTime():t}}),this},a.qtype=function(t){return void 0!==t&&(e=t,i.clear()),e},a}function Tx(t,e){if(t&&t.qNumFormat&&-1!==["D","T","TS","IV"].indexOf(t.qNumFormat.qType))return Ix(t.qNumFormat.qFmt,t.qNumFormat.qType,e);var n="#",r=e&&void 0!==e.qThousandSep?e.qThousandSep:",",i=e&&void 0!==e.qDecimalSep?e.qDecimalSep:".",o="U",a=t&&!!t.qIsAutoFormat;return t&&t.qNumFormat?(n=t.qNumFormat.qFmt||n,r=t.qNumFormat.qThou||r,i=t.qNumFormat.qDec||i,o=t.qNumFormat.qType||o,a=a&&-1===["M"].indexOf(t.qNumFormat.qType)):a=!0,(a||"U"===o)&&(n="#".concat(i,"##"),o="U"),vx(n,r,i,o,e)}function Rx(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.meta,r=e.id,i=e.key,o=e.localeInfo,a=e.fieldExtractor,s=e.value,u=e.type,l=e.sourceField,c=s||("dimension"===u?function(t){return t.qElemNo}:function(t){return t.qValue}),h=function(t){return t.qText||""},f="dimension"===u?"first":"avg",d=Tx(n,o),p="dimension"===u?"first":function(t,e){return d(e)},m={id:function(){return r},key:function(){return i},raw:function(){return n},title:function(){return n.qFallbackTitle||n.label},type:function(){return u},origin:function(){return l},items:function(){return t||(t=a(m)),t},min:function(){return n.qMin},max:function(){return n.qMax},value:c,label:h,reduce:f,reduceLabel:p,formatter:function(){return d},tags:function(){return n.qTags}};return m}function Px(t,e,n,r,i){return(e[t]||[]).map((function(e,o){var a="".concat(r?"".concat(r,"/"):"").concat(t,"/").concat(o),s={instance:Rx(bv({id:"".concat(n?"".concat(n,"/"):"").concat(a),key:a,meta:e},i))};return s.attrDims=Px("qAttrDimInfo",e,n,a,bv({},i,{value:function(t){return t.qElemNo},type:"dimension"})),s.attrExps=Px("qAttrExprInfo",e,n,a,bv({},i,{value:function(t){return t.qNum},type:"measure"})),s.measures=Px("qMeasureInfo",e,n,a,bv({},i,{value:function(t){return t.qValue},type:"measure"})),s}))}function Fx(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.key,o=r.data,a=r.config,s=void 0===a?{}:a,u={fields:[],wrappedFields:[],allFields:[],virtualFields:[]},l=o;if(!l)throw new Error('Missing "data" input');if(!l.qDimensionInfo)throw new Error('The "data" input is not recognized as a hypercube');var c=Fx.util,h={cache:u,cube:l,localeInfo:s.localeInfo,fieldExtractor:null,pages:null,hierarchy:function(){return null},virtualFields:s.virtualFields},f={key:function(){return i},raw:function(){return l},field:function(t){return jv(t,h)},fields:function(){return u.fields.slice()},extract:function(t){return h.extractor(t,f,u,c)},hierarchy:function(t){return h.hierarchy(t,f,u,c)},_cache:function(){return u}};"K"===l.qMode||"T"===l.qMode||!l.qMode&&l.qNodesOnDim?(h.extractor=Qv,h.hierarchy=Zv,h.pages="K"===l.qMode?l.qStackedDataPages:l.qTreeDataPages):"S"===l.qMode?(h.extractor=_v,h.pages=l.qDataPages,h.hierarchy=Zv):h.extractor=function(){return[]},h.fieldExtractor=function(t){return h.extractor({field:t},f,u,c)};var d="S"===l.qMode?function(t){return t.qElemNumber}:void 0,p="S"===l.qMode?function(t){return t.qNum}:void 0;(t=u.wrappedFields).push.apply(t,lv(Px("qDimensionInfo",l,i,"",bv({},h,{value:d,type:"dimension"})))),(e=u.wrappedFields).push.apply(e,lv(Px("qMeasureInfo",l,i,"",bv({},h,{value:p,type:"measure"})))),u.fields=u.wrappedFields.map((function(t){return t.instance}));var m=function t(e){e.forEach((function(e){u.allFields.push(e.instance),t(e.measures),t(e.attrDims),t(e.attrExps)}))};return m(u.wrappedFields),(s.virtualFields||[]).forEach((function(t){var e=f.field(t.from),n=Rx(Qy({meta:e.raw(),id:"".concat(i,"/").concat(t.key),sourceField:e,fieldExtractor:function(t){return h.extractor({field:t},f,u,c)},key:t.key,type:e.type(),localeInfo:h.localeInfo,value:e.value},t.override||{}));u.virtualFields.push(n)})),(n=u.allFields).push.apply(n,lv(u.virtualFields)),f}var Lx=[["qHyperCube","qHyperCubeDef"],["qTreeData","qTreeDataDef"],["qDimensionInfo","qDimensions"],["qMeasureInfo","qMeasures"],["qAttrDimInfo","qAttributeDimensions"],["qAttrExprInfo","qAttributeExpressions"]],jx=/\/qDimensionInfo(?:\/(\d+))?/,zx=/\/qMeasureInfo\/(\d+)/,Vx=/\/qAttrDimInfo\/(\d+)(?:\/(\d+))?/,Hx=/\/qAttrExprInfo\/(\d+)/,Bx=/\/?qHyperCube/,Wx=/\/?qTreeData/,Ux=function(t){return"".concat(t.substr(0,t.indexOf("/qHyperCubeDef")+14))},Yx=function(t){return"".concat(t.substr(0,t.indexOf("/qTreeDataDef")+13))};function $x(t,e){var n=t,r=-1,i=-1,o="",a=function(t){return t};Bx.test(t)?(o="".concat(n.substr(0,n.indexOf("qHyperCube")+10)),a=Ux):Wx.test(t)&&(o="".concat(n.substr(0,n.indexOf("qTreeData")+9)),a=Yx);var s=!0;if(jx.test(t)&&(r=+jx.exec(t)[1]),zx.test(t)&&(i=+zx.exec(t)[1]),Vx.test(t)){i=-1,r=0;var u=+Vx.exec(n)[2];isNaN(u)||(r=u,n=n.replace(/\/\d+$/,"")),s=!1}if(Hx.test(t)){var l=i;if(e){i=0;var c=Pv(o,e);i+=(c.qMeasureInfo||[]).length,r>-1?(i=c.qDimensionInfo.slice(0,r).reduce((function(t,e){return t+e.qAttrExprInfo.length}),i),r=-1):(i=c.qDimensionInfo.reduce((function(t,e){return t+e.qAttrExprInfo.length}),i),i=c.qMeasureInfo.slice(0,l).reduce((function(t,e){return t+e.qAttrExprInfo.length}),i)),i+=+Hx.exec(n)[1]}else r>-1?(r=-1,i=+Hx.exec(n)[1]):i+=+Hx.exec(n)[1]+1}return Lx.forEach((function(t){var e=uv(t,2),r=e[0],i=e[1];n=n.replace(r,i)})),s&&(n=a(n)),n&&"/"!==n[0]&&(n="/".concat(n)),{measureIdx:i,dimensionIdx:r,path:n}}function Xx(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=n.byCells,o=n.primarySource,a=[],s={},u=t.isActive(),l=!1;if(t.brushes().forEach((function(t){var e=$x(t.id,r);if("range"===t.type&&e.measureIdx>-1&&e.dimensionIdx>-1){var n=t.brush.ranges();n.length&&(l=!0,s.multiRangeSelectTreeDataValues||(s.multiRangeSelectTreeDataValues={path:e.path,ranges:[]}),n.forEach((function(t){return s.multiRangeSelectTreeDataValues.ranges.push({qMeasureIx:e.measureIdx,qDimensionIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})})))}else{if("range"===t.type&&e.measureIdx>-1){var u=t.brush.ranges();u.length&&(l=!0,s.rangeSelectHyperCubeValues||(s.rangeSelectHyperCubeValues={path:e.path,ranges:[]}),u.forEach((function(t){return s.rangeSelectHyperCubeValues.ranges.push({qMeasureIx:e.measureIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})})))}if("range"===t.type&&e.dimensionIdx>-1){var c=t.brush.ranges();c.length&&(l=!0,s.selectHyperCubeContinuousRange||(s.selectHyperCubeContinuousRange={path:e.path,ranges:[]}),c.forEach((function(t){return s.selectHyperCubeContinuousRange.ranges.push({qDimIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!1}})})))}if("value"===t.type&&e.dimensionIdx>-1)if(i)if(r&&r.qHyperCube&&("P"===r.qHyperCube.qMode||"T"===r.qHyperCube.qMode||"K"===r.qHyperCube.qMode)){var h=r.qHyperCube,f=h.qNoOfLeftDims,d=h.qEffectiveInterColumnSortOrder.indexOf(e.dimensionIdx);if(s.selectPivotCells||(s.selectPivotCells={path:e.path,cells:[]}),t.id===o||!o){var p=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)}));(0===f||d>=f)&&f>-1?p.forEach((function(t){s.selectPivotCells.cells.push({qType:"T",qCol:t,qRow:d-f})})):p.forEach((function(t){s.selectPivotCells.cells.push({qType:"L",qCol:e.dimensionIdx,qRow:t})})),l=!!s.selectPivotCells.cells.length}}else s.selectHyperCubeCells||(s.selectHyperCubeCells={path:e.path,cols:[]}),s.selectHyperCubeCells.cols.push(e.dimensionIdx),t.id!==o&&(o||s.selectHyperCubeCells.values)||(s.selectHyperCubeCells.values=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)})),l=!!s.selectHyperCubeCells.values.length);else{var m=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)}));l=!!m.length,a.push({params:[e.path,e.dimensionIdx,m,!1],method:"selectHyperCubeValues"})}}})),!l&&u)return[{method:"resetMadeSelections",params:[]}];s.rangeSelectHyperCubeValues&&a.push({method:"rangeSelectHyperCubeValues",params:[s.rangeSelectHyperCubeValues.path,s.rangeSelectHyperCubeValues.ranges,[],null===(e=n.orMode)||void 0===e||e]});return s.selectHyperCubeContinuousRange&&a.push({method:"selectHyperCubeContinuousRange",params:[s.selectHyperCubeContinuousRange.path,s.selectHyperCubeContinuousRange.ranges]}),s.selectHyperCubeCells&&a.push({method:"selectHyperCubeCells",params:[s.selectHyperCubeCells.path,s.selectHyperCubeCells.values,s.selectHyperCubeCells.cols]}),s.selectPivotCells&&a.push({method:"selectPivotCells",params:[s.selectPivotCells.path,s.selectPivotCells.cells]}),s.multiRangeSelectTreeDataValues&&a.push({method:"multiRangeSelectTreeDataValues",params:[s.multiRangeSelectTreeDataValues.path,s.multiRangeSelectTreeDataValues.ranges]}),a}function Gx(t){Fx.util=t.data("matrix").util,t.data("q",Fx),t.formatter("q-number",vx),t.formatter("q-time",Ix)}Gx.qBrushHelper=Xx,Gx.selections=Xx;var Kx=function(t){var e=t.renderer,n=Jy({renderer:{prio:[e||"canvas"]}});return n.use(Gx),n.use(function(t){if("function"!=typeof t.interaction)return function(e){e.interaction("hammer",$e(t))};t.interaction("hammer",$e(Hammer))}(We)),{pic:n,picassoQ:Gx}},Jx=function(t){var e=t.qHyperCube.qDimensionInfo,n=e.reduce((function(t,n,r){return 1===e[r].qStateCounts.qSelected?t+1:t}),0);return n=Math.min(n,e.length-1)},Zx=function(t){var e=t.qHyperCube.qDimensionInfo,n=e.findIndex((function(t){return 0===t.qStateCounts.qSelected}));return-1===n?e.length-1:n},Qx=Object.prototype.hasOwnProperty,tb=Object.prototype.toString,eb=Object.defineProperty,nb=Object.getOwnPropertyDescriptor,rb=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===tb.call(t)},ib=function(t){if(!t||"[object Object]"!==tb.call(t))return!1;var e,n=Qx.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&Qx.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||Qx.call(t,e)},ob=function(t,e){eb&&"__proto__"===e.name?eb(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},ab=function(t,e){if("__proto__"===e){if(!Qx.call(t,e))return;if(nb)return nb(t,e).value}return t[e]},sb=function t(){var e,n,r,o,a,s,u=arguments[0],l=1,c=arguments.length,h=!1;for("boolean"==typeof u&&(h=u,u=arguments[1]||{},l=2),(null==u||"object"!==i(u)&&"function"!=typeof u)&&(u={});l<c;++l)if(null!=(e=arguments[l]))for(n in e)r=ab(u,n),u!==(o=ab(e,n))&&(h&&o&&(ib(o)||(a=rb(o)))?(a?(a=!1,s=r&&rb(r)?r:[]):s=r&&ib(r)?r:{},ob(u,{name:n,newValue:t(h,s,o)})):void 0!==o&&ob(u,{name:n,newValue:o}));return u};
/**
   * @preserve IntegraXor Web SCADA - JavaScript Number Formatter
   * http://www.integraxor.com/
   * author: KPL, KHL
   * (c)2011 ecava
   * Dual licensed under the MIT or GPL Version 2 licenses.
   */
function ub(t,e){if(!t||isNaN(+e))return e;var n=(e="-"==t.charAt(0)?-e:+e)<0?e=-e:0,r=t.match(/[^\d\-\+#]/g),i=r&&r[r.length-1]||".",o=r&&r[1]&&r[0]||",";t=t.split(i);e=e.toFixed(t[1]&&t[1].length),e="".concat(+e);var a=t[1]&&t[1].lastIndexOf("0"),s=e.split(".");(!s[1]||s[1]&&s[1].length<=a)&&(e=(+e).toFixed(a+1));var u=t[0].split(o);t[0]=u.join("");var l=t[0]&&t[0].indexOf("0");if(l>-1)for(;s[0].length<t[0].length-l;)s[0]="0".concat(s[0]);else 0==+s[0]&&(s[0]="");(e=e.split("."))[0]=s[0];var c=u[1]&&u[u.length-1].length;if(c){for(var h=e[0],f="",d=h.length%c,p=0,m=h.length;p<m;p++)f+=h.charAt(p),!((p-d+1)%c)&&p<m-c&&(f+=o);e[0]=f}return e[1]=t[1]&&e[1]?i+e[1]:"",(n?"-":"")+e[0]+e[1]}var lb=function(t){return t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")},cb={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},hb=/%$/,fb=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,db=/^\(oct\)/i,pb=/^\(dec\)/i,mb=/^\(hex\)/i,gb=/^\(bin\)/i,yb=/^\(rom\)/i,vb=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i;function xb(t,e,n,r){return t=t.toString(e),n[1]===n[1].toUpperCase()&&(t=t.toUpperCase()),t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11)),t.replace(".",r||".")}function bb(t,e,n){var r;return fb.test(e)?t=xb(t,Number(/\d{2}/.exec(e)[0]),e,n):db.test(e)?t=xb(t,8,e,n):pb.test(e)?t=xb(t,10,e,n):mb.test(e)?t=xb(t,16,e,n):gb.test(e)?t=xb(t,2,e,n):yb.test(e)&&(r="",t<0&&(r="-",t=-t),0===(t=Math.floor(t))?t="0":t<=5e5?(t=function(t,e){var n,r="",i=Number(String(t).slice(-3)),o=(t-i)/1e3,a=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),s=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();for(;i>0;)for(n=0;n<a.length;n++)if(a[n]<=i){r+=s[n],i-=a[n];break}for(n=0;n<o;n++)r="M".concat(r);e[1]!==e[1].toUpperCase()&&(r=r.toLowerCase());return r}(t,e),t=r+t):t=e+r+t.toExponential(0)),t}var wb=function(){function t(e,n,r,i,o){s(this,t),this.localeInfo=e,this.pattern=n,this.thousandDelimiter=r||",",this.decimalDelimiter=i||".",this.type=o||"numeric",this.abbreviations=function(t){if(!t||!t.qNumericalAbbreviation)return cb;var e={};return t.qNumericalAbbreviation.split(";").forEach((function(t){var n=t.split(":");2===n.length&&(e[n[0]]=n[1])})),e}(e),this.prepare()}return l(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e,n,r){return this.prepare(e,n,r),this.formatValue(t)}},{key:"prepare",value:function(t,e,n){if(void 0===t&&(t=this.pattern),void 0===e&&(e=this.thousandDelimiter),void 0===n&&(n=this.decimalDelimiter),t){this._prepared={positive:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}};var r=this._prepared;t=t.split(";"),r.positive.pattern=t[0],r.negative.pattern=t[1],vb.test(t[0])&&(r.positive.isFunctional=!0),t[1]?vb.test(t[1])&&(r.negative.isFunctional=!0):r.negative=!1,r.positive.isFunctional&&(!r.negative||r.negative&&r.negative.isFunctional)||(Mb(r.positive,e,n),r.negative&&Mb(r.negative,e,n))}else this._prepared={pattern:!1}}},{key:"formatValue",value:function(t){var e,n,r,i,o,a,s,u=this._prepared,l="",c="";if(Number.isNaN(+t))return t;if(!1===u.pattern)return t.toString();t<0&&u.negative?(u=u.negative,t=-t):u=u.positive;var h=u.d,f=u.t;if(u.isFunctional)t=bb(t,u.pattern,h);else{if(u.percentage&&(t*=100),u.abbreviate){var d,p,m=this.abbreviations,g=Object.keys(m).map((function(t){return parseInt(t,10)})).sort((function(t,e){return t>e?1:-1})),y=g[0];for(o=0,n=Number(Number(t).toExponential().split("e")[1]);y<=n&&o<g.length;)y=g[++o];o>0&&(d=g[o-1]),d&&n>0&&d>0?p=d:(n<0&&d<0||!d)&&(y<0&&y-n<=u.maxPrecision?p=y:d<=n&&!(y>0&&-n<=u.maxPrecision)&&(p=d)),p&&(l=m[p],t/=Math.pow(10,p))}if(r=Math.abs(t),e=u.temp,s=(a=u.numericPattern).split(h)[1],"I"===this.type&&(t=Math.round(t)),i=t,s||"#"!==a.slice(-1)[0])if(r>=1e15||r>0&&r<=1e-14)t=r?r.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var v=Number(t.toFixed(Math.min(20,s?s.length:0)).split(".")[0]),x=a.split(h)[0];if(t=ub(x+=h,v)||"0",s){var b=Math.max(0,Math.min(14,s.length)),w=s.replace(/#+$/,"").length,M=Number((r%1).toPrecision(b)).toFixed(b);for(o=(M=M.slice(2).replace(/0+$/,"")).length;o<w;o++)M+="0";M&&(t+=h+M)}else 0===v&&(i=0)}else if(r>=Math.pow(10,e)||r<1||r<1e-4)0===t?t="0":r<1e-4||r>=1e20?(t=(t=i.toExponential(Math.max(1,Math.min(14,e))-1)).replace(/\.?0+(?=e)/,""),c=""):(t=t.toPrecision(Math.max(1,Math.min(14,e)))).indexOf(".")>=0&&(t=(t=t.replace(t.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"")).replace(".",h));else{for(a+=h,e=Math.max(0,Math.min(20,e-Math.ceil(Math.log(r)/Math.log(10)))),o=0;o<e;o++)a+="#";t=ub(a,t)}t=t.replace(u.numericRegex,(function(t){return t===f?u.groupTemp:t===h?u.decTemp:""})),i<0&&!/^-/.test(t)&&(t="-".concat(t))}return u.prefix+t+c+l+u.postfix}}]),t}();function Mb(t,e,n){var r,i,o=t.pattern;o.indexOf("A")>=0&&(o=o.replace("A",""),t.abbreviate=!0);var a=function(t,e){e&&(e=lb(e));t&&(t=lb(t));return new RegExp("(?:[#0]+".concat(t,")?[#0]+(?:").concat(e,"[#0]+)?"))}(e,n),s=o.match(a),u=(s=s?s[0]:"")?o.substr(0,o.indexOf(s)):o,l=s?o.substring(o.indexOf(s)+s.length):"";s||(s=o?"#":"##########"),e&&e===n&&(i=(r=s.split(n)).pop(),s=r.join("")+n+i,e="");var c=e;e=/,/.test(n)?"":",",c&&(s=s.replace(kb(c,"g"),e));var h=n;n=".",h&&(s=s.replace(kb(h,"g"),n));var f=s.match(/#/g);f=f?f.length:0;var d,p=o.split(h);p[1]&&(d=p[1].match(/#|0/g)),t.prefix=u||"",t.postfix=l||"",t.pattern=o,t.maxPrecision=d?d.length:2,t.percentage=hb.test(o),t.numericPattern=s||"",t.numericRegex=new RegExp("".concat(kb(e,null,!0),"|").concat(kb(n,null,!0)),"g"),t.groupTemp=c,t.decTemp=h,t.t=e,t.d=n,t.temp=f}function kb(t,e,n){var r=lb(t);return n?r:new RegExp(r||"",e)}wb.getStaticFormatter=function(){return{prepare:function(){},formatValue:function(t){return"".concat(t)}}};var _b=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],qb=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Db=["January","February","March","April","May","June","July","August","September","October","November","December"],Sb=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Cb(t,e){for(var n=t.length;n<e;n++)t="0".concat(t);return t}function Eb(t){var e=t.toString().split(".");return e[1]?e=Number("0.".concat(e[1])):0}function Ab(t){var e=t,n=24*Eb(e),r=60*Eb(n),i=60*Eb(r),o=1e3*Eb(i);return{d:Math.floor(e),h:Math.floor(n),m:Math.floor(r),s:Math.floor(i),f:Math.round(o)}}var Nb=function(){function t(e,n){s(this,t);var r=e||{};r.qCalendarStrings||(r.qCalendarStrings={qLongDayNames:_b,qDayNames:qb,qLongMonthNames:Db,qMonthNames:Sb}),this.localeInfo=r,this.locale_days=r.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=r.qCalendarStrings.qDayNames.slice(),this.locale_months=r.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=r.qCalendarStrings.qMonthNames.slice(),this.pattern=n}return l(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e){e||(e=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),e=e.replace(/\[.+\]|\[|\]/g,"");var n,r=/t+/gi.test(e);t instanceof Date?n=function(t,e){var n=t.getHours(),r=t.getDay()-1;return e&&((n%=12)||(n=12)),r<0&&(r=6),{year:t.getFullYear(),month:t.getMonth(),day:r,date:t.getDate(),h:n,m:t.getMinutes(),s:t.getSeconds(),f:t.getMilliseconds(),t:t.getHours()>=12?"pm":"am"}}(t,r):(t<0&&(t=-t,e="-".concat(e)),n=function(t,e){var n,r=Ab(t),i=r.d,o=r.h,a=r.m,s=r.s,u=r.f,l=0;return/w+|t+/gi.test(e)&&(n=new Date(1899,11,30+Math.floor(t),0,0,86400*(t-Math.floor(t))),Number.isNaN(+n.getTime())&&(n=null)),/D+/gi.test(e)||(o+=24*i),/h+/gi.test(e)||(a+=60*o),/m+/gi.test(e)||(s+=60*a),/w+/gi.test(e)&&(l=n?n.getDay()-1:0)<0&&(l=6),{year:0,month:0,day:l,date:i,h:o,m:a,s:s,f:u,t:n?n.getHours()>=12?"pm":"am":""}}(t,e));var i=function(t,e){return{"Y+|y+":{Y:"".concat(Number("".concat(e.year).slice(-2))),YY:Cb("".concat(e.year).slice(-2),2),YYY:Cb("".concat(e.year).slice(-3),3),def:function(t){return Cb("".concat(e.year),t.length)}},"M+":{M:e.month+1,MM:Cb("".concat(e.month+1),2),MMM:t.locale_months_abbr[e.month],def:t.locale_months[e.month]},"W+|w+":{W:e.day,WW:Cb("".concat(e.day),2),WWW:t.locale_days_abbr[e.day],def:t.locale_days[e.day]},"D+|d+":{D:e.date,def:function(t){return Cb("".concat(e.date),t.length)}},"h+|H+":{h:e.h,def:function(t){return Cb("".concat(e.h),t.length)}},"m+":{m:e.m,def:function(t){return Cb("".concat(e.m),t.length)}},"s+|S+":{s:e.s,def:function(t){return Cb("".concat(e.s),t.length)}},"f+|F+":{def:function(t){var n="".concat(e.f),r=t.length-n.length;if(r>0)for(var i=0;i<r;i++)n+="0";else r<0&&(n=n.slice(0,t.length));return n}},"t{1,2}|T{1,2}":{def:function(t){var n=e.t;return t[0].toUpperCase()===t[0]&&(n=n.toUpperCase()),n.slice(0,t.length)}}}}(this,n),o=[];for(var a in i)o.push(a);var s=new RegExp(o.join("|"),"g"),u=e.replace(s,(function(t){var e,n,r;for(n in i)if((e=new RegExp(n)).test(t))break;if(!e)return"";for(var o in i[n])if(o===t||o.toLowerCase()===t){void 0===(r=i[n][o])&&(r=i[n][o.toLowerCase()]);break}return void 0===r&&(r=i[n].def),"function"==typeof r&&(r=r(t)),r}));return u}}]),t}();Nb.parseInterval=Ab;var Ob="U",Ib="I",Tb="R",Rb="F",Pb="M",Fb="D",Lb="T",jb="TS",zb="IV",Vb=function(){function t(e,n,r,i,o){s(this,t);var a=e||{};this.localeInfo=a,this.pattern=n||"",this.decimalDelimiter="string"==typeof i?i:"string"==typeof a.qDecimalSep?a.qDecimalSep:".",this.thousandDelimiter="string"==typeof r?r:"string"==typeof a.qThousandSep&&this.decimalDelimiter!==a.qThousandSep?a.qThousandSep:"",this.type=o||Ob,o===Ob&&(this.pattern="#".concat(this.decimalDelimiter,"##A")),this._numberFormatter=new wb(e),this._dateFormatter=new Nb(e),this.prepare()}return l(t,[{key:"clone",value:function(){return new t(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type)}},{key:"prepare",value:function(t,e,n){if(t||(t=this.pattern),!t)switch(this.type){case Ib:t="##############";break;case Tb:t=Array(void 0!==this.localeInfo.qnDec||11).join("#");break;case Rb:t="#".concat(this.localeInfo.qDecimalSep)||".".concat(Array(this.localeInfo.qnDec||4).join("#"));break;case Pb:t=this.localeInfo.qMoneyFmt,n||(n=this.localeInfo.qMoneyDecimalSep||"."),e||n===this.localeInfo.qMoneyThousandSep||(e=this.localeInfo.qMoneyThousandSep);break;case Fb:t=this.localeInfo.qDateFmt||"YYYY-MM-DD";break;case jb:t=this.localeInfo.qTimestampFmt||"YYYY-MM-DD hh:mm:ss";break;case Lb:case zb:t=this.localeInfo.qTimeFmt||"hh:mm:ss";break;default:t="##########"}this._numberFormatter.pattern=this.pattern,this._dateFormatter.pattern=this.pattern,this._numberFormatter.thousandDelimiter=this.thousandDelimiter,this._numberFormatter.decimalDelimiter=this.decimalDelimiter,this._numberFormatter.type=this.type,this._numberFormatter.prepare(t,e,n),this._prepared={pattern:t,t:e,d:n}}},{key:"formatValue",value:function(t,e){var n,r=this._prepared;if("NaN"===t||"number"==typeof t&&Number.isNaN(+t))return"-";if(Number.isNaN(+t)||"number"!=typeof t)return"".concat(t);switch(this.type){case Fb:case Lb:case jb:return n=new Date(1899,11,30+Math.floor(t),0,0,86400*(t-Math.floor(t))),Number.isNaN(+n.getTime())?this._numberFormatter.format(t,"0",r.t,r.d):this._dateFormatter.format(n,e||r.pattern);case zb:return this._dateFormatter.format(t,r.pattern);default:return this._numberFormatter.formatValue(t)}}},{key:"format",value:function(t,e,n,r){return"NaN"===t||"number"==typeof t&&Number.isNaN(+t)?"-":Number.isNaN(+t)||"number"!=typeof t?"".concat(t):(this.prepare(e,n,r),this.formatValue(t))}},{key:"createPatternFromRange",value:function(t,e,n){var r,i,o="",a=Number(Number(t).toExponential().split("e")[1]),s=Number(Number(e).toExponential().split("e")[1]),u=Math.min(Math.abs(a),Math.abs(s)),l=Math.abs(e-t),c=Number(Number(l/50).toExponential().split("e")[1]);if(i=Math.abs(c),0===l)return"0".concat(this.decimalDelimiter,"##").concat(n?"A":"");if(c>=0?i=n?Math.max(2,u-c):0:i-=(n?u-u%3:0)*(s<0?1:-1),this.thousandDelimiter?o+="#".concat(this.thousandDelimiter,"##0"):o+="0",i)for(o+=this.decimalDelimiter,r=0;r<i;r++)o+="#";return o+(n?"A":"")}}]),t}();Vb.getSignificantIntegers=function(t){return function(t){if(Number.isNaN(+t)||!Number.isFinite(+t))return 1;var e=Number(t).toExponential().split("e"),n=1;"+"===e[1][0]&&(n+=Number(e[1]));return n}(t)},Vb.getSignificantDecimals=function(t){return function(t){if(Number.isNaN(+t)||!Number.isFinite(+t))return 0;var e,n=Number(t).toExponential().split("e"),r=0;"-"===n[1][0]?(r=Math.abs(Number(n[1])),(n=n[0].split("."))[1]&&(r+=n[1].length)):(e=Number(n[1]),r=(n=n[0].split("."))[1]?n[1].length-e:0);return r}(t)};var Hb=function(){function t(e,n){s(this,t),this.localeInfo=e;var r=this.getFormattersForMeasures(n),i=sb(!0,[],r);if(i&&1===i.length&&n[0].isCustomFormatted)i=null;else{for(var o=0,a=0;a<i.length;a++)n[a].isCustomFormatted&&(i[a]=null,o++);o===i.length&&(i=null)}this.measureFormatters=i,this.combinedMeasuresFormatter=this.getFormatterFromFormatters(r)}return l(t,[{key:"createFormatter",value:function(){return new Vb(this.localeInfo)}},{key:"getLocaleInfo",value:function(){return this.localeInfo||{}}},{key:"getFormatters",value:function(){return this.measureFormatters||[]}},{key:"getMeasureFormatter",value:function(t){if(this.measureFormatters&&this.measureFormatters[t])return this.measureFormatters[t]}},{key:"getCombinedMeasuresFormatter",value:function(){return this.combinedMeasuresFormatter}},{key:"formatMeasure",value:function(t,e){var n=this.measureFormatters[e];return n?n.format(t):t}},{key:"getFormatterFromFormatters",value:function(t){var e,n,r,i,o,a=0,s=0,u=0,l=t?t.filter((function(t){return!!t.values&&!Number.isNaN(+t.values.range)})):[];return t&&t.length&&(t.forEach((function(t){return"U"===t.type||t.values&&Number.isNaN(+t.values.range)?s++:["D","T","TS","IV"].includes(t.type)?a=1:u=1,t.prepare(),t})),l.length&&(e=l.reduce((function(t,e){return Math.min(e.values.min,t)}),l[0].values.min),n=l.reduce((function(t,e){return Math.max(e.values.max,t)}),l[0].values.max),r=Math.abs(n-e)),a+u>1?(o=t.filter((function(t){return"datetime"!==t.type}))[0]||{},i=new Vb(this.localeInfo,o.pattern,o.thousandDelimiter,o.decimalDelimiter,"U"),Number.isNaN(+r)||(i.pattern=i.createPatternFromRange(e,n,!0))):a+u===1&&0===s?(o=t[0]||{},i=new Vb(this.localeInfo,o.pattern,o.thousandDelimiter,o.decimalDelimiter,o.type)):(o=(o=t.filter((function(t){return"U"!==t.type}))).length?o[0]:t[0]||{},i=new Vb(this.localeInfo,o.pattern,o.thousandDelimiter,o.decimalDelimiter,o.type),Number.isNaN(+r)||"U"!==o.type||(i.pattern=i.createPatternFromRange(e,n,!0))),i.prepare()),i||(i=new Vb(this.localeInfo,"0")),i}},{key:"getFormattersForMeasures",value:function(t,e){var n=[];return t&&t.length&&(n=(e?t.filter((function(t,n){return e.indexOf(n)>=0})):t).map((function(t){var e=function(t){return!!t.qIsAutoFormat&&["M","D","T","TS","IV"].indexOf(t.qNumFormat.qType)<0}(t),n=new Vb(this.localeInfo,t.qNumFormat.qFmt,t.qNumFormat.qThou,t.qNumFormat.qDec,e?"U":t.qNumFormat.qType),r=Math.abs(t.qMax-t.qMin),i=Number.isNaN(+r);return n.values={min:t.qMin,max:t.qMax,range:r},!i&&e&&(n.pattern=n.createPatternFromRange(t.qMin,t.qMax,!0)),n.prepare(),n}),this)),n}}]),t}(),Bb={FULL:{width:550,height:450},MEDIUM:{width:400,height:220},SMALL:{width:300,height:150},XSMALL:{width:150,height:75},SPARK:{width:0,height:0}};function Wb(t,e){if(t.snapshotData&&!e.freeResize)return{align:.5,preserveAspectRatio:!0,width:t.snapshotData.content.size.w,height:t.snapshotData.content.size.h}}function Ub(t,e){return{layoutModes:Bb,center:{minWidthRatio:0,minHeightRatio:0},logicalSize:Wb(t,e)}}var Yb=function(t){var e=t.layout,r=t.theme,i=t.env,o=t.picassoQ,a=t.selectionsApi,s=t.showLegend,u=t.invalidMessage,l=t.translator,c=t.colorService,h=t.chart,d=t.options;if(!e.qHyperCube)return{};var p,m=Jx(e),g=Zx(e),y=Math.min(m,g),v=i.carbon?"kinesics":"hammer",x=[].concat(f([{type:"native",key:"native",events:{mousemove:function(t){var e=this.chart.component("tooltip");e&&e.emit("show",t)},mouseleave:function(){var t=this.chart.component("tooltip");t&&t.emit("hide")}}}]),f(function(t){var e=t.interactionType,n=t.picassoQ,r=t.selectionsApi;return[{type:e,key:"hammer",enable:function(){return!0},gestures:[{type:"Pan",events:{panstart:function(t){this.chart.component("lasso").emit("lassoStart",t)},pan:function(t){this.chart.component("lasso").emit("lassoMove",t)},panend:function(t){this.chart.component("lasso").emit("lassoEnd",t);var e=this.chart.brush("lassoContext");e&&r&&setTimeout((function(){n.selections(e,{}).forEach((function(t){var e,n;null!=t&&null!==(e=t.params)&&void 0!==e&&null!==(n=e[0])&&void 0!==n&&n.startsWith("/0/")&&(t.params[0]="/qHyperCubeDef"),r.select(t)}))}),0)}}}]}]}({interactionType:v,picassoQ:o,selectionsApi:a}))),b=e.qHyperCube.qMeasureInfo,w=function(t,e,n){for(var r,i,o=new Hb(t,n),a=[],s=0;s<e;s++)r=n[s],(i=o.getMeasureFormatter(s))&&"U"===i.type&&(i.pattern=i.createPatternFromRange(r.qMax,r.qMax,!0),Math.floor(Math.log(Math.abs(r.qMax))/Math.log(10))%3==2&&(i.pattern=i.pattern.substr(0,i.pattern.length-2),i.pattern+="A"),i.prepare()),a.push(i);return a=a.filter((function(t){return void 0!==t})),0===a.length&&a.push({formatValue:function(t){return t}}),a}("",b.length,b),M=c.getScales(),k=[{key:"hierarchy",data:{hierarchy:{label:function(t){return null!=t&&t.qText?t.qText:void 0},value:function(t){var e,n,r;if("N"===(null==t?void 0:t.qType)&&(null==t||null===(e=t.qSubNodes)||void 0===e?void 0:e.length)>1)return"NaN";if("N"===(null==t?void 0:t.qType)&&1===(null==t||null===(n=t.qSubNodes)||void 0===n?void 0:n.length)){for(var i=t.qSubNodes;i.length>1;)i=i.qSubNodes;return"V"!==i[0].qType?0:t.qMaxPos}return"O"===t.qType&&1===(null==t||null===(r=t.qSubNodes)||void 0===r?void 0:r.length)&&(null==t?void 0:t.qSubNodes[0].qValue)||0},props:n(n({select:{field:"qDimensionInfo/".concat(y),reduce:function(t){return 1===t.length?t[0]:void 0}}},c.getDatumProps()),{},{isOther:{value:function(t,e){return-3===e.data.qElemNo}}})}}}],_=[{type:"treemap",key:"treemap",data:{collection:{key:"hierarchy"}},settings:{formatter:w,labels:e.labels,box:{fill:c.getColor()},color:{mode:e.color.mode,measureScheme:e.color.measureScheme,others:r.getDataColorSpecials().others,persistent:e.color.persistent||e.qHyperCube.qDimensionInfo.length>1},showHeaders:e.qHyperCube.qDimensionInfo.length>1,getContrastingColorTo:r.getContrastingColorTo,headerColor:"#F2F2F2",level:m,invalidMessage:u,translator:l},brush:{trigger:[{on:"tap",contexts:["dataContext"],data:["select"]}],consume:[{filter:function(t){var e,n;return(null==t||null===(e=t.data)||void 0===e||null===(n=e.select)||void 0===n?void 0:n.value)>-1},context:"dataContext",data:["select"],style:{active:{stroke:"black",strokeWidth:function(t){return t.data.child?0:2},opacity:function(t){var e;return null!=t&&null!==(e=t.data)&&void 0!==e&&e.overlay?.7:1}},inactive:{opacity:function(t){var e;return null!=t&&null!==(e=t.data)&&void 0!==e&&e.parentGroup?0:.5}}}},{filter:function(t){var e,n;return(null==t||null===(e=t.data)||void 0===e||null===(n=e.select)||void 0===n?void 0:n.value)>-1},context:"lassoContext",data:["select"],style:{active:{stroke:"black",strokeWidth:function(t){return t.data.child?0:2},opacity:function(t){var e;return null!=t&&null!==(e=t.data)&&void 0!==e&&e.overlay?.7:1}},inactive:{opacity:function(t){var e;return null!=t&&null!==(e=t.data)&&void 0!==e&&e.parentGroup?0:.5}}}}]}}],q=function(t){var e=t.colorService,n=t.chart;return t.layout,e.getLegend({eventName:"legend",key:"legend",chart:n,styleReference:"object.treemap"})}({colorService:c,chart:h,layout:e});q&&!0===s&&(_.push.apply(_,f(q.components)),(p=x[1].gestures).push.apply(p,f(q.interactions)));return _.push(function(t){var e=t.level,n=t.layout;return{key:"tooltip",type:"tooltip",settings:{duration:2500,placement:{type:"bounds",area:"target"},extract:function(t){return{value:t.node.data}},content:function(t){var r=t.h,i=t.data,o=i[0].value.label;if(0!==e){o="";var a=[];!function t(e,n){e&&a.push(e.label),e&&t(e.next)}(i[1].value);var s=n.qHyperCube.qDimensionInfo.length-e-1;a.splice(0,s),o=a.join(", ")}if(e!==n.qHyperCube.qDimensionInfo.length-1)return r("div",{},r("div",{style:{"font-size":"14px","font-weight":"bold"}},o));var u="".concat(n.qHyperCube.qMeasureInfo[0].qFallbackTitle,": ").concat(i[1].value.value);return r("div",{},r("div",{style:{"font-size":"14px","margin-bottom":"8px","font-weight":"bold"}},o),r("div",{},u))}}}}({level:m,layout:e,formatter:w})),_.push({key:"lasso",type:"brush-lasso",settings:{brush:{components:[{key:"treemap",data:["select"],contexts:["lassoContext"],action:"add"}]}}}),{collections:k,scales:M,components:_,interactions:x,palettes:c.getPalettes(),strategy:Ub(e,d)}};function $b(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}var Xb=r().mark(Gb);function Gb(){var t,e,n,i,o,a;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=[t=this];case 1:e=n.reverse(),n=[];case 2:if(!(t=e.pop())){r.next=8;break}return r.next=5,t;case 5:if(i=t.children)for(o=0,a=i.length;o<a;++o)n.push(i[o]);r.next=2;break;case 8:if(n.length){r.next=1;break}case 9:case"end":return r.stop()}}),Xb,this)}function Kb(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Zb)):void 0===e&&(e=Jb);for(var n,r,i,o,a,s=new ew(t),u=[s];n=u.pop();)if((i=e(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)u.push(r=i[o]=new ew(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(tw)}function Jb(t){return t.children}function Zb(t){return Array.isArray(t)?t[1]:null}function Qb(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function tw(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function ew(t){this.data=t,this.depth=this.height=0,this.parent=null}function nw(t){if("function"!=typeof t)throw new Error;return t}function rw(){return 0}function iw(t){return function(){return t}}function ow(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function aw(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,l=t.value&&(r-e)/t.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*l}function sw(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,l=t.value&&(i-n)/t.value;++s<u;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*l}ew.prototype=Kb.prototype=c({constructor:ew,count:function(){return this.eachAfter($b)},each:function(t,e){var n,r=-1,i=m(this);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.call(e,o,++r,this)}}catch(t){i.e(t)}finally{i.f()}return this},eachAfter:function(t,e){for(var n,r,i,o=this,a=[o],s=[],u=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)t.call(e,o,++u,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(e,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){var n,r=-1,i=m(this);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(t.call(e,o,++r,this))return o}}catch(t){i.e(t)}finally{i.f()}},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Kb(this).eachBefore(Qb)}},Symbol.iterator,Gb),Object.create(ew.prototype);var uw=(1+Math.sqrt(5))/2;function lw(t,e,n,r,i,o){for(var a,s,u,l,c,h,f,d,p,m,g,y=[],v=e.children,x=0,b=0,w=v.length,M=e.value;x<w;){u=i-n,l=o-r;do{c=v[b++].value}while(!c&&b<w);for(h=f=c,g=c*c*(m=Math.max(l/u,u/l)/(M*t)),p=Math.max(f/g,g/h);b<w;++b){if(c+=s=v[b].value,s<h&&(h=s),s>f&&(f=s),g=c*c*m,(d=Math.max(f/g,g/h))>p){c-=s;break}p=d}y.push(a={value:c,dice:u<l,children:v.slice(x,b)}),a.dice?aw(a,n,r,i,M?r+=l*c/M:o):sw(a,n,r,M?n+=u*c/M:i,o),M-=c,x=b}return y}var cw=function t(e){function n(t,n,r,i,o){lw(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(uw);function hw(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function fw(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function dw(){}!function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,u,l,c,h=-1,f=a.length,d=t.value;++h<f;){for(u=(s=a[h]).children,l=s.value=0,c=u.length;l<c;++l)s.value+=u[l].value;s.dice?aw(s,n,r,i,d?r+=(o-r)*s.value/d:o):sw(s,n,r,d?n+=(i-n)*s.value/d:i,o),d-=s.value}else t._squarify=a=lw(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(uw);var pw=.7,mw=1/pw,gw="\\s*([+-]?\\d+)\\s*",yw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xw=/^#([0-9a-f]{3,8})$/,bw=new RegExp("^rgb\\(".concat(gw,",").concat(gw,",").concat(gw,"\\)$")),ww=new RegExp("^rgb\\(".concat(vw,",").concat(vw,",").concat(vw,"\\)$")),Mw=new RegExp("^rgba\\(".concat(gw,",").concat(gw,",").concat(gw,",").concat(yw,"\\)$")),kw=new RegExp("^rgba\\(".concat(vw,",").concat(vw,",").concat(vw,",").concat(yw,"\\)$")),_w=new RegExp("^hsl\\(".concat(yw,",").concat(vw,",").concat(vw,"\\)$")),qw=new RegExp("^hsla\\(".concat(yw,",").concat(vw,",").concat(vw,",").concat(yw,"\\)$")),Dw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Sw(){return this.rgb().formatHex()}function Cw(){return this.rgb().formatRgb()}function Ew(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=xw.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Aw(e):3===n?new Iw(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Nw(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Nw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=bw.exec(t))?new Iw(e[1],e[2],e[3],1):(e=ww.exec(t))?new Iw(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Mw.exec(t))?Nw(e[1],e[2],e[3],e[4]):(e=kw.exec(t))?Nw(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=_w.exec(t))?jw(e[1],e[2]/100,e[3]/100,1):(e=qw.exec(t))?jw(e[1],e[2]/100,e[3]/100,e[4]):Dw.hasOwnProperty(t)?Aw(Dw[t]):"transparent"===t?new Iw(NaN,NaN,NaN,0):null}function Aw(t){return new Iw(t>>16&255,t>>8&255,255&t,1)}function Nw(t,e,n,r){return r<=0&&(t=e=n=NaN),new Iw(t,e,n,r)}function Ow(t){return t instanceof dw||(t=Ew(t)),t?new Iw((t=t.rgb()).r,t.g,t.b,t.opacity):new Iw}function Iw(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Tw(){return"#".concat(Lw(this.r)).concat(Lw(this.g)).concat(Lw(this.b))}function Rw(){var t=Pw(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(Fw(this.r),", ").concat(Fw(this.g),", ").concat(Fw(this.b)).concat(1===t?")":", ".concat(t,")"))}function Pw(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Fw(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Lw(t){return((t=Fw(t))<16?"0":"")+t.toString(16)}function jw(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Vw(t,e,n,r)}function zw(t){if(t instanceof Vw)return new Vw(t.h,t.s,t.l,t.opacity);if(t instanceof dw||(t=Ew(t)),!t)return new Vw;if(t instanceof Vw)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Vw(a,s,u,t.opacity)}function Vw(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Hw(t){return(t=(t||0)%360)<0?t+360:t}function Bw(t){return Math.max(0,Math.min(1,t||0))}function Ww(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}hw(dw,Ew,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Sw,formatHex:Sw,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return zw(this).formatHsl()},formatRgb:Cw,toString:Cw}),hw(Iw,(function(t,e,n,r){return 1===arguments.length?Ow(t):new Iw(t,e,n,null==r?1:r)}),fw(dw,{brighter:function(t){return t=null==t?mw:Math.pow(mw,t),new Iw(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?pw:Math.pow(pw,t),new Iw(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},clamp:function(){return new Iw(Fw(this.r),Fw(this.g),Fw(this.b),Pw(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tw,formatHex:Tw,formatHex8:function(){return"#".concat(Lw(this.r)).concat(Lw(this.g)).concat(Lw(this.b)).concat(Lw(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Rw,toString:Rw})),hw(Vw,(function(t,e,n,r){return 1===arguments.length?zw(t):new Vw(t,e,n,null==r?1:r)}),fw(dw,{brighter:function(t){return t=null==t?mw:Math.pow(mw,t),new Vw(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?pw:Math.pow(pw,t),new Vw(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Iw(Ww(t>=240?t-240:t+120,i,r),Ww(t,i,r),Ww(t<120?t+240:t-120,i,r),this.opacity)},clamp:function(){return new Vw(Hw(this.h),Bw(this.s),Bw(this.l),Pw(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=Pw(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(Hw(this.h),", ").concat(100*Bw(this.s),"%, ").concat(100*Bw(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));var Uw=Math.PI/180,Yw=180/Math.PI,$w=.96422,Xw=.82521,Gw=4/29,Kw=6/29,Jw=3*Kw*Kw;function Zw(t){if(t instanceof Qw)return new Qw(t.l,t.a,t.b,t.opacity);if(t instanceof oM)return aM(t);t instanceof Iw||(t=Ow(t));var e,n,r=rM(t.r),i=rM(t.g),o=rM(t.b),a=tM((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?e=n=a:(e=tM((.4360747*r+.3850649*i+.1430804*o)/$w),n=tM((.0139322*r+.0971045*i+.7141733*o)/Xw)),new Qw(116*a-16,500*(e-a),200*(a-n),t.opacity)}function Qw(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function tM(t){return t>.008856451679035631?Math.pow(t,1/3):t/Jw+Gw}function eM(t){return t>Kw?t*t*t:Jw*(t-Gw)}function nM(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function rM(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function iM(t){if(t instanceof oM)return new oM(t.h,t.c,t.l,t.opacity);if(t instanceof Qw||(t=Zw(t)),0===t.a&&0===t.b)return new oM(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Yw;return new oM(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function oM(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function aM(t){if(isNaN(t.h))return new Qw(t.l,0,0,t.opacity);var e=t.h*Uw;return new Qw(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}hw(Qw,(function(t,e,n,r){return 1===arguments.length?Zw(t):new Qw(t,e,n,null==r?1:r)}),fw(dw,{brighter:function(t){return new Qw(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Qw(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Iw(nM(3.1338561*(e=$w*eM(e))-1.6168667*(t=1*eM(t))-.4906146*(n=Xw*eM(n))),nM(-.9787684*e+1.9161415*t+.033454*n),nM(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),hw(oM,(function(t,e,n,r){return 1===arguments.length?iM(t):new oM(t,e,n,null==r?1:r)}),fw(dw,{brighter:function(t){return new oM(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new oM(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return aM(this).rgb()}}));var sM=-.14861,uM=1.78277,lM=-.29227,cM=-.90649,hM=1.97294,fM=hM*cM,dM=hM*uM,pM=uM*lM-cM*sM;function mM(t){if(t instanceof gM)return new gM(t.h,t.s,t.l,t.opacity);t instanceof Iw||(t=Ow(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(pM*r+fM*e-dM*n)/(pM+fM-dM),o=r-i,a=(hM*(n-i)-lM*o)/cM,s=Math.sqrt(a*a+o*o)/(hM*i*(1-i)),u=s?Math.atan2(a,o)*Yw-120:NaN;return new gM(u<0?u+360:u,s,i,t.opacity)}function gM(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function yM(t,e,n,r,i){var o=n.measureText({text:"W",fontSize:r,fontFamily:i}),a=e/o.width;return o.width*t.length>e?"".concat(t.slice(0,a),"..."):t}function vM(t,e,n,r,i,o){var a=function(t,e,n){var r,i,o,a=t?t.split(/\n+|\r+|\r\n/):[],s=[],u=t?t.split(/\s+/):[],l=a[0];if("number"!=typeof e||e<=0)return[t];for(i=0;i<a.length;i++){for(l=(u=(a[i]||"").split(/\s+/))[0],r=1;r<u.length;r++)n(o="".concat(l," ").concat(u[r])).width>e?(s.push(l),l=u[r]):l=o;s[Math.max(0,s.length-1)]="".concat(s[Math.max(0,s.length-1)]||""," ").concat(l," ").concat("")}return s}(t,e.width,n);return a.length>1?(a[a.length-1]=yM(a[a.length-1],e.width,r,i,o),a.join("\n")):yM(t,e.width,r,i,o)}hw(gM,(function(t,e,n,r){return 1===arguments.length?mM(t):new gM(t,e,n,null==r?1:r)}),fw(dw,{brighter:function(t){return t=null==t?mw:Math.pow(mw,t),new gM(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?pw:Math.pow(pw,t),new gM(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Uw,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Iw(255*(e+n*(sM*r+uM*i)),255*(e+n*(lM*r+cM*i)),255*(e+n*(hM*r)),this.opacity)}}));var xM=12,bM="Arial",wM=function(t){var e,r=t.node,i=t.width,o=t.height,a=t.fill,s=t.valueLables,u=t.labels,l=t.formatter,c=t.getContrastingColorTo,h=t.renderer;if(i*o&&null!=r&&null!==(e=r.data)&&void 0!==e&&e.label){if(r.header)return void MM({node:r,width:i,height:o,fill:a,getContrastingColorTo:c,renderer:h,valueLables:s,labels:u});var f=r.data.label;u.value&&(f+="\n".concat(l[0].formatValue(r.data.value)));var d=f.split(/(\s+)/).filter((function(t){return" "!==t})),p=d.reduce((function(t,e){return t.length>e.length?t:e}));if(h.measureText({text:p,fontSize:xM,fontFamily:bM}).width<i-12){var m=r.y0+4;u.value&&d.push(l[0].formatValue(r.data.value));var g=d.reduce((function(t,e){return t+h.measureText({text:e,fontSize:xM,fontFamily:bM}).height}),0);if(g<o-8){var y,v=m,x="".concat(r.data.label);y=l[0].formatValue(r.data.value);var b=h.measureText({text:y,fontSize:xM,fontFamily:bM});x=vM(x,{width:i-8,height:o},(function(t){return h.measureText({text:t,fontFamily:bM,fontSize:xM})}),h,xM,bM),b.width<i-12&&b.height+g<o-8&&(x+="\n".concat(y)),s.push({type:"text",text:x,fontFamily:bM,fontSize:xM,x:r.x0+6,y:v,fill:a?c(a):"rgb(0, 0, 0)",baseline:"text-before-edge",wordBreak:"break-word",data:n(n({},r.data),{},{depth:r.depth})})}}}},MM=function(t){var e=t.node,r=t.width,i=t.fill,o=t.valueLables,a=t.getContrastingColorTo,s=t.renderer,u=e.data.label,l=s.measureText({text:u,fontSize:12,fontFamily:bM}),c=e.y0+l.height;e.header&&!e.showLable||(l.width>r-8&&(u=yM(u,r-10,s,12,bM)),o.push({type:"text",text:u,fontFamily:bM,fontSize:12,x:e.x0+6,y:c+6,fill:i?a(i):"rgb(0, 0, 0)",anchor:"left",baseline:"central",maxWidth:r-12,data:n(n({},e.data),{},{depth:e.depth})}))},kM=function(t){var e=t.rect,n=t.text,r=t.renderer.measureText({text:n,fontSize:16,fontFamily:bM});return[{type:"rect",x:0,y:0,width:e.width,height:e.height,fill:"red",opacity:.1},{type:"text",text:n,fontFamily:bM,fontSize:16,x:(e.width-r.width)/2,y:(e.height-r.height)/2,fill:"red",baseline:"text-before-edge",maxWidth:e.width-8,wordBreak:"break-word"}]},_M=function(t){var e=t.node,r=t.avgColor,i=t.width,o=t.height,a=t.renderer,s=t.getContrastingColorTo,u=e.data.label,l=function(t){var e=t.rect,r=t.renderer,i=t.text,o=n({},e);o.height=.3*e.height;var a=r.measureText({text:"W",fontSize:"".concat(o.height,"px"),fontFamily:bM}),s=i.length,u=o.width*o.height/(a.width*s),l=r.measureText({fontSize:"".concat(u,"px"),text:i,fontFamily:bM}),c=Math.sqrt(o.width/l.width),h=parseInt(Math.min(o.height,u*c),10),f="".concat(h,"px");return{fontSize:f,bounding:r.measureText({fontSize:f,text:i,fontFamily:bM})}}({rect:{x:0,y:0,width:i,height:o},renderer:a,text:u}),c=l.fontSize,h=l.bounding,f=e.x0+Math.abs(i/2-h.width/2),d=e.y0+o/2,p=parseInt(c,10),m=s(r);if(p>8)return{type:"text",text:u,fontFamily:bM,fontSize:c,x:f,y:d,fill:m,stroke:s(m),strokeWidth:1,opacity:.7,baseline:"central",data:n(n({},e.data),{},{depth:e.depth,overlay:!0})}},qM=Object.freeze({HEAER_HEIGHT:28,OUTER_PADDING:1,STROKE_WIDTH:.5}),DM=function(t,e){var n=t.path(e),r="";return n.forEach((function(t){r=t.data.source?"".concat(r,"/").concat(t.data.source.field):"".concat(r,"/").concat(t.data.select.label)})),r="".concat(r,"/").concat(e.data.select.value)},SM=function(){return{require:["chart","renderer","element"],render:function(t){var e=this,r=t.data,i=this.settings.settings,o=i.headerColor,a=i.getContrastingColorTo,s=i.labels,u=i.formatter,l=i.level,c=i.invalidMessage,h=i.translator,f=i.box,d=this.rect;if(function(t,e){var n=e.interactions.instances.find((function(t){return"kinesics"===t.key}));n&&n.setupBrushes(t,e)}(this.settings.brush,this.chart),!r.root||0===r.fields.length)return kM({rect:this.rect,renderer:this.renderer,text:h.translate("InvalidVisualization")});var p=r.root.sum((function(t){return isNaN(t.value)?0:t.value})).sort((function(t,e){return t.data.isOther.value!==e.data.isOther.value?t.data.isOther.value?1:-1:e.value-t.value})),m=function(){var t=cw,e=!1,n=1,r=1,i=[0],o=rw,a=rw,s=rw,u=rw,l=rw;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(ow),t}function h(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<c&&(c=f=(c+f)/2),e.x0=r,e.y0=c,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=o(e)/2,r+=l(e)-n,c+=a(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(f-=u(e)-n)<c&&(c=f=(c+f)/2),t(e,r,c,h,f))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=nw(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:iw(+t),c):o},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:iw(+t),c):a},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:iw(+t),c):s},c.paddingBottom=function(t){return arguments.length?(u="function"==typeof t?t:iw(+t),c):u},c.paddingLeft=function(t){return arguments.length?(l="function"==typeof t?t:iw(+t),c):l},c}().size([d.width,d.height]).round(!1).paddingInner(qM.STROKE_WIDTH).paddingOuter(qM.OUTER_PADDING).paddingTop((function(t){if(1===t.depth&&1!==t.height){var e=t.y1-t.y0>2*qM.HEAER_HEIGHT;return t.header=!0,t.showLable=e,s.headers&&e?qM.HEAER_HEIGHT:1}return 1}))(p),g=[],y=[],v=[],x=m.height,b=function t(r){var i=r.y1-r.y0,c=r.x1-r.x0;if(i*c){var h=function(t,e,n,r){return t.header&&!isNaN(t.value)?e:n.fill({datum:t.data,resources:{scale:function(t){return r.scale(t)}}})}(r,o,f,e.chart);if(r.header||1===r.height){if(function(t,e){var n=Ew(e);if(n){var r=4===t.depth?t.parent.parent:t.parent,i=(null==r?void 0:r.sumColor)||{r:0,g:0,b:0,count:0};i.r+=n.r,i.g+=n.g,i.b+=n.b,i.count+=1,r.sumColor=i}}(r,h),r.header&&i?s.headers?wM({node:r,width:c,height:i,fill:h,valueLables:g,labels:s,formatter:u,getContrastingColorTo:a,renderer:e.renderer}):s.overlay&&y.push(r):s.leaves&&!r.header&&wM({node:r,width:c,height:i,fill:h,valueLables:g,labels:s,formatter:u,getContrastingColorTo:a,renderer:e.renderer}),r.depth===x-1){var d,p=DM(m,r),b={type:"rect",width:c,height:i,fill:h,x:r.x0,y:r.y0,data:n(n({},r.data),{},{depth:r.depth,next:n({},null==r||null===(d=r.parent)||void 0===d?void 0:d.data),child:!0,path:p})};v.push(b)}else if(r.header&&!isNaN(r.value)){var w={type:"rect",width:c,height:i,fill:h,x:r.x0,y:r.y0};v.push(w)}}else if(2===r.depth&&x>2&&r.data.label){var M;r.data.next=null==r||null===(M=r.parent)||void 0===M?void 0:M.data,r.data.depth=r.depth,y.push(r)}if(r.depth-1===l){var k,_,q=DM(m,r);r.data.next=null==r||null===(k=r.parent)||void 0===k?void 0:k.data;var D={type:"rect",width:c,height:i,fill:"rgba(255,255,255,0)",opacity:0,x:r.x0,y:r.y0,data:n(n({},r.data),{},{depth:r.depth,next:n({},null==r||null===(_=r.parent)||void 0===_?void 0:_.data),path:q})};v.push(D)}}r.children&&r.children.forEach((function(e,n){return t(e)}))};m.children.forEach((function(t,e){b(t)}));var w=[];return y.forEach((function(t){var n=t.y1-t.y0,r=t.x1-t.x0,i=function(t){var e=t.sumColor;if(e){var n={r:Math.round(e.r/e.count),g:Math.round(e.g/e.count),b:Math.round(e.b/e.count)},r="rgb(".concat(n.r,", ").concat(n.g,", ").concat(n.b,")"),i=Ew(a(r));return i.opacity=.7,i.toString()}return"rgba(0, 0, 0, 0.7)"}(t),o=_M({node:t,avgColor:i,width:r,height:n,renderer:e.renderer,getContrastingColorTo:a});o&&w.push(o)})),0===v.length?kM({rect:this.rect,renderer:this.renderer,text:c}):[].concat(v,g,w,[])}}},CM={data:{targets:[{path:"/qHyperCubeDef",dimensions:{min:1},measures:{min:1}}]},properties:{version:"1.0.0-alpha.12",color:{auto:!0,mode:"primary",formatting:{numFormatFromTemplate:!0},useBaseColors:"off",paletteColor:{index:6},useDimColVal:!0,useMeasureGradient:!0,persistent:!1,expressionIsColor:!0,expressionLabel:"",measureScheme:"sg",reverseScheme:!1,dimensionScheme:"12",autoMinMax:!0,measureMin:0,measureMax:10},footnote:"",labels:{auto:!0,headers:!0,overlay:!0,leaves:!0,values:!1},legend:{dock:"auto",show:!1,showTitle:!0},qHyperCubeDef:{qDimensions:[],qMeasures:[],qMode:"K",qNoOfLeftDims:-1,qSortbyYValue:-1,qIndentMode:!0,qShowTotalsAbove:!0,qMaxStackedCells:3e3,qAlwaysFullyExpanded:!0,qInitialDataFetch:[{qTop:0,qHeight:3e3,qLeft:0,qWidth:30}],qSuppressZero:!1,qSuppressMissing:!0},showDetails:!1,showDisclaimer:!0,showTitles:!0,subtitle:"",title:"",tooltip:{auto:!0,hideBasic:!1,title:"",description:"",chart:void 0,imageComponents:void 0}}},EM=function(t){var e=t.selectBrush,n=t.picassoQ,i=t.selections,o=function(t){return e.brushes().forEach((function(t){"range"===t.type&&e.clear([])})),t.filter((function(t){return t.value>=0})).slice(0,-1)},s=function(t){var n=e.brushes().filter((function(t){return"value"===t.type}));return n.length?(e.clear([]),t):t};t.lasso||e.on("update",function(){var t=a(r().mark((function t(o){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.isActive()||!(o.length>0)){t.next=3;break}return t.next=3,i.begin(["/qHyperCubeDef"]);case 3:if(i.isActive())try{n.selections(e,{}).forEach((function(t){var e,n;null!=t&&null!==(e=t.params)&&void 0!==e&&null!==(n=e[0])&&void 0!==n&&n.startsWith("/0/")&&(t.params[0]="/qHyperCubeDef"),i.select(t)}))}catch(t){console.error("Failed to apply selections",t)}case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.intercept("set-ranges",s),e.intercept("toggle-ranges",s),e.intercept("toggle-values",o),e.intercept("set-values",o),e.intercept("add-values",o)};function AM(t){var e=t.defaultAuto,n=t.layout;if(n.qHyperCube.qDimensionInfo.length<=1)return e(n);var r=Jx(n),i=Zx(n);return{mode:"byDimension",persistent:!1,useDimColVal:!0,byDimDef:{activeDimensionIndex:Math.min(r,i)}}}var NM={exports:{}};!function(t,e){window,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==i(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/conversion/",n(n.s=2)}([function(t,e,n){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,u=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},l=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var e,n=r.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!i)return!1;for(e in t);return void 0===e||r.call(t,e)},c=function(t,e){a&&"__proto__"===e.name?a(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},h=function(t,e){if("__proto__"===e){if(!r.call(t,e))return;if(s)return s(t,e).value}return t[e]};t.exports=function t(){var e,n,r,o,a,s,f=arguments[0],d=1,p=arguments.length,m=!1;for("boolean"==typeof f&&(m=f,f=arguments[1]||{},d=2),(null==f||"object"!=i(f)&&"function"!=typeof f)&&(f={});d<p;++d)if(null!=(e=arguments[d]))for(n in e)r=h(f,n),f!==(o=h(e,n))&&(m&&o&&(l(o)||(a=u(o)))?(a?(a=!1,s=r&&u(r)?r:[]):s=r&&l(r)?r:{},c(f,{name:n,newValue:t(m,s,o)})):void 0!==o&&c(f,{name:n,newValue:o}));return f}},function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==i(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/qlik-modifiers/",n(n.s=1)}([function(t,e,n){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,u=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},l=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var e,n=r.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!i)return!1;for(e in t);return void 0===e||r.call(t,e)},c=function(t,e){a&&"__proto__"===e.name?a(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},h=function(t,e){if("__proto__"===e){if(!r.call(t,e))return;if(s)return s(t,e).value}return t[e]};t.exports=function t(){var e,n,r,o,a,s,f=arguments[0],d=1,p=arguments.length,m=!1;for("boolean"==typeof f&&(m=f,f=arguments[1]||{},d=2),(null==f||"object"!=i(f)&&"function"!=typeof f)&&(f={});d<p;++d)if(null!=(e=arguments[d]))for(n in e)r=h(f,n),f!==(o=h(e,n))&&(m&&o&&(l(o)||(a=u(o)))?(a?(a=!1,s=r&&u(r)?r:[]):s=r&&l(r)?r:{},c(f,{name:n,newValue:t(m,s,o)})):void 0!==o&&c(f,{name:n,newValue:o}));return f}},function(t,e,n){n.r(e);var r=n(0),o=n.n(r),a=function(t,e,n){if(!e)return!1;var r,i=e.split("."),o=i[i.length-1],a=t;for(r=0;r<i.length-1;++r)void 0===a[i[r]]&&(a[i[r]]=Number.isNaN(+i[r+1])?{}:[]),a=a[i[r]];if(void 0!==n){var s=a[o];return a[o]=n,{updated:n,previous:s}}return delete a[o],!1},s=function(t,e,n){var r,i=e.split("."),o=t;if(void 0===o)return n;for(r=0;r<i.length;++r){if(void 0===o[i[r]])return n;o=o[i[r]]}return o},u="".concat(" ","(").concat(""),l="".concat("",")").concat(" ");function c(t){return u+t+l}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.qLibraryId){var n=function(t,e){if(!e)return null;var n,r;for(n=0;n<e.length;n++)if((r=e[n]).qInfo.qId===t)return r;return null}(t.qLibraryId,e.dimensionList);return n&&n.qData.info[0].qTags.indexOf("$numeric")>-1}var r=function(t,e){if(!e)return null;var n,r,i=function(t){var e=t.trim();"="===e.charAt(0)&&(e=(e=e.substring(1)).trim());var n=e.length-1;return"["===e.charAt(0)&&"]"===e.charAt(n)&&(e=(e=e.substring(1,n)).trim()),e}(t);for(n=0;n<e.length;n++){if((r=e[n]).qName===i)return r;if(r.qDerivedFieldData)for(var o=0;o<r.qDerivedFieldData.qDerivedFieldLists.length;++o)for(var a=r.qDerivedFieldData.qDerivedFieldLists[o],s=0;s<a.qFieldDefs.length;++s){var u=a.qFieldDefs[s];if(u.qName===i)return u}}return null}(t.qDef.qFieldDefs[0],e.fieldList);return r&&r.qTags.indexOf("$numeric")>-1}function f(t){return!(!t.fullAccumulation&&!t.fullRange)}function d(t,e){var n=t.crossAllDimensions;return 2===e&&n?"RowNo(Total)":"RowNo()"}function p(t){var e=function(t){return t?(t=function(t){return t.replace(/\/\*[^]*?\*\//g,"")}(t=function(t){return t.replace(/\/\/(.*)$/gm,"")}(t))).trim():""}(t).trim();return"="===e.substring(0,1)?e.substring(1).trim():e}function m(){return"[$(=Replace(GetObjectField(".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,"),']',']]'))]")}function g(t,e){var n=t.crossAllDimensions;return 2===e&&n?"Above(Total ":"Above("}function y(t){return void 0===t?")":", 0, ".concat(t,")")}function v(t,e){return t?"".concat(e,'={">=$(=Min(').concat(e,"))<=$(=Max(").concat(e,'))"}'):"".concat(e,'={"=Only({1}').concat(e,")>='$(=MinString(").concat(e,"))' and Only({1}").concat(e,")<='$(=MaxString(").concat(e,"))'\"}")}function x(t){var e=t.modifier,n=void 0===e?{}:e,r=t.dimensions,i=t.dimensionAndFieldList,o=t.funcComp,a=void 0===o?"Sum":o,s=t.valueComp,u=void 0===s?"0":s;if(!n.showExcludedValues)return"";if(r&&1===r.length){var l=v(h(r[0],i),m(0));return"".concat(a,"({1<").concat(l,">}").concat(u,")")}if(r&&2===r.length){var c=h(r[0],i),f=h(r[1],i),d=m(0),p=m(1),g=v(c,d),y=v(f,p);return"".concat(a,"({1<").concat(g,",").concat(y,">}").concat(u,")")}return"".concat(a,"({1}").concat(u,")")}function b(t){return"".concat(t,"(")}function w(t){var e=t.properties,n=t.layout;return s(e,"qHyperCubeDef.qDimensions",s(n,"qHyperCube.qDimensionInfo",[])).length}var M={isFullRange:f,getNumDimensions:w,getExpressionWithExcludedComp:function(t){var e=t.expression,n=t.modifier,r=t.dimensions,i=t.dimensionAndFieldList,o=t.treatMissingAsNull,a=c(p(e));if(!n.showExcludedValues)return a;var s=x({modifier:n,dimensions:r,dimensionAndFieldList:i}),u=o?"":", 0";if(r&&1===r.length){var l=m(0);return"If(Count(".concat(l,") > 0, ").concat(a," + ").concat(s).concat(u,")")}if(r&&2===r.length){var h=m(0),f=m(1);return"If(Count(".concat(h,") * Count(").concat(f,") > 0, ").concat(a," + ").concat(s).concat(u,")")}return a},getRowNoComp:d,getNumStepComp:function(t,e){if(!f(t)){var n=t.steps;return"number"!=typeof n||Number.isNaN(n)?6:n}return d(t,e)},getAboveCompPrefix:g,getAboveCompSuffix:y,getAboveComp:function(t,e,n,r){return g(t,e)+n+y(r)},getFunctionPrefix:b,getFunctionSuffix:function(){return")"},getRangeComp:function(t,e){return b(t)+e+")"},getAggrComp:function(t,e,n){return"Aggr(".concat(t,", ").concat(e,", ").concat(n,")")},getExcludedComp:x,needDimension:function(t){var e=t.modifier,n=t.properties,r=t.layout;return 0===function(t){return void 0===t.primaryDimension?t.accumulationDimension:t.primaryDimension}(e)&&2===w({properties:n,layout:r})},getDimComp:function(t,e){var n=function(t){return t[arguments.length>1&&void 0!==arguments[1]?arguments[1]:0].qDef.qSortCriterias[0]}(t,e),r=m(e);if(!n.qSortByExpression&&!n.qSortByNumeric&&!n.qSortByAscii)return r;var i=["Descending","Ascending"],o=n.qSortByNumeric?"(Numeric, ".concat(i[(n.qSortByNumeric+1)/2],")"):"",a=n.qSortByAscii?"(Text, ".concat(i[(n.qSortByAscii+1)/2],")"):"";return n.qSortByNumeric&&n.qSortByAscii?"(".concat(r,", ").concat(o,", ").concat(a,")"):n.qSortByNumeric?"(".concat(r,", ").concat(o,")"):n.qSortByAscii?"(".concat(r,", ").concat(a,")"):r},simplifyExpression:p,extractInputExpression:function(t){var e=t.outputExpression;if(t.modifier){var n=e.indexOf(u);if(-1!==n){var r=e.indexOf(l);if(-1!==r)return e.substring(n+u.length,r)}}},initModifier:function(t,e){Object.keys(e).forEach((function(n){void 0===t[n]&&(t[n]=e[n])}))},isNumeric:h,isApplicable:function(t){var e=t.properties,n=t.layout,r=t.minDimensions,i=void 0===r?1:r,o=t.maxDimensions,a=void 0===o?2:o;if(!e&&!n)return!0;var s=w({properties:e,layout:n});return s>=i&&s<=a},getExpressionWithMarkers:c,canExtract:function(t){var e=t.indexOf(u),n=t.indexOf(l);return e>-1&&n>-1&&e<n},getDimDefWithWrapper:m,getFieldWithWrapper:function(t){var e=t?t.replace(/]/g,"]]"):t;return"[".concat(e,"]")}};function k(t){return(k="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}var _=o.a.bind(null,!0),q={},D=Array.isArray;function S(t){return null!=t&&!Array.isArray(t)&&"object"===k(t)}function C(t){return void 0===t}function E(t,e){return"function"==typeof t[e]||"$$"===e.substring(0,2)||"_"===e.substring(0,1)}function A(t,e){var n,r=e.substring(1).split("/").slice(0,-1);return r.forEach((function(e,i){if(i!==r.length){n=+e;var o=Number.isNaN(n)?{}:[];t[n||e]=C(t[n||e])?o:t[e],t=t[n||e]}})),t}function N(t,e){var n=!0;if(S(t)&&S(e))return Object.keys(t).length===Object.keys(e).length&&(Object.keys(t).forEach((function(r){N(t[r],e[r])||(n=!1)})),n);if(D(t)&&D(e)){if(t.length!==e.length)return!1;for(var r=0,i=t.length;r<i;r+=1)if(!N(t[r],e[r]))return!1;return!0}return t===e}q.generate=function(t,e,n){n=n||"";var r=[];return Object.keys(e).forEach((function(i){var o=function(t){return t?_({},{val:t}).val:t}(e[i]),a=t[i],s="".concat(n,"/").concat(i);N(o,a)||E(e,i)||(C(a)?r.push({op:"add",path:s,value:o}):S(o)&&S(a)?r=r.concat(q.generate(a,o,s)):D(o)&&D(a)?r=r.concat(function(t,e,n){var r=[],i=t.slice(),o=-1;function a(t,e,n){if(t[n]&&C(t[n].qInfo))return null;if(t[n]&&t[n].qInfo.qId===e)return n;for(var r=0,i=t.length;r<i;r+=1)if(t[r]&&t[r].qInfo.qId===e)return r;return-1}if(N(e,i))return r;if(!C(e[0])&&C(e[0].qInfo))return r.push({op:"replace",path:n,value:e}),r;for(var s=i.length-1;s>=0;s-=1)-1===(o=a(e,i[s].qInfo&&i[s].qInfo.qId,s))?(r.push({op:"remove",path:"".concat(n,"/").concat(s)}),i.splice(s,1)):r=r.concat(q.generate(i[s],e[o],"".concat(n,"/").concat(s)));for(var u=0,l=e.length;u<l;u+=1)-1===(o=a(i,e[u].qInfo&&e[u].qInfo.qId))?(r.push({op:"add",path:"".concat(n,"/").concat(u),value:e[u]}),i.splice(u,0,e[u])):o!==u&&(r.push({op:"move",path:"".concat(n,"/").concat(u),from:"".concat(n,"/").concat(o)}),i.splice(u,0,i.splice(o,1)[0]));return r}(a,o,s)):r.push({op:"replace",path:"".concat(n,"/").concat(i),value:o}))})),Object.keys(t).forEach((function(i){C(e[i])&&!E(t,i)&&r.push({op:"remove",path:"".concat(n,"/").concat(i)})})),r},q.apply=function(t,e){e.forEach((function(e){var n,r=A(t,e.path),i=e.path.split("/").splice(-1)[0],o=i&&Number.isNaN(+i)?r[i]:r[+i]||r,a=e.from?e.from.split("/").splice(-1)[0]:null;if("/"===e.path&&(r=null,o=t),"add"===e.op||"replace"===e.op)if(D(r))"-"===i&&(i=r.length),r.splice(+i,"add"===e.op?0:1,e.value);else if(D(o)&&D(e.value)){var s,u=e.value.slice();o.length=0,(s=o).push.apply(s,function(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(u))}else if(S(o)&&S(e.value))n=o,Object.keys(n).forEach((function(t){Object.getOwnPropertyDescriptor(n,t).configurable&&!E(n,t)&&delete n[t]})),_(o,e.value);else{if(!r)throw new Error("Patchee is not an object we can patch");r[i]=e.value}else if("move"===e.op){var l=A(t,e.from);D(r)?r.splice(+i,0,l.splice(+a,1)[0]):(r[i]=l[a],delete l[a])}else"remove"===e.op&&(D(r)?r.splice(+i,1):delete r[i])}))},q.clone=function(t){return _({},t)},q.createPatch=function(t,e,n){var r={op:t.toLowerCase(),path:n};return"move"===r.op?r.from=e:void 0!==e&&(r.value=e),r},q.updateObject=function(t,e){Object.keys(t).length?q.apply(t,q.generate(t,e)):_(t,e)};var O=q,I=function(t,e,n){if(!t)return Promise.resolve();var r=O.generate(e,n);return o()(!0,e,n),r&&r.length?(r=r.map((function(t){return{qOp:t.op,qValue:JSON.stringify(t.value),qPath:t.path}})),t.applyPatches(r,!0)):Promise.resolve()},T="accumulation";function R(t,e){var n=s(t,e);if(n)for(var r=0;r<n.length;r++)if(n[r].type===T)return n[r]}function P(t,e){var n=function(t,e){var n=s(t,e);if(!n)return-1;for(var r=0;r<n.length;r++)if(n[r].type===T)return r;return-1}(t,e);return n>-1?"".concat(e,".").concat(n):e}var F={type:"accumulation",disabled:!1,accumulationDimension:0,crossAllDimensions:!1,showExcludedValues:!0,fullAccumulation:!1,steps:6,outputExpression:""},L={translationKey:"properties.modifier.accumulation",needDimension:M.needDimension,isApplicable:function(t){var e=t.properties,n=t.layout;return M.isApplicable({properties:e,layout:n,minDimensions:1,maxDimensions:2})},generateExpression:function(t){var e=t.expression,n=t.modifier,r=t.properties,i=t.layout,o=t.numDimensions,a=t.dimensionAndFieldList;if(!n)return e;var u=o;void 0===u&&(u=M.getNumDimensions({properties:r,layout:i}));var l=s(r,"qHyperCubeDef.qDimensions",[]),c=M.getExpressionWithExcludedComp({expression:e,modifier:n,dimensions:l,dimensionAndFieldList:a}),h=M.getNumStepComp(n,u),f=M.getAboveComp(n,u,c,h),d=M.getRangeComp("RangeSum",f);if(M.needDimension({modifier:n,properties:r,layout:i})){var p=M.getDimComp(l,1),m=M.getDimComp(l,0),g=M.getAggrComp(d,p,m);d=n.showExcludedValues?M.getExcludedComp({modifier:n,dimensions:l,dimensionAndFieldList:a,valueComp:g}):g}return d},extractInputExpression:M.extractInputExpression,initModifier:function(t){M.initModifier(t,F)},enableTotalsFunction:function(){return!1},propertyPanelDef:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={type:"items",items:{disclaimer:{component:"text",translation:e.disclaimer||"properties.modifier.accumulation.disclaimer",show:function(t,e){return!M.isApplicable({properties:e.properties})}},settings:{type:"items",items:{primaryDimension:{refFn:function(e){return"".concat(P(e,t),".accumulationDimension")},type:"integer",translation:e.primaryDimension||"properties.modifier.primaryDimension",title:{translation:e.primaryDimensionTooltip||"properties.modifier.accumulation.primaryDimension.tooltip"},component:"dropdown",schemaIgnore:!0,defaultValue:1,options:function(t,e){return e.layout.qHyperCube.qDimensionInfo.map((function(t,e){return{value:e,label:t.qGroupFallbackTitles[0]}}))},show:function(t,e){return e.layout.qHyperCube.qDimensionInfo.length>1}},crossAllDimensions:{refFn:function(e){return"".concat(P(e,t),".crossAllDimensions")},type:"boolean",translation:e.crossAllDimensions||"properties.modifier.crossAllDimensions",title:{translation:e.crossAllDimensionsTooltip||"properties.modifier.accumulation.crossAllDimensions.tooltip"},schemaIgnore:!0,defaultValue:!1,show:function(t,e){return e.layout.qHyperCube.qDimensionInfo.length>1}},fullRange:{refFn:function(e){return"".concat(P(e,t),".fullAccumulation")},type:"boolean",translation:e.range||"properties.modifier.range",component:"dropdown",schemaIgnore:!0,defaultValue:!1,options:[{value:!0,translation:e.rangeFull||"properties.modifier.range.full"},{value:!1,translation:e.rangeCustom||"properties.modifier.range.custom"}]},steps:{refFn:function(e){return"".concat(P(e,t),".steps")},type:"integer",translation:e.rangeSteps||"properties.modifier.range.steps",schemaIgnore:!0,defaultValue:6,change:function(e){var n=R(e,t);if(n){var r=n.steps;n.steps="number"!=typeof r||Number.isNaN(r)?6:Math.abs(r)}},show:function(e){var n=R(e,t);return n&&!n.fullAccumulation}},showExcludedValues:{refFn:function(e){return"".concat(P(e,t),".showExcludedValues")},type:"boolean",translation:e.showExcludedValues||"properties.modifier.showExcludedValues",schemaIgnore:!0,defaultValue:!0}},show:function(t,e){return M.isApplicable({properties:e.properties})}}},show:function(e,n,r){var i=r.ext.support.modifiers;if(!Array.isArray(i)||-1===i.indexOf(T))return!1;var o=R(e,t);return o&&!o.disabled}};return n}},j="movingAverage";function z(t,e){var n=s(t,e);if(n)for(var r=0;r<n.length;r++)if(n[r].type===j)return n[r]}function V(t,e){var n=function(t,e){var n=s(t,e);if(!n)return-1;for(var r=0;r<n.length;r++)if(n[r].type===j)return r;return-1}(t,e);return n>-1?"".concat(e,".").concat(n):e}var H={type:"movingAverage",disabled:!1,primaryDimension:0,crossAllDimensions:!1,showExcludedValues:!0,fullRange:!1,steps:6,outputExpression:"",nullSuppression:!1},B={translationKey:"properties.modifier.movingAverage",needDimension:M.needDimension,isApplicable:function(t){var e=t.properties,n=t.layout;return M.isApplicable({properties:e,layout:n,minDimensions:1,maxDimensions:2})},generateExpression:function(t){var e,n=t.expression,r=t.modifier,i=t.properties,o=t.layout,a=t.numDimensions,u=t.dimensionAndFieldList;if(!r)return n;var l=a;void 0===l&&(l=M.getNumDimensions({properties:i,layout:o}));var c=s(i,"qHyperCubeDef.qDimensions",[]),h=r.showExcludedValues&&r.nullSuppression,f=M.getExpressionWithExcludedComp({expression:n,modifier:r,dimensions:c,dimensionAndFieldList:u,treatMissingAsNull:h}),d=M.getNumStepComp(r,l),p=M.getAboveComp(r,l,f,d);if(r.nullSuppression)e=M.getRangeComp("RangeAvg",p);else{var m=M.getRangeComp("RangeSum",p),g=function(t,e){var n=M.getRowNoComp(t,e);if(!M.isFullRange(t)){var r=t.steps,i="number"!=typeof r||Number.isNaN(r)?6:r;return"RangeMin(".concat(i,", ").concat(n,")")}return n}(r,l);e="".concat(m," / ").concat(g)}var y=e;if(M.needDimension({modifier:r,properties:i,layout:o})){var v=M.getDimComp(c,1),x=M.getDimComp(c,0),b=M.getAggrComp(y,v,x);y=r.showExcludedValues?M.getExcludedComp({modifier:r,dimensions:c,dimensionAndFieldList:u,funcComp:"Only",valueComp:b}):b}return y},extractInputExpression:M.extractInputExpression,initModifier:function(t){M.initModifier(t,H)},enableTotalsFunction:function(){return!1},propertyPanelDef:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={type:"items",items:{disclaimer:{component:"text",translation:e.disclaimer||"properties.modifier.movingAverage.disclaimer",show:function(t,e){return!M.isApplicable({properties:e.properties})}},settings:{type:"items",items:{primaryDimension:{refFn:function(e){return"".concat(V(e,t),".primaryDimension")},type:"integer",translation:e.primaryDimension||"properties.modifier.primaryDimension",title:{translation:e.primaryDimensionTooltip||"properties.modifier.movingAverage.primaryDimension.tooltip"},component:"dropdown",schemaIgnore:!0,defaultValue:1,options:function(t,e){return e.layout.qHyperCube.qDimensionInfo.map((function(t,e){return{value:e,label:t.qGroupFallbackTitles[0]}}))},show:function(t,e){return e.layout.qHyperCube.qDimensionInfo.length>1}},crossAllDimensions:{refFn:function(e){return"".concat(V(e,t),".crossAllDimensions")},type:"boolean",translation:e.crossAllDimensions||"properties.modifier.crossAllDimensions",title:{translation:e.crossAllDimensionsTooltip||"properties.modifier.movingAverage.crossAllDimensions.tooltip"},schemaIgnore:!0,defaultValue:!1,show:function(t,e){return e.layout.qHyperCube.qDimensionInfo.length>1}},fullRange:{refFn:function(e){return"".concat(V(e,t),".fullRange")},type:"boolean",translation:e.range||"properties.modifier.range",component:"dropdown",schemaIgnore:!0,defaultValue:!1,options:[{value:!0,translation:e.rangeFull||"properties.modifier.range.full"},{value:!1,translation:e.rangeCustom||"properties.modifier.range.custom"}]},steps:{refFn:function(e){return"".concat(V(e,t),".steps")},type:"integer",translation:e.rangeSteps||"properties.modifier.range.steps",schemaIgnore:!0,defaultValue:6,change:function(e){var n=z(e,t);if(n){var r=n.steps;n.steps="number"!=typeof r||Number.isNaN(r)?6:Math.abs(r)}},show:function(e){var n=z(e,t);return n&&!n.fullRange}},showExcludedValues:{refFn:function(e){return"".concat(V(e,t),".showExcludedValues")},type:"boolean",translation:e.showExcludedValues||"properties.modifier.showExcludedValues",schemaIgnore:!0,defaultValue:!0},nullSuppression:{refFn:function(e){return"".concat(V(e,t),".nullSuppression")},type:"boolean",translation:e.showNull||"properties.dimensions.showNull",schemaIgnore:!0,defaultValue:!1,inverted:!0}},show:function(t,e){return M.isApplicable({properties:e.properties})}}},show:function(e,n,r){var i=r.ext.support.modifiers;if(!Array.isArray(i)||-1===i.indexOf(j))return!1;var o=z(e,t);return o&&!o.disabled}};return n}},W="difference";function U(t,e){var n=s(t,e);if(n)for(var r=0;r<n.length;r++)if(n[r].type===W)return n[r]}function Y(t,e){var n=function(t,e){var n=s(t,e);if(!n)return-1;for(var r=0;r<n.length;r++)if(n[r].type===W)return r;return-1}(t,e);return n>-1?"".concat(e,".").concat(n):e}var $={type:"difference",disabled:!1,primaryDimension:0,crossAllDimensions:!1,showExcludedValues:!0,outputExpression:""},X={translationKey:"properties.modifier.difference",needDimension:M.needDimension,isApplicable:function(t){var e=t.properties,n=t.layout;return M.isApplicable({properties:e,layout:n,minDimensions:1,maxDimensions:2})},extractInputExpression:M.extractInputExpression,generateExpression:function(t){var e=t.expression,n=t.modifier,r=t.properties,i=t.layout,o=t.numDimensions,a=t.dimensionAndFieldList;if(!n)return e;var u=o;void 0===u&&(u=M.getNumDimensions({properties:r,layout:i}));var l=s(r,"qHyperCubeDef.qDimensions",[]),c=M.getExpressionWithExcludedComp({expression:e,modifier:n,dimensions:l,dimensionAndFieldList:a}),h=M.getAboveComp(n,u,c),f="".concat(c," - ").concat(h);if(M.needDimension({modifier:n,properties:r,layout:i})){var d=M.getDimComp(l,1),p=M.getDimComp(l,0),m=M.getAggrComp(f,d,p);f=n.showExcludedValues?M.getExcludedComp({modifier:n,dimensions:l,dimensionAndFieldList:a,funcComp:"Only",valueComp:m}):m}return f},initModifier:function(t){Object.keys($).forEach((function(e){void 0===t[e]&&(t[e]=$[e])}))},enableTotalsFunction:function(){return!1},propertyPanelDef:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={type:"items",items:{disclaimer:{component:"text",translation:e.disclaimer||"properties.modifier.difference.disclaimer",show:function(t,e){return!M.isApplicable({properties:e.properties})}},settings:{type:"items",items:{primaryDimension:{refFn:function(e){return"".concat(Y(e,t),".primaryDimension")},type:"integer",translation:e.primaryDimension||"properties.modifier.primaryDimension",title:{translation:e.primaryDimensionTooltip||"properties.modifier.difference.primaryDimension.tooltip"},component:"dropdown",schemaIgnore:!0,defaultValue:1,options:function(t,e){return e.layout.qHyperCube.qDimensionInfo.map((function(t,e){return{value:e,label:t.qGroupFallbackTitles[0]}}))},show:function(t,e){return e.layout.qHyperCube.qDimensionInfo.length>1}},crossAllDimensions:{refFn:function(e){return"".concat(Y(e,t),".crossAllDimensions")},type:"boolean",translation:e.crossAllDimensions||"properties.modifier.crossAllDimensions",title:{translation:e.crossAllDimensionsTooltip||"properties.modifier.difference.crossAllDimensions.tooltip"},schemaIgnore:!0,defaultValue:!1,show:function(t,e){return e.layout.qHyperCube.qDimensionInfo.length>1}},showExcludedValues:{refFn:function(e){return"".concat(Y(e,t),".showExcludedValues")},type:"boolean",translation:e.showExcludedValues||"properties.modifier.showExcludedValues",schemaIgnore:!0,defaultValue:!0}},show:function(t,e){return M.isApplicable({properties:e.properties})}}},show:function(e,n,r){var i=r.ext.support.modifiers;if(!Array.isArray(i)||-1===i.indexOf(W))return!1;var o=U(e,t);return o&&!o.disabled}};return n}},G={CURRENT_SELECTION:0,SELECT_FIELD_VALUE:1,DISREGARD_SELECTION:2},K={ONE_DIMENSION:0,ALL_DIMENSIOANS:1,DISREGARD_ALL_DIMENSIONS:2},J="normalization";function Z(t,e){var n=s(t,e);if(n)for(var r=0;r<n.length;r++)if(n[r].type===J)return n[r]}function Q(t,e){var n=function(t,e){var n=s(t,e);if(!n)return-1;for(var r=0;r<n.length;r++)if(n[r].type===J)return r;return-1}(t,e);return n>-1?"".concat(e,".").concat(n):e}function tt(t,e){for(var n=0;n<t.length;n++)if(t[n].value===e)return n;return-1}function et(t,e,n,r){var i=e.layout.qHyperCube.qDimensionInfo.length,o=[{value:K.ONE_DIMENSION,translation:n.dimensionalScopeOneDimension||"properties.modifier.dimensionalScope.respectOneDimension",tooltipTranslation:n.dimensionalScopeOneDimensionTooltip||"properties.modifier.dimensionalScope.respectOneDimension.tooltip"},{value:K.ALL_DIMENSIOANS,translation:n.dimensionalScopeAllDimensions||"properties.modifier.dimensionalScope.".concat(2===i?"respectAllDimensions":"respectDimension"),tooltipTranslation:n.dimensionalScopeAllDimensionsTooltip||"properties.modifier.dimensionalScope.".concat(2===i?"respectAllDimensions":"respectDimension",".tooltip")},{value:K.DISREGARD_ALL_DIMENSIONS,translation:n.dimensionalScopeDisregardAllDimensions||"properties.modifier.dimensionalScope.".concat(2===i?"disregardAllDimensions":"disregardDimension"),tooltipTranslation:n.dimensionalScopeDisregardAllDimensionsTooltip||"properties.modifier.dimensionalScope.".concat(2===i?"disregardAllDimensions":"disregardDimension",".tooltip")}];return o=function(t,e,n){if(t<2){var r=tt(e,0);e.splice(r,1)}return e}(i,o),function(t,e,n){if(0===t){var r=tt(e,1);e.splice(r,1)}return e}(Z(t,r).selectionScope,o)}function nt(t,e,n){var r=[{value:G.CURRENT_SELECTION,translation:e.selectionScopeCurrentSelection||"properties.modifier.selectionScope.currentSelection"},{value:G.SELECT_FIELD_VALUE,translation:e.selectionScopeSpecificValue||"properties.modifier.selectionScope.selectAField"},{value:G.DISREGARD_SELECTION,translation:e.selectionScopeTotal||"properties.modifier.selectionScope.total"}];return function(t,e,n){if(1===t){var r=tt(e,0);e.splice(r,1)}return e}(Z(t,n).dimensionalScope,r)}var rt={type:"normalization",disabled:!1,primaryDimension:0,outputExpression:"",dimensionalScope:K.DISREGARD_ALL_DIMENSIONS,selectionScope:G.DISREGARD_SELECTION};function it(t){return 2===t?"{1}":""}function ot(t,e,n){return 1===t?"{$<".concat(M.getFieldWithWrapper(e),"={'").concat(n,"'}>}"):""}function at(t,e){return 0===t&&e>1||2===t?"Total":""}function st(t,e,n){return 0===t&&e>1?"<".concat(M.getDimDefWithWrapper(n),">"):""}var ut={translationKey:"properties.modifier.normalization",needDimension:function(){return!0},isApplicable:function(t){var e=t.properties,n=t.layout;return M.isApplicable({properties:e,layout:n,minDimensions:1,maxDimensions:2})},extractInputExpression:M.extractInputExpression,generateExpression:function(t){var e=t.expression,n=t.modifier,r=t.properties,i=t.layout,o=t.numDimensions,a=t.dimensionAndFieldList;if(!n)return e;var u=o;void 0===u&&(u=M.getNumDimensions({properties:r,layout:i}));var l=s(r,"qHyperCubeDef.qDimensions",[]),c=M.getExpressionWithExcludedComp({expression:e,modifier:n,dimensions:l,dimensionAndFieldList:a}),h=n.selectionScope,f=n.dimensionalScope;return function(t,e,n,r,i,o,a){var s=it(e),u=ot(e,n,r),l=""===s&&""===u?"":s||u,c=at(i,o),h=st(i,o,a),f=function(t){for(var e=[],n=0;n<t;n++)e[n]=M.getDimDefWithWrapper(n);return e.join(", ")}(o);return"".concat(t,"/ Sum(").concat(l," ").concat(c).concat(h," Aggr(").concat(l," ").concat(t,", ").concat(f,"))")}(c,h,n.field,n.value,f,u,n.primaryDimension)},initModifier:function(t){Object.keys(rt).forEach((function(e){void 0===t[e]&&(t[e]=rt[e])}))},updateModifier:function(t,e){1===(e.qDimensions?e.qDimensions.length:0)&&0===t.dimensionalScope&&(t.dimensionalScope=2)},enableTotalsFunction:function(){return!0},propertyPanelDef:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={type:"items",items:{disclaimer:{component:"text",translation:e.disclaimer||"properties.modifier.normalization.disclaimer",show:function(t,e){return!M.isApplicable({properties:e.properties})}},settings:{type:"items",items:{selectionScope:{refFn:function(e){return"".concat(Q(e,t),".selectionScope")},type:"string",translation:e.modifierSelectionScope||"properties.modifier.selectionScope",title:{translation:e.modifierSelectionScopeTooltip||"properties.modifier.selectionScope.tooltip"},component:"dropdown",schemaIgnore:!0,defaultValue:G.DISREGARD_SELECTION,options:function(n){return nt(n,e,t)}},field:{refFn:function(e){return"".concat(Q(e,t),".field")},type:"string",component:"expression-with-dropdown",translation:"Common.Field",defaultValue:"",dropdownOnly:!0,options:function(t,e,n){return n.app.getFieldList().then((function(t){return t.map((function(t){return{label:t.qName,value:t.qName}}))}))},show:function(e){return Z(e,t).selectionScope===G.SELECT_FIELD_VALUE}},value:{refFn:function(e){return"".concat(Q(e,t),".value")},type:"string",ref:"value",component:"string",translation:"properties.value",expression:"optional",show:function(e){return Z(e,t).selectionScope===G.SELECT_FIELD_VALUE}},dimensionalScope:{refFn:function(e){return"".concat(Q(e,t),".dimensionalScope")},type:"string",translation:e.modifierDimensionalScope||"properties.modifier.dimensionalScope",title:{translation:e.modifierDimensionalScopeTooltip||"properties.modifier.dimensionalScope.tooltip"},component:"dropdown",schemaIgnore:!0,defaultValue:K.DISREGARD_ALL_DIMENSIONS,supportTooltip:!0,options:function(n,r){return et(n,r,e,t)}},primaryDimension:{refFn:function(e){return"".concat(Q(e,t),".primaryDimension")},type:"integer",translation:e.primaryDimension||"properties.modifier.primaryDimension",title:{translation:e.primaryDimensionTooltip||"properties.modifier.normalization.primaryDimension.tooltip"},component:"dropdown",schemaIgnore:!0,defaultValue:1,options:function(t,e){return e.layout.qHyperCube.qDimensionInfo.map((function(t,e){return{value:e,label:t.qGroupFallbackTitles[0]}}))},show:function(e,n){return(Z(e,t).dimensionalScope||0)===K.ONE_DIMENSION&&n.layout.qHyperCube.qDimensionInfo.length>1}}},show:function(t,e){return M.isApplicable({properties:e.properties})}}},show:function(e,n,r){var i=r.ext.support.modifiers;if(!Array.isArray(i)||-1===i.indexOf(J))return!1;var o=Z(e,t);return o&&!o.disabled}};return n},getDisregardSelectionComp:it,getFieldSelectionComp:ot,getTotalComp:at,getSelectedDimComp:st},lt={getExpression:function(t){return s(t,"qDef.base.qDef")||s(t,"qDef.qDef")},getExpressionRef:function(t){return s(t,"qDef.base.qDef")?"qDef.base.qDef":"qDef.qDef"},getLibraryIdRef:function(t){return s(t,"qDef.base.qLibraryId")?"qDef.base.qLibraryId":"qLibraryId"},getLibraryId:function(t){return s(t,"qDef.base.qLibraryId")||s(t,"qLibraryId")},getLabelRef:function(t){return s(t,"qDef.base")?"qDef.base.qLabel":"qDef.qLabel"},getLabelExpressionRef:function(t){return s(t,"qDef.base")?"qDef.base.qLabelExpression":"qDef.qLabelExpression"}},ct={initBase:function(t,e){(e||ct.isValid(t))&&(a(t,"qDef.base.qDef",s(t,"qDef.qDef")),a(t,"qDef.base.qLibraryId",s(t,"qLibraryId")),a(t,"qDef.base.qLabel",s(t,"qDef.qLabel")),a(t,"qDef.base.qLabelExpression",s(t,"qDef.qLabelExpression")))},restoreBase:function(t){ct.isValid(t)&&(a(t,"qDef.qDef",s(t,"qDef.base.qDef")),a(t,"qLibraryId",s(t,"qDef.base.qLibraryId")),a(t,"qDef.qLabel",s(t,"qDef.base.qLabel")),a(t,"qDef.qLabelExpression",s(t,"qDef.base.qLabelExpression")),s(t,"qDef.qAggrFunc")&&s(t,"qDef.base.qAggrFunc")&&a(t,"qDef.qAggrFunc",s(t,"qDef.base.qAggrFunc")),delete t.qDef.base)},isValid:function(t){var e=s(t,"qDef.base.qDef"),n=s(t,"qDef.base.qLibraryId");return void 0!==e||void 0!==n}},ht=ct;function ft(t){return(ft="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}var dt={accumulation:L,movingAverage:B,difference:X,normalization:ut},pt=(e.default={modifiers:dt,apply:mt,applyModifiers:gt,cleanUpMeasure:yt,destroy:function(t){t&&pt[t.id]&&pt[t.id].masterItemSubscriber&&(pt[t.id].masterItemSubscriber&&pt[t.id].masterItemSubscriber.unsubscribe(),delete pt[t.id])},hasActiveModifiers:vt,getActiveModifier:xt,initBase:ht.initBase,isSupportedModifiers:function(t){return Array.isArray(t)&&t.some((function(t){return dt[t]}))},isApplicableSupportedModifiers:function(t){var e=t.modifierTypes,n=t.properties,r=t.layout;return Array.isArray(e)&&e.some((function(t){return dt[t]&&dt[t].isApplicable({properties:n,layout:r})}))},measureBase:lt,limitedSorting:function(t){var e=t.measures,n=t.properties,r=t.layout,i=!1,o=!1;return e.forEach((function(t){var e=Mt(t);Et({modifiers:e,properties:n,layout:r})&&(i=!0,o=o||Tt({modifiers:e,properties:n,layout:r}))})),i&&!o},ifEnableTotalsFunction:bt},{});function mt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.model,n=t.properties,r=t.isSnapshot,i=void 0!==r&&r,a=t.masterItem;pt[e.id]=pt[e.id]||{isFirstTime:!0};var u=pt[e.id].isFirstTime;if(pt[e.id].isFirstTime=!1,n&&"object"===ft(n))return gt({model:e,properties:n});var l=e?e.layout:void 0,c=s(l,"qSelectionInfo.qInSelections");if(i||c)return Promise.resolve(!1);var h=s(l,"qHyperCube.qMeasureInfo"),f=pt[e.id].lastReloadTime;if(pt[e.id].lastReloadTime=s(e,"app.layout.qLastReloadTime"),vt({measures:h,layout:l})){var d=function(t){var e=t.measures,n=t.layout,r=t.lastReloadTime;return s(t.model,"app.layout.qLastReloadTime")!==r&&function(t){var e=t.measures,n=t.properties,r=t.layout;return!!Array.isArray(e)&&e.some((function(t){return Ct({measure:t,properties:n,layout:r})}))}({measures:e,layout:n})}({measures:h,layout:l,model:e,lastReloadTime:f});return d||function(t){var e=t.measures,n=t.layout,r=t.masterItem,i=t.isFirstTime;return!!Array.isArray(e)&&(i||r||e.some((function(t){return function(t){var e=t.measure,n=t.layout;return Et({modifiers:Mt(e),layout:n})?!e.base:!!e.base}({measure:t,layout:n})})))}({measures:h,layout:l,masterItem:a,isFirstTime:u})?e.getEffectiveProperties().then((function(t){var n=o()(!0,{},t);_t(n);var r=Rt(n);return At({model:e}).then((function(i){return Nt({libraryIds:r,model:e}).then((function(r){return d&&function(t){var e=t.properties;wt(e).forEach((function(t){return function(t){var e=t.measure;if(Ct({measure:e,properties:t.properties})){var n=0,r=e.qDef.modifiers;Array.isArray(r)&&r.forEach((function(t){if("object"===ft(t)&&!t.disabled){if(n++,"object"!==ft(dt[t.type]))throw new Error('Modifier "'.concat(t.type,'" is not available'));if(n>1)throw new Error("More than 1 modifier on a measure! (not yet supported)");var r=dt[t.type].extractInputExpression({outputExpression:e.qDef.qDef,modifier:t});void 0!==r&&Dt(e)&&M.simplifyExpression(e.qDef.base.qDef)!==M.simplifyExpression(r)&&(e.qDef.base.qDef=r)}}))}}({measure:t,properties:e})}))}({properties:n}),gt({model:e,oldProperties:t,properties:n,runUpdateIfChange:!0,masterItem:a,libraryItemsProps:r,dimensionAndFieldList:i})}))}))})):Promise.resolve(!1)}return function(t){return!!Array.isArray(t)&&t.some((function(t){return"object"===ft(t.base)}))}(h)?e.getEffectiveProperties().then((function(t){return function(t){var e=t.model,n=t.properties,r=Rt(n);return Pt({model:e,libraryIds:r}).then((function(){var t=o()(!0,{},n);return wt(n).forEach((function(t){return yt(t)})),It({oldProperties:t,newProperties:n,model:e})}))}({model:e,properties:t})})):Promise.resolve(!1)}function gt(t){var e=t.model,n=t.oldProperties,r=t.properties,i=t.measures,a=t.runUpdateIfChange,u=void 0!==a&&a,l=t.masterItem,c=t.libraryItemsProps,h=t.dimensionAndFieldList;void 0===n&&(n=u?o()(!0,{},r):r),_t(r);var f=Rt(r);return Pt({model:e,libraryIds:f,masterItem:l}).then((function(){return function(t){var e=t.measures,n=t.properties,r=t.model,i=t.libraryItemsProps,a=t.dimensionAndFieldList;if(e||(e=wt(n)),!e.length)return Promise.resolve();if(!vt({measures:e,properties:n}))return e.forEach((function(t){return yt(t)})),Promise.resolve();var u=i?void 0:Rt(n);return At({model:r,dimensionAndFieldList:a}).then((function(t){return Nt({libraryIds:u,model:r,libraryItemsProps:i}).then((function(r){e.forEach((function(e){Et({modifiers:e.qDef.modifiers,properties:n})?(function(t){var e=t.measure,n=t.properties,r=t.libraryItemsProps,i=t.dimensionAndFieldList,a=0;ht.isValid(e)||ht.initBase(e,!0);var u=e.qDef,l=u.modifiers,c=u.base;Array.isArray(l)&&l.forEach((function(t){if("object"===ft(t)&&!t.disabled){if(a++,"object"!==ft(dt[t.type]))throw new Error('Modifier "'.concat(t.type,'" is not available'));if(a>1)throw new Error("More than 1 modifier on a measure! (not yet supported)");dt[t.type].initModifier(t);var u=e.qLibraryId||c&&c.qLibraryId;u?function(t){var e=t.measure,n=t.modifier,r=t.properties,i=t.dimensionAndFieldList,a=t.libraryItemsProps[t.libraryId],s=a.qMeasure.qDef,u=dt[n.type].generateExpression({expression:s,modifier:n,properties:r,dimensionAndFieldList:i});n.outputExpression=u,e.qDef.qDef=n.outputExpression,(e.qDef.qLabel||a.qMeasure.qLabel)&&(e.qDef.qLabel=a.qMeasure.qLabel),(e.qDef.qLabelExpression||a.qMeasure.qLabelExpression)&&(e.qDef.qLabelExpression=a.qMeasure.qLabelExpression),e.qDef.quarantine&&e.qDef.quarantine.qNumFormat&&a.qMeasure.qNumFormat&&(e.qDef.qNumFormat=a.qMeasure.qNumFormat,e.qDef.isCustomFormatted=a.qMeasure.isCustomFormatted),delete e.qLibraryId,e.qDef.coloring=a.qMeasure.coloring,n.base=o()(!0,{},e.qDef.base)}({measure:e,modifier:t,libraryId:u,properties:n,libraryItemsProps:r,dimensionAndFieldList:i}):function(t){var e=t.measure,n=t.modifier,r=t.properties,i=t.dimensionAndFieldList;"function"==typeof dt[n.type].updateModifier&&dt[n.type].updateModifier(n,r.qHyperCubeDef);var a=lt.getExpression(e),s=dt[n.type].generateExpression({expression:a,modifier:n,properties:r,dimensionAndFieldList:i});n.outputExpression=s,e.qDef.qDef=n.outputExpression,e.qDef.base.qLabelExpression?e.qDef.qLabelExpression=e.qDef.base.qLabelExpression:e.qDef.qLabel=e.qDef.base.qLabel||a,n.base=o()(!0,{},e.qDef.base)}({measure:e,modifier:t,properties:n,dimensionAndFieldList:i}),function(t){var e=s(t,"qDef.qAggrFunc");"Expr"!==e||bt(t)?"None"!==e?delete t.qDef.base.qAggrFunc:"None"===e&&bt(t)&&"Expr"===t.qDef.base.qAggrFunc&&(t.qDef.qAggrFunc="Expr",delete t.qDef.base.qAggrFunc):(t.qDef.qAggrFunc="None",t.qDef.base.qAggrFunc="Expr")}(e)}}))}({measure:e,properties:n,libraryItemsProps:r,dimensionAndFieldList:t}),qt(e)):yt(e)}))}))}))}({measures:i,properties:r,model:e,libraryItemsProps:c,dimensionAndFieldList:h}).then((function(){return u?It({oldProperties:n,newProperties:r,model:e}):Promise.resolve(!1)}))}))}function yt(t){!function(t){var e=Mt(t);return Array.isArray(e)&&e.some((function(t){return"object"===ft(t)&&!t.disabled&&!dt[t.type]}))}(t)?ht.restoreBase(t):delete t.qDef.base,t.qDef.coloring&&delete t.qDef.coloring,qt(t)}function vt(t){var e=t.measures,n=t.properties,r=t.layout;return!!Array.isArray(e)&&e.some((function(t){return Et({modifiers:Mt(t),properties:n,layout:r})}))}function xt(t){var e=Mt(t);if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];if(dt[r.type]&&!r.disabled)return r}}function bt(t){var e=xt(t);return!e||dt[e.type].enableTotalsFunction(t)}function wt(t){return s(t,"qHyperCubeDef.qMeasures",[]).concat(s(t,"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures",[]))}function Mt(t){return t.modifiers||t.qDef&&t.qDef.modifiers}function kt(t){return s(t,"outputExpression.qValueExpression.qExpr")||s(t,"outputExpression")}function _t(t){wt(t).forEach((function(t){return function(t){var e=xt(t);e&&(void 0!==e.outputExpression&&kt(e)!==t.qDef.qDef?delete t.qDef.base:!ht.isValid(t)&&e.base&&(t.qDef.base=o()(!0,{},e.base)))}(t)}))}function qt(t){var e=Mt(t);Array.isArray(e)&&e.forEach((function(e){"object"===ft(e)&&(e.disabled||!dt[e.type]&&kt(e)!==t.qDef.qDef)&&(e.disabled=!0,delete e.base)}))}function Dt(t){return t.base||t.qDef&&t.qDef.base}function St(t){var e=Dt(t);return t.qLibraryId||e&&e.qLibraryId}function Ct(t){var e=t.measure,n=t.properties,r=t.layout;return!St(e)&&Et({modifiers:Mt(e),properties:n,layout:r})}function Et(t){var e=t.modifiers,n=t.properties,r=t.layout,i={};return Array.isArray(e)&&e.some((function(t){return!("object"!==ft(t)||t.disabled||!dt[t.type])&&(void 0===i[t.type]&&(i[t.type]=dt[t.type].isApplicable({properties:n,layout:r})),i[t.type])}))}function At(t){var e=t.model,n=t.dimensionAndFieldList;if(n)return Promise.resolve(n);var r=[],i={},o=e.app.getDimensionList().then((function(t){i.dimensionList=t}));r.push(o);var a=e.app.getFieldList().then((function(t){i.fieldList=t}));return r.push(a),Promise.all(r).then((function(){return i}))}function Nt(t){var e=t.libraryIds,n=t.model,r=t.libraryItemsProps;if(r)return Promise.resolve(r);var i=e.measureLibraryIds,o=e.dimensionLibraryIds,a={},s=[];return i.forEach((function(t){var e=n.app.getMeasure(t).then((function(e){return e.getProperties().then((function(e){a[t]=e}))}));s.push(e)})),o.forEach((function(t){var e=n.app.getDimension(t).then((function(e){return e.getProperties().then((function(e){a[t]=e}))}));s.push(e)})),Promise.all(s).then((function(){return a}))}function Ot(t,e){if(""!==e||-1===["qFmt","qDec","qThou"].indexOf(t))return e}function It(t){var e=t.oldProperties,n=t.newProperties,r=t.model,i=JSON.stringify(s(e,"qHyperCubeDef.qMeasures"),Ot)!==JSON.stringify(s(n,"qHyperCubeDef.qMeasures"),Ot)||JSON.stringify(s(e,"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures"),Ot)!==JSON.stringify(s(n,"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures"),Ot);return i?function(t){var e=t.model,n=t.oldProperties,r=t.newProperties,i=e.layout;return i&&!i.qHasSoftPatches&&!i.qExtendsId&&s(i,"qMeta.privileges",[]).indexOf("update")>-1?e.setProperties(r):I(e,n,r)}({model:r,oldProperties:e,newProperties:n}).then((function(){return i})):Promise.resolve(i)}function Tt(t){var e=t.modifiers,n=t.properties,r=t.layout;return Array.isArray(e)&&e.some((function(t){return"object"===ft(t)&&!t.disabled&&dt[t.type]&&dt[t.type].needDimension({modifier:t,properties:n,layout:r})}))}function Rt(t){var e=wt(t),n=[],r=[],i=!1;return e.forEach((function(e){var r=Mt(e);if(Et({modifiers:r,properties:t})){var o=St(e);o&&n.push(o),i=i||Tt({modifiers:r,properties:t})}})),s(t,"qHyperCubeDef.qDimensions",[]).forEach((function(t){var e=t.qLibraryId;e&&r.push(e)})),{measureLibraryIds:n,dimensionLibraryIds:r}}function Pt(t){var e=t.model,n=t.libraryIds;return!t.masterItem&&n&&(n.measureLibraryIds.length||n.dimensionLibraryIds.length)?(pt[e.id].masterItemSubscriber=pt[e.id].masterItemSubscriber||function(t){var e=t.model,n=t.callback,r={},i={},o={},a={dimension:["qDim.qFieldDefs"],measure:["qMeasure.qDef","qMeasure.qLabel","qMeasure.qLabelExpression","qMeasure.coloring","qMeasure.qNumFormat","qMeasure.isCustomFormatted"]};function u(t){var e={},n=s(t,"qInfo.qType");return n&&a[n]&&a[n].forEach((function(n){e[n]=s(t,n)})),JSON.stringify(e)}function l(t){var e=t.qInfo.qId;if(r[e]){var i=u(t);r[e].properties!==i&&(r[e].properties=i,"function"==typeof n&&r[e].enabled&&n(t)),r[e].enabled=!0}}function c(t,n){return e.app[n](t).then((function(e){r[t]={listener:e.layoutSubscribe(l),enabled:!1,properties:u(e.layout)}}))}return{subscribe:function(t){var n=t.measureLibraryIds,a=t.dimensionLibraryIds,s=[];return function(t){var e=t.dimensionLibraryIds;i={},t.measureLibraryIds.forEach((function(t){i[t]=!0})),o={},e.forEach((function(t){o[t]=!0}))}({measureLibraryIds:n,dimensionLibraryIds:a}),Object.keys(r).forEach((function(t){i[t]||o[t]||(r[t].listener.dispose(),delete r[t])})),e.app&&(Object.keys(i).forEach((function(t){i[t]&&!r[t]&&s.push(c(t,"getMeasure"))})),Object.keys(o).forEach((function(t){o[t]&&!r[t]&&s.push(c(t,"getDimension"))}))),Promise.all(s)},unsubscribe:function(){Object.keys(r).forEach((function(t){r[t].listener.dispose()})),r={}}}}({model:e,callback:function(t){return mt({model:e,masterItem:t}).then((function(){return e.app.clearUndoBuffer()}))}}),pt[e.id].masterItemSubscriber.subscribe(n)):Promise.resolve()}}])},function(t,e,n){function r(t){var e=function t(e){var n,r=e;return r>9?(n=65+r-10)>90&&(n+=6):r="".concat(r).charCodeAt(0),[48,111,79,105,73,108].indexOf(n)>-1?t(r+1):String.fromCharCode(n)}(t%62),n=Math.floor(t/62);return n>0?r(n)+e:e}function o(t){return(o="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}n.r(e);var a={getValue:function(t,e,n){if(null==t||null==e)return n;for(var r=e.split("."),i=t,o=0;o<r.length;++o){var a=r[o];if(""!==a){if(void 0===i[a]||null===i[a])return n;i=i[a]}}return i},setValue:function(t,e,n){if(null!=t&&null!=e){for(var r=e.split("."),i=r[r.length-1],o=t,a=0;a<r.length-1;++a){var s=r[a];void 0!==o[s]&&null!==o[s]||(o[s]=Number.isNaN(+r[a+1])?{}:[]),o=o[s]}void 0!==n?o[i]=n:delete o[i]}},isEmpty:function(t){return 0===Object.keys(t).length&&t.constructor===Object},isAtomicValue:function(t){return/boolean|number|string/.test(o(t))},generateId:function(){return r(Math.round(99e11*Math.random()+1e11)).replace(/\W/g,"")}};function s(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e,n){if(t){for(var r=0;r<t.length;r++)if(t[r][e]===n)return r;return-1}return-1}var f={isOrderedSubset:function(t,e){if(!(t&&e&&t.length&&e.length))return!1;var n=t.indexOf(e[0]);if(-1!==n){for(var r=0;r<e.length;r++){var i=t.indexOf(e[r]);if(n>i)return!1;n=i}return!0}return!1},indexAdded:function(t,e){var n;for(n=0;n<t.length;++n)t[n]>=0&&t[n]>=e&&++t[n];t.push(e)},indexRemoved:function(t,e){var n,r=0;for(n=0;n<t.length;++n)t[n]>e?--t[n]:t[n]===e&&(r=n);return t.splice(r,1),r},findItemByPropertyValue:function(t,e,n){if(t){for(var r=0;r<t.length;r++)if(t[r][e]===n)return t[r];return null}return null},findIndexByPropertyValue:h},d=n(1),p=n.n(d),m={addDimensions:function(t){var e,n=t.exportFormat,r=t.qHyperCubeDef,i=n.data[0];(e=i.dimensions).push.apply(e,s(r.qDimensions));var o,u=a.getValue(r,"qLayoutExclude.qHyperCubeDef.qDimensions");u&&(o=i.excludedDimensions).push.apply(o,s(u))},addMeasures:function(t){var e,n=t.exportFormat,r=t.qHyperCubeDef,i=n.data[0];(e=i.measures).push.apply(e,l(r.qMeasures));var o,s=a.getValue(r,"qLayoutExclude.qHyperCubeDef.qMeasures");s&&(o=i.excludedMeasures).push.apply(o,l(s))},setInterColumnSortOrder:function(t){var e=t.exportFormat,n=t.qHyperCubeDef,r=e.data[0];n.qInterColumnSortOrder||(n.qInterColumnSortOrder=[]),r.interColumnSortOrder=n.qInterColumnSortOrder.concat();var i=a.getValue(n,"qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder");i&&f.isOrderedSubset(i,r.interColumnSortOrder)&&(r.interColumnSortOrder=i.concat())},copyProperties:function(t){var e=t.exportFormat,n=t.properties;Object.keys(n).forEach((function(t){e.properties[t]=n[t]}))},updateLayoutExclude:function(t){var e=t.exportFormat,n=t.properties;n.qLayoutExclude||(n.qLayoutExclude={}),n.qLayoutExclude.disabled&&(Object.keys(n.qLayoutExclude.disabled).forEach((function(t){e.properties.hasOwnProperty(t)||(e.properties[t]=n.qLayoutExclude.disabled[t])})),delete n.qLayoutExclude.disabled),n.qLayoutExclude.changed&&(function(t){Object.keys(t.qLayoutExclude.changed).forEach((function(e){t.qLayoutExclude.changed[e].to===a.getValue(t,e)&&a.setValue(t,e,t.qLayoutExclude.changed[e].from)}))}(n),delete n.qLayoutExclude.changed),n.qLayoutExclude.quarantine&&!a.isEmpty(n.qLayoutExclude.quarantine)||delete n.qLayoutExclude},storeMeasuresModifiers:function(t){t.forEach((function(t){p.a.cleanUpMeasure(t),t.qDef.modifiers&&(t.store={modifiers:t.qDef.modifiers},delete t.qDef.modifiers)}))}};function g(t,e,n){var r,i,o=a.getValue(t,e);if(!a.isAtomicValue(o))try{if((i=(i=(r=JSON.stringify(o)).match(/:\{/g))?i.length:0)>2)return;o=JSON.parse(r)}catch(t){return}a.getValue(t,"qLayoutExclude.quarantine")||a.setValue(t,"qLayoutExclude.quarantine",{});var s=a.getValue(t,"qLayoutExclude.quarantine");s[n]||(s[n]={}),s[n][e]=o}var y=n(0),v=n.n(y);function x(t,e){var n=v()(!0,{},e,t);return a.getValue(n,"qOtherTotalSpec.qOtherCounted")||a.setValue(n,"qOtherTotalSpec.qOtherCounted",{qv:"10"}),a.getValue(n,"qOtherTotalSpec.qOtherLimit")||a.setValue(n,"qOtherTotalSpec.qOtherLimit",{qv:"0"}),n.hasOwnProperty("othersLabel")||(n.othersLabel="Others"),n}function b(t,e){return v()(!0,{},e,t)}function w(t,e,n){return"function"==typeof t?t(e):Number.isNaN(+t)?n:t}var M=Math.pow(2,53)-1;function k(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S={importCommonProperties:function(t,e,n){var r="masterobject"===a.getValue(e,"properties.qInfo.qType")?"masterobject":a.getValue(n,"qInfo.qType");a.setValue(t,"qInfo.qType",r),t.visualization=n.visualization},copyPropertyIfExist:function(t,e,n){e.hasOwnProperty(t)&&(n[t]=e[t])},copyPropertyOrSetDefault:function(t,e,n,r){e.hasOwnProperty(t)?n[t]=e[t]:n[t]=r},getDefaultDimension:function(){return{qDef:{autoSort:!0,cId:"",othersLabel:"Others"},qLibraryId:"",qNullSuppression:!1,qOtherLabel:"Others",qOtherTotalSpec:{qOtherLimitMode:"OTHER_GE_LIMIT",qOtherMode:"OTHER_OFF",qOtherSortMode:"OTHER_SORT_DESCENDING",qSuppressOther:!1}}},getDefaultMeasure:function(){return{qDef:{autoSort:!0,cId:"",numFormatFromTemplate:!0},qLibraryId:"",qTrendLines:[]}},addDimensions:function(t){var e,n=t.exportFormat,r=t.maxDimensions,i=t.minDimensions,o=t.newHyperCubeDef,a=t.defaultDimension,s=n.data[0];for(e=0;e<s.dimensions.length;++e){var u=x(s.dimensions[e],a);o.qDimensions.length<r?o.qDimensions.push(u):o.qLayoutExclude.qHyperCubeDef.qDimensions.push(u)}for(e=0;e<s.excludedDimensions.length;++e){var l=x(s.excludedDimensions[e],a);o.qDimensions.length<i?o.qDimensions.push(l):o.qLayoutExclude.qHyperCubeDef.qDimensions.push(l)}},addMeasures:function(t){var e,n=t.exportFormat,r=t.maxMeasures,i=t.minMeasures,o=t.newHyperCubeDef,a=t.defaultMeasure,s=n.data[0];for(e=0;e<s.measures.length;++e){var u=b(s.measures[e],a);o.qMeasures.length<r?o.qMeasures.push(u):o.qLayoutExclude.qHyperCubeDef.qMeasures.push(u)}for(e=0;e<s.excludedMeasures.length;++e){var l=b(s.excludedMeasures[e],a);o.qMeasures.length<i?o.qMeasures.push(l):o.qLayoutExclude.qHyperCubeDef.qMeasures.push(l)}},getMaxMinDimensionMeasure:function(t){var e=t.exportFormat,n=t.dataDefinition,r=void 0===n?{}:n,i=e.data[0],o=r.dimensions||{max:0},a=r.measures||{max:0},s=w(a.max,i.dimensions.length,M),u=w(a.min,i.dimensions.length,0);return{maxDimensions:w(o.max,s,M),minDimensions:w(o.min,u,0),maxMeasures:s,minMeasures:u}},setInterColumnSortOrder:function(t){var e=t.exportFormat,n=t.newHyperCubeDef,r=e.data[0],i=n.qDimensions.length+n.qMeasures.length;n.qInterColumnSortOrder=r.interColumnSortOrder.concat();var o=n.qInterColumnSortOrder.length;if(o!==i)for(n.qLayoutExclude&&(n.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder=r.interColumnSortOrder.concat());o!==i;)o<i?(f.indexAdded(n.qInterColumnSortOrder,o),++o):(--o,f.indexRemoved(n.qInterColumnSortOrder,o))},createNewProperties:function(t){var e=t.exportFormat,n=t.initialProperties,r=t.hypercubePath,i={qLayoutExclude:{disabled:{},quarantine:{}}};return Object.keys(e.properties).forEach((function(t){"qLayoutExclude"===t?e.properties[t].quarantine&&(i.qLayoutExclude.quarantine=v()(!0,{},e.properties[t].quarantine)):"qHyperCubeDef"===t&&r?a.setValue(i,"".concat(r,".qHyperCubeDef"),e.properties.qHyperCubeDef):n.hasOwnProperty(t)||-1!==["qMetaDef","descriptionExpression","labelExpression"].indexOf(t)||function(t,e){return"components"===e&&Array.isArray(t[e])&&t[e].some((function(t){return"general"===t.key}))}(e.properties,t)?i[t]=e.properties[t]:i.qLayoutExclude.disabled[t]=e.properties[t]})),null===(i=v()(!0,{},n,i)).components&&(i.components=[]),i},shouldInitLayoutExclude:function(t){var e=t.exportFormat,n=t.maxDimensions,r=t.minDimensions,i=t.maxMeasures,o=t.minMeasures,a=e.data[0];return a.dimensions.length>n&&n>0||a.measures.length>i&&i>0||a.excludedDimensions.length>0&&a.dimensions.length+a.excludedDimensions.length>r||a.excludedMeasures.length>0&&a.measures.length+a.excludedMeasures.length>o||!i&&a.measures.length>0||!n&&a.dimensions.length>0},initLayoutExclude:function(t){var e=t.exportFormat,n=t.maxDimensions,r=t.minDimensions,i=t.maxMeasures,o=t.minMeasures,a=t.newHyperCubeDef,s=e.data[0];a.qLayoutExclude||(a.qLayoutExclude={}),a.qLayoutExclude.qHyperCubeDef||(a.qLayoutExclude.qHyperCubeDef={}),(s.dimensions.length>n&&n>0||s.excludedDimensions&&s.excludedDimensions.length&&s.dimensions.length+s.excludedDimensions.length>r)&&(a.qLayoutExclude.qHyperCubeDef.qDimensions||(a.qLayoutExclude.qHyperCubeDef.qDimensions=[])),(s.measures.length>i&&i>0||s.excludedMeasures&&s.excludedMeasures.length&&s.measures.length+s.excludedMeasures.length>o)&&(a.qLayoutExclude.qHyperCubeDef.qMeasures||(a.qLayoutExclude.qHyperCubeDef.qMeasures=[])),!i&&s.measures.length&&(a.qLayoutExclude.qHyperCubeDef.qMeasures||(a.qLayoutExclude.qHyperCubeDef.qMeasures=[])),!n&&s.dimensions.length&&(a.qLayoutExclude.qHyperCubeDef.qDimensions||(a.qLayoutExclude.qHyperCubeDef.qDimensions=[]))},updateDimensionsOnAdded:function(t){var e=t.newProperties,n=t.dataDefinition,r=t.hypercubePath;if(n.dimensions&&"function"==typeof n.dimensions.added){var i=a.getValue(e,r||"").qHyperCubeDef,o=k(i.qDimensions);i.qDimensions=[],o.forEach((function(t){i.qDimensions.push(t),n.dimensions.added(t,e)}))}},updateMeasuresOnAdded:function(t){var e=t.newProperties,n=t.dataDefinition,r=t.hypercubePath;if(n.measures&&"function"==typeof n.measures.added){var i=a.getValue(e,r||"").qHyperCubeDef,o=q(i.qMeasures);i.qMeasures=[],o.forEach((function(t){i.qMeasures.push(t),n.measures.added(t,e)}))}},restoreMeasuresModifiers:function(t){var e=t.measures,n=t.modifierTypes;e&&n&&p.a.isSupportedModifiers(n)&&e.forEach((function(t){t.store&&t.store.modifiers&&(t.qDef.modifiers=t.store.modifiers),delete t.store}))}};function C(t,e){var n=a.getValue(t,"qLayoutExclude.quarantine",{})[e];return!!n&&(Object.keys(n).forEach((function(e){a.setValue(t,e,n[e])})),delete t.qLayoutExclude.quarantine[e],!0)}var E={exportProperties:function(t){var e=t.propertyTree,n=t.hypercubePath,r=t.viewDataMode,i=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e={data:[],properties:{}},n=0;n<t;++n)e.data.push({dimensions:[],measures:[],excludedDimensions:[],excludedMeasures:[],interColumnSortOrder:[]});return e}(),o=e.qProperty,s=a.getValue(o,n||""),u=s.qHyperCubeDef;return u.qInterColumnSortOrder||(u.qInterColumnSortOrder=[]),m.addDimensions({exportFormat:i,qHyperCubeDef:u}),m.addMeasures({exportFormat:i,qHyperCubeDef:u}),m.setInterColumnSortOrder({exportFormat:i,qHyperCubeDef:u}),delete u.qLayoutExclude,m.copyProperties({exportFormat:i,properties:o}),n&&(i.properties.qHyperCubeDef=u,delete s.qHyperCubeDef),m.updateLayoutExclude({exportFormat:i,properties:o}),r||m.storeMeasuresModifiers(i.properties.qHyperCubeDef.qMeasures),Array.isArray(i.properties.filters)&&(g(i.properties,"filters","storedFilters"),delete i.properties.filters),i.properties.qHyperCubeDef.qContextSetExpression&&(g(i.properties,"qHyperCubeDef.qContextSetExpression","storedFilters"),i.properties.qHyperCubeDef.qContextSetExpression=""),i.properties.qHyperCubeDef.qDynamicScript&&i.properties.qHyperCubeDef.qDynamicScript.length&&(g(i.properties,"qHyperCubeDef.qDynamicScript","dynamicScript"),i.properties.qHyperCubeDef.qDynamicScript=[]),i},importProperties:function(t){var e=t.exportFormat,n=t.initialProperties,r=void 0===n?{}:n,i=t.dataDefinition,o=void 0===i?{}:i,s=t.defaultPropertyValues,u=void 0===s?{}:s,l=t.hypercubePath,c=t.extension,h=t.supportedFilters,f=void 0===h||h,d=t.isHCModifierSupported,p=void 0===d||d,m={qChildren:[]},g=S.createNewProperties({exportFormat:e,initialProperties:r,hypercubePath:l}),y=a.getValue(r,l||"").qHyperCubeDef,v=a.getValue(g,l||"").qHyperCubeDef,x=S.getMaxMinDimensionMeasure({exportFormat:e,dataDefinition:o}),b=x.maxDimensions,w=x.minDimensions,M=x.maxMeasures,k=x.minMeasures,_=u.defaultDimension,q=void 0===_?S.getDefaultDimension():_,D=u.defaultMeasure,E=void 0===D?S.getDefaultMeasure():D;v.qDimensions.length=0,v.qMeasures.length=0,S.shouldInitLayoutExclude({exportFormat:e,maxDimensions:b,minDimensions:w,maxMeasures:M,minMeasures:k})&&S.initLayoutExclude({exportFormat:e,maxDimensions:b,minDimensions:w,maxMeasures:M,minMeasures:k,newHyperCubeDef:v}),S.addDimensions({exportFormat:e,maxDimensions:b,minDimensions:w,newHyperCubeDef:v,defaultDimension:q}),S.addMeasures({exportFormat:e,maxMeasures:M,minMeasures:k,newHyperCubeDef:v,defaultMeasure:E}),S.updateDimensionsOnAdded({newProperties:g,dataDefinition:o,hypercubePath:l}),S.updateMeasuresOnAdded({newProperties:g,dataDefinition:o,hypercubePath:l}),S.setInterColumnSortOrder({exportFormat:e,newHyperCubeDef:v}),S.copyPropertyIfExist("qMaxStackedCells",y,v),S.copyPropertyIfExist("qNoOfLeftDims",y,v),S.copyPropertyOrSetDefault("qInitialDataFetch",y,v,[{qTop:0,qLeft:0,qWidth:0,qHeight:0}]),S.copyPropertyOrSetDefault("qMode",y,v,"S"),S.copyPropertyOrSetDefault("qReductionMode",y,v,"N"),S.copyPropertyOrSetDefault("qSortbyYValue",y,v),S.copyPropertyOrSetDefault("qIndentMode",y,v),S.copyPropertyOrSetDefault("qShowTotalsAbove",y,v),S.importCommonProperties(g,e,r),m.qProperty=g;var A=a.getValue(c||{},"support.modifiers");return S.restoreMeasuresModifiers({measures:v.qMeasures,modifierTypes:A}),f&&C(m.qProperty,"storedFilters"),"S"===v.qMode&&p&&C(m.qProperty,"dynamicScript"),m}},A={cellBackgroundColor:!0,cellForegroundColor:!0,colorByAlternative:!0,colorByExpression:!0,tooltip:!0,urlLabel:!0,url:!0};function N(t,e,n,r){e=e||[];var i=h(t,r,n),o=h(e,r,n);if(-1!==i&&-1===o){var a=t.splice(i,1);e.push(a[0])}return e}function O(t,e){return t.length!==e}var I={create:function(t,e){if(!t||!A[t])throw new Error("Attribute Expressions Util: ID required");var n={};return e&&Object.keys(e).forEach((function(t){n[t]=e[t]})),n.id=t,n.qAttribute=!0,n},moveByIdFromGroup:function(t,e,n,r,i){n=n||"qAttributeExpressions",i=i||"id";for(var o=0;o<t.length;o++){var a=t[o][n],s=e.length;if(N(a,e,r,i),O(e,s))return e}return e},IDMAP:{CELL_BACKGROUND_COLOR:"cellBackgroundColor",CELL_FOREGROUND_COLOR:"cellForegroundColor",COLOR_BY_ALTERNATIVE:"colorByAlternative",COLOR_BY_EXPRESSION:"colorByExpression",TOOLTIP:"tooltip",CELL_LINK_LABEL:"urlLabel",CELL_LINK_URL:"url"}},T={getNumDimensions:function(t){return a.getValue(t,"qHyperCubeDef.qDimensions.length",0)},getNumMeasures:function(t){return a.getValue(t,"qHyperCubeDef.qMeasures.length",0)},wrapFieldName:function(t){return t.split(" ").length>1&&"="!==t[0]&&"["!==t[0]?"[".concat(t,"]"):t},getItemLabel:function(t){return t.label||t.name}},R={colorModeOptions:{primary:function(){return!0},dimension:function(t){return T.getNumDimensions(t)>0&&T.getNumMeasures(t)<=1},multiColor:function(t){return T.getNumMeasures(t)>1},measure:function(t){return T.getNumDimensions(t)>0},expression:function(t){return T.getNumMeasures(t)>=1}}},P={colorModeOptions:{primary:function(){return!0},dimension:function(){return!0},multiColor:function(){return!1},measure:function(){return!0},expression:function(t){return T.getNumMeasures(t)>=1}}},F={scatterplot:P,"sn-scatter-plot":P,piechart:{colorModeOptions:{primary:function(){return!0},dimension:function(){return!0},multiColor:function(){return!1},measure:function(){return!0},expression:function(t){return T.getNumMeasures(t)>=1}}},linechart:{colorModeOptions:{primary:function(){return!0},dimension:function(t){return T.getNumDimensions(t)>1},multiColor:function(t){return T.getNumMeasures(t)>1},measure:function(t){return T.getNumDimensions(t)<=1},expression:function(t){return T.getNumMeasures(t)>=1}}},map:{colorModeOptions:{primary:function(){return!0},dimension:function(t){return T.getNumDimensions(t)>=1},multiColor:function(t){return T.getNumMeasures(t)>1},measure:function(t){return T.getNumDimensions(t)>=1},expression:function(t){return T.getNumDimensions(t)>=1}}},distributionplot:{colorModeOptions:{primary:function(){return!0},dimension:function(){return!0},multiColor:function(){return!1},measure:function(){return!0},expression:function(t){return T.getNumDimensions(t)>=1}}}};function L(t,e,n){if(Array.isArray(t[e])){var r=f.findIndexByPropertyValue(t[e],"id",n);r>=0&&t[e].splice(r,1)}else t[e]=[]}function j(t,e){var n=I.IDMAP.COLOR_BY_ALTERNATIVE;t.forEach((function(t){L(t,"qAttributeDimensions",n),L(t,"qAttributeExpressions",n)})),e.forEach((function(t){L(t,"qAttributeDimensions",n),L(t,"qAttributeExpressions",n)}))}function z(t,e){if(e){var n="="===e.charAt(0);t.color.altLabel=n?{qStringExpression:{qExpr:e.substr(1)}}:e}}function V(t){var e=t.properties,n=t.isDimension,r=t.dimensions,i=t.excludedDimensions,o=t.measures,s=t.label;j(r,i);var u=r[r.length-1];if(u){var l=n?a.getValue(e,"color.byDimDef"):a.getValue(e,"color.byMeasureDef"),c=a.getValue(e,"color.formatting.qNumFormat"),h=a.getValue(e,"color.formatting.isCustomFormatted");if(l){var d=I.create(I.IDMAP.COLOR_BY_ALTERNATIVE);switch(l.type){case"expression":!function(t){var e=t.attributeExpression,n=t.label,r=t.item,i=t.isDimension,o=t.qNumFormat,a=t.isCustomFormatted;e.label=n||r.label,i?e.qDef=r.key:(e.qExpression=r.key,o&&(e.qNumFormat=o,e.isCustomFormatted=a)),e.matchMeasure=r.activeMeasureIndex,e.label&&"="===e.label.charAt(0)&&(e.labelExpRef="color.altLabel")}({attributeExpression:d,label:s,item:l,isDimension:n,qNumFormat:c,isCustomFormatted:h});break;case"libraryItem":!function(t){var e=t.attributeExpression,n=t.measures,r=t.item,i=t.isDimension,o=t.qNumFormat,a=t.isCustomFormatted;i||(e.matchMeasure=f.findIndexByPropertyValue(n,"qLibraryId",r.key),o&&(e.qNumFormat=o,e.isCustomFormatted=a)),void 0!==r.expression?e.qExpression=r.expression:e.qLibraryId=r.key,e.colorMapRef=r.key}({attributeExpression:d,measures:o,item:l,isDimension:n,qNumFormat:c,isCustomFormatted:h})}n?(d.qSortBy={qSortByAscii:1},u.qAttributeDimensions.push(d)):u.qAttributeExpressions.push(d)}}}function H(t,e,n,r){var i,o,a,s={};switch(t){case"dimension":n.qLibraryId?(s.type="dimension",s.name=n.qLibraryId,s.id=n.qLibraryId):(s.type="field",e?(s.name=n.label||n.qDef,s.id=n.qDef):(s.name=n.qDef.qFieldDefs[0],s.label=(a=n.qDef).qLabelExpression?a.qLabelExpression:a.qFieldLabels&&a.qFieldLabels[0]?a.qFieldLabels[0]:a.qFieldDefs[0]));break;case"measure":(i=function(t,e){return e?t.qLibraryId:p.a.measureBase.getLibraryId(t)}(n,e))?(s.type="measure",s.name=i,s.id=i,(o=function(t,e){return p.a.hasActiveModifiers({measures:[t]})&&e?t.qDef.qDef:void 0}(n,r))&&(s.expression=o)):(s.type="expression",e?(s.name=n.label||n.qExpression,s.id=n.qExpression):(s.name=n.qDef.qDef,s.label=function(t){var e=t.qDef;return e.qLabelExpression?e.qLabelExpression:e.qLabel?e.qLabel:e.qDef}(n)));break;default:throw new Error('columnType should be "dimension" or "measure"')}return s}var B={useMasterNumberFormat:function(t){t.quarantine={qNumFormat:t.qNumFormat||{},isCustomFormatted:t.isCustomFormatted||!1},t.qNumFormat=null,t.isCustomFormatted=void 0}};function W(t,e,n,r){var i=n?"expression":e.type,o=t.color,a=o.mode,s=T.getItemLabel(e);switch(z(t,s||""),i){case"field":a="byDimension",o.byDimDef={label:e.label||T.wrapFieldName(e.name),key:T.wrapFieldName(e.name),type:"expression",activeDimensionIndex:e.activeDimensionIndex};break;case"expression":a="byMeasure",o.byMeasureDef={label:n||s,key:n||e.name,type:"expression",activeMeasureIndex:e.activeMeasureIndex};break;case"dimension":a="byDimension",o.byDimDef={label:e.name,key:e.id,type:"libraryItem",activeDimensionIndex:e.activeDimensionIndex};break;case"measure":a="byMeasure",o.byMeasureDef={label:e.name,key:e.id,expression:e.expression,type:"libraryItem",activeMeasureIndex:e.activeMeasureIndex},o.formatting&&B.useMasterNumberFormat(o.formatting)}r||(o.auto=!1,o.mode=a)}function U(t,e){var n=a.getValue(t,"".concat(e,"qDimensions"),[]),r=n[function(t,e,n){var r=a.getValue(e,"visualization"),i=n.split("."),o=Number(i[1]),s=a.getValue(e,"layers.".concat(o,".type"));return 2===t.length&&"map"===r&&"point"===s}(n,t,e)?0:n.length-1],i=I.IDMAP.COLOR_BY_ALTERNATIVE,o=f.findItemByPropertyValue(r.qAttributeDimensions,"id",i);return W(t,H("dimension",!!o,o||r)),!!o}function Y(t,e){var n=a.getValue(t,"".concat(e,"qDimensions"),[]),r=a.getValue(t,"".concat(e,"qMeasures"),[]),i=a.getValue(t,"".concat(e,"qLayoutExclude.qHyperCubeDef.qDimensions"),[]),o=a.getValue(t,"color.byDimDef");if(o&&z(t,o.label),function(t){return!!(t&&t.activeDimensionIndex>-1)}(o))!function(t,e){var n=a.getValue(t,"".concat(e,"qDimensions"),[]),r=a.getValue(t,"color.byDimDef");r.activeDimensionIndex=Math.min(r.activeDimensionIndex,n.length-1);var i=H("dimension",!1,n[r.activeDimensionIndex]);i.activeDimensionIndex=r.activeDimensionIndex,W(t,i)}(t,e);else if(function(t){return!t||!t.key}(o)&&U(t,e))return;V({properties:t,isDimension:!0,dimensions:n,excludedDimensions:i,measures:r,label:a.getValue(t,"color.byDimDef.label")})}function $(t,e){var n=a.getValue(t,"".concat(e,"qDimensions"),[]),r=a.getValue(t,"".concat(e,"qMeasures"),[]),i=a.getValue(t,"".concat(e,"qLayoutExclude.qHyperCubeDef.qDimensions"),[]),o=a.getValue(t,"color.byMeasureDef");if(o&&z(t,o.label),function(t){return!!(t&&t.activeMeasureIndex>-1)}(o))!function(t,e){var n=a.getValue(t,"".concat(e,"qMeasures"),[]),r=a.getValue(t,"color.byMeasureDef");if(r.activeMeasureIndex=Math.min(r.activeMeasureIndex,n.length-1),r.activeMeasureIndex>-1){var i=H("measure",!1,n[r.activeMeasureIndex],!0);i.activeMeasureIndex=r.activeMeasureIndex,W(t,i)}}(t,e);else if(function(t,e){return(!t||!t.key)&&e.length>0}(o,r)&&function(t,e){var n=a.getValue(t,"".concat(e,"qDimensions"),[]),r=a.getValue(t,"".concat(e,"qMeasures"),[]),i=n[n.length-1],o=I.IDMAP.COLOR_BY_ALTERNATIVE,s=f.findItemByPropertyValue(i.qAttributeExpressions,"id",o);return W(t,H("measure",!!s,s||r[0])),!!s}(t,e))return;V({properties:t,isDimension:!1,dimensions:n,excludedDimensions:i,measures:r,label:a.getValue(t,"color.byMeasureDef.label")})}var X={changeProperty:function(t,e,n){a.setValue(t,e,n),a.isAtomicValue(n)&&function(t,e,n){var r=t.qLayoutExclude;r&&(r.changed||(r.changed={}),r.changed[e]={from:a.getValue(t,e),to:n})}(t,e,n)},getCanColorBy:function(t,e){var n={primary:!0};if(t){var r=(F[e]||R).colorModeOptions||R.colorModeOptions;n.byDimension=r.dimension(t),n.byMeasure=r.measure(t),n.byMultiple=r.multiColor(t),n.byExpression=r.expression(t)}return n},shouldUpdateColorBy:function(t){var e=t.canColorBy,n=t.autoColor,r=t.colorMode,i=t.dimensions;return!(e[r]&&!n&&("byDimension"!==r&&"byMeasure"!==r||!i.length))},updateColorBy:function(t,e){var n=a.getValue(t,"color.mode"),r=a.getValue(t,"color.auto"),i=a.getValue(t,"".concat(e,"qDimensions"),[]),o=a.getValue(t,"".concat(e,"qMeasures"),[]),s=a.getValue(t,"".concat(e,"qLayoutExclude.qHyperCubeDef.qDimensions"),[]);r?j(i,s):function(t){var e=t.auto,n=t.colorMode,r=t.dimensions;return!e&&"byDimension"===n&&r.length>0}({auto:r,colorMode:n,dimensions:i})?Y(t,e):function(t){var e=t.auto,n=t.colorMode,r=t.dimensions,i=t.measures,o=t.properties,s=a.getValue(o,"visualization");return!(e||"byMeasure"!==n||!r.length||"map"!==s&&!i.length)}({auto:r,colorMode:n,dimensions:i,measures:o,properties:t})?$(t,e):function(t,e){var n=a.getValue(t,"color.mode"),r=a.getValue(t,"".concat(e,"qDimensions"),[]),i=a.getValue(t,"".concat(e,"qMeasures"),[]),o=a.getValue(t,"".concat(e,"qLayoutExclude.qHyperCubeDef.qDimensions"),[]);"byMultiple"===n&&i.length<2&&a.setValue(t,"color.mode","primary"),j(r,o)}(t,e)},deleteTotalMode:function(t){t.forEach((function(t){t.qOtherTotalSpec&&"qTotalMode"in t.qOtherTotalSpec&&delete t.qOtherTotalSpec.qTotalMode}))},shouldAddColorByExpression:function(t){var e=t.shouldUpdateColorBy,n=t.properties,r=a.getValue(n,"qHyperCubeDef.qMeasures",[]),i=a.getValue(n,"color.mode","");return!e&&"byExpression"===i&&r.length>0},addColorByExpression:function(t){var e=a.getValue(t,"qHyperCubeDef.qMeasures.0.qAttributeExpressions",[]),n=a.getValue(t,"color.colorExpression","");e.splice(0,0,{qExpression:n,id:"colorByExpression"}),a.setValue(t,"qHyperCubeDef.qMeasures.0.qAttributeExpressions",e)},switchToAutoColor:function(t){a.setValue(t,"color.mode","primary"),a.setValue(t,"color.auto",!0)},shouldSwitchToColorPersistent:function(t){var e=a.getValue(t,"qHyperCubeDef.qDimensions",[]),n=a.getValue(t,"color.persistent",!1);return e.length>1&&!n}},G={exportProperties:function(t){var e=t.propertyTree,n=t.hypercubePath,r=t.viewDataMode,i=E.exportProperties({propertyTree:e,hypercubePath:n,viewDataMode:r}),o=i.data[0],a=o.dimensions.concat(o.excludedDimensions),s=o.measures.concat(o.excludedMeasures),u=I.IDMAP,l=u.COLOR_BY_ALTERNATIVE,c=u.COLOR_BY_EXPRESSION;return I.moveByIdFromGroup(a,[],"qAttributeDimensions",l),I.moveByIdFromGroup(a,[],"qAttributeExpressions",l),I.moveByIdFromGroup(s,[],"qAttributeExpressions",c),i},importProperties:function(t){var e=t.exportFormat,n=t.initialProperties,r=t.dataDefinition,i=t.defaultPropertyValues,o=t.hypercubePath,s=t.extension,u=t.supportedFilters,l=t.isHCModifierSupported,c=E.importProperties({exportFormat:e,initialProperties:n,dataDefinition:r,defaultPropertyValues:i,hypercubePath:o,extension:s,supportedFilters:u,isHCModifierSupported:l}),h=c.qProperty,f=a.getValue(h,"visualization"),d=a.getValue(h,"qHyperCubeDef.qDimensions",[]),p=a.getValue(h,"color.mode",""),m=a.getValue(h,"color.auto",""),g=X.getCanColorBy(h,f),y=X.shouldUpdateColorBy({canColorBy:g,autoColor:m,colorMode:p,dimensions:d});return g[p]?X.shouldAddColorByExpression({shouldUpdateColorBy:y,properties:h})&&X.addColorByExpression(h):X.switchToAutoColor(h),y&&X.updateColorBy(h,"qHyperCubeDef."),X.shouldSwitchToColorPersistent(h)&&X.changeProperty(h,"color.persistent",!0),X.deleteTotalMode(d),c}},K=["bar","marker","line"],J={handleAutoMinMax:function(t){var e=t.initialProperties,n=t.properties;e.measureAxis&&void 0===e.measureAxis.autoMinMax?C(n,"unsupportedAutoMinMax")||v()(n.measureAxis,e.measureAxis):C(n,"supportedAutoMinMax")||v()(n.measureAxis,e.measureAxis)},handleMeasuresAxis:function(t){var e,n=t.exportFormat,r=t.initialProperties,i=t.properties,o=t.measureType,a=i.qHyperCubeDef,s=i.measureAxis;if(function(t){var e=t.exportFormat,n=t.initialProperties;return!(!e.properties.measureAxes||n.measureAxes||!n.measureAxis||void 0===n.measureAxis.autoMinMax)}({exportFormat:n,initialProperties:r})){var u=function(t){var e=[];return t.qMeasures.length>0&&t.qMeasures.forEach((function(t){if(t.qDef.series){var n=t.qDef.series,r=n.type,i=n.axis;e[i]||(e[i]={axis:i,type:{line:0,marker:0,bar:0,total:0}}),K.includes(r)&&e[i].type[r]++,e[i].type.total++}})),e}(a);u.length?(o&&(e=u.filter((function(t){return t.type[o]>0})).sort((function(t,e){return e.type[o]-t.type[o]}))),e&&e.length||(e=u.sort((function(t,e){return e.type.total-t.type.total}))),e&&e[0]&&v()(s,n.properties.measureAxes[e[0].axis])):v()(s,n.properties.measureAxes[0])}},setInterColumnSortOrder:function(t){if(t.qDimensions.length>1){var e=t.qInterColumnSortOrder.indexOf(0);if(0!==e){var n=t.qInterColumnSortOrder[0];t.qInterColumnSortOrder[0]=0,t.qInterColumnSortOrder[e]=n}}}},Z={exportProperties:function(t){var e=t.propertyTree,n=t.hypercubePath,r=t.viewDataMode,i=t.supportedAutoMinMax,o=void 0===i||i,a=G.exportProperties({propertyTree:e,hypercubePath:n,viewDataMode:r}),s=a.properties;return o?(g(s,"measureAxis.min","supportedAutoMinMax"),g(s,"measureAxis.max","supportedAutoMinMax")):(g(s,"measureAxis.min","unsupportedAutoMinMax"),g(s,"measureAxis.max","unsupportedAutoMinMax")),a},importProperties:function(t){var e=t.exportFormat,n=t.initialProperties,r=t.dataDefinition,i=t.defaultPropertyValues,o=t.hypercubePath,a=t.measureType,s=t.extension,u=t.supportedFilters,l=t.isHCModifierSupported,c=G.importProperties({exportFormat:e,initialProperties:n,dataDefinition:r,defaultPropertyValues:i,hypercubePath:o,extension:s,supportedFilters:u,isHCModifierSupported:l}),h=c.qProperty;return J.handleAutoMinMax({initialProperties:n,properties:h}),J.handleMeasuresAxis({exportFormat:e,initialProperties:n,properties:h,measureType:a}),J.setInterColumnSortOrder(h.qHyperCubeDef),c}};function Q(t,e,n){return"qLayoutExclude.quarantine.".concat(t,".").concat(e,".").concat(n)}function tt(t){var e=t.properties,n=t.arrayPath,r=t.quarantineName,i=t.arrayName,o=t.itemPath;a.getValue(e,n,[]).forEach((function(t){return function(t){var e=t.properties,n=t.quarantineName,r=t.arrayName,i=t.item,o=t.itemPath,s=a.getValue(i,o);if(void 0!==s){var u=a.getValue(i,"qDef.cId");u||(u=a.generateId(),a.setValue(i,"qDef.cId",u));var l=Q(n,r,u);a.setValue(e,l,s),a.setValue(i,o,void 0)}}({properties:e,quarantineName:r,arrayName:i,item:t,itemPath:o})}))}function et(t){var e=t.properties,n=t.arrayPath,r=t.quarantineName,i=t.arrayName,o=t.itemPath;a.getValue(e,n,[]).forEach((function(t){return function(t){var e=t.properties,n=t.quarantineName,r=t.arrayName,i=t.item,o=t.itemPath,s=a.getValue(i,"qDef.cId");if(s){var u=Q(n,r,s),l=a.getValue(e,u);void 0!==l&&(a.setValue(i,o,l),a.setValue(e,u,void 0))}}({properties:e,quarantineName:r,arrayName:i,item:t,itemPath:o})}))}var nt={quarantine:function(t){tt({properties:t,arrayPath:"qHyperCubeDef.qMeasures",quarantineName:"conditionalColoring",arrayName:"measures",itemPath:"qDef.conditionalColoring"})},unquarantine:function(t){et({properties:t,arrayPath:"qHyperCubeDef.qMeasures",itemPath:"qDef.conditionalColoring",arrayName:"measures",quarantineName:"conditionalColoring"})}},rt={quarantine:function(t){tt({properties:t,arrayPath:"qHyperCubeDef.qMeasures",quarantineName:"conditionalShowHide",arrayName:"measures",itemPath:"qCalcCondition"}),tt({properties:t,arrayPath:"qHyperCubeDef.qDimensions",quarantineName:"conditionalShowHide",arrayName:"dimensions",itemPath:"qCalcCondition"})},unquarantine:function(t){et({properties:t,arrayPath:"qHyperCubeDef.qMeasures",quarantineName:"conditionalShowHide",arrayName:"measures",itemPath:"qCalcCondition"}),et({properties:t,arrayPath:"qHyperCubeDef.qDimensions",quarantineName:"conditionalShowHide",arrayName:"dimensions",itemPath:"qCalcCondition"})}};e.default={hypercube:E,colorChart:G,axisChart:Z,quarantineProperty:g,unquarantineProperty:C,quarantineArrayProp:tt,unquarantineArrayProp:et,conditionalColoring:nt,conditionalShow:rt}}])}(NM);var OM=He(NM.exports);function IM(t){t.flags;var e={items:{simpleItems:{items:{autoColor:{change:function(t){var e,n,r;null!==(e=t.color)&&void 0!==e&&e.auto||((null===(n=t.qHyperCubeDef)||void 0===n||null===(r=n.qDimensions)||void 0===r?void 0:r.length)>1?(ue(t,"color.mode","byDimension"),ue(t,"color.byDimDef.activeDimensionIndex",0)):ue(t,"color.mode","primary"))}}}}}},n={items:{labels:{items:{header:{show:function(t){return t.qHyperCubeDef.qDimensions.length&&t.qHyperCubeDef.qMeasures.length}},valueLabels:{component:"checkbox",ref:"labels.values",type:"boolean",translation:"Simple.Label.Value",show:function(t){return t.qHyperCubeDef.qDimensions.length&&t.qHyperCubeDef.qMeasures.length},convertFunctions:{get:function(t,e,n,r){var i,o;return(null===(i=r.labels)||void 0===i?void 0:i.leaves)&&(null===(o=r.labels)||void 0===o?void 0:o.values)},set:function(t,e,n,r,i){ue(i,"labels.leaves",!0),ue(i,"labels.values",t)}}},headers:{component:"checkbox",ref:"labels.headers",type:"boolean",defaultValue:!0,translation:"Simple.Label.Header",show:function(t){return t.qHyperCubeDef.qDimensions.length>1&&t.qHyperCubeDef.qMeasures.length},convertFunctions:{get:function(t,e,n,r){var i,o;return(null===(i=r.labels)||void 0===i?void 0:i.auto)||(null===(o=r.labels)||void 0===o?void 0:o.headers)},set:function(t,e,n,r,i){t||ue(i,"labels.auto",!1),ue(i,"labels.headers",t)}}}}}}},r={uses:"settings",items:{simpleLabels:n,general:{items:{showDisclaimer:{translation:"properties.showDisclaimer",type:"boolean",ref:"showDisclaimer",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Show"},{value:!1,translation:"properties.hide"}]}}},presentation:{type:"items",translation:"properties.presentation",grouped:!1,items:{labels:{type:"items",items:{auto:{ref:"labels.auto",type:"boolean",translation:"properties.dataPoints.headersAndLabels",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],snapshot:{tid:"property-dataPoints"}},headers:{ref:"labels.headers",translation:"properties.dataPoints.headers",type:"boolean",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t,e){return!se(t,"labels.auto")&&function(t,e){var n=e.getDimensions();return e.getMeasures().length+n.length>2}(0,e)}},overlay:{ref:"labels.overlay",type:"boolean",component:"switch",translation:"properties.dataPoints.overlayLabels",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t,e){return!se(t,"labels.auto")&&e.getDimensions().length-(se(t,"labels.headers")?1:0)>1}},leaves:{ref:"labels.leaves",type:"string",translation:"properties.dataPoints.leafLabels",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t){return!se(t,"labels.auto")},snapshot:{tid:"property-leafLabels"}},values:{ref:"labels.values",type:"boolean",component:"switch",translation:"properties.dataPoints.labelmode",defaultValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t){return se(t,"labels.auto")||se(t,"labels.leaves")}}}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{simpleColors:e,legend:{items:{show:{defaultValue:!1}}}}},tooltips:{uses:"tooltip"}}};return{type:"items",component:"accordion",items:{data:{uses:"data",items:{dimensions:{},measures:{}}},addons:{type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null,calcCond:{uses:"calcCond"}}}}},settings:r}}}function TM(t,e){var n=e.getDimensions(),r=e.getMeasures(),i=se(t,"color.mode");n.length>1&&t.color?t.color.persistent=!0:"byExpression"===i&&0===r.length&&ue(t,"color.mode","primary")}function RM(t){var e=t.translator;return{dimensions:{min:1,max:15,description:function(t,n){var r=n>=t.qHyperCubeDef.qDimensions.length-1?"Visualizations.Descriptions.Rectangle":"Visualizations.Descriptions.Group";return e.get(r)},add:function(t,e,n){TM(e,n)},move:function(t,e,n){!function(t){var e;t.getDimensions().length>1&&0!==(e=t.getSorting().indexOf(0))&&t.changeSorting(e,0)}(n),TM(e,n)},remove:function(t,e,n){!function(t,e){ue(e,"color.dimensionId",void 0)}(0,e),TM(e,n)},replace:function(t,e,n,r){se(r,"color.dimensionId")===e.qDef.cId&&ue(r,"color.dimensionId",t.qDef.cId)}},measures:{min:1,max:1,description:function(t,n){var r=0===n?"Visualizations.Descriptions.Size":"Visualizations.Descriptions.Color";return e.get(r)},add:function(t,e,n){TM(e,n)},move:function(t,e,n){TM(e,n)},remove:function(t,e,n){TM(e,n)}}}}function PM(t){return t.qHyperCube.qDimensionInfo.length||0}function FM(t){return se(t,"labels.auto")}var LM={type:"items",component:"accordion",items:{data:{uses:"data"},presentation:{uses:"presentation",type:"items",translation:"properties.presentation",grouped:!1,items:{labels:{type:"items",items:{auto:{ref:"labels.auto",type:"boolean",translation:"properties.dataPoints.headersAndLabels",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},headers:{ref:"labels.headers",translation:"properties.dataPoints.headers",type:"boolean",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t,e){return function(t,e){return!FM(t)&&function(t){return t.qHyperCube.qMeasureInfo.length||0}(e)+PM(e)>2}(t,e)}},overlay:{ref:"labels.overlay",type:"boolean",component:"switch",translation:"properties.dataPoints.overlayLabels",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t,e){return function(t,e){return!FM(t)&&PM(e)-(se(t,"labels.headers")?1:0)>1}(t,e)}},leaves:{ref:"labels.leaves",type:"string",translation:"properties.dataPoints.leafLabels",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t){return!FM(t)}},values:{ref:"labels.values",type:"boolean",component:"switch",translation:"properties.dataPoints.labelmode",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(t){return FM(t)||se(t,"labels.leaves")}}}}}}}};function jM(t){return t&&!(t.qHyperCube.qMeasureInfo.every((function(t){return t.qMax<=0&&t.qMax>=t.qMin}))||0===t.qHyperCube.qSize.qcy)}function zM(t){return{definition:IM(t),softDefinition:LM,support:{cssScaling:!1,snapshot:jM,export:jM,exportData:!0,sharing:jM,viewData:!0},importProperties:function(e,n,r){return OM.colorChart.importProperties({exportFormat:e,initialProperties:n,dataDefinition:RM(t),defaultPropertyValues:{defaultDimension:r.getDefaultDimensionProperties(),defaultMeasure:r.getDefaultMeasureProperties()}})},exportProperties:function(t){return OM.colorChart.exportProperties({propertyTree:t})}}}return function(e){var i=Kx({renderer:e.renderer}),o=i.pic,s=i.picassoQ,u=!0,l="This chart cannot be displayed.";return o.component("treemap",SM()),e.carbon&&(o.component("floating",{require:["chart","renderer","element"],on:{touchstart:function(t){var e=this.settings.content,n={x:t.clientX,y:t.clientY},r=this.chart.shapesAt(n),i=r.length>=2?1:0;if(r.length>=1){var o=r[i];n.x=o.x,n.y=o.y,n.rect=o,n.tap=t,n.content=e(r,i),this.chart.element.emit("onTooltipData",n)}}},render:function(){return[]}}),o.component("nativeLegend",{require:["chart","renderer","element"],preferredSize:function(){return 68},mounted:function(){this.chart.element.mountCatLegend(this.data.fields[0].title())},render:function(t){var e=t.data,n=this.settings.settings.persistent,r=this.chart.scale(this.settings.scale).range(),i=e.items.map((function(t,e){return{label:t.label,color:r[(n?t.value:e)%r.length]}}));return this.chart.element.setCatLegendData(i),[{type:"rect",x:0,y:0,width:this.rect.width,height:this.rect.height,fill:"black",opacity:0}]}}),u=e.showLegend,l=e.invalidMessage),{qae:CM,ext:zM(e),component:function(){var i=t.useTheme(),c=t.useLayout(),d=t.useElement(),p=t.useSelections(),m=t.useTranslator(),g=t.useApp(),y=t.useModel(),v=t.useRect(),x=t.useOptions(),b=t.useAppLayout().qLocaleInfo,w=h(t.useState(void 0),2),M=w[0],k=w[1],_=t.useState({mounted:!1});t.useEffect((function(){return function(){M&&M.destroy()}}),[d,M]),t.useEffect((function(){M&&null!=c&&c.qHyperCube&&M.update()}),[v.width,v.height,M]),t.useEffect((function(){if(!_.mounted&&void 0!==p&&c.qHyperCube){_.mounted=!0;var t=o.chart({element:d,settings:{},data:[]});_.selectBrush=t.brush("dataContext"),_.lassoBrush=t.brush("lassoContext"),p.addListener("cleared",(function(){_.selectBrush.clear(),_.lassoBrush.clear()})),p.addListener("aborted",(function(){_.selectBrush.end(),_.lassoBrush.end()})),EM({selectBrush:_.selectBrush,picassoQ:s,selections:p}),EM({selectBrush:_.lassoBrush,picassoQ:s,selections:p,lasso:!0}),k(t)}}),[d,c,p,i,x]);var q=t.usePromise(a(r().mark((function t(){var a,h,d,v;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(M&&!c.qSelectionInfo.qInSelections){t.next=2;break}return t.abrupt("return");case 2:return a=ae({picasso:o,model:y,app:g,translator:m,config:{auto:AM,key:"fill"}}),h=function(t){var e=t.getUseBaseColors;return{theme:i,legendProps:c.legend,layout:c,localeInfo:b,hc:c.qHyperCube,colorProps:n(n({},c.color),{},{useBaseColors:e(c)})}},t.next=6,a.initialize({createConfig:h});case 6:d=Yb({layout:c,theme:i,env:e,picassoQ:s,selectionsApi:p,showLegend:u,invalidMessage:l,translator:m,colorService:a,chart:M,options:x}),v=[{type:"q",key:"qHyperCube",data:c.qHyperCube,config:{localeInfo:b}}].concat(f(a.getData())),M.update({data:v,settings:d}),_.selectBrush.end(),_.lassoBrush.end();case 11:case"end":return t.stop()}}),t)}))),[c,M,i,p,x]),D=h(q,2)[1];if(D)throw D}}}}));
